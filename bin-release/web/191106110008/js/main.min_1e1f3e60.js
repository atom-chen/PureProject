var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{h(n.next(t))}catch(e){r(e)}}function s(t){try{h(n["throw"](t))}catch(e){r(e)}}function h(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,s)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,r&&(a=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,r=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(a=h.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){h.label=i[1];break}if(6===i[0]&&h.label<a[1]){h.label=a[1],a=i;break}if(a&&h.label<a[2]){h.label=a[2],h.ops.push(i);break}a[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],r=0}finally{o=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,r,a,s,h={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},BaseThing=function(t){function e(){var e=t.call(this)||this;return e.disappear=!0,e.canTouch=!0,e.isView=!1,e.touchEnabled=!1,e.touchChildren=!1,e.cellXY={x:0,y:0},e.title=new ThingTitle,e.addChild(e.title),e}return __extends(e,t),e.prototype.init=function(t){this.disappear=!1,this.pro=t,this.initPropertys(t),this.setCellXY(t.pro(PropId.AP_X),t.pro(PropId.AP_Y),!0),this.title.setName(this.pro.charName)},e.prototype.initPropertys=function(t){for(var e in t){var i=parseInt(e),n=t.pro(i);this.updateProperty(i,n)}},e.prototype.updateProperty=function(t,e){switch(this.pro.pro(t,e),t){case PropId.AP_ACTOR_ID:this.id=e}},e.prototype.setCellXY=function(t,e,i){void 0===i&&(i=!1),this.cellXY.x=t,this.cellXY.y=e,this.x=GameCache.map.cellWidth*(t+.5)>>0,this.y=GameCache.map.cellHeight*(e+.5)>>0},e.prototype.isTouch=function(t,e){return this.canTouch?this.disappear?!1:Math.abs(this.x-t)<40&&this.y-e<120&&this.y>=e:!1},e.prototype.update=function(t){},e.prototype.checkInView=function(t,e,i,n){var o=this.getWidth(),r=this.getHeight(),a=this.x,s=this.y,h=!0;t>=a+o?h=!1:a>=t+i?h=!1:e>=s+r?h=!1:s>=e+n&&(h=!1),this.setOnView(h)},e.prototype.getWidth=function(){return 40},e.prototype.getHeight=function(){return 120},e.prototype.setOnView=function(t){this.isView!=t&&(this.isView=t,t?App.ThingManager.playerLayer.addChild(this):this.parent&&this.parent.removeChild(this))},Object.defineProperty(e.prototype,"isInView",{get:function(){return this.isView&&null!=this.stage},enumerable:!0,configurable:!0}),e.prototype.say=function(t,e){void 0===e&&(e=5e3),this.getBubbles(),this.bubbles.setData(t,e)},e.prototype.getBubbles=function(){this.bubbles&&this.bubbles.parent==this||(this.bubbles=ObjectPool.get(ThingBubbles),this.addChild(this.bubbles)),this.bubbles.y=-120,this.bubbles.x=0},e.prototype.removeBubbles=function(){this.bubbles&&(this.bubbles.parent==this&&this.bubbles.dispose(),this.bubbles=null)},e.prototype.dispose=function(){this.setOnView(!1),this.removeBubbles(),this.pro=null,ObjectPool.push(this)},e}(egret.DisplayObjectContainer);__reflect(BaseThing.prototype,"BaseThing",["IThing"]);var DisplayObjectContainer=egret.DisplayObjectContainer,BaseEuiComponent=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.event=[],i.flushList=[],i._myParent=e,i.isInit=!1,i.touchEnabled=!1,i}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init(),this.isInit=!0},e.prototype.init=function(){},e.prototype.open=function(t){void 0===t&&(t=null)},e.prototype.close=function(t){void 0===t&&(t=null),this.removeAllEvent()},Object.defineProperty(e.prototype,"myParent",{get:function(){return this._myParent},enumerable:!0,configurable:!0}),e.prototype.isShow=function(){return null!=this.stage},e.prototype.addToParent=function(){this._myParent&&this._myParent.addChild(this)},e.prototype.removeFromParent=function(){this.removeAllEvent(),App.DisplayUtils.removeFromParent(this),App.DisplayUtils.removeFromParent(this.$modalTipsRect)},e.prototype.dispose=function(){this.destroy()},e.prototype.destroy=function(){this.removeFromParent(),this._myParent=null,this.disposeChildren(this),this.removeAllEvent()},e.prototype.disposeChildren=function(t){if(t.numChildren)for(var e,i=t.numChildren;i;)i--,e=t.removeChildAt(0),e instanceof eui.Image&&e.texture&&(e.source=null),e.clickEff&&App.DisplayUtils.removeClickEff(e),e.stop&&e.stop(),e.dispose&&e.dispose(),e instanceof eui.List&&(e.dataProvider=null),this.disposeChildren(e)},e.prototype.setVisible=function(t){this.visible=t},e.prototype.setListData=function(t,e,i){void 0===i&&(i=!1);var n=t.dataProvider;n?n.length!=e.length?n.source=e:i?n.replaceAll(CommonUtils.copyDataHandler(e)):n.source=e:t.dataProvider=new eui.ArrayCollection(e)},e.prototype.addItemClick=function(t,e){this.addEvent(eui.ItemTapEvent.ITEM_TAP,t,e)},e.prototype.addTouchEvent=function(t,e){this.addEvent(egret.TouchEvent.TOUCH_TAP,t,e)},e.prototype.removeTouchEvent=function(t,e){t.removeEventListener(egret.TouchEvent.TOUCH_TAP,e,this)},e.prototype.addEvent=function(t,e,i){e.addEventListener(t,i,this),this.event.push([t,i,e])},e.prototype.removeAllEvent=function(){for(var t=0,e=this.event;t<e.length;t++){var i=e[t];i[2].removeEventListener(i[0],i[1],this)}this.event=[],this.removeMessage(),App.TimerManager.removeAll(this),this.removeFlushFun()},e.prototype.message=function(t,e){App.MessageCenter.addListener(t,e,this)},e.prototype.removeMessage=function(){App.MessageCenter.removeAll(this)},e.prototype.flushFun=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(e)for(var o=0,r=this.flushList.length;r>o;o++)if(this.flushList[o].fun==t){this.flushList.splice(o,1);break}this.flushList.push({fun:t,param:i}),App.TimerManager.isExists(this.onFlush,this)||App.TimerManager.addFrame(2,this.onFlush,this)},e.prototype.onFlush=function(){var t=this.flushList.shift();t&&t.fun.apply(this,t.param)},e.prototype.removeFlushFun=function(){this.flushList.length=0},e}(eui.Component);__reflect(BaseEuiComponent.prototype,"BaseEuiComponent");var BaseMoveThing=function(t){function e(){var e=t.call(this)||this;return e.moveSpeed=GlobalVar.DEFAULT_MOVE_SPEED,e.moveSpeedX=2,e.moveSpeedY=2,e.isMove=!1,e.isJump=!1,e.isfollow=!1,e._jumpValue=0,e._jumpStartPos=new XY,e._jumpTopPos=new XY,e._jumpEndPos=new XY,e.touchEnabled=e.touchChildren=!1,e.body=new ThingBody(e),e.body.callHandler=Handler.create(e,e.bodyPlayComplete,null,!1),e}return __extends(e,t),e.prototype.init=function(e){this.moveSpeed=GlobalVar.DEFAULT_MOVE_SPEED,this.playAction(ActionStandard.SA_IDLE),this.body.init(e),t.prototype.init.call(this,e)},e.prototype.updateProperty=function(e,i){switch(t.prototype.updateProperty.call(this,e,i),e){case PropId.AP_BODY_ID:case PropId.AP_HAIR:case PropId.AP_HAT:case PropId.AP_EYE:case PropId.AP_GLASSES:case PropId.AP_PANTS:case PropId.AP_ASSIST:case PropId.AP_WEAPON:case PropId.AP_BACK:case PropId.AP_SWING:this.body.changeSkin();break;case PropId.AP_MOVE_SPEED:this.moveSpeed=i}},e.prototype.loadBody=function(t){this.body.changeSkin()},e.prototype.playAction=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),t==ActionStandard.SA_STRUCK&&(this.nextAction||this.curAction!=ActionStandard.SA_IDLE&&this.curAction!=ActionStandard.SA_RUN)||(this.nextAction=t,this.nextActionNum=e,i&&this.playNextAction())},e.prototype.playNextAction=function(){var t=this.nextAction,e=this.nextActionNum;return t==ActionStandard.SA_STRUCK&&this.curAction!=ActionStandard.SA_IDLE&&this.curAction!=ActionStandard.SA_RUN?void(this.nextAction=null):(this.curAction=t,this.body.playAction(ActionStandard.getSpine(t),e),void(this.nextAction=null))},Object.defineProperty(e.prototype,"action",{get:function(){return this.curAction},enumerable:!0,configurable:!0}),e.prototype.moveTo=function(t,e){var i=GameCache.map.findPath(this.cellXY.x,this.cellXY.y,t,e);return this.setPath(i),i&&i.length>0},e.prototype.stopMove=function(){this.clearPath(),this.endMove()},e.prototype.setPath=function(t){this.clearPath(),t&&0==t.length&&(t=null),this.path=t},e.prototype.addPathPoint=function(t,e){var i=new CWTPoint;i.mX=t,i.mY=e,this.path||(this.path=[]),this.path.push(i)},e.prototype.update=function(t){if(!this.isJump){var e=this.tarPoint;if(this.tarPoint)if(this.moveTargetTime<=t)this.arrivedPathPoint();else{var i=this.moveSpeedX*(t-this.moveStarTime),n=this.moveSpeedY*(t-this.moveStarTime);this.x+=i,this.y+=n,this.moveStarTime=t,this.checkCellXY()}else if(this.path){this.tarPoint=this.path.shift(),e=this.tarPoint;var o=this.cellXY;if(e){var r=Math.pow(Math.pow(o.x-e.mX,2)+Math.pow(o.y-e.mY,2),.5),a=GameCache.map.cellWidth,s=GameCache.map.cellHeight,h=r*this.moveSpeed;this.updateBodyDir(this.cellXY.x,e.mX);var p=GameCache.map.isJump(o.x,o.y,e.mX,e.mY);p?this.jumpTo((e.mX+.5)*a,(e.mY+.5)*s,.8*(h+1*this.moveSpeed)):(this.moveTargetTime=t+h,this.moveStarTime=t,this.moveSpeedX=(e.mX-o.x)*a/h,this.moveSpeedY=(e.mY-o.y)*s/h,this.startMove())}else this.endMove()}else this.endMove();null!=this.nextAction&&this.playNextAction()}},e.prototype.jumpTo=function(t,e,i){this.isJump=!0,this.isMove=!0,this._jumpX=t,this._jumpY=e,this._jumpTime=i,this.jumpStart()},e.prototype.jumpStart=function(){if(!this.disappear){this.playAction(ActionStandard.SA_JUMP,0,!0),this._jumpStartPos.x=this.x,this._jumpStartPos.y=this.y,this._jumpEndPos.x=this._jumpX,this._jumpEndPos.y=this._jumpY;var t=40,e=this._jumpTopPos;this.y>this._jumpY?(e.y=this._jumpY-t,Math.abs(this.x-this._jumpX)<=1?e.x=this._jumpX:this.x>this._jumpX?e.x=this._jumpX+t:e.x=this._jumpX-t):this.y<this._jumpY?(e.y=this.y-t,Math.abs(this.x-this._jumpX)<=1?e.x=this.x:this.x>this._jumpX?e.x=this.x-t:e.x=this.x+t):e.y=0,this._jumpValue=0,egret.Tween.get(this).to({factor:1},this._jumpTime).call(this.jumpEnd,this)}},e.prototype.jumpEnd=function(){this.isJump=!1,egret.Tween.removeTweens(this),this.arrivedPathPoint(),this.path&&this.path.length>0||this.endMove()},e.prototype.jumpProcess=function(){},Object.defineProperty(e.prototype,"factor",{get:function(){return this._jumpValue},set:function(t){this._jumpValue=t;var e=1-t,i=e*e,n=t*e*2,o=t*t;this.x=i*this._jumpStartPos.x+n*this._jumpTopPos.x+o*this._jumpEndPos.x,this.y=i*this._jumpStartPos.y+n*this._jumpTopPos.y+o*this._jumpEndPos.y,this.jumpProcess()},enumerable:!0,configurable:!0}),e.prototype.bodyPlayComplete=function(t){return this.curAction!=ActionStandard.SA_DIE&&this.curAction!=ActionStandard.SA_JUMP?this.curAction==ActionStandard.SA_JUMP_START?void this.jumpStart():void this.playAction(this.isMove?ActionStandard.SA_RUN:ActionStandard.SA_IDLE,0):void 0},e.prototype.startMove=function(){this.curAction!=ActionStandard.SA_RUN&&this.playAction(ActionStandard.SA_RUN,0),this.isMove||(this.isMove=!0)},e.prototype.endMove=function(){this.isMove&&(this.isMove=!1,this.isfollow=!1,this.path=null,this.playAction(ActionStandard.SA_IDLE,0))},e.prototype.setCellXY=function(e,i,n){t.prototype.setCellXY.call(this,e,i,n)},e.prototype.arrivedPathPoint=function(){this.tarPoint&&(this.setCellXY(this.tarPoint.mX,this.tarPoint.mY,!1),this.tarPoint=null)},e.prototype.toLastPoint=function(){if(this.path){var t=this.path.length;t>0&&(this.path=[this.path.pop()])}},e.prototype.clearPath=function(){this.path=null,this.isJump||(this.tarPoint=null)},e.prototype.clearJump=function(){this.isJump&&(this.isJump=!1,this.tarPoint=null,egret.Tween.removeTweens(this))},e.prototype.checkCellXY=function(){this.cellXY.x=this.x/40>>0,this.cellXY.y=this.y/40>>0},e.prototype.updateBodyDir=function(t,e){t>e?this.body.setDir(-1):e>t&&this.body.setDir(1)},e.prototype.$onRemoveFromeStage=function(){t.prototype.$onRemoveFromStage.call(this),this.body.setStage(!1)},e.prototype.$onAddToStage=function(e,i){t.prototype.$onAddToStage.call(this,e,i),this.body.setStage(!0)},e.prototype.getBodyDir=function(){return this.body.dir},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.path=null,this.isMove=!1,this.isJump=!1,this.isfollow=!1,this.curAction=null,this.tarPoint=null,egret.Tween.removeTweens(this),this.body.onRemove()},e}(BaseThing);__reflect(BaseMoveThing.prototype,"BaseMoveThing");var BaseEuiWindow=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.viewKey=0,i.closeDispose=!0,i.disposeTime=0,i.bClickClose=!0,null==e&&(e=LayerManager.UI_Win,i._myParent=e),i.isInit=!1,i}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._initOpen&&this.openView.apply(this,this.openParam)},e.prototype.addDelayDestroy=function(t){void 0===t&&(t=2e4),this.closeDispose&&(this.disposeTime>0||(this.disposeTime=egret.setTimeout(this.destroy,this,t)))},e.prototype.removeDelayDestroy=function(){this.disposeTime>0&&(egret.clearTimeout(this.disposeTime),this.disposeTime=0)},e.prototype.open=function(t){void 0===t&&(t=null),this.$modalTipsRect&&this.addTouchEvent(this.$modalTipsRect,this.closeView),this.closeBtn&&this.addTouchEvent(this.closeBtn,this.onCloseBtn),this.bg&&this.bg.closeBtn&&this.addTouchEvent(this.bg.closeBtn,this.closeView)},e.prototype.focusToStage=function(){this.message(MsgConst.RESIZE_STAGE,this.resizeStage),this.resizeStage()},e.prototype.resizeStage=function(){this.height=App.StageUtils.getHeight(),this.width=App.StageUtils.getWidth()},e.prototype.openView=function(t){void 0===t&&(t=null),this.isInit?(this._initOpen=!1,this.open.call(this,t)):(this._initOpen=!0,this.openParam=t)},e.prototype.closeView=function(t){App.ViewManager.close(this.viewKey)},e.prototype.onCloseBtn=function(t){App.ViewManager.backOpen&&App.ViewManager.open(App.ViewManager.backOpen.key,App.ViewManager.backOpen),App.ViewManager.close(this.viewKey)},e.prototype.resetOpen=function(t){this.close.call(this,t),this.removeAllEvent.call(this),this.openView.call(this,t)},e.prototype.setWinTitle=function(t){this.bg&&this.bg.setNameImg(t)},e.prototype.setWinTitleHold=function(t){this.bg&&this.bg.setNameImgHold(t)},e.prototype.setWinHeleTitle=function(t){void 0===t&&(t=null),this.bg&&this.bg.setHelpBtn(t)},e.prototype.addToParent=function(){if((this._myParent==LayerManager.UI_Tips||this._myParent==LayerManager.UI_Win)&&this.bClickClose){var e=this.$modalTipsRect;e||(e=new eui.Rect,e.fillColor=2302241,e.alpha=0,e.width=App.StageUtils.getWidth()+80,e.height=App.StageUtils.getHeight()+80,e.horizontalCenter=0,e.verticalCenter=0,e.x=e.y=-40,this.$modalTipsRect=e),this._myParent.addChild(e),this.addTouchEvent(e,this.closeView)}t.prototype.addToParent.call(this),this.removeDelayDestroy()},e.prototype.destroy=function(){if(this.viewKey){var e=this.viewKey;return this.viewKey=null,void App.ViewManager.destroy(e)}this.removeDelayDestroy(),t.prototype.destroy.call(this)},e}(BaseEuiComponent);__reflect(BaseEuiWindow.prototype,"BaseEuiWindow");var BaseSpriteView=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i._resources=null,i.isInit=!0,i}return __extends(e,t),e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this)},e.prototype.addToParent=function(){this._myParent&&this._myParent.addChild(this)},e.prototype.refreshRed=function(){this.roleSelect&&this.roleSelect.setListRed&&this.roleSelect.setListRed()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this._myParent=null,this._resources=null},e}(BaseEuiComponent);__reflect(BaseSpriteView.prototype,"BaseSpriteView");var BaseCustComponent=function(t){function e(){var e=t.call(this)||this;return e.className="@逻辑类名",e.event=[],e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){},e.prototype.addItemClick=function(t,e){this.addEvent(eui.ItemTapEvent.ITEM_TAP,t,e)},e.prototype.addTouchEvent=function(t,e){this.addEvent(egret.TouchEvent.TOUCH_TAP,t,e)},e.prototype.addEvent=function(t,e,i){e&&(e.addEventListener(t,i,this),this.event.push([t,i,e]))},e.prototype.removeAllEvent=function(){for(var t=0,e=this.event;t<e.length;t++){var i=e[t];i[2].removeEventListener(i[0],i[1],this)}this.event=[],App.MessageCenter.removeAll(this),App.TimerManager.removeAll(this)},e.prototype.dispose=function(){this.removeAllEvent(),this.disposeChildren(this)},e.prototype.setListData=function(t,e){var i=t.dataProvider;i?i.source=e:t.dataProvider=new eui.ArrayCollection(e)},e.prototype.disposeChildren=function(t){if(t.numChildren)for(var e,i=t.numChildren;i;)i--,e=t.removeChildAt(0),e instanceof eui.Image&&e.texture&&(e.source=null),e.stop&&e.stop(),e.dispose&&e.dispose(),this.disposeChildren(e)},e}(eui.ItemRenderer);__reflect(BaseCustComponent.prototype,"BaseCustComponent");var AnimalThing=function(t){function e(){var e=t.call(this)||this;return e.isDie=!1,e.banHavior=0,e.showTop=!1,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),e.fightAi&&(this.fight=ObjectPool.get(ThingFight),this.fight.register(this)),this.skillAction=new SkillAction},e.prototype.createShadow=function(){if(null==this.shadow){var t=new eui.Image;t.source=RES_DIR_BODY_SHADOW,t.anchorOffsetX=39,t.anchorOffsetY=16,this.shadow=t}App.ThingManager.bottomLayer.addChild(this.shadow)},e.prototype.removeShadow=function(){App.DisplayUtils.removeFromParent(this.shadow)},e.prototype.jumpStart=function(){this.disappear||(t.prototype.jumpStart.call(this),this.shadow&&(this.shadow.visible=!1))},e.prototype.jumpEnd=function(){t.prototype.jumpEnd.call(this),this.shadow&&(this.shadow.visible=!0)},e.prototype.updateProperty=function(e,i){switch(t.prototype.updateProperty.call(this,e,i),e){case PropId.AP_LEVEL:break;case PropId.AP_HP:this.changeHp(i);break;case PropId.AP_MAX_HP:break;case PropId.AP_ATTACK_SPEED:break;case PropId.AP_DIR:break;case PropId.AP_BODY_COLOR:break;case PropId.AP_STATE:i&ThingState.DEATH?this.isDie=!0:this.isDie&&this.reAlive()}},e.prototype.changeHp=function(t){this.isDie&&t>0&&this.reAlive();var e=this.pro.pro(PropId.AP_MAX_HP);t&&e&&e>t?App.TimerManager.isExists(this.showHp,this)?this.topTitle&&this.showHp():App.TimerManager.addDelay(500,1,1,this.showHp,this,null,null):this.removeTopTile()},e.prototype.showHp=function(){this.getTopTitle(),this.topTitle.setHp(this.pro.pro(PropId.AP_HP),this.pro.pro(PropId.AP_MAX_HP))},e.prototype.clearBehavior=function(){this.stopMove(),this.skillAction.play=!1},e.prototype.getTopTitle=function(){null==this.topTitle&&(this.topTitle=ObjectPool.get(ThingTopTitle),this.topTitle.setHpType(this.pro.hpType),this.topTitle.x=this.x,this.topTitle.y=this.y-120,App.ThingManager.titleLayer.addChild(this.topTitle))},e.prototype.removeTopTile=function(){App.TimerManager.remove(this.showHp,this),this.topTitle&&(this.topTitle.dispose(),App.DisplayUtils.removeFromParent(this.topTitle),this.topTitle=null)},e.prototype.die=function(){this.isDie=!0,this.clearBehavior(),App.TimerManager.addDelay(200,1,1,this.playAction,this,null,null,ActionStandard.SA_DIE,1),this.pro.pro(PropId.AP_HP)>0&&this.changeHp(0),this.removeBubbles(),this.removeTopTile(),this.isfollow=!1},e.prototype.reAlive=function(){this.playAction(ActionStandard.SA_IDLE),this.isDie=!1},e.prototype.moveTo=function(e,i){return this.banHavior>App.TimerManager.getSyncTime()?!1:t.prototype.moveTo.call(this,e,i)},e.prototype.setPath=function(e){this.isDie||this.banHavior>App.TimerManager.getSyncTime()||t.prototype.setPath.call(this,e)},e.prototype.update=function(e){t.prototype.update.call(this,e);var i=this.topTitle;i&&(i.x!=this.x&&(i.x=this.x),i.y!=this.y&&(i.y=this.y-120));var n=this.shadow;if(n&&(n.x!=this.x&&(n.x=this.x),n.y!=this.y&&(n.y=this.y)),!(this.banHavior>e)){if(!this.isMove){var o=this.skillAction;o.play&&(o.play=!1,this.playSkillAction(o))}this.fight&&this.fight.update(e)}},e.prototype.jumpProcess=function(){var t=this.topTitle;t&&(t.x!=this.x&&(t.x=this.x),t.y!=this.y&&(t.y=this.y-120))},e.prototype.preSkill=function(){this.clearPath()},e.prototype.playSkill=function(t,e,i,n){this.toLastPoint();var o=this.skillAction;o.skill=t,o.x=e,o.y=i,o.target=n,o.play=!0},e.prototype.playSkillAction=function(t){var e=GameConfig.skill[t.skill.nSkillId];if(!e)throw new Error("找不到技能配置,"+t.skill.nSkillId);this.updateBodyDir(this.cellXY.x,t.x),e.action1&&this.playAction(e.action1,1),App.skillPlay.play(this,t.skill,t.x,t.y,t.target)},e.prototype.setBanHavior=function(t){this.banHavior=t+App.TimerManager.getSyncTime()-1},e.prototype.isTouch=function(e,i){return this.isDie?!1:t.prototype.isTouch.call(this,e,i)},e.prototype.dispose=function(){App.TimerManager.removeAll(this),this.fight&&(this.fight.onRemove(),this.fight=null),t.prototype.dispose.call(this),this.removeTopTile(),this.removeShadow(),this.skillAction.play=!1,this.banHavior=0},e}(BaseMoveThing);__reflect(AnimalThing.prototype,"AnimalThing");var BaseSound=function(){function t(){this.cache={},this.loadingCache=[]}return t.prototype.getSound=function(t){var e=RES.getRes(t);if(e)this.cache[t];else{if(-1!=this.loadingCache.indexOf(t))return null;this.loadingCache.push(t),RES.getResByUrl(t,this.onResourceLoadComplete,this,RES.ResourceItem.TYPE_SOUND)}return e},t.prototype.onResourceLoadComplete=function(t,e){var i=this.loadingCache.indexOf(e);-1!=i&&(this.loadingCache.splice(i,1),t&&this.loadedPlay(t,e))},t.prototype.loadedPlay=function(t,e){},t.prototype.checkCanClear=function(t){return!0},t}();__reflect(BaseSound.prototype,"BaseSound");var ColorUtil=function(){function t(){}return t.mergeARGB=function(t,e,i,n){return t<<24|e<<16|i<<8|n},t.getChannel=function(t,e){switch(e){case this.ALPHA:return t>>24&255;case this.RED:return t>>16&255;case this.GREEN:return t>>8&255;case this.BLUE:return 255&t}return 0},t.numberToString=function(t,e){return void 0===e&&(e="#"),e+t.toString(16)},t.getColorByquality=function(t){return 0},t.C_WHITE=16777215,t.C_YELLOW=16767011,t.C_YELLOW2=16774656,t.C_COFFEE=4992807,t.C_RED=16711680,t.C_GREEN=2817792,t.C_BLUE=41727,t.TITLE_NORMAL=16762368,t.TITLE_NPC=65286,t.TITLE_HERO=16776672,t.ALPHA=4278190080,t.RED=16711680,t.GREEN=65280,t.BLUE=255,t.ColorGrayFlilter=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],t}();__reflect(ColorUtil.prototype,"ColorUtil");var PropPart=function(t){function e(){var e=t.call(this)||this;return e._zdl=0,e.itemArr=[],e.skinName="PropPartSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),null==this.data&&this.recycle()},e.prototype.dispose=function(){this.recycle(),t.prototype.dispose.call(this)},e.prototype.setData=function(t,e,i,n,o,r,a,s){void 0===i&&(i=0),void 0===n&&(n=16765801),void 0===o&&(o=16777215),void 0===r&&(r=103937),void 0===a&&(a=["","+"]),void 0===s&&(s="PropItemSkin");var h=t,p=e,l=0,c=this.comparerProp(h,p,n,o,r,a);for(var u in c){var d=void 0;this.itemArr[l]?d=this.itemArr[l]:(d=ObjectPool.get(PropItem),this.itemArr.push(d),this.pG.addChild(d)),d.skinName=s,d.data=c[u],l++}for(var g=l;l<this.itemArr.length;)App.DisplayUtils.removeFromParent(this.itemArr[l]),ObjectPool.push(this.itemArr[l]),l++;g<this.itemArr.length&&(this.itemArr=this.itemArr.slice(0,g)),this._zdl=ItemUtils.getZdlByProp(t)},e.prototype.comparerProp=function(t,e,i,n,o,r){void 0===i&&(i=16777215),void 0===n&&(n=16777215),void 0===o&&(o=103937);var a={};for(var s in t){var h={},p=t[s].type+"";h.type=t[s].type,h.oldValue=t[s].value,h.color=[i,n,o],h.str=r,a[p]=h}for(var s in e){var p=e[s].type+"";if(!a[p]){var h={};h.type=e[s].type,h.oldValue=0,h.color=[i,n,o],h.str=r,a[p]=h}a[p].newValue=e[s].value}return a},e.prototype.recycle=function(){if(this.itemArr)for(var t=0,e=this.itemArr;t<e.length;t++){var i=e[t];App.DisplayUtils.removeFromParent(i),ObjectPool.push(i),i=null}this.itemArr=[],this._zdl=0},e.prototype.setSortType=function(t,e,i){var n;"ver"==t?(n=new eui.VerticalLayout,e&&(n.gap=e)):"hor"==t&&(n=new eui.HorizontalLayout,e&&(n.gap=e)),this.pG.layout=n},e.prototype.setGap=function(t){this.pG.layout&&(this.pG.layout.gap=t)},Object.defineProperty(e.prototype,"zdl",{get:function(){return this._zdl},enumerable:!0,configurable:!0}),e}(BaseCustComponent);__reflect(PropPart.prototype,"PropPart");var BaseClass=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;if(!i._instance){var n=t.length;0==n?i._instance=new i:1==n?i._instance=new i(t[0]):2==n?i._instance=new i(t[0],t[1]):3==n?i._instance=new i(t[0],t[1],t[2]):4==n?i._instance=new i(t[0],t[1],t[2],t[3]):5==n&&(i._instance=new i(t[0],t[1],t[2],t[3],t[4]))}return i._instance},e}(egret.HashObject);__reflect(BaseClass.prototype,"BaseClass");var MovieClip=function(t){function e(){var e=t.call(this)||this;return e.autoDispose=!0,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.loadFile=function(t,e,i){void 0!=e&&(this.playCount=e),this._compFun=i,-1==t.indexOf("/")&&(t=t),this.mcName&&this.movieClipData&&(McDataManager.removeMovieClipDataByName(this.mcName),this.movieClipData=null),this.mcName=t,this.visible=!1,App.TimerManager.removeAll(this),this.loadSource(t)},e.prototype.loadSource=function(t){var e=McDataManager.getMovieClipDataByName(t);if(e)return void this.setMcData(e);var i,n=this,o=t;if(o.indexOf("/")>-1){var r=o.lastIndexOf("/");o=t.substr(r+1)}var a=RES.getRes(o+"_png");a?RES.getResByUrl(t+".json",function(e){i=e,n.resGetComplete(t,a,i)},n,RES.ResourceItem.TYPE_JSON):MovieClipLoader.ins().load(this,t)},e.prototype.resGetComplete=function(t,e,i){if(McDataManager.setMovieClipDataByName(t,i,e),this.mcName==t){var n=McDataManager.getMovieClipDataByName(t);this.setMcData(n)}},e.prototype.setMcData=function(t){t&&(this.rate?t.frameRate=this.rate:24==t.frameRate&&(t.frameRate=8),this.movieClipData=t,this.play(this.playCount),this.playCount>0&&App.TimerManager.addDelay(this.playTime*this.playCount,0,1,this.playComplete,this),this.visible=!0)},Object.defineProperty(e.prototype,"playTime",{get:function(){return this.movieClipData?1/this.frameRate*this.totalFrames*1e3:0},enumerable:!0,configurable:!0}),e.prototype.playComplete=function(){this.visible=!1,this._compFun&&this._compFun.run(),this.autoDispose&&this.dispose()},e.prototype.dispose=function(){this.autoDispose=!0,this.mcName&&this.movieClipData&&(McDataManager.removeMovieClipDataByName(this.mcName),this.mcName=null),this.stop(),this.playCount=0,this.rate=null,this.movieClipData=null,this._compFun=null,this.x=this.y=0,this.scaleX=this.scaleY=1,this.rotation=0,this.visible=!1,this.touchEnabled=!1,App.DisplayUtils.removeFromParent(this),ObjectPool.push(this)},e.prototype.$onAddToStage=function(e,i){this.movieClipData&&this.playCount<=0&&this.play(this.playCount),t.prototype.$onAddToStage.call(this,e,i)},e.prototype.$onRemoveFromStage=function(){this.playCount<=0&&this.stop(),t.prototype.$onRemoveFromStage.call(this)},e.create=function(){return ObjectPool.get(e)},e}(egret.MovieClip);__reflect(MovieClip.prototype,"MovieClip");var CommunalPagePannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.oldIndex=-1,i.viewDic={},i.bSetTitleInChile=!1,i.skinName="CommunalPagePannelSkin",i}return __extends(e,t),e.prototype.open=function(t){void 0===t&&(t=null),this.isInit&&(this.addEvent(egret.TouchEvent.CHANGE,this.tabBtn,this.onTabChange),this.addEvent(egret.Event.CHANGING,this.tabBtn,this.onTabEvent),this.tabBtn.selectedIndex=t?t.secIndex:0,this.viewProp=t,this.onTabChange(),this.setTabBar(),this.message(MsgConst.PROPERTY+PropId.AP_LEVEL,this.setTabBar))},e.prototype.init=function(){this.setTabBar(),this.bSetTitleInChile=!0;for(var t=0;4>t;t++)this["line"+t].visible=t<Object.keys(this.pannelModuleData).length-1},e.prototype.setTabBar=function(){var t=[],e=[];for(var i in this.pannelModuleData){var n={icon:"role.png"};n.icon=RES_DIR_PAGEICON+this.pannelModuleData[i].viewIcon,App.ViewManager.checkOpenCondition(this.pannelModuleData[i],!1)||(n.icon=n.icon.replace(".png","_ud.png")),t.push(n),e.push(this.pannelModuleData[i].module)}this.setViewData(t,e)},e.prototype.refreshRed=function(){if(t.prototype.refreshRed.call(this),this.tabBtn){for(var e=0;e<this.tabBtn.numChildren;e++){var i=this.pannelModuleData[e]?this.pannelModuleData[e].module:"";App.ViewManager.showRedPoint(this.tabBtn.getChildAt(e),App.RedPoint.redViewResult[i])}if(this.tabBtn.selectedIndex>=0){var n=this.viewDic[this.tabBtn.selectedIndex];n&&n.refreshRed&&n.refreshRed()}}},e.prototype.close=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.close.call(this),this.curView&&this.curView.close()},e.prototype.onTabEvent=function(t){var e=t.target;if(this.pannelModuleData[e.selectedIndex]){var i=this.pannelModuleData[e.selectedIndex];if(!App.ViewManager.checkOpenCondition(i,!0))return void t.preventDefault()}},e.prototype.onTabChange=function(t){var e=this.tabBtn.selectedIndex;this.oldIndex!=e&&(this.curView&&(this.curView.close(),this.curView.visible=!1),this.oldIndex=e);var i=this.getView(e);if(t?(i.open(),this.refreshRed&&this.refreshRed()):(i.open(this.viewProp),this.refreshRed&&this.refreshRed()),i.visible=!0,this.curView=i,this.pannelModuleData[e]){var n=this.pannelModuleData[e],o=App.ViewManager.getView(n.viewconst);o&&n&&n.winTitle&&o.setWinTitle(n.winTitle),o&&n&&o.setWinHeleTitle(n.helpBtn)}},e.prototype.setViewData=function(t,e){this.tabBtn.dataProvider=new eui.ArrayCollection(t),this.viewCl=e},e.prototype.getView=function(t){var e=this.viewDic[t];if(!e){var i=this.viewCl[t];"string"==typeof i&&(i=window[i]),e=new i,e&&i.name&&(e.name=i.name),this.viewDic[t]=e,this.viewContent.addChild(e),e.width=this.viewContent.width,e.height=this.viewContent.height}return e},e}(BaseSpriteView);__reflect(CommunalPagePannel.prototype,"CommunalPagePannel");var CommunalPageWin=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.oldIndex=-1,i.viewDic={},i.winModuleData={},i.listIcon=[],i.listPanel=[],i.skinName="CommunalPageWinSkin",i}return __extends(e,t),e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this),this.refreshRed&&this.refreshRed()},e.prototype.openView=function(e){this.isInit&&(this.addEvent(egret.TouchEvent.CHANGE,this.tabBtn,this.onTabChange),this.addEvent(egret.Event.CHANGING,this.tabBtn,this.onTabEvent),this.tabBtn.visible=this.viewCl.length>1,this.tabBtn.selectedIndex=e?e.firIndex:0,this.viewProp=e,this.onTabChange()),t.prototype.openView.call(this,e)},e.prototype.refreshRed=function(){for(var t=0;t<this.tabBtn.numChildren;t++){this.listPanel[t]?this.listPanel[t]:"";App.ViewManager.showRedPoint(this.tabBtn.getChildAt(t),this.getPanelRedForView(t))}if(this.tabBtn.selectedIndex>=0){var e=this.viewDic[this.tabBtn.selectedIndex];e&&e.refreshRed&&e.refreshRed()}},e.prototype.getPanelRedForView=function(t){var e=!1;if(this.winModuleData[t]){var i=this.winModuleData[t];if(i)for(var n in i){var o=i[n];if(o.pannel){if(void 0!=App.RedPoint.redViewResult[o.pannel]){e=App.RedPoint.redViewResult[o.pannel];break}if(App.RedPoint.redViewResult[o.module]){e=!0;break}}}}return e},e.prototype.init=function(){var t=GameConfig.modControl[ViewConst[this.viewKey]];this.listIcon=[],this.listPanel=[];for(var e in t){var i=0,n={icon:"role_json.role_index_ud_0_png",icon2:"role_json.role_index_0_png"},o=void 0;for(var r in t[e])if(t[e][r].pannel){n.icon=t[e][r].pageIcon,n.icon2=t[e][r].pageIcon2,i=t[e][r].firIndex,o=t[e][r].pannel;break}this.listIcon.push(n),o&&this.listPanel.push(o),this.winModuleData[i]=t[e]
}this.setViewData(this.listIcon,this.listPanel)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curView&&this.curView.close()},e.prototype.onTabEvent=function(t){var e=t.target;if(this.winModuleData[e.selectedIndex]){var i=this.winModuleData[e.selectedIndex]?this.winModuleData[e.selectedIndex][0]:null;if(!App.ViewManager.checkOpenCondition(i,!0))return void t.preventDefault()}},e.prototype.onTabChange=function(t){var e=this.tabBtn.selectedIndex;this.oldIndex!=e&&(this.curView&&(this.curView.close(),this.curView.visible=!1),this.oldIndex=e);var i=this.getView(e);if(t?(i.open(),this.refreshRed&&this.refreshRed()):(i.open(this.viewProp),this.refreshRed&&this.refreshRed()),i.visible=!0,this.curView=i,this.backGrp&&(this.backGrp.visible=!0),this.winModuleData[e]){var n=this.winModuleData[e][0];if(!n)return;n.winTitle&&!i.bSetTitleInChile&&(this.setWinTitle(n.winTitle),this.setWinHeleTitle(n.helpBtn)),this.backGrp&&(this.backGrp.visible=n.showBackBTN>0)}},e.prototype.setViewData=function(t,e){t.length&&(this.tabBtn.dataProvider=new eui.ArrayCollection(t),this.tabBtn.validateNow()),e.length&&(this.viewCl=e)},e.prototype.getView=function(t){var e=this.viewDic[t];if(!e){var i=this.viewCl[t];"string"==typeof i&&(i=window[i]),e=new i,e&&i.name&&(e.name=i.name),e.pannelModuleData=this.winModuleData[t],this.viewDic[t]=e,this.viewContent.addChild(e)}return e},e}(BaseEuiWindow);__reflect(CommunalPageWin.prototype,"CommunalPageWin");var BaseCache=function(t){function e(e){void 0===e&&(e=!0);var i=t.call(this)||this;return i.needClear=e,CacheManager.reg(i),i}return __extends(e,t),e.prototype.clear=function(){},e}(egret.HashObject);__reflect(BaseCache.prototype,"BaseCache");var BaseProxy=function(t){function e(e){var i=t.call(this)||this;return i.sysId=e,i}return __extends(e,t),e.prototype.getGameByteArray=function(){return GameByteArray.getBytes()},e.prototype.getBytes=function(t){var e=this.getGameByteArray();return e.writeCmd(this.sysId,t),e},e.prototype.sendMsgId=function(t){var e=this.getGameByteArray();e.writeCmd(this.sysId,t),this.sendToServer(e)},e.prototype.sendToServer=function(t){App.Socket.sendToServer(t)},e.prototype.regNetMsg=function(t,e){App.Socket.registerSTCFunc(this.sysId,t,e,this)},e}(egret.HashObject);__reflect(BaseProxy.prototype,"BaseProxy");var BaseEuiLayer=function(t){function e(e){var i=t.call(this)||this;return i.numShow=0,i.originalAlpha=0,i.param=e,i.percentWidth=100,i.percentHeight=100,i.touchEnabled=!1,i.visible=!1,e&&i.modal(e.modal,e.alpha),i.numShow=i.numChildren,i}return __extends(e,t),Object.defineProperty(e.prototype,"focusStage",{set:function(t){t?(App.MessageCenter.addListener(MsgConst.RESIZE_STAGE,this.resizeStage,this),this.resizeStage()):App.MessageCenter.removeListener(MsgConst.RESIZE_STAGE,this)},enumerable:!0,configurable:!0}),e.prototype.resizeStage=function(){this.modalRect&&(this.modalRect.graphics.clear(),this.modalRect.graphics.beginFill(0,1),this.modalRect.graphics.drawRect(0,0,App.StageUtils.getWidth(),App.StageUtils.getHeight()),this.modalRect.cacheAsBitmap=!0)},e.prototype.modal=function(e,i){e&&(this.modalRect=new egret.Shape,this.modalRect.alpha=null==i?.8:i,this.originalAlpha=this.modalRect.alpha,t.prototype.addChildAt.call(this,this.modalRect,0),this.focusStage=!0)},e.prototype.setRectAlpha=function(t){this.modalRect&&(this.modalRect.alpha=t)},e.prototype.resetAlpha=function(){this.modalRect&&(this.modalRect.alpha=this.originalAlpha)},Object.defineProperty(e.prototype,"visible",{get:function(){return this.$visible},set:function(t){this.modalRect&&this.param&&this.param.modalClick&&(0==this.visible&&1==t?this.modalRect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.removeAll,this):1==this.visible&&0==t&&this.modalRect.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.removeAll,this)),this.$setVisible(t)},enumerable:!0,configurable:!0}),e.prototype.addChild=function(e){return this.visible=!0,t.prototype.addChild.call(this,e)},e.prototype.addChildAt=function(e,i){return i+=this.numShow,this.visible=!0,t.prototype.addChildAt.call(this,e,i)},e.prototype.removeChild=function(e){var i=t.prototype.removeChild.call(this,e);return this.numChildren-this.numShow<=0&&(this.visible=!1),i},e.prototype.removeChildAt=function(e){var i=t.prototype.removeChildAt.call(this,e);return this.numChildren-this.numShow<=0&&(this.visible=!1),i},e.prototype.removeModalTop=function(){var t,e=this.numChildren-this.numShow;e&&(t=this.removeChildAt(this.numChildren-1),t.closeView&&t.closeView(),e--)},e.prototype.removeAll=function(){for(var t,e=this.numChildren-this.numShow;e;)t=this.removeChildAt(this.numShow),t.closeView&&t.closeView(),e--},e.prototype.removeChildren=function(){this.removeAll()},e}(eui.Group);__reflect(BaseEuiLayer.prototype,"BaseEuiLayer");var BaseScene=function(){function t(){this._layers=new Array}return t.prototype.onEnter=function(){},t.prototype.onExit=function(){App.ViewManager.closeAll(),this.removeAllLayer()},t.prototype.addLayer=function(t){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().addChild(t),this._layers.push(t)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().addChild(t),this._layers.push(t))},t.prototype.addLayerAt=function(t,e){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().addChildAt(t,e),this._layers.push(t)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().addChildAt(t,e),this._layers.push(t))},t.prototype.removeLayer=function(t){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1))},t.prototype.layerRemoveAllChild=function(t){t instanceof BaseSpriteLayer?t.removeChildren():t instanceof BaseEuiLayer&&t.removeChildren()},t.prototype.removeAllLayer=function(){for(;this._layers.length;){var t=this._layers[0];this.layerRemoveAllChild(t),this.removeLayer(t)}},t}();__reflect(BaseScene.prototype,"BaseScene");var HumanThing=function(t){function e(){var e=t.call(this)||this;return e.pet=[],e.flowUpdateTime=0,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.removePet();for(var i in e.petId)this.updatePet(e.petId[i],e.petName[i],e.petStar[i])},e.prototype.changeHp=function(e){t.prototype.changeHp.call(this,e),ActorSeleMgr.hpChange(this)},e.prototype.updateProperty=function(e,i){switch(t.prototype.updateProperty.call(this,e,i),e){case PropId.AP_BADGE_LVL:this.title.setBadge(i);break;case PropId.AP_HP:this.changeHp(i)}},e.prototype.updatePet=function(t,e,i){if(t){var n=GameConfig.pet[t];if(!n)return;var o=this.pro,r=new PropertySet;r.kind=ThingKind.Pet,r.pro(PropId.AP_ACTOR_ID,t),r.pro(PropId.AP_BODY_ID,GameCache.pet.getModelId(i,t)),r.pro(PropId.AP_X,this.cellXY.x),r.pro(PropId.AP_Y,this.cellXY.y),r.masterName=this.pro.charName,r.isFlow=!0;var a=e;""==a&&(a=n.name),r.charName=StringUtils.substitute(Language.lang.de,o.charName,a),r.recog=App.ThingManager.createRecog();var s=App.ThingManager.createThing(r);this.pet.push(s)}},e.prototype.removePet=function(){for(var t in this.pet){var e=this.pet[t];e&&(e.dispose(),e=null)}this.pet.length=0},e.prototype.update=function(e){t.prototype.update.call(this,e);var i=this.flowUpdateTime<=e;i&&(this.flowUpdateTime=e+500);for(var n=this.cellXY,o=6-this.pet.length,r=0,a=this.pet;r<a.length;r++){var s=a[r];if(i&&!s.isMove){if(!GameCache.map.canStand(s.cellXY.x,s.cellXY.y)){s.setCellXY(n.x,n.y,!1);continue}var h=Math.abs(s.cellXY.x-n.x)>o||Math.abs(s.cellXY.y-n.y)>o;if(h){if(!s.isfollow)if(s.moveSpeed=GlobalVar.DEFAULT_MOVE_SPEED,s.cellXY.y==n.y&&s.moveTo(n.x,n.y-this.getBodyDir()))s.isfollow=!0;else{for(var p=2,l=this.getBodyDir();p>0;){var c=n.x-l*p;if(GameCache.map.canStand(c,n.y)){s.setCellXY(c,n.y,!1),s.updateBodyDir(s.cellXY.x,n.x);break}p--}s.isfollow=!1}}else s.clearPath(),s.isfollow=!1;if(n.x==s.cellXY.x&&n.y==s.cellXY.y)for(var p=2,l=this.getBodyDir();p>0;){var c=n.x-l*p;if(GameCache.map.canStand(c,n.y)){s.moveSpeed=GlobalVar.DEFAULT_MOVE_SPEED<<1,s.moveTo(c,n.y);break}p--}o++,s.setOnView(this.isInView)}s.update(e)}},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.removePet()},e}(AnimalThing);__reflect(HumanThing.prototype,"HumanThing");var ItemBase=function(t){function e(){var e=t.call(this)||this;return e.typeItem=0,e.showArrow=!0,e.showColor=!0,e.count=1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.enabled=!0},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.count=1,this.data&&this.initData(),App.DisplayUtils.addClickEff(this.ico),this.showZLflag(),this.showJob(),this.showEff(),this.showLv()},e.prototype.initData=function(){var t;this._userItem=null,this.data instanceof StdItem||-1==this.data.type?t=this.data:this.data instanceof UserItem?(t=this.data.stdItem,this._userItem=this.data,this.count=this.data.btCount):"number"==typeof this.data?t=this.getItemById(this.data):this.data.length?(this.count=this.data[1],t=this.getItemById(this.data[0])):this.data.id&&(this.count=this.data.count?this.data.count:1,t=this.getItemById(this.data.id)),this._itemData=t,this.initLayout()},e.prototype.initLayout=function(){this._itemData&&(this.ico.source=RES_DIR_IMAGES_ITEM+this._itemData.icon+".png",this.itemName&&(this.itemName.textFlow=TextFlowUtils.generateTextFlow(ItemUtils.getItemNamewithColor(this._itemData))),this.num.text=this.count+"",this.num.visible=this.count>1,this.showColor&&(this.color.source=this._itemData.showQuality<=1?null:"public_json.public_item_color_"+this._itemData.showQuality+"_png"))},e.prototype.showEff=function(){this._itemData&&this._itemData.eff?(this.eff||(this.eff=MovieClip.create(),this.addChild(this.eff),this.eff.x=40,this.eff.y=40),this.eff.loadFile(RES_DIR_EFF+this._itemData.eff,-1)):this.eff&&(this.eff.dispose(),this.eff=null)},e.prototype.showZLflag=function(){if(this.zlflag&&this.showArrow){if(!this.data||!this._itemData)return void(this.zlflag.visible=!1);var t=!ItemUtils.isEquip(this._itemData);if(!t&&(this._userItem&&this._userItem.sourceType==ItemSourceType.BAG||(t=!0),!t)){var e=GameCache.equip.compartPower(this._itemData);0==e?t=!0:e>0?this.zlflag.source="public_json.public_g_allow_png":t=!0}this.zlflag.visible=!t}},e.prototype.showJob=function(){if(this.jobImg){var t;t=!this._userItem||this._userItem.sourceType!=ItemSourceType.ROLEEQUIP&&this._userItem.sourceType!=ItemSourceType.OTHER_ROLEEQUIP?this._itemData&&ItemUtils.isEquip(this._itemData)&&ItemUtils.getEquipJob(this._itemData):0,t?this.jobImg.source="public_itemjob"+t+"_png":this.jobImg.source=null}},e.prototype.showLv=function(){if(this.usLevel){var t;t=!this._userItem||this._userItem.sourceType!=ItemSourceType.ROLEEQUIP&&this._userItem.sourceType!=ItemSourceType.OTHER_ROLEEQUIP?this._itemData&&ItemUtils.isEquip(this._itemData)&&ItemUtils.getUsLv(this._itemData):0,t?this.usLevel.text=StringUtils.substitute(Language.lang.usLv,t):this.usLevel.text=""}},Object.defineProperty(e.prototype,"partSource",{set:function(t){this.part||(this.part=new eui.Image,this.part.x=5,this.part.y=54,this.addChild(this.part)),this.part.source=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemData",{get:function(){return this._itemData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userItem",{get:function(){return this._userItem},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{set:function(e){t.prototype.$setEnabled=e,this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),e&&this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},enumerable:!0,configurable:!0}),e.prototype.setHandler=function(t,e,i){this.handler&&this.handler.dispose(),this.handler=Handler.create(t,e,i,!1)},e.prototype.getItemById=function(t){for(var e in GameConfig.item)if(GameConfig.item[e].id==t)return GameConfig.item[e];return null},e.prototype.onTouch=function(){App.ViewManager.isShow(ViewConst.ITEMTIPS)||(this.handler?this.handler.run():this._itemData&&GlobalFun.itemTips(this._userItem||this._itemData))},e.prototype.dispose=function(){t.prototype.dispose.call(this),App.DisplayUtils.removeClickEff(this.ico),this.enabled=!1,this.data||(this.ico.source=null),this.disposeHandler()},e.prototype.reSet=function(){this.data=null,this._itemData=null,this.num.text="",this.color.source=null,this.ico.source=null,this.eff&&(this.eff.dispose(),this.eff=null),this.itemName&&(this.itemName.text="")},e.prototype.setIconImg=function(t){t&&(this.ico.source=t)},e.prototype.setColorImg=function(t){void 0===t&&(t=null),this.color.source=t},e.prototype.setBgImg=function(t){this.bg.source=t},e.prototype.setCount=function(t){(!t||0>t)&&(this.count=1),this.count=t},Object.defineProperty(e.prototype,"select",{get:function(){return this.sele.visible},set:function(t){this.sele.visible=t},enumerable:!0,configurable:!0}),e.prototype.disposeHandler=function(){this.handler&&(this.handler.dispose(),this.handler=null)},e}(BaseCustComponent);__reflect(ItemBase.prototype,"ItemBase");var DeBugMgr=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.skillEffEdit=function(){},e}(BaseClass);__reflect(DeBugMgr.prototype,"DeBugMgr");var CMovieDataCache=function(t){function e(){var e=t.call(this)||this;return e._dataDic={},App.TimerManager.add(1e4,e.check,e,0),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.printData=function(){var t,e=this._dataDic;for(var i in e)t=e[i],t.printData();e=McDataManager.mcDataPool;var n;for(var i in e)n=e[i],n.printData()},e.prototype.check=function(){var t,e=this._dataDic,i=App.TimerManager.getSyncTime();for(var n in e)t=e[n],t.disposeTime>0&&t.disposeTime<=i&&(t.dispose(),delete e[n])},e.prototype.clearEffect=function(){var t,e=McDataManager.mcDataPool,i=App.TimerManager.getSyncTime();for(var n in e)t=e[n],t.disposeTime>0&&t.disposeTime<=i&&(t.dispose(),delete e[n])},e.prototype.getData=function(t){return null==this._dataDic[t]&&(this._dataDic[t]=ObjectPool.get(CMovieData),this._dataDic[t].isDispose=!1,this._dataDic[t].url=t),this._dataDic[t]},e}(BaseClass);__reflect(CMovieDataCache.prototype,"CMovieDataCache");var CMovieData=function(t){function e(){var e=t.call(this)||this;return e._counts=0,e.disposeTime=0,e.isDispose=!1,e.level=0,e._data={},e._mcArr=[],e}return __extends(e,t),e.prototype.getMovieClipData=function(t){if(void 0===t&&(t=-1),this._data[t])return this._data[t];var e=t>-1?this.url+"_"+t:this.url;CMovieDataLoader.ins().addLoader(e,t,this)},e.prototype.onComplete=function(t,e){if(null==this._data)return void this.dispose();this._data[t]=e;for(var i=0,n=this._mcArr,o=this._counts;o>i;i++){var r=n[i];r.curLoaDir==t&&r.setMCData(e)}},e.prototype.addTarget=function(t){var e=this._mcArr,i=e.indexOf(t);-1==i&&(this.disposeTime=0,this._counts++,e.push(t))},e.prototype.removeTarget=function(t){var e=this._mcArr,i=e.indexOf(t);i>-1&&(e.splice(i,1),this._counts--,this._counts<=0&&(CMovieDataLoader.ins().remove(this),this.disposeTime=App.TimerManager.getSyncTime()+1e4))},Object.defineProperty(e.prototype,"count",{get:function(){return this._counts},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this._data;this.isDispose=!0;for(var e in t)parseInt(e)>-1?(RES.destroyRes(this.url+"_"+e+".png"),RES.destroyRes(this.url+"_"+e+".json")):(RES.destroyRes(this.url+".png"),RES.destroyRes(this.url+".json"));this._data={},this.level=0,ObjectPool.push(this)},e.prototype.printData=function(){var t=this._data;console.log("disposeTime : "+this.disposeTime);for(var e in t)parseInt(e)>-1?console.log("$$ CMovieData Cache："+this.url+"_"+e):console.log("$$ CMovieData Cache："+this.url)},e}(egret.HashObject);__reflect(CMovieData.prototype,"CMovieData");var McDataManager=function(){function t(){}return t.getMovieClipDataByName=function(t){var e=this.mcDataPool[t];return e?(e.addCount(),e.data):null},t.setMovieClipDataByName=function(t,e,i,n){if(!this.mcDataPool[t]&&i&&e){this.mcDataFactory||(this.mcDataFactory=new egret.MovieClipDataFactory),this.mcDataFactory.texture=i,this.mcDataFactory.mcDataSet=e;var o=this.mcDataFactory.generateMovieClipData();o.frameRate=n?n:o.frameRate,o.frameRate>=24&&(o.frameRate=8);var r=ObjectPool.get(McDataRf);r.data=o,r.mcName=t,this.mcDataPool[t]=r,this.mcDataFactory.clearCache()}},t.removeMovieClipDataByName=function(t){var e=this.mcDataPool[t];e&&e.removeCount(),MovieClipLoader.ins().removeUrl(t)},t.mcDataPool={},t}();__reflect(McDataManager.prototype,"McDataManager");var McDataRf=function(){function t(){this.disposeTime=0,this.mcName="",this._counts=0}return t.prototype.addCount=function(t){void 0===t&&(t=1),this._counts=this._counts+t,this.disposeTime=0},t.prototype.removeCount=function(t){void 0===t&&(t=1),this._counts=this._counts-t,this._counts<=0&&(this.disposeTime=App.TimerManager.getSyncTime()+3e4)},t.prototype.printData=function(){console.log("disposeTime : "+this.disposeTime),this.mcName&&console.log("$$ effect："+this.mcName)},t.prototype.dispose=function(){this.mcName&&(RES.destroyRes(this.mcName+".png"),RES.destroyRes(this.mcName+".json")),this.data=null,this.disposeTime=0,this._counts=0,this.mcName=null,ObjectPool.push(this)},t}();__reflect(McDataRf.prototype,"McDataRf");var CMovieDataLoader=function(){function t(){this.loaderList_A=[],this.loaderList_B=[],this.loaderDic={},this.loadingConut=0,this._factory=new egret.MovieClipDataFactory}return t.ins=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.addLoader=function(t,e,i){var n=this.loaderDic[i.hashCode];n||(n=this.loaderDic[i.hashCode]=[]);var o=ObjectPool.get(CMovieDataLoaderItem);o.isDelete=!1,o.url=t,o.tar=i,o.dir=e,this.loadingConut>=3?(1==i.level?this.loaderList_A.push(o):this.loaderList_B.push(o),n.push(o)):this.load(o)},t.prototype.load=function(t){this.loadingConut++;var e,i,n=this._factory,o=t.url,r=t.tar,a=t.dir,s=this,h=!1,p=function(p){if(!h){if(!p)return console.log("加载失败，跳过",o),h=!0,s.loadingConut--,void s.loadNext();if(e&&i){if(s.loadingConut--,ObjectPool.push(t),t.isDelete)return void s.loadNext();n.texture=e,n.mcDataSet=i,r.onComplete(a,n.generateMovieClipData()),n.clearCache(),s.loadNext()}}};RES.getResByUrl(o+".png",function(t){e=t,p(t)},s,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl(o+".json",function(t){i=t,p(t)},s,RES.ResourceItem.TYPE_JSON)},t.prototype.loadNext=function(){var t=this.loaderList_A.pop();t||(t=this.loaderList_B.pop()),t&&(t.isDelete?(ObjectPool.push(t),this.loadNext()):this.load(t))},t.prototype.remove=function(t){var e=this.loaderDic[t.hashCode];if(e){for(var i=0,n=e;i<n.length;i++){var o=n[i];o.isDelete=!0}delete this.loaderDic[t.hashCode]}},t}();__reflect(CMovieDataLoader.prototype,"CMovieDataLoader");var CMovieDataLoaderItem=function(){function t(){}return t}();__reflect(CMovieDataLoaderItem.prototype,"CMovieDataLoaderItem");var DBAvatar=function(){function t(){this._dir=1}return Object.defineProperty(t.prototype,"rolePro",{set:function(t){this.unload(),this.pro=t,this._partName={},this._partArmature={};var e=DBPart.PartId,i=this._partName;for(var n in e)i[n]=0},enumerable:!0,configurable:!0}),t.prototype.setRoot=function(t,e){this._root=t,this._completeHandler=e},t.prototype.load=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),e&&this.unload(),this._armatureName=t,App.DBAvatarManager.loadArmature(t,this,!1,1,!0,i?DBPart.NUDE:t)},t.prototype.unload=function(){if(this._armatureName){this._armature&&(this.stop(),App.DisplayUtils.removeFromParent(this._armature.display),this._armature.dispose(),this._armature=null),App.DBAvatarManager.unLoadArmature(this._armatureName,this),this._armatureName=null;var t=this._partName;for(var e in t)t[e]&&this.unLoadPart(e,t[e]);this._partName=null,this._partArmature=null}},t.prototype.unLoadPart=function(t,e){var i=DBPart.getPartNameList(t);if(i){for(var n=this._partArmature,o=0,r=i.length;r>o;o++){var a=t+i[o];if(n[a]&&(n[a].dispose(),delete n[a]),this._armature){var s=this._armature.getSlot(a);s.childArmature=null}}App.DBAvatarManager.unLoadArmature(e,this)}},t.prototype.updateSkin=function(){if(this._armature&&this.pro&&ThingKind.isHumanModel(this.pro.kind)){var t=this.pro,e=DBPart.PartId,i=this._partName,n=t.pro(PropId.AP_JOB),o=t.pro(PropId.AP_SEX);for(var r in e){var a=e[r],s=t.pro(a);if(a==PropId.AP_PANTS){var h=t.pro(PropId.AP_BODY_ID),p=GameConfig.dress[h];p&&(s=p.pantsID)}var l=s?s+""+o:DBPart.getDefault(n,o,r);if(l!=i[r]){var c=i[r];c&&this.unLoadPart(r,c),i[r]=l,l&&App.DBAvatarManager.loadArmature(l,this,!0)}}}},t.prototype.create=function(t,e){this._armature=t,this._clock=e,this._root.addChild(this._armature.display),this.play(this._playName,this._playNum),this.setDir(this._dir),this.updateSkin()},t.prototype.relaceSkin=function(t){if(this._armature){var e=this._partName;for(var i in e)if(e[i]==t){var n=DBPart.getPartNameList(i);if(n)for(var o=0,r=n.length;r>o;o++){var a=i+n[o],s=t+n[o],h=App.DBAvatarManager.factory.buildArmature(s);if(h){h.cacheFrameRate=DBPart.CACHE;var p=this._armature.getSlot(a);p&&(p.childArmature=h,this._partArmature[a]=h,this._playNum||this.play(this._playName,this._playNum))}}break}}},t.prototype.setDir=function(t){this._dir=t,this._armature&&this._armature.display.scaleX!=t&&(this._armature.display.scaleX=t)},t.prototype.play=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!0);var n=this._armature;if(this._playName=t,this._playNum=e,n&&this._playName&&i&&(this.start(),n.animation.play(t,e),!e))for(var o in this._partArmature)this._partArmature[o].animation.play(t,e)},t.prototype.playTempAction=function(t){this._armature&&this._playName&&(this.start(),this._armature.animation.play(t,1))},t.prototype.recoverPlay=function(){this.play(this._playName,this._playNum)},t.prototype.addListeners=function(){this._armature.eventDispatcher.addEvent(dragonBones.EventObject.COMPLETE,this.playComplete,this)},t.prototype.removeListeners=function(){this._armature.eventDispatcher.removeEvent(dragonBones.EventObject.COMPLETE,this.playComplete,this)},t.prototype.resetParam=function(){this._armatureName=null,this._isPlay=!1,this._playName=null,this._playNum=0},t.prototype.playComplete=function(t){this._completeHandler&&(this._completeHandler.args=[this._playName],this._completeHandler.run())},t.prototype.start=function(){this._isPlay||(this._clock.add(this._armature),this._isPlay=!0,this.addListeners())},t.prototype.stop=function(){this._isPlay&&(this._clock.remove(this._armature),this._isPlay=!1,this._playName=null,this.removeListeners())},t.prototype.onRemove=function(){this.unload(),this.resetParam(),this.pro=null},t.prototype.dispose=function(){this.onRemove(),this._root=null,this._completeHandler=null},t}();__reflect(DBAvatar.prototype,"DBAvatar");var DBAvatarManager=function(t){function e(){var e=t.call(this)||this;return e.disposeTime=0,e.disposeList=[],e.averageUtils=new AverageUtils,e.factory=new dragonBones.EgretFactory,e.clocks=new Array,e.clocksLen=0,e.files={},e.loadFiles={},e.start(),e}return __extends(e,t),e.prototype.addArmatureFile=function(t,e,i,n){if(!this.files[t.name]){this.factory.parseDragonBonesData(t),e&&this.factory.parseTextureAtlasData(i,e);var o=new DBFile;o.name=t.name,o.ref=0,o.type=n,this.files[t.name]=o}},e.prototype.removeArmatureFile=function(t){var e=this.files[t];if(e){if(e.isNude)return;this.factory.removeDragonBonesData(t),this.factory.removeTextureAtlasData(t),RES.destroyRes(RES_DIR_DRAGON+e.name+"_ske.json"),RES.destroyRes(RES_DIR_DRAGON+e.name+"_tex.json"),RES.destroyRes(RES_DIR_DRAGON+e.name+"_tex.png"),delete this.files[t]}},e.prototype.loadArmature=function(t,e,i,n,o,r){if(void 0===i&&(i=!1),void 0===n&&(n=1),void 0===o&&(o=!0),void 0===r&&(r=null),this.files[t])this.makeArmature(t,e,i,n,o);else{var a=this.loadFiles[t];a||(a=this.loadFiles[t]=new LoadFile,a.name=t,a.isReplace=i,a.type=r),a.tar.push(e),a.loading||this.starLoad(a)}},e.prototype.unLoadArmature=function(t,e){if(this.files[t])this.files[t].ref--;else{var i=this.loadFiles[t];if(i){var n=i.tar.indexOf(e);n>=0&&(i.tar.splice(n,1),i.tar.length<=0)}}},e.prototype.starLoad=function(t){t.loading=!0;var e,i,n,o=this,r=function(){if(e&&i&&n){o.addArmatureFile(e,n,i,t.type);for(var r=0,a=t.tar.length;a>r;r++)o.makeArmature(t.name,t.tar[r],t.isReplace);delete o.loadFiles[t.name]}};RES.getResByUrl(RES_DIR_DRAGON+t.name+"_ske.json",function(t){e=t,r()},o,RES.ResourceItem.TYPE_JSON),RES.getResByUrl(RES_DIR_DRAGON+t.name+"_tex.json",function(t){i=t,r()},o,RES.ResourceItem.TYPE_JSON),RES.getResByUrl(RES_DIR_DRAGON+t.name+"_tex.png",function(t){n=t,r()},o,RES.ResourceItem.TYPE_IMAGE)},e.prototype.makeArmature=function(t,e,i,n,o){void 0===n&&(n=1),void 0===o&&(o=!0);var r=this.files[t];if(r)if(r.ref++,i)e.relaceSkin(t);else{var a=this.factory.buildArmature(t);if(null==a)return;o&&(a.cacheFrameRate=DBPart.CACHE);var s=this.createWorldClock(n);e.create(a,s)}},e.prototype.createWorldClock=function(t){for(var e=0;e<this.clocksLen;e++)if(this.clocks[e].timeScale==t)return this.clocks[e];var i=new dragonBones.WorldClock;return i.timeScale=t,this.clocks.push(i),this.clocksLen=this.clocks.length,i},e.prototype.onEnterFrame=function(){var t=this.advancedTime;t=App.TimerManager.getSyncTime()-t,this.averageUtils.push(t),this.advancedTime=App.TimerManager.getSyncTime();for(var e=.001*this.averageUtils.getValue(),i=0;i<this.clocksLen;i++){var n=this.clocks[i];n.advanceTime(e)}if(t=this.advancedTime,t>=this.disposeTime){this.disposeTime=t+6e4;var o=this.disposeList.shift();if(o){var r=this.files[o];if(!r||r.ref>0)return;this.removeArmatureFile(o)}}},e.prototype.onScengChange=function(){var t=App.TimerManager.getSyncTime();this.disposeTime=t+6e4,this.disposeList.length=0;for(var e in this.files){var i=this.files[e];i.ref<=0&&this.disposeList.push(i.name)}},e.prototype.replaceSoltDisplay=function(t,e,i,n,o){this.factory.replaceSlotDisplay(t,e,i,n,o)},e.prototype.stop=function(){this.isPlay&&(App.TimerManager.remove(this.onEnterFrame,this),this.isPlay=!1)},e.prototype.start=function(){this.isPlay||(this.isPlay=!0,this.disposeTime=this.advancedTime=App.TimerManager.getSyncTime(),App.TimerManager.addFrame(2,this.onEnterFrame,this))},e}(BaseClass);__reflect(DBAvatarManager.prototype,"DBAvatarManager");var DBFile=function(){function t(){this._ref=0}return Object.defineProperty(t.prototype,"ref",{get:function(){return this._ref},set:function(t){this._ref=t},enumerable:!0,configurable:!0}),t}();__reflect(DBFile.prototype,"DBFile");var LoadFile=function(){function t(){this.tar=[],this.loading=!1}return t}();__reflect(LoadFile.prototype,"LoadFile");var DBPart=function(){function t(){}return Object.defineProperty(t,"PartId",{get:function(){var t=this._partId;return t||(t={},t[this.ARMOUR]=PropId.AP_BODY_ID,t[this.HAT]=PropId.AP_HAT,t[this.EYE]=PropId.AP_EYE,t[this.PANTS]=PropId.AP_PANTS,t[this.WEAPON]=PropId.AP_WEAPON,t[this.ASSIST]=PropId.AP_ASSIST,t[this.GLASSES]=PropId.AP_GLASSES,t[this.HAIR]=PropId.AP_HAIR,t[this.BACK]=PropId.AP_BACK,t[this.WING]=PropId.AP_SWING,this._partId=t),t},enumerable:!0,configurable:!0}),t.getDefault=function(t,e,i){return i==this.WEAPON?0:i==this.ASSIST?0:i==this.GLASSES?0:i==this.BACK?0:i==this.HAT?0:i==this.WING?0:t+"_"+e+"_"+i},t.getPartNameList=function(t){var e=this._partNameList;return e||(e={},e[this.ARMOUR]=["1","2"],e[this.HAT]=[""],e[this.EYE]=[""],e[this.PANTS]=[""],e[this.WEAPON]=[""],e[this.ASSIST]=[""],e[this.GLASSES]=[""],e[this.HAIR]=["1","2"],e[this.BACK]=[""],e[this.WING]=[""],this._partNameList=e),e[t]},t.NUDE="nude",t.HAIR="hair",t.HAT="hat",t.EYE="eye",t.GLASSES="glasses",t.ARMOUR="armour",t.PANTS="pants",t.WEAPON="weapon",t.ASSIST="assist",t.WING="wing",t.BACK="back",t.MONSTER="monster",t.CACHE=0,t}();__reflect(DBPart.prototype,"DBPart");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?n(o):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var CacheManager=function(){function t(){}return t.reg=function(t){this.cacheList.push(t)},t.clearAll=function(){for(var t=0,e=this.cacheList.length;e>t;t++)this.cacheList[t].needClear&&this.cacheList[t].clear()},t.cacheList=[],t}();__reflect(CacheManager.prototype,"CacheManager");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function o(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}var a=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.split("/");s.pop();var h=s.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(h,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(n,generateJSON.paths[t])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var MsgEvent;!function(t){t.SOCKET_CONNECT="SOCKET_CONNECT",t.SOCKET_START_RECONNECT="SOCKET_START_RECONNECT",t.SOCKET_CLOSE="SOCKET_CLOSE",t.RESIZE_STAGE="RESIZE_STAGE",t.SOCKET_RECONNECT_FAILD="SOCKET_RECONNECT_FAILD"}(MsgEvent||(MsgEvent={}));var GameByteArray=function(t){function e(){var e=t.call(this)||this;return e.endian=egret.Endian.LITTLE_ENDIAN,e}return __extends(e,t),e.prototype.readCustomBytes=function(){var t=this.readUTF();return this.position++,t},e.prototype.readNumber=function(){var t=new uint64(this),e=t.toString();return+e},e.prototype.readNumeric=function(t){switch(t){case e.DT_SMALL:return this.readByte();case e.DT_USMALL:return this.readUnsignedByte();case e.DT_SHORT:return this.readShort();case e.DT_USHORT:return this.readUnsignedShort();case e.DT_INT:return this.readInt();case e.DT_UINT:return this.readUnsignedInt();case e.DT_FLOAT:return this.readFloat();default:return 0}},e.prototype.writeNumber=function(t){var e=uint64.stringToUint64(t.toString());this.writeInt64(e)},e.prototype.writeInt64=function(t){this.writeUnsignedInt(t._lowUint),this.writeUnsignedInt(t._highUint)},e.prototype.writeString=function(t){this.writeUTF(t),this.writeByte(0)},e.prototype.writeCmd=function(t,e){this.writeByte(t),this.writeByte(e)},e.recycleByte=function(t){ObjectPool.push(t)},e.getBytes=function(){var t=ObjectPool.get(e);return t.clear(),t.writeShort(GameSocket.DEFAULT_TAG),t.writeShort(0),t.writeShort(0),t.writeShort(0),t.writeInt(0),t.writeInt(0),t},e.DT_VOID=0,e.DT_SMALL=1,e.DT_USMALL=2,e.DT_SHORT=3,e.DT_USHORT=4,e.DT_INT=5,e.DT_UINT=6,e.DT_FLOAT=7,e}(egret.ByteArray);__reflect(GameByteArray.prototype,"GameByteArray");var GameSocket=function(t){function e(){var e=t.call(this)||this;return e._socketStatus=0,e._lastReceiveTime=0,e.pid=0,e.PACK_HANDLER=[],e._serverId=0,e._user="",e._pwd="",e.reLoginCount=0,e.newSocket(),e.recvPack=new GameByteArray,e._packets=[],e}return __extends(e,t),e.ins=function(){return e._ins||(e._ins=new e),e._ins},e.prototype.newSocket=function(){this.socket_=new egret.WebSocket,this.socket_.type=egret.WebSocket.TYPE_BINARY,this.socket_.addEventListener(egret.Event.CONNECT,this.onSocketConnected,this),this.socket_.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket_.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketRead,this),this.socket_.addEventListener(egret.IOErrorEvent.IO_ERROR,this.connectError,this)},e.prototype.removeSocket=function(){this.socket_&&(this.socket_.removeEventListener(egret.Event.CONNECT,this.onSocketConnected,this),this.socket_.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket_.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketRead,this),this.socket_.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.connectError,this),this.socket_=null)
},e.prototype.sendToServer=function(t){this.send(t),GameByteArray.recycleByte(t)},e.prototype.connectError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onDisconnected()},e.prototype.connect=function(t,i){this.updateStatus(e.STATUS_CONNECTING),this._host=t,this._port=i,this.socket_.connect(t,i)},e.prototype.close=function(){console.log("close socket！ip:"+this._host+" port:"+this._port),this.socket_.close()},e.prototype.send=function(t){return this._socketStatus==e.STATUS_COMMUNICATION?(this.sendPack(t),!0):(console.log("发送数据时没和服务连接或者未进入通信状态"),!1)},e.prototype.onSocketConnected=function(t){console.log("Server connected! ip:"+this._host+" port:"+this._port),App.TimerManager.remove(this.reLogin,this),this.reLoginCount=0,GameCache.global.disconnectedType=-1,this.updateStatus(e.STATUS_CHECKING);var i=new GameByteArray;i.writeUnsignedInt(Encrypt.getSelfSalt()),this.socket_.writeBytes(i),this.socket_.flush()},e.prototype.onSocketRead=function(t){if(this._socketStatus<e.STATUS_COMMUNICATION)return void this.sendKeyToServer();var i=this.recvPack;this.socket_.readBytes(i,i.length);var n=0;for(i.position=0;i.bytesAvailable>e.HEAD_SIZE;){n=i.position;var o=i.readUnsignedShort();if(o==e.DEFAULT_TAG){var r=i.readUnsignedShort();if(i.position+=12,r>i.bytesAvailable)break;var a=r+e.HEAD_SIZE;if(2*a>i.bytesAvailable){var s=ObjectPool.get(GameByteArray);if(s.clear(),i.bytesAvailable>r){var h=i.position;i.position+=r,i.readBytes(s,0,i.bytesAvailable),i.position=h}this._packets.push(i),i=this.recvPack=s,i.position=0}else{var p=ObjectPool.get(GameByteArray);p.clear(),i.readBytes(p,0,r),this._packets.push(p)}n=i.position}}for(n&&(i.position=n,i.readBytes(i),i.length-=n);this._packets.length>0;){var l=this._packets.shift();this.processRecvPacket(l),GameByteArray.recycleByte(l)}this._packets.length=0},e.prototype.sendKeyToServer=function(){var t=new GameByteArray;this.socket_.readBytes(t),t.position=0;var i=t.readUnsignedInt();Encrypt.setTargetSalt(i),t.position=0;var n=Encrypt.getCheckKey();t.writeShort(n),this.socket_.writeBytes(t,0,2),this.updateStatus(e.STATUS_COMMUNICATION)},e.prototype.onSocketClose=function(t){console.log("Server disconnected! ip:"+this._host+" port:"+this._port),this.updateStatus(e.STATUS_DISCONNECT),App.TimerManager.remove(this.reLogin,this),this.onDisconnected()},e.prototype.reLogin=function(){this.close(),this.removeSocket(),this.newSocket(),this.reLoginCount++,GlobalFun.SysMsg(Language.lang.socket3),this.login(this._user,this._pwd,this._serverId,this._host,this._port)},e.prototype.updateStatus=function(t){if(this._socketStatus!=t){var e=this._socketStatus;this._socketStatus=t,this.onFinishCheck(t,e)}},e.prototype.onFinishCheck=function(t,i){t==e.STATUS_COMMUNICATION?this.sendCheckAccount(this._user,this._pwd):t==e.STATUS_DISCONNECT},Object.defineProperty(e.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),e.prototype.sendCheckAccount=function(t,e){console.log("account：",t,e);var i=GameByteArray.getBytes();i.writeCmd(255,1),i.writeString(t),i.writeString(e),i.writeUnsignedInt(this._serverId),i.writeUnsignedInt(this._serverId),this.sendToServer(i)},e.prototype.login=function(t,e,i,n,o){this._user=t,this._pwd=e,this._serverId=i,n.split(":")[1]&&n.split(":")[1].length&&(o=parseInt(n.split(":")[1])),this.socket_.connected?this.sendCheckAccount(t,e):(console.log("connect to "+n+" ,port: "+o),this.connect(n,o))},e.prototype.processRecvPacket=function(t){var e=t.readUnsignedByte(),i=t.readUnsignedByte();this.dispatch(e,i,t)},e.prototype.dispatch=function(t,e,i){if(this.PACK_HANDLER[t]&&this.PACK_HANDLER[t][e]){var n=this.PACK_HANDLER[t][e];n[0].call(n[1],i,e)}},e.prototype.registerSTCFunc=function(t,e,i,n){if(this.PACK_HANDLER[t]){if(this.PACK_HANDLER[t][e])return void console.log("重复注册协议接口"+t+"-"+e)}else this.PACK_HANDLER[t]=[];this.PACK_HANDLER[t][e]=[i,n]},e.prototype.sendPack=function(t){if(null==t||0==t.length)throw new egret.error("创建客户端数据包时数据不能为空！");var i=e.HEAD_SIZE;t.position=2,t.writeShort(t.length-i);var n=Encrypt.getCRC16ByPos(t,i);t.position=4,t.writeShort(n);var o=Encrypt.getCRC16(t,i);t.position=6,t.writeShort(o),Encrypt.encode(t,4,4),this.socket_.writeBytes(t)},e.prototype.onDisconnected=function(){return this.reLoginCount>30?void GlobalFun.alert(Language.lang.socket3,null,null,1):0!=this.reLoginCount?void this.delayRelogin():(App.MessageCenter.dispatch(MsgConst.RECONNECTED),void(1==GameCache.global.disconnectedType?GlobalFun.alert(Language.lang.socket1,null,null,1):GlobalFun.alert(Language.lang.socket2,this.delayRelogin,this,1)))},e.prototype.delayRelogin=function(){App.TimerManager.addDelay(1e3,1,1,this.reLogin,this)},e.DEFAULT_TAG=52462,e.DEFAULT_CRC_KEY=31832,e.HEAD_SIZE=16,e.STATUS_CONNECTING=1,e.STATUS_CHECKING=2,e.STATUS_COMMUNICATION=3,e.STATUS_DISCONNECT=4,e}(egret.HashObject);__reflect(GameSocket.prototype,"GameSocket");var PHPAPI=function(){function t(){}return t.SVER_URL="http://pay.gz.1251208707.clb.myqcloud.com/",t.USER_INFO=t.SVER_URL+"payment/userInfo?",t.BUY=t.SVER_URL+"payment/buy?",t}();__reflect(PHPAPI.prototype,"PHPAPI");var CRC16=function(){function t(){}return t.update=function(e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var o=0,r=0;0==n&&(n=e.length),e.position=i;for(var a=i;n>a;++a)r=255&t.CRCBitReflect(e.readByte(),8)^o>>8&16777215,r&=255,o=t.CRCTable[r]^o<<8&4294967040;return 65535&(0^t.CRCBitReflect(o,16))},t.makeCRCTable=function(){for(var e=0,i=new Array(256),n=0;256>n;++n){e=n<<8&4294967040;for(var o=0;8>o;++o)e=32768&e?e<<1&4294967294^t.POLYNOMIAL:e<<1&4294967294;i[n]=e}return i},t.CRCBitReflect=function(e,i){var n=0,o=0;i--;for(var r=0;i>=r;++r)o=i-r,1&e&&(n|=1<<o&t.DropBits[o]),e=e>>1&2147483647;return n},t.POLYNOMIAL=4129,t.CRCTable=t.makeCRCTable(),t.DropBits=[4294967295,4294967294,4294967292,4294967288,4294967280,4294967264,4294967232,4294967168,4294967040,4294966784,4294966272,4294965248,4294963200,4294959104,4294950912,4294934528],t}();__reflect(CRC16.prototype,"CRC16");var Encrypt=function(){function t(){}return t.encode=function(e,i,n){if(void 0===i&&(i=0),void 0===n&&(n=0),i>=e.length)return 0;var o=n?i+n:e.length;o>e.length&&(o=e.length),e.position=i;for(var r=i;o>r;++r){var a=e.readByte();a^=t.sKeyBuff[r%4],e.position--,e.writeByte(a)}return o-i},t.decode=function(e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),t.encode(e,i,n)},t.getCRC16=function(t,e){return void 0===e&&(e=0),CRC16.update(t,0,e)},t.getCRC16ByPos=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),CRC16.update(t,e,i)},t.getCheckKey=function(){var e=new egret.ByteArray;e.endian=egret.Endian.LITTLE_ENDIAN,e.writeUnsignedInt(t.sKey);var i=CRC16.update(e);return i},t.getSelfSalt=function(){return t.sSelfSalt},t.getTargetSalt=function(){return t.sTargetSalt},t.setTargetSalt=function(e){t.sTargetSalt=e,t.makeKey()},t.makeSalt=function(){var t=new Date;return Math.random()*t.getTime()},t.makeKey=function(){t.sKey=(t.sSelfSalt^t.sTargetSalt)+t.sSelfSalt+8654;for(var e=0;4>e;++e)t.sKeyBuff[e]=(t.sKey&255<<(e<<3))>>(e<<3)},t.sSelfSalt=t.makeSalt(),t.sKeyBuff=new Array(4),t}();__reflect(Encrypt.prototype,"Encrypt");var DynamicChange=function(){function t(){this._dataCache=[],this._pUpdate=new ProxyUpdate(this._dataCache)}return Object.defineProperty(t.prototype,"pUpdate",{get:function(){return this._pUpdate},enumerable:!0,configurable:!0}),t.prototype.getCacheData=function(t){return this._dataCache[t]?this._dataCache[t]:null},t.prototype.clearCache=function(){for(var t=Object.keys(this._dataCache),e=0,i=t.length;i>e;e++){var n=t[e];this._dataCache[n]=null,delete this._dataCache[n]}},t.prototype.getCacheKeyInfos=function(){for(var t=[],e=Object.keys(this._dataCache),i=0,n=e.length;n>i;i++){var o=e[i],r=this._dataCache[o];t.push(r)}return t},t.prototype.isCache=function(t){return this._dataCache[t]},t}();__reflect(DynamicChange.prototype,"DynamicChange");var ProxyUpdate=function(){function t(t){this._cache=t}return t.prototype.isArray=function(t){return t instanceof Array},t.prototype.isObject=function(t){return t.indexOf("object")>-1},t.prototype.isNormal=function(t){var e=t.indexOf("@")>-1,i=t.indexOf(".")>-1,n=t.indexOf("_")>-1;return!e&&!i&&!n},t.prototype.isAddToArray=function(t){return"@a"==t},t.prototype.isRemoveToArray=function(t){var e=t.split("_");return e.length<=3&&"@d"==e[0]},t.prototype.isFilter=function(t){var e=t.split("_");return"@f"==e[0]},t.prototype.isNumeric=function(t){return parseFloat(t).toString()==t.toString()},t.prototype._updateObject=function(t,e,i){var n=t.split(".");"@a"==n[0]||"@s"==n[0]?i[n[1]]=e:"@d"==n[0]&&delete i[n[1]]},t.prototype._getFilterObject=function(t,e){if(e){var i=t.split("_");if(3==i.length&&"@f"==i[0]&&this.isArray(e))for(var n=i[1],o=i[2],r=0;r<e.length;r++){var a=e[r];if(3==i.length&&this.isObject(a.toString())){var s=a[n];if(s&&("@"==o[0]&&(o=o.replace("@","")),o==s))return a}}}return null},t.prototype._addObjectToArray=function(t,e){if(this.isArray(e))for(var i=0;i<e.length;i++)t.push(e[i]);else t.push(e)},t.prototype._removeObjectFromArray=function(t,e,i){var n=e.split("_");if(n.length<=3&&"@d"==n[0]&&this.isArray(t))for(var o=t.length,r=o-1;r>=0;r--){var a=t[r];if(3==n.length){if(a.hasOwnProperty(n[1])){var s=n[2];"@"==s[0]&&(s=s.replace("@","")),s==a[n[1]]&&t.splice(r,1)}}else 2==n.length&&a.hasOwnProperty(n[1])?i==a[n[1]]&&t.splice(r,1):1==n.length&&i==a&&t.splice(r,1)}},t.prototype.update=function(t,e){if(this._cache[t]=e,e.hasOwnProperty("c"))for(var i=e.c,n=Object.keys(i),o=0,r=n.length;r>o;o++){var a=n[o];this._cache[a]&&(this._update(this._cache[a],i[a]),App.MessageCenter.dispatch(a+"_HttpUpdate"))}},t.prototype._update=function(t,e){if(t&&e&&this.isObject(e.toString()))for(var i=Object.keys(e),n=0,o=i.length;o>n;n++){var r=i[n],a=e[r];if(this.isNormal(r)&&this.isObject(a.toString()))t.hasOwnProperty(r)&&this._update(t[r],a);else if(this.isNormal(r)&&this.isNumeric(a)){var s=t[r];t[r]=s+a}else if(this.isNormal(r))t[r]=a;else if(this.isAddToArray(r))this._addObjectToArray(t,a);else if(this.isRemoveToArray(r))this._removeObjectFromArray(t,r,a);else if(this.isFilter(r)){var h=this._getFilterObject(r,t);h&&this._update(h,a)}else this._updateObject(r,a,t)}},t}();__reflect(ProxyUpdate.prototype,"ProxyUpdate");var Http=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.send=function(t,e,i,n,o,r){var a=new egret.HttpRequest;a.responseType=e?egret.HttpResponseType.TEXT:egret.HttpResponseType.ARRAY_BUFFER,a.open(t,i?egret.HttpMethod.GET:egret.HttpMethod.POST),a.once(egret.Event.COMPLETE,n,this),a.once(egret.IOErrorEvent.IO_ERROR,o?o:function(){},this),a.once(egret.ProgressEvent.PROGRESS,r?r:function(){},this),a.send()},e}(BaseClass);__reflect(Http.prototype,"Http");var RedPointManager=function(t){function e(){var e=t.call(this)||this;return e.redViewResult={},e.redViewCycleResult={},e.redViewResult={},e}return __extends(e,t),e.prototype.clear=function(){},e}(BaseClass);__reflect(RedPointManager.prototype,"RedPointManager");var RedPointView=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.changeDic={},App.MessageCenter.changeDic={},App.TimerManager.add(1e3,i.onCheckRed,i),i}return __extends(e,t),e.prototype.onCheckRed=function(){this.changeDic=App.MessageCenter.changeDic;var t=App.ViewManager.getView(ViewConst.MAIN_UI_COCER),e=App.ViewManager.getView(ViewConst.MAIN_UI);this.checkMainBtnRed(t),this.checkMainBtnRed(e);var i=App.ViewManager.openedUI;for(var n in i){App.ViewManager.getRedByWinName(ViewConst[i[n]],this.changeDic,!1);var o=App.ViewManager.getView(i[n]);o&&o.refreshRed&&o.refreshRed()}App.MessageCenter.changeDic={},App.RedPoint.redViewCycleResult={}},e.prototype.checkMainBtnRed=function(t){if(t&&(t||t.tRefreshIcon))for(var e in t.tRefreshIcon){var i=t.tRefreshIcon[e];i&&""!=i&&App.ViewManager.showRedPoint(i,App.ViewManager.getRedByWinName(i.name,this.changeDic))}},e}(BaseEuiComponent);__reflect(RedPointView.prototype,"RedPointView");var EUIResourceManager=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.resHash={},e.disposeHash={},e}return __extends(e,t),e.prototype.add=function(t,e){var i=this.getSheetName(t);return i&&(t=i),this.resHash[t]||(this.resHash[t]=ObjectPool.get(EUIResourceItem),this.resHash[t].dir=e),this.resHash[t].count++,delete this.disposeHash[t],this.resHash[t].count},e.prototype.remove=function(t){var e=this.getSheetName(t);return e&&(t=e),this.resHash[t]?(this.resHash[t].count--,0==this.resHash[t].count&&(this.disposeHash[t]=1),this.resHash[t].count):0},e.prototype.has=function(t){return null==this.resHash[t]?0:this.resHash[t]},e.prototype.getSheetName=function(t){if("string"!=typeof t)return null;var e=t.indexOf("_json");return e>-1?t.substr(0,e)+"_json":null},e.prototype.log=function(){var t=this.resHash,e=0;for(var i in t)e++,console.log("texture ",i);console.log("total ",e)},e.prototype.init=function(){App.TimerManager.add(1e4,this.doTime,this)},e.prototype.doTime=function(){var t=App.TimerManager.getSyncTime(),e=0;for(var i in this.disposeHash){var n=this.resHash[i];if(n.destroyTime>0&&t>n.destroyTime){var o=this.resHash[i].dir;if(o);else if(RES.destroyRes(i)){if(n.dispose(),delete this.resHash[i],delete this.disposeHash[i],e++,e>=15)return}else n.times++,n.times>0&&(n.dispose(),delete this.resHash[i],delete this.disposeHash[i])}}},e}(BaseClass);__reflect(EUIResourceManager.prototype,"EUIResourceManager");var EUIResourceItem=function(){function t(){this.times=0,this._count=0}return Object.defineProperty(t.prototype,"count",{get:function(){return this._count<0?0:this._count},set:function(t){this._count=t,this.destroyTime=this._count>0?0:App.TimerManager.getSyncTime()+1e4},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._count=0,this.destroyTime=0,this.times=0,ObjectPool.push(this)},t}();__reflect(EUIResourceItem.prototype,"EUIResourceItem");var Handler=function(){function t(t,e,i,n){void 0===i&&(i=[]),void 0===n&&(n=!1),this.isDispose=!1,this.setData(t,e,i,n)}return t.prototype.setData=function(t,e,i,n){return this.caller=t,this.method=e,this.args=i,this.once=n,this},t.prototype.run=function(){this.method&&this.method.apply(this.caller,this.args),this.once&&this.dispose()},t.prototype.dispose=function(){this.isDispose||(this.isDispose=!0,this.caller=null,this.method=null,this.args=null,t.pool.push(this))},t.create=function(e,i,n,o){void 0===n&&(n=[]),void 0===o&&(o=!0);var r;return this.pool.length>0?(r=this.pool.pop(),r.isDispose=!1,r.setData(e,i,n,o),r.hashCode=t.hashCode++,r):(r=new t(e,i,n,o),r.hashCode=t.hashCode++,r)},t.pool=[],t.hashCode=0,t}();__reflect(Handler.prototype,"Handler");var RES_DIR="res/",RES_DIR_DRAGON=RES_DIR+"dragon/",RES_DIR_EFF=RES_DIR+"eff/",RES_DIR_SKILLEFF=RES_DIR+"skilleff/",RES_DIR_CHARACTER=RES_DIR+"character/",RES_DIR_SOUND=RES_DIR+"music/",RES_DIR_BTN=RES_DIR+"btn/",RES_DIR_IMAGES=RES_DIR+"images/",RES_DIR_BG=RES_DIR_IMAGES+"bg/",RES_DIR_NPC_BODY=RES_DIR_IMAGES+"npc/",RES_DIR_TRANSFER=RES_DIR_IMAGES+"transfer/1.png",RES_DIR_IMAGES_ITEM=RES_DIR_IMAGES+"item/",RES_DIR_WIN_TITTLE=RES_DIR_IMAGES+"winTitle/",RES_DIR_SKILL=RES_DIR_IMAGES+"skill/",RES_DIR_PET=RES_DIR_IMAGES+"pet/",RES_DIR_PET_SKILL=RES_DIR_IMAGES+"petskill/",RES_DIR_INSTRUCTION_TITTLE=RES_DIR_IMAGES+"instructionTitle/",RES_DIR_MONSTERICON=RES_DIR_IMAGES+"monsterIcon/",RES_DIR_BADGE=RES_DIR_IMAGES+"badge/",RES_DIR_TOTEMS_ICON=RES_DIR_IMAGES+"totems/icon/",RES_DIR_TOTEMS_NAME=RES_DIR_IMAGES+"totems/name/",RES_DIR_BUFF_ICON=RES_DIR_IMAGES+"buff/",RES_DIR_ROLE_ICON=RES_DIR_IMAGES+"roleIco/",RES_DIR_PURGATORY=RES_DIR_IMAGES+"purgatory/",RES_DIR_PURGATORY_ICON=RES_DIR_PURGATORY+"icon/",RES_DIR_SYSOPEN_ICON=RES_DIR_IMAGES+"sysIcon/icon/",RES_DIR_SYSOPEN_NAME=RES_DIR_IMAGES+"sysIcon/name/",RES_DIR_PAGEICON=RES_DIR_IMAGES+"pageIcon/",RES_DIR_ADVENTURE=RES_DIR_IMAGES+"adventure/",RES_DIR_BODY_SHADOW=RES_DIR_IMAGES+"shadow.png",RES_DIR_PURGATORY_SHOW=RES_DIR_PURGATORY+"show/",RES_DIR_IMAGES_BANNER=RES_DIR_IMAGES+"banner/",RES_DIR_IMAGES_BANNE_ACTIVITY=RES_DIR_IMAGES_BANNER+"activity/",RES_DIR_FASHIONCOPY=RES_DIR_IMAGES+"fashionCopy/",DIR_ATLAS="resource/image/atlas/",LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var FrameHandler=function(t){function e(){var e=t.call(this)||this;return e._handler=[],e}return __extends(e,t),e.prototype.add=function(t,e,i){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];if(i)for(var r=0,a=this._handler.length;a>r;r++)if(this._handler[r].method==t&&this._handler[r].caller==e)return void(this._handler[r].args=n);var s=Handler.create(e,t,n);this._handler.push(s)},e.prototype.remove=function(t,e){for(var i=0,n=this._handler,o=n.length;o>i;i++){var r=n[i];if(r.method==t&&r.caller==e){r.dispose(),n.splice(i,1);break}}},e.prototype.has=function(t,e){for(var i=0,n=this._handler,o=n.length;o>i;i++){var r=n[i];if(r.method==t&&r.caller==e)return!0}return!1},e.prototype.onFrame=function(){var t=this._handler.shift();t&&t.run()},e}(BaseClass);__reflect(FrameHandler.prototype,"FrameHandler");var BaseSpriteLayer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(BaseSpriteLayer.prototype,"BaseSpriteLayer");var LayerManager=function(){function t(){}return t.init=function(){this.Game_Main=new BaseEuiLayer,this.Game_Main.name="Game_Main",this.UI_Main=new BaseEuiLayer,this.UI_Main.name="UI_Main",this.UI_Main2=new BaseEuiLayer,this.UI_Main2.name="UI_Main2",this.UI_Win=new UIWinLayer({modal:!0,alpha:.7}),this.UI_Win.name="UI_Win",this.UI_Tips=new BaseEuiLayer({modal:!0,alpha:0}),this.UI_Tips.name="UI_Tips",this.UI_TipsNoClick=new BaseEuiLayer({modal:!0}),this.UI_TipsNoClick.name="UI_TipsNoClick",this.UI_Message=new BaseEuiLayer,this.UI_Message.name="UI_Message",this.UI_Message.touchEnabled=!1,this.UI_Guide=new BaseEuiLayer({modal:!0,alpha:0}),this.UI_Guide.name="UI_Guide"},t.prototype.onStageResize=function(){},t}();__reflect(LayerManager.prototype,"LayerManager");var SceneManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.clear=function(){var t=this._currScene;t&&(t.onExit(),this._currScene=void 0)},e.prototype.runScene=function(t){if(null==t)return void console.log("runScene:scene is null");if(!(this._currScene&&this._currScene instanceof t)){var e=this._currScene;e&&(e.onExit(),e=void 0);var i=new t;i.onEnter(),this._currScene=i}},e.prototype.getCurrScene=function(){return this._currScene},e}(BaseClass);__reflect(SceneManager.prototype,"SceneManager");var UIWinLayer=function(t){function e(e){var i=this;return DeviceUtils.IsPC?i=t.call(this,e)||this:(i=t.call(this)||this,i.numShow++,i.bg=new eui.Image,i.bg.source=RES_DIR_IMAGES+"phoneUIBg.jpg",i.bg.width=App.StageUtils.getWidth(),i.bg.height=App.StageUtils.getHeight(),i.addChild(i.bg),i.visible=!1),i}return __extends(e,t),e}(BaseEuiLayer);__reflect(UIWinLayer.prototype,"UIWinLayer");var MessageCenter=function(t){function e(){var e=t.call(this)||this;return e._dic={},e.changeDic={},e._targetDic={},e._type=1,e._msgVo=[],e._msgPool=[],0==e._type&&egret.startTick(e.onRun,e),e}return __extends(e,t),e.prototype.addListener=function(t,e,i,n){void 0===n&&(n=!1);var o=this._dic[t];null==o&&(o=[],this._dic[t]=o);var r=i&&i.hashCode;if(r){var a=this._targetDic[r];null==a&&(a=[],this._targetDic[r]=a),a.push(t)}var s=Handler.create(i,e,null,n);o.push(s)},e.prototype.removeListener=function(t,e){var i=this._dic[t];if(i)for(var n=0,o=i.length;o>n;n++){var r=i[n];if(r.caller===e)return r.dispose(),i.splice(n,1),void(0==i.length&&delete this._dic[t])}},e.prototype.removeAll=function(t){var e=t&&t.hashCode;if(e){var i=this._targetDic[e];if(i){for(var n=0,o=i;n<o.length;n++){var r=o[n];this.removeListener(r,t)}delete this._targetDic[e]}}else for(var a in this._dic)this.removeListener(a,t)},e.prototype.dispatch=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];0==this._type?this._msgVo.push(this.getMessageVo(t,e)):this.doMsg(t,e)},e.prototype.doMsg=function(t,e){var i=this._dic[t];if(i&&i.length)for(var n=i.length-1,o=void 0;n>=0;n--)o=i[n],o?(null==e?o.run():(o.args=e,o.run(),o.args=null),o.once&&i.splice(n,1)):i.splice(n,1);this.changeDic[t]=t},e.prototype.onRun=function(){for(var t=App.TimerManager.getSyncTime(),e=this._msgVo;e.length>0;){var i=e.shift();this.doMsg(i.type,i.param),this._msgPool.push(i);var n=egret.getTimer()-t;if(n>5)break}return!0},e.prototype.addProperty=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];for(var o=i.length,r=0;o>r;r++)this.addListener(MsgConst.PROPERTY+i[r],t,e)},e.prototype.getMessageVo=function(t,e){var i=this._msgPool.pop();return i||(i=new MessageVo),i.type=t,i.param=e,i},e.prototype.getMsgList=function(){return this._dic},e}(BaseClass);__reflect(MessageCenter.prototype,"MessageCenter");var MessageVo=function(){function t(){}return t.prototype.dispose=function(){this.type=null,this.param=null},t}();__reflect(MessageVo.prototype,"MessageVo");var SoundEffects=function(t){function e(){var e=t.call(this)||this;return e.limitName=null,e}return __extends(e,t),e.prototype.play=function(t,e){if(!e||!this.limitName){e&&(this.limitName=t);var i=this.getSound(t);i&&this.playSound(i,t)}},e.prototype.playSound=function(t,e){var i=t.play(0,1);i.volume=this.volume,this.limitName==e&&i.once(egret.Event.SOUND_COMPLETE,this.onPlayComplete,this)},e.prototype.onPlayComplete=function(t){this.limitName=null},e.prototype.setVolume=function(t){this.volume=t},e.prototype.loadedPlay=function(t,e){this.playSound(t,e)},e}(BaseSound);__reflect(SoundEffects.prototype,"SoundEffects");var SoundManager=function(){function t(){this.musicOff=1,this.effectOff=1,this.soundFlag=!0,this.soundMusic=new SoundMusic,this.soundEffect=new SoundEffects}return t.getIns=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(t,e,i,n){this.musicOff=t,this.musicVolume=e,this.soundMusic.setVolume(e),this.effectOff=i,this.effectVolume=n,this.soundEffect.setVolume(n)},t.prototype.playMusic=function(t){t?this.currMusicName=t:t=this.currMusicName,1!=this.musicOff&&t&&this.soundMusic.play(RES_DIR_SOUND+t+".mp3")},t.prototype.stopMusic=function(){this.soundMusic.stop()},t.prototype.setMusicOn=function(t){this.musicOff=t,t?this.currMusicName&&this.playMusic(this.currMusicName):this.soundMusic.stop()},t.prototype.setMusicVolume=function(t){this.musicVolume=t,this.soundMusic.setVolume(t)},t.prototype.getMusicVolume=function(){return this.musicVolume},t.prototype.playEffect=function(t,e){1!=this.effectOff&&this.soundEffect.play(RES_DIR_SOUND+t+".mp3",e)},t.prototype.setEffectOn=function(t){this.effectOff=t},t.prototype.setEffectVolume=function(t){this.effectVolume=t,this.soundEffect.setVolume(t)},t.prototype.getEffectVolume=function(){return this.effectVolume},t.prototype.closeAllSound=function(t){this.setMusicOn(t),this.setEffectOn(t)},t.prototype.useSkill=function(t){var e=GameConfig.skill[t];e.music&&this.playEffect(e.music)},t}();__reflect(SoundManager.prototype,"SoundManager");var SoundMusic=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.stop=function(){this.currSoundChannel&&this.currSoundChannel.stop(),this.currSoundChannel=null,this.currSound=null,this.currName=""},e.prototype.play=function(t){if(this.currName!=t){this.stop(),this.currName=t;var e=this.getSound(t);e&&this.playSound(e)}},e.prototype.playSound=function(t){t.type=egret.Sound.MUSIC,this.currSound=t,this.currSoundChannel=this.currSound.play(0,-1),this.currSoundChannel.volume=this.volume},e.prototype.setVolume=function(t){this.volume=t,this.currSoundChannel&&(this.currSoundChannel.volume=this.volume)},e.prototype.loadedPlay=function(t,e){this.currName==e&&this.playSound(t)},e.prototype.checkCanClear=function(t){return this.currName!=t},e}(BaseSound);__reflect(SoundMusic.prototype,"SoundMusic");var Algorithm=function(){function t(){}return t.sortAsc=function(t,e){return e>t?-1:t>e?1:0},t.sortAsc1=function(t,e){return e>t?1:t>e?-1:0},t.sortDesc=function(t,e){return t>e?-1:e>t?1:0},t.binSearch=function(e,i,n){if(void 0===n&&(n=null),!e||0==e.length)return 0;n||(n=t.sortAsc);for(var o=0,r=e.length-1;r>=o;){var a=r+o>>1,s=e[a];n(s,i)<=0?o=a+1:r=a-1}return o},t}();__reflect(Algorithm.prototype,"Algorithm");var AverageUtils=function(){function t(t){void 0===t&&(t=10),this.nums=[],this.numsLen=0,this.numSum=0,this.maxNum=t}return t.prototype.push=function(t){this.numsLen>this.maxNum&&(this.numsLen--,this.numSum-=this.nums.shift()),this.nums.push(t),this.numSum+=t,this.numsLen++},t.prototype.getValue=function(){return this.numSum/this.numsLen},t.prototype.clear=function(){this.nums.splice(0),this.numsLen=0,this.numSum=0},t}();__reflect(AverageUtils.prototype,"AverageUtils");var BitStorer=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=!0),this._length=t,this._storer=[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(t){this._storer.length=t>>5},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numDirtyBits",{get:function(){var t,e,i=this._length;for(e=0;i>e;e++)this._storer[e>>5]&1<<e%32&&t++;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dirtyBits",{get:function(){var t,e=[];for(t=this._length-1;t>-1;t--)this._storer[t>>5]&1<<t%32&&(e[e.length]=t);return e},enumerable:!0,configurable:!0}),t.prototype.store=function(t){},t.prototype.toByteArray=function(t,e){void 0===t&&(t=null),void 0===e&&(e=0),t||(t=new egret.ByteArray),t.position=e;for(var i,n=this._storer.length,o=0;n>o;o++){i=this._storer[o];for(var r=0;32>r;r+=8)t.writeByte(i>>r&255)}return t},t.prototype.setBit=function(t,e){1&e?this._storer[t>>5]|=1<<t%32:this._storer[t>>5]&=~(1<<t%32)},t.prototype.getBit=function(t){return this._storer[t%this._length>>5]>>t%32&1},t}();__reflect(BitStorer.prototype,"BitStorer");var ObjectPool=function(){function t(){}return t.get=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=egret.getQualifiedClassName(e);null==t.PoolObj[o]&&(t.PoolObj[o]=[]);var r=t.PoolObj[o].pop();if(r)return r instanceof eui.Image&&(r.x=r.y=0,r.scaleX=r.scaleY=1,r.width=r.height=0/0,r.alpha=1),r;if(0==t.PoolObj[o].length)switch(i.length){case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);default:return new e}},t.push=function(e){var i=e.__class__;if(t.PoolObj[i]){if(t.PoolObj[i].indexOf(e)>-1)return;t.PoolObj[i].length>=t.max||t.PoolObj[i].push(e)}},t.max=100,t.PoolObj={},t}();__reflect(ObjectPool.prototype,"ObjectPool");var CommonUtils=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.addLableStrokeColor=function(t,e,i){t.strokeColor=e,t.stroke=i},e.getObjectLength=function(t){var e=0;for(var i in t)e++;return e},e.copyDataHandler=function(t){var e;if(t instanceof Array)e=[];else{if(!(t instanceof Object))return t;e={}}for(var i=Object.keys(t),n=0,o=i.length;o>n;n++){var r=i[n];e[r]=this.copyDataHandler(t[r])}return e},e.lock=function(){App.StageUtils.getStage().touchChildren=!1},e.unlock=function(){App.StageUtils.getStage().touchChildren=!0},e.labelIsOverLenght=function(t,e){t.text=this.overLength(e)},e.overLength=function(t){var e=null;return 1e5>t?e=t:t>1e8?(t/=1e8,t=Math.floor(10*t)/10,e=t+"亿"):(t/=1e4,t=Math.floor(10*t)/10,e=t+"万"),e},e}(BaseClass);__reflect(CommonUtils.prototype,"CommonUtils");var DataUtil=function(){function t(){}return t.dataToNumberOnArray=function(t,e){for(var i=[],n=0,o=t;n<o.length;n++){var r=o[n];i.push(r[e])}return i},t.fitListData=function(t){for(var e=t.concat(),i=e.length-1;i>-1;i--)(void 0==e[i]||null==e[i])&&e.splice(i,1);return e},t.formatNList=function(t){var e=[];for(var i in t){var n=t[i];e.push(n)}return e},t}();__reflect(DataUtil.prototype,"DataUtil");var DateStyle=function(t){function e(e,i,n,o){var r=t.call(this)||this;return r.format=[],r.from=0,r.to=0,r.isFormatNum=!1,r.format=e,r.from=i,r.to=n,r.isFormatNum=o,r}return __extends(e,t),e}(BaseClass);__reflect(DateStyle.prototype,"DateStyle");var DateUtils=function(t){function e(){var i=t.call(this)||this;return i.mod=[e.SECOND_PER_MUNITE,e.MUNITE_PER_HOUR,e.HOURS_PER_DAY,e.DAYS_PER_MONTH,e.MONTH_PER_YEAR,e.YEAR_PER_YEAR],i.mul=[e.SECOND_PER_SECOND,e.SECOND_PER_MUNITE,e.SECOND_PER_HOUR,e.SECOND_PER_DAY,e.SECOND_PER_MONTH,e.SECOND_PER_YEAR],i}return __extends(e,t),e.prototype.formatMiniDateTime=function(t){return e.MINI_DATE_TIME_BASE+(2147483647&t)*e.MS_PER_SECOND},e.prototype.formatServerTime=function(t){return(t-e.MINI_DATE_TIME_BASE)/e.MS_PER_SECOND},e.prototype.getFormatBySecond=function(t,i,n){void 0===i&&(i=1),void 0===n&&(n=999);var o="",r=1e3*t;switch(i){case e.TIME_FORMAT_1:o=this.format_1(r);break;case e.TIME_FORMAT_2:o=this.format_2(r);break;case e.TIME_FORMAT_3:o=this.format_3(r);break;case e.TIME_FORMAT_4:o=this.format_4(r);break;case e.TIME_FORMAT_5:o=this.format_5(r,n);break;case e.TIME_FORMAT_6:o=this.format_6(r);break;case e.TIME_FORMAT_7:o=this.format_7(r);break;case e.TIME_FORMAT_8:o=this.format_8(r);break;case e.TIME_FORMAT_9:o=this.format_9(r);break;case e.TIME_FORMAT_10:o=this.format_10(r);break;case e.TIME_FORMAT_11:o=this.format_11(r);break;case e.TIME_FORMAT_12:o=this.format_12(r);break;case e.TIME_FORMAT_13:o=this.format_13(r);break;case e.TIME_FORMAT_14:o=this.format_14(r);break;case e.TIME_FORMAT_15:o=this.format_15(r)}return o},e.prototype.format_1=function(t){var i=0,n="##:##:##";return i=Math.floor(t/e.MS_PER_HOUR),n=n.replace("##",this.formatTimeNum(i)),i&&(t-=i*e.MS_PER_HOUR),i=Math.floor(t/e.MS_PER_MINUTE),n=n.replace("##",this.formatTimeNum(i)),i&&(t-=i*e.MS_PER_MINUTE),i=Math.floor(t/1e3),n=n.replace("##",this.formatTimeNum(i))},e.prototype.format_2=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,o=e.getDate(),r=e.getHours(),a=e.getMinutes(),s=e.getSeconds();return i+"-"+n+"-"+o+" "+r+":"+a+":"+s},e.prototype.format_3=function(t){var e=this.format_1(t),i=e.split(":");return i[1]+":"+i[2]},e.prototype.format_4=function(t){return t<e.MS_PER_HOUR?Math.floor(t/e.MS_PER_MINUTE)+"分钟前":t<e.MS_PER_DAY?Math.floor(t/e.MS_PER_HOUR)+"小时前":Math.floor(t/e.MS_PER_DAY)+"天前"},e.prototype.format_5=function(t,i){void 0===i&&(i=2);var n="",o=["天","时","分","秒"],r=[],a=Math.floor(t/e.MS_PER_DAY);r.push(a),t-=a*e.MS_PER_DAY;var s=Math.floor(t/e.MS_PER_HOUR);r.push(s),t-=s*e.MS_PER_HOUR;var h=Math.floor(t/e.MS_PER_MINUTE);r.push(h),t-=h*e.MS_PER_MINUTE;var p=Math.floor(t/1e3);r.push(p);for(var l in r)if(r[l]>0&&(n+=this.formatTimeNum(r[l])+o[l],i--,0>=i))break;return n},e.prototype.format_6=function(t){var e=new Date(t),i=e.getHours(),n=e.getMinutes(),o=e.getSeconds();return this.formatTimeNum(i)+":"+this.formatTimeNum(n)+":"+this.formatTimeNum(o)},e.prototype.format_7=function(t){return t<e.MS_PER_HOUR?"<1小时":t<e.MS_PER_DAY?Math.floor(t/e.MS_PER_HOUR)+"小时":Math.floor(t/e.MS_PER_DAY)+"天"},e.prototype.format_8=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,o=e.getDate(),r=e.getHours(),a=e.getMinutes();return i+"-"+n+"-"+o+" "+r+":"+a},e.prototype.format_9=function(t){var i=Math.floor(t/e.MS_PER_HOUR);t-=i*e.MS_PER_HOUR;var n=Math.floor(t/e.MS_PER_MINUTE);t-=n*e.MS_PER_MINUTE;var o=Math.floor(t/1e3);return i+"小时"+n+"分钟"+o+"秒"},e.prototype.format_10=function(t){var i=Math.floor(t/e.MS_PER_MINUTE);
t-=i*e.MS_PER_MINUTE;var n=Math.floor(t/1e3);return i?n?i+"分钟"+n+"秒":i+"分钟":n+"秒"},e.prototype.format_11=function(t){var i=Math.ceil(t/e.MS_PER_MINUTE);return i+"分钟"},e.prototype.format_12=function(t){var i="",n=Math.floor(t/e.MS_PER_DAY);t-=n*e.MS_PER_DAY;var o=Math.floor(t/e.MS_PER_HOUR);t-=o*e.MS_PER_HOUR;var r=t<e.MS_PER_MINUTE?Math.ceil(t/e.MS_PER_MINUTE):Math.floor(t/e.MS_PER_MINUTE);return t-=r*e.MS_PER_MINUTE,n>0&&(i+=n+"天"),i+=o+"小时",i+=r+"分钟"},e.prototype.format_14=function(t){return Math.floor(t/e.MS_PER_DAY)+""},e.prototype.format_15=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,o=e.getDate(),r=e.getHours(),a=e.getMinutes(),s=e.getSeconds(),h="",p="",l="";return h=10>r?"0"+r:""+r,p=10>a?"0"+a:""+a,l=10>r?"0"+s:""+s,i+"-"+n+"-"+o+" "+h+":"+p+":"+l},e.prototype.format_13=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,o=e.getDate(),r=e.getHours(),a=e.getMinutes();return i+"年"+n+"月"+o+"日"+r+"时"+a+"分 "},e.prototype.DayEndTime=function(t){var e=new Date;e.setTime(1e3*t);var i=e.getHours(),n=e.getMinutes(),o=e.getSeconds();return 23-i+"小时"+(59-n)+"分钟"+(59-o)+"秒"},e.prototype.DayEndTimeSe=function(t){var e=0,i=ObjectPool.get(Date);i.setTime(t);var n=i.getHours(),o=i.getMinutes(),r=i.getSeconds();return e=3600*(23-n)+60*(59-o)+(59-r),ObjectPool.push(i),e},e.prototype.dayDelta=function(t,e){if(t&&e){var i,n=new Date,o=new Date;return n.setTime(1e3*t),o.setTime(1e3*e),n.setHours(0,0,0,0),o.setHours(0,0,0,0),i=Math.floor((o.getTime()-n.getTime())/864e5)}},e.prototype.isOverdue=function(t){return!1},e.prototype.formatTimeNum=function(t){return t>=10?t.toString():"0"+t},e.TIME_FORMAT_1=1,e.TIME_FORMAT_2=2,e.TIME_FORMAT_3=3,e.TIME_FORMAT_4=4,e.TIME_FORMAT_5=5,e.TIME_FORMAT_6=6,e.TIME_FORMAT_7=7,e.TIME_FORMAT_8=8,e.TIME_FORMAT_9=9,e.TIME_FORMAT_10=10,e.TIME_FORMAT_11=11,e.TIME_FORMAT_12=12,e.TIME_FORMAT_13=13,e.TIME_FORMAT_14=14,e.TIME_FORMAT_15=15,e.MS_PER_SECOND=1e3,e.MS_PER_MINUTE=6e4,e.MS_PER_HOUR=36e5,e.MS_PER_DAY=864e5,e.SECOND_PER_HOUR=3600,e.SECOND_PER_DAY=86400,e.SECOND_PER_MONTH=2592e3,e.SECOND_PER_YEAR=31104e3,e.DAYS_PER_WEEK=7,e.YEAR_PER_YEAR=1,e.MONTH_PER_YEAR=12,e.DAYS_PER_MONTH=30,e.HOURS_PER_DAY=24,e.MUNITE_PER_HOUR=60,e.SECOND_PER_MUNITE=60,e.SECOND_PER_SECOND=1,e.MINI_DATE_TIME_BASE=Date.UTC(2010,0)+(new Date).getTimezoneOffset()*e.MS_PER_MINUTE,e.TIME_ZONE_OFFSET=8*e.MS_PER_HOUR,e.TO_SECOND=0,e.TO_MINUTE=1,e.TO_HOUR=2,e.TO_DAY=3,e.TO_MONTH=4,e.TO_YEAR=5,e.FORMAT_1=["秒","分","时","天","月","年"],e.FORMAT_2=[":",":",":",":",":",":"],e.STYLE_1=new DateStyle(e.FORMAT_1,e.TO_SECOND,e.TO_HOUR,!1),e.STYLE_2=new DateStyle(e.FORMAT_1,e.TO_SECOND,e.TO_DAY,!1),e.STYLE_3=new DateStyle(e.FORMAT_2,e.TO_SECOND,e.TO_HOUR,!0),e.STYLE_4=new DateStyle(e.FORMAT_1,e.TO_SECOND,e.TO_MINUTE,!0),e}(BaseClass);__reflect(DateUtils.prototype,"DateUtils");var DebugUtils=function(){function t(){}return t.logOnline=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t}();__reflect(DebugUtils.prototype,"DebugUtils");var logOnline=DebugUtils.logOnline,DeviceUtils=function(){function t(){}return Object.defineProperty(t,"IsHtml5",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE||egret.Capabilities.runtimeType==egret.RuntimeType.RUNTIME2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsMobile",{get:function(){return egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsPC",{get:function(){return!egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsCanvas",{get:function(){return"canvas"==egret.Capabilities.renderMode},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsQQBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MQQBrowser")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsIEBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MSIE")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsFirefoxBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Firefox")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsChromeBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Chrome")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsSafariBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Safari")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsOperaBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Opera")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isLocation",{get:function(){return location.href.indexOf("192.168.201")>=0||location.href.indexOf("127.0.0.1")>=0||location.href.indexOf("localhost")>=0||location.href.indexOf("cq.api.com")>=0},enumerable:!0,configurable:!0}),t}();__reflect(DeviceUtils.prototype,"DeviceUtils");var Dichotomy=function(){function t(){}return t.searchIndex=function(t,e,i,n,o){void 0===n&&(n=0),void 0===o&&(o=2147483647);var r,a;for(2147483647==o&&(o=t.length-1);o>=n;){if(r=n+o>>1,a=e(i,t[r]),0==a)return r;0>a?o=r-1:n=++r}return-1},t}();__reflect(Dichotomy.prototype,"Dichotomy");var DirType;!function(t){t[t.UP=0]="UP",t[t.RIGHT_UP=1]="RIGHT_UP",t[t.RIGHT=2]="RIGHT",t[t.RIGHT_DOWN=3]="RIGHT_DOWN",t[t.DOWN=4]="DOWN",t[t.LEFT_DOWN=5]="LEFT_DOWN",t[t.LEFT=6]="LEFT",t[t.LEFT_UP=7]="LEFT_UP"}(DirType||(DirType={}));var DisplayUtils=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shakingList={},e}return __extends(e,t),e.prototype.removeFromParent=function(t){t&&null!=t.parent&&t.parent.removeChild(t)},e.prototype.drawArc=function(t,e,i,n,o,r){return null==t&&(t=new egret.Shape),t.graphics.clear(),t.graphics.lineStyle(o,n),t.graphics.drawArc(0,0,e,0,i*Math.PI/180,r),t.graphics.endFill(),t},e.prototype.shakeIt=function(t,e,i,n,o){if(void 0===n&&(n=1),void 0===o&&(o=function(){return!0}),t&&!(1>n)&&o()){var r=App.DisplayUtils.shakingList[t.hashCode];if(!r){App.DisplayUtils.shakingList[t.hashCode]=!0;var a=[{anchorOffsetX:0,anchorOffsetY:-e},{anchorOffsetX:-e,anchorOffsetY:0},{anchorOffsetX:e,anchorOffsetY:0},{anchorOffsetX:0,anchorOffsetY:e},{anchorOffsetX:0,anchorOffsetY:0}];egret.Tween.removeTweens(t);var s=i/5;egret.Tween.get(t).to(a[0],s).to(a[1],s).to(a[2],s).to(a[3],s).to(a[4],s).call(function(){delete App.DisplayUtils.shakingList[t.hashCode],App.DisplayUtils.shakeIt(t,e,i,--n)},this)}}},e.prototype.flashingObj=function(t,e,i){void 0===i&&(i=1e3),this.tweenProp(t,e,{alpha:0},{alpha:1},i)},e.prototype.tweenProp=function(t,e,i,n,o){void 0===o&&(o=1e3),e?(egret.Tween.removeTweens(t),egret.Tween.get(t,{loop:!0}).to(i,o).to(n,o)):egret.Tween.removeTweens(t)},e.prototype.newTextField=function(t,e,i,n,o,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=16777215),void 0===o&&(o="center"),void 0===r&&(r=20);var a=new egret.TextField;return a.x=e,a.y=i,a.text=t,a.size=r,a.textColor=n,a.textAlign=o,a},e.prototype.tabBarIndexShow=function(t,e,i){if(t.numChildren>e){var n=t.getChildAt(e);n.includeInLayout=i,n.visible=i}},e.prototype.tabBarShowFirst=function(t){t.validateNow();var e=t.numChildren;if(!e)return!1;for(var i=0;e>i;i++)if(t.getChildAt(i).includeInLayout)return t.selectedIndex=i,!0;return!1},e.prototype.slideContent=function(t,e,i){t.$slideHand=[e,i],t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.slideEvent,t),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.slideEvent,t),e&&(t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.slideEvent,t),t.addEventListener(egret.TouchEvent.TOUCH_END,this.slideEvent,t))},e.prototype.slideEvent=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this.$slideValue=[t.stageX,t.stageY];break;case egret.TouchEvent.TOUCH_END:this.$slideValue&&(this.$slideHand[0].apply(this.$slideHand[1],[t.stageX-this.$slideValue[0],t.stageY-this.$slideValue[1]]),this.$slideValue=null)}},e.prototype.buttonDownTime=function(t,e,i){void 0===i&&(i=[]),(t.downTimer<=0||!t.downTimer)&&(t.restLabel=t.label),t.downTimer=e,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,t),App.TimerManager.addDelay(0,1e3,0,this.onButtonTime,t,null,null,i)},e.prototype.onButtonTime=function(t){void 0===t&&(t=[]);var e=this;return e.downTimer<=0?(e.label=e.restLabel,void e.dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP))):(e.label=e.restLabel+("("+e.downTimer+")"),t&&(t[0].text=StringUtils.substitute(t[1],""+e.downTimer)),void e.downTimer--)},e.prototype.onTap=function(){var t=this;t.downTimer=null,t.label=t.restLabel,t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,t),App.TimerManager.removeAll(t)},e.prototype.circularLayout=function(t,e,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0);for(var r,a,s=t.numChildren,h=0;s>h;h++)r=(360/s*h-90+i)/180*Math.PI,a=t.getChildAt(h),a.x=e*Math.cos(r)+n,a.y=e*Math.sin(r)+o},e.prototype.addLinkonText=function(t,e){t.addEvent(egret.TextEvent.LINK,e,function(t){TextFlowUtils.hrefType(t.text)})},e.prototype.addEffectToObj=function(t,e,i,n,o,r){void 0===i&&(i=-1),void 0===n&&(n=0),void 0===o&&(o=0);var a=MovieClip.create();return t.addChild(a),a.x=n,a.y=o,a.loadFile(RES_DIR_EFF+e,i,r),a},e.prototype.addClickEff=function(t){t.clickEff||(t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.scaleFunc,t),t.addEventListener(egret.TouchEvent.TOUCH_END,this.scaleFunc,t),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.scaleFunc,t)),t.clickEff=1},e.prototype.scaleFunc=function(t){if(this instanceof eui.TabBar){var e=this.getChildAt(this.selectedIndex);e.ico?e.ico.scaleX=e.ico.scaleY="touchBegin"!=t.type?1:.95:e.scaleX=e.scaleY="touchBegin"!=t.type?1:.95}else this.scaleX=this.scaleY="touchBegin"!=t.type?1:.95},e.prototype.removeClickEff=function(t){t.clickEff&&(t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.scaleFunc,t),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.scaleFunc,t),t.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.scaleFunc,t),delete t.clickEff)},e}(BaseClass);__reflect(DisplayUtils.prototype,"DisplayUtils");var FilterTextUtil=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.uncompress(RES.getRes("fw_dat")),RES.destroyRes("fw_dat")},e.prototype.uncompress=function(t){},e.prototype.getFilterStr=function(t){return t},e.prototype.validate=function(t){return!1},e.dic={},e}(BaseClass);__reflect(FilterTextUtil.prototype,"FilterTextUtil");var FilterMsg=function(){function t(){this._splitReg=/(\n|\r)+/gm,this._wordMap={}}return t.prototype.createRegExpStr=function(t){for(var e=t.split(this._splitReg),i=e.length,n=0;i>n;n++)this.addWord(e[n])},t.prototype.addWord=function(t){if(t=t.replace("\n",""),t&&t.length>0){var e,i=t.charAt(0);e=this._wordMap[i],e?this._wordMap[i]+="|"+t:this._wordMap[i]=t}},t.prototype.getFilterStr=function(t){if(!t)return"";t=t.replace(/^\s*|\s*$/,"");for(var e,i,n=t.length,o=0;n>o;o++)e=t.charAt(o),"*"!=e&&(i=this._wordMap[e],"string"==typeof i&&(i=this._wordMap[e]=new RegExp("("+i+")","img")),t=t.replace(i,this.regHandler));return t},t.prototype.validate=function(t){t=t.replace(/\s/g,"");for(var e,i,n=t.length,o=0;n>o;o++)if(e=t.charAt(o),i=this._wordMap[e]){"string"==typeof i&&(i=i.replace(/\(/g,"（"),i=i.replace(/\)/g,"）"),i=this._wordMap[e]=new RegExp("("+i+")","img"));var r=i;if(r.lastIndex=0,r.test(t))return!0}return!1},t.prototype.regHandler=function(){var t=arguments[1].toString();return t.replace(/.{1}/g,"*")},t.prototype.setWordMap=function(t){this._wordMap=t},t.prototype.getWordMap=function(){return this._wordMap},t}();__reflect(FilterMsg.prototype,"FilterMsg");var FilterUtils=function(){function t(){}return Object.defineProperty(t,"DefaultGrayFilters",{get:function(){return null==this._DefaultGrayFilters&&(this._DefaultGrayFilters=[new egret.ColorMatrixFilter([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])]),this._DefaultGrayFilters},enumerable:!0,configurable:!0}),t}();__reflect(FilterUtils.prototype,"FilterUtils");var KeyboardUtils=function(t){function e(){var e=t.call(this)||this;if(e.key_ups=new Array,e.key_downs=new Array,DeviceUtils.IsHtml5){var i=e;document.addEventListener("keyup",function(t){for(var e=0,n=i.key_ups.length;n>e;e++){var o=i.key_ups[e][0],r=i.key_ups[e][1];r?o.call(r,t.keyCode):o(t.keyCode)}}),document.addEventListener("keydown",function(t){for(var e=0,n=i.key_downs.length;n>e;e++){var o=i.key_downs[e][0],r=i.key_downs[e][1];r?o.call(r,t.keyCode):o(t.keyCode)}})}return e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.addKeyUp=function(t,e){this.key_ups.push([t,e])},e.prototype.addKeyDown=function(t,e){this.key_downs.push([t,e])},e.prototype.removeKeyUp=function(t,e){for(var i=0;i<this.key_ups.length;i++)this.key_ups[i][0]==t&&this.key_ups[i][1]==e&&(this.key_ups.splice(i,1),i--)},e.prototype.removeKeyDown=function(t,e){for(var i=0;i<this.key_downs.length;i++)this.key_downs[i][0]==t&&this.key_downs[i][1]==e&&(this.key_downs.splice(i,1),i--)},e}(BaseClass);__reflect(KeyboardUtils.prototype,"KeyboardUtils");var KeyCode=function(){function t(){}return t.KC_1=49,t.KC_2=50,t.KC_3=51,t.KC_4=52,t.KC_5=53,t.KC_6=54,t.KC_7=55,t.KC_8=56,t.KC_9=57,t.KC_0=48,t.KC_A=65,t.KC_B=66,t.KC_C=67,t.KC_D=68,t.KC_E=69,t.KC_F=70,t.KC_G=71,t.KC_H=72,t.KC_I=73,t.KC_J=74,t.KC_K=75,t.KC_L=76,t.KC_M=77,t.KC_N=78,t.KC_O=79,t.KC_P=80,t.KC_Q=81,t.KC_R=82,t.KC_S=83,t.KC_T=84,t.KC_U=85,t.KC_V=86,t.KC_W=87,t.KC_X=88,t.KC_Y=89,t.KC_Z=90,t.KC_F1=112,t.KC_F2=113,t.KC_F3=114,t.KC_F4=115,t.KC_F5=116,t.KC_F6=117,t.KC_F7=118,t.KC_F8=119,t.KC_F9=120,t.KC_F10=121,t.KC_F11=122,t.KC_F12=123,t.KC_F13=124,t.KC_F14=125,t.KC_F15=126,t.KC_NUMPAD_0=96,t.KC_NUMPAD_1=97,t.KC_NUMPAD_2=98,t.KC_NUMPAD_3=99,t.KC_NUMPAD_4=100,t.KC_NUMPAD_5=101,t.KC_NUMPAD_6=102,t.KC_NUMPAD_7=103,t.KC_NUMPAD_8=104,t.KC_NUMPAD_9=105,t.KC_NUMPAD_MULTIPLY=106,t.KC_NUMPAD_ADD=107,t.KC_NUMPAD_ENTER=108,t.KC_NUMPAD_SUBTRACT=109,t.KC_NUMPAD_DECIMAL=110,t.KC_NUMPAD_DIVIDE=111,t.KC_BACKSPACE=8,t.KC_TAB=9,t.KC_ENTER=13,t.KC_SHIFT=16,t.KC_CONTROL=17,t.KC_ESCAPE=27,t.KC_SPACE=32,t.KC_WINDOWS=91,t.KC_MENU=93,t.KC_CAPS_LOCK=20,t.KC_NUM_LOCK=144,t.KC_SCROLL_LOCK=145,t.KC_PAUSE=19,t.KC_PAGE_UP=33,t.KC_PAGE_DOWN=34,t.KC_END=35,t.KC_HOME=36,t.KC_INSERT=45,t.KC_DELETE=46,t.KC_LEFT=37,t.KC_UP=38,t.KC_RIGHT=39,t.KC_DOWN=40,t.KC_SEMICOLON_COLON=186,t.KC_EQUAL_PLUS=187,t.KC_MINUS_UNDERLINE=189,t.KC_SLASH_QUESTIONMARK=191,t.KC_SPECIALCOMMA_EARTHWORM=192,t.KC_LEFT_BRACKET_BRACE=219,t.KC_BACKSLASH_VERTICALBAR=220,t.KC_RIGHT_BRACKET_BRACE=221,t.KC_QUOTE=222,t.KC_COMMA=188,t.KC_PERIOD=190,t}();__reflect(KeyCode.prototype,"KeyCode");var LocationProperty=function(){function t(){}return t.init=function(){this.urlParam={};var t=window.paraUrl||location.href;if(t){var e=t.indexOf("?");if(-1!=e)for(var i=t.slice(e+1).split("&"),n=void 0,o=0;o<i.length;o++)n=i[o].split("="),this.urlParam[n[0]]=n[1]}},Object.defineProperty(t,"resAdd",{get:function(){return this.urlParam.hosts||"http://192.168.1.114:5479/client/"},set:function(t){this.urlParam.hosts=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"user",{get:function(){return"fgafddff"},set:function(t){this.urlParam.user=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"srvid",{get:function(){return 1},set:function(t){this.urlParam.srvid=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"srvName",{get:function(){return this.urlParam.srvName},set:function(t){this.urlParam.srvName=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"serverIP",{get:function(){return"152.136.19.57"},set:function(t){this.urlParam.srvaddr=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"serverPort",{get:function(){return 13001},set:function(t){this.urlParam.srvport=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pfid",{get:function(){return this.urlParam.pfid||""},enumerable:!0,configurable:!0}),Object.defineProperty(t,"appid",{get:function(){return this.urlParam.appid||""},enumerable:!0,configurable:!0}),t.isCanLogin=function(){return null!=this.user&&null!=this.srvid&&null!=this.serverIP&&null!=this.serverPort},t.setLoadProgress=function(t,e){console.log(t,e),window.showLoadProgress&&window.showLoadProgress(t,e)},t.enterGame=function(){this.isEnter||(this.isEnter=!0,window.showGame&&window.showGame())},t.isEnter=!1,t}();__reflect(LocationProperty.prototype,"LocationProperty");var XY=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t}();__reflect(XY.prototype,"XY");var MathUtils=function(){function t(){}return t.getAngle=function(t){return 180*t/Math.PI},t.getRadian=function(t){return t/180*Math.PI},t.getRadian2=function(t,e,i,n){var o=i-t,r=n-e;return Math.atan2(r,o)},t.getDistance=function(t,e,i,n){var o=Math.abs(i-t),r=Math.abs(n-e);if(o>20||r>20){var a=Math.min(o,r);return Math.floor(o+r-(a>>1)-(a>>2)+(a>>4))}var s=o*o+r*r;return Math.floor(Math.sqrt(s))},t.getDistanceByObject=function(t,e){return this.getDistance(t.x,t.y,e.x,e.y)},t.getDistanceX2ByObject=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},t.getDirMove=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var o=this.getRadian(t),r={x:0,y:0};return r.x=Math.cos(o)*e+i>>0,r.y=Math.sin(o)*e+n>>0,r},t.getPByDistance=function(t,e,i){var n=Math.atan2(e.y-t.y,e.x-t.x),o=new egret.Point;return o.x=e.x+i*Math.cos(n),o.y=e.y+i*Math.sin(n),o},t.limit=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var i=e-t;return t+Math.random()*i},t.limitInteger=function(t,e){return Math.floor(this.limit(t,e))},t.randomArray=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},t.toInteger=function(t){return t>>0},t.getGridTowardByDir=function(t,e,i,n){void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0);var o={x:0,y:0};return 0==t?(o.x=i,o.y=n-e):1==t?(o.x=i+e,o.y=n-e):2==t?(o.x=i+e,o.y=n):3==t?(o.x=i+e,o.y=n+e):4==t?(o.x=i,o.y=n+e):5==t?(o.x=i-e,o.y=n+e):6==t?(o.x=i-e,o.y=n):7==t&&(o.x=i-e,o.y=n-e),o},t.getDirByGridPoint=function(t,e,i,n){return t==i?n>=e?DirType.DOWN:DirType.UP:e==n?t>i?DirType.LEFT:DirType.RIGHT:i>t?e>n?DirType.RIGHT_UP:DirType.RIGHT_DOWN:e>n?DirType.LEFT_UP:DirType.LEFT_DOWN},t.getRectangle=function(t,e,i,n,o,r){void 0===r&&(r=Number.MAX_VALUE);var a=[];a.push(e);for(var s=i,h=e.x-t.x,p=e.y-t.y,l=Math.atan2(p,h),c=n/2,u=0,d=o;u<d.length;u++){var g=d[u],f=g.x-t.x,m=g.y-t.y,y=Math.abs(Math.atan2(m,f)-l),_=f*f+m*m,v=Math.cos(y),C=Math.sin(y);if((y<=Math.PI/2||y>=3*Math.PI/2)&&s*s>=v*v*_&&c*c>=C*C*_&&e!=g&&a.push(g),a.length>=r)break}return a},t.getClosest=function(t,e,i){void 0===i&&(i=1);for(var n=[],o="_tDis",r=e.length,a=0;r>a;a++){var s=this.getDistanceByObject(t,e[a]);e[a][o]=s,n.push(e[a])}return n.sort(function(t,e){return Algorithm.sortAsc(t[o],e[o])}),n.length>i&&(n.length=i),n},t.fomatFloat=function(t,e){return Math.floor(t*Math.pow(10,e))/Math.pow(10,e)},t.getAngelByXY=function(t,e,i,n){return this.getAngle(this.getRadiansByXY(t,e,i,n))},t.getRadiansByXY=function(t,e,i,n){return Math.atan2(n-e,i-t)},t.toInt=function(t){var e=parseInt(t);return isNaN(e)?0:e},t.toFloat=function(t){var e=parseFloat(t);return isNaN(e)?0:e},t.random=function(t,e){return Math.round(Math.random()*(e-t))+t},t.randomArraySort=function(t){var e=function(t,e){return Math.random()>.5?-1:1};return t.sort(e),t},t.hypot=function(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))},t.prototype.fortmatDecimals=function(t,e){void 0===e&&(e=2);var i=Math.pow(10,e);return Math.floor(t*i)/i},t.accMul=function(t,e){var i=0,n=t.toString(),o=e.toString();try{i+=n.split(".")[1].length}catch(r){}try{i+=o.split(".")[1].length}catch(r){}return Number(n.replace(".",""))*Number(o.replace(".",""))/Math.pow(10,i)},t.changeBit=function(t,e,i){var n=Math.pow(2,e-1);return t&n?i||(t-=n):i&&(t+=n),t},t}();__reflect(MathUtils.prototype,"MathUtils");var md5=function(){function t(){}return t.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.any_hmac_md5=function(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},t.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.rstr_hmac_md5=function(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var n=Array(16),o=Array(16),r=0;16>r;r++)n[r]=909522486^i[r],o[r]=1549556828^i[r];var a=this.binl_md5(n.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(o.concat(a),640))},t.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var i,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",o="",r=0;r<t.length;r++)i=t.charCodeAt(r),o+=n.charAt(i>>>4&15)+n.charAt(15&i);return o},t.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",o=t.length,r=0;o>r;r+=3)for(var a=t.charCodeAt(r)<<16|(o>r+1?t.charCodeAt(r+1)<<8:0)|(o>r+2?t.charCodeAt(r+2):0),s=0;4>s;s++)n+=8*r+6*s>8*t.length?this.b64pad:i.charAt(a>>>6*(3-s)&63);return n},t.rstr2any=function(t,e){var i,n,o,r,a,s=e.length,h=Array(Math.ceil(t.length/2));for(i=0;i<h.length;i++)h[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var p=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),l=Array(p);for(n=0;p>n;n++){for(a=Array(),r=0,i=0;i<h.length;i++)r=(r<<16)+h[i],o=Math.floor(r/s),r-=o*s,(a.length>0||o>0)&&(a[a.length]=o);l[n]=r,h=a}var c="";for(i=l.length-1;i>=0;i--)c+=e.charAt(l[i]);return c},t.str2rstr_utf8=function(t){for(var e,i,n="",o=-1;++o<t.length;)e=t.charCodeAt(o),i=o+1<t.length?t.charCodeAt(o+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),o++),127>=e?n+=String.fromCharCode(e):2047>=e?n+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n},t.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},t.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},t.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},t.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},t.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var i=1732584193,n=-271733879,o=-1732584194,r=271733878,a=0;a<t.length;a+=16){var s=i,h=n,p=o,l=r;i=this.md5_ff(i,n,o,r,t[a+0],7,-680876936),r=this.md5_ff(r,i,n,o,t[a+1],12,-389564586),o=this.md5_ff(o,r,i,n,t[a+2],17,606105819),n=this.md5_ff(n,o,r,i,t[a+3],22,-1044525330),i=this.md5_ff(i,n,o,r,t[a+4],7,-176418897),r=this.md5_ff(r,i,n,o,t[a+5],12,1200080426),o=this.md5_ff(o,r,i,n,t[a+6],17,-1473231341),n=this.md5_ff(n,o,r,i,t[a+7],22,-45705983),i=this.md5_ff(i,n,o,r,t[a+8],7,1770035416),r=this.md5_ff(r,i,n,o,t[a+9],12,-1958414417),o=this.md5_ff(o,r,i,n,t[a+10],17,-42063),n=this.md5_ff(n,o,r,i,t[a+11],22,-1990404162),i=this.md5_ff(i,n,o,r,t[a+12],7,1804603682),r=this.md5_ff(r,i,n,o,t[a+13],12,-40341101),o=this.md5_ff(o,r,i,n,t[a+14],17,-1502002290),n=this.md5_ff(n,o,r,i,t[a+15],22,1236535329),i=this.md5_gg(i,n,o,r,t[a+1],5,-165796510),r=this.md5_gg(r,i,n,o,t[a+6],9,-1069501632),o=this.md5_gg(o,r,i,n,t[a+11],14,643717713),n=this.md5_gg(n,o,r,i,t[a+0],20,-373897302),i=this.md5_gg(i,n,o,r,t[a+5],5,-701558691),r=this.md5_gg(r,i,n,o,t[a+10],9,38016083),o=this.md5_gg(o,r,i,n,t[a+15],14,-660478335),n=this.md5_gg(n,o,r,i,t[a+4],20,-405537848),i=this.md5_gg(i,n,o,r,t[a+9],5,568446438),r=this.md5_gg(r,i,n,o,t[a+14],9,-1019803690),o=this.md5_gg(o,r,i,n,t[a+3],14,-187363961),n=this.md5_gg(n,o,r,i,t[a+8],20,1163531501),i=this.md5_gg(i,n,o,r,t[a+13],5,-1444681467),r=this.md5_gg(r,i,n,o,t[a+2],9,-51403784),o=this.md5_gg(o,r,i,n,t[a+7],14,1735328473),n=this.md5_gg(n,o,r,i,t[a+12],20,-1926607734),i=this.md5_hh(i,n,o,r,t[a+5],4,-378558),r=this.md5_hh(r,i,n,o,t[a+8],11,-2022574463),o=this.md5_hh(o,r,i,n,t[a+11],16,1839030562),n=this.md5_hh(n,o,r,i,t[a+14],23,-35309556),i=this.md5_hh(i,n,o,r,t[a+1],4,-1530992060),r=this.md5_hh(r,i,n,o,t[a+4],11,1272893353),o=this.md5_hh(o,r,i,n,t[a+7],16,-155497632),n=this.md5_hh(n,o,r,i,t[a+10],23,-1094730640),i=this.md5_hh(i,n,o,r,t[a+13],4,681279174),r=this.md5_hh(r,i,n,o,t[a+0],11,-358537222),o=this.md5_hh(o,r,i,n,t[a+3],16,-722521979),n=this.md5_hh(n,o,r,i,t[a+6],23,76029189),i=this.md5_hh(i,n,o,r,t[a+9],4,-640364487),r=this.md5_hh(r,i,n,o,t[a+12],11,-421815835),o=this.md5_hh(o,r,i,n,t[a+15],16,530742520),n=this.md5_hh(n,o,r,i,t[a+2],23,-995338651),i=this.md5_ii(i,n,o,r,t[a+0],6,-198630844),r=this.md5_ii(r,i,n,o,t[a+7],10,1126891415),o=this.md5_ii(o,r,i,n,t[a+14],15,-1416354905),n=this.md5_ii(n,o,r,i,t[a+5],21,-57434055),i=this.md5_ii(i,n,o,r,t[a+12],6,1700485571),r=this.md5_ii(r,i,n,o,t[a+3],10,-1894986606),o=this.md5_ii(o,r,i,n,t[a+10],15,-1051523),n=this.md5_ii(n,o,r,i,t[a+1],21,-2054922799),i=this.md5_ii(i,n,o,r,t[a+8],6,1873313359),r=this.md5_ii(r,i,n,o,t[a+15],10,-30611744),o=this.md5_ii(o,r,i,n,t[a+6],15,-1560198380),n=this.md5_ii(n,o,r,i,t[a+13],21,1309151649),i=this.md5_ii(i,n,o,r,t[a+4],6,-145523070),r=this.md5_ii(r,i,n,o,t[a+11],10,-1120210379),o=this.md5_ii(o,r,i,n,t[a+2],15,718787259),n=this.md5_ii(n,o,r,i,t[a+9],21,-343485551),i=this.safe_add(i,s),n=this.safe_add(n,h),o=this.safe_add(o,p),r=this.safe_add(r,l)}return[i,n,o,r]},t.md5_cmn=function(t,e,i,n,o,r){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(n,r)),o),i)},t.md5_ff=function(t,e,i,n,o,r,a){return this.md5_cmn(e&i|~e&n,t,e,o,r,a)},t.md5_gg=function(t,e,i,n,o,r,a){return this.md5_cmn(e&n|i&~n,t,e,o,r,a)},t.md5_hh=function(t,e,i,n,o,r,a){return this.md5_cmn(e^i^n,t,e,o,r,a)},t.md5_ii=function(t,e,i,n,o,r,a){return this.md5_cmn(i^(e|~n),t,e,o,r,a)},t.safe_add=function(t,e){var i=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(i>>16);return n<<16|65535&i},t.bit_rol=function(t,e){return t<<e|t>>>32-e},t.hexcase=0,t.b64pad="",t}();__reflect(md5.prototype,"md5");var NumericUtils=function(){function t(){}return t.IntToHex=function(t){return this.HexCharTable[(4026531840&t)>>28]+this.HexCharTable[(251658240&t)>>24]+this.HexCharTable[(15728640&t)>>20]+this.HexCharTable[(983040&t)>>16]+this.HexCharTable[(61440&t)>>12]+this.HexCharTable[(3840&t)>>8]+this.HexCharTable[(240&t)>>4]+this.HexCharTable[15&t]},t.HexToInt=function(t){var e,i,n=0;for(e=0;8>e&&!(e>=t.length);++e)if(n<<=4,i=t.charCodeAt(e),i>=48&&57>=i)n|=i-48;else if(i>=65&&70>=i)n|=i-65+10;else{if(!(i>=97&&102>=i))break;n|=i-97+10}return n},t.MakeLong64=function(t,e){return t+4294967296*e},t.MakeLong=function(t,e){return 65535&t|e<<16&4294901760},t.MakeWord=function(t,e){return 255&t|e<<8&65280},t.LoWord=function(t){return 65535&t},t.HiWord=function(t){return t>>16&65535},t.LoByte=function(t){return 255&t},t.HiByte=function(t){return t>>8&255},t.PercentToFixed=function(t,e){return e=10^e,t*=e,t=Math.floor(t)/e,t.toString()},t.HexCharTable=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],t}();__reflect(NumericUtils.prototype,"NumericUtils");var RegExpUtil=function(){function t(){}return t.LINE_BREAK=/\r+/g,t.BLANK_REG=/[\s\\]/g,t.ARGB_COLOR=/[a-fA-F0-9]{8}/,t.HTML=/<[^>]+>/g,t.DELETE_SPACE=/\s/g,t.NumericExp=/^\d+$/,t.NonNumericExp=/\D/,t.ActorNameExp=/^([\u4e00-\u9fa5]?\w?[^>|!@#$%&*\^\?]){1,48}$/,t}();__reflect(RegExpUtil.prototype,"RegExpUtil");var ResourceUtils=function(t){function e(){var e=t.call(this)||this;return e._groupIndex=0,e._configs=new Array,e._groups={},e._urlResorce={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e.onResourceLoadComplete,e),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,e.onResourceLoadProgress,e),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,e.onResourceLoadError,e),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.addConfig=function(t,e){this._configs.push([t,e])},e.prototype.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},e.prototype.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},e.prototype.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},e.prototype.loadGroup=function(t,e,i,n){this._groups[t]=[e,i,n],RES.loadGroup(t)},e.prototype.loadGroups=function(t,e,i,n,o){RES.createGroup(t,e,!0),this.loadGroup(t,i,n,o)},e.prototype.pilfererLoadGroup=function(t,e){void 0===e&&(e=null);var i="pilferer_"+t;e||(e=[t]),RES.createGroup(i,e,!0),RES.loadGroup(i,-1)},e.prototype.onResourceLoadComplete=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][0],n=this._groups[e][2];null!=i&&i.call(n),this._groups[e]=null,delete this._groups[e]}},e.prototype.onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][1],n=this._groups[e][2];null!=i&&i.call(n,t.itemsLoaded,t.itemsTotal)}},e.prototype.onResourceLoadError=function(t){console.log(t.groupName+"资源组有资源加载失败"),this.onResourceLoadComplete(t)},e.prototype.loadResource=function(t,e,i,n,o){void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null);var r=t.concat(e),a="loadGroup"+this._groupIndex++;RES.createGroup(a,r,!0),this._groups[a]=[i,n,o],RES.loadGroup(a)},e.prototype.loadUrlResource=function(t,e,i,n){var o=this;null==this._urlResorce[t]?(this._urlResorce[t]={data:null,compFun:i,thisObj:n},RES.getResByUrl(t,function(e){o._urlResorce[t].data=e,null!=i&&i.apply(o._urlResorce[t].thisObj)},this,e)):null!=i&&i.apply(n)},e.prototype.getUrlResource=function(t){return null==this._urlResorce[t]?(console.log("资源未加载"),null):this._urlResorce[t].data},e}(BaseClass);__reflect(ResourceUtils.prototype,"ResourceUtils");var StageUtils=function(t){function e(){var e=t.call(this)||this;return null==e._uiStage&&(e._uiStage=new eui.UILayer,e._uiStage.touchEnabled=!1,e._uiStage.percentHeight=100,e._uiStage.percentWidth=100,e.getStage().addChild(e._uiStage)),e}return __extends(e,t),e.prototype.getHeight=function(){return this.stageHeight},e.prototype.getWidth=function(){return this.stageWidth},e.prototype.setTouchChildren=function(t){this.getStage().touchChildren=t},e.prototype.setMaxTouches=function(t){this.getStage().maxTouches=t},e.prototype.setFrameRate=function(t){this.getStage().frameRate=t},e.prototype.setScaleMode=function(t){this.getStage().scaleMode=t},e.prototype.setOrientation=function(t){DeviceUtils.IsPC||(t?this.getStage().orientation=t:this.getStage().orientation==egret.OrientationMode.LANDSCAPE?(this.getStage().orientation=egret.OrientationMode.PORTRAIT,this.getStage().setContentSize(580,930)):(this.getStage().orientation=egret.OrientationMode.LANDSCAPE,this.getStage().setContentSize(930,580)))},e.prototype.getStage=function(){return egret.MainContext.instance.stage},e.prototype.getUIStage=function(){return this._uiStage},e.prototype.resize=function(){var t=this.getStage(),e=t.stageWidth,i=t.stageHeight;
this.stageWidth=e,this.stageHeight=i},e.prototype.init=function(){var t=this.getStage();if(DeviceUtils.IsPC)window.innerHeight<GlobalVar.GAME_PC_HEIGHT?(t.setContentSize(window.innerWidth,GlobalVar.GAME_PC_HEIGHT),t.scaleMode=egret.StageScaleMode.FIXED_HEIGHT):t.scaleMode=egret.StageScaleMode.NO_SCALE;else{var e=GlobalVar.GAME_HEIGHT/GlobalVar.GAME_WIDTH,i=window.innerHeight/window.innerWidth;e>=i?(t.setContentSize(GlobalVar.GAME_HEIGHT*window.innerWidth/window.innerHeight,GlobalVar.GAME_HEIGHT),t.scaleMode=egret.StageScaleMode.SHOW_ALL):(t.setContentSize(GlobalVar.GAME_WIDTH,GlobalVar.GAME_WIDTH*window.innerHeight/window.innerWidth),t.scaleMode=egret.StageScaleMode.SHOW_ALL)}var n=t.stageWidth,o=t.stageHeight;this.stageWidth=n,this.stageHeight=o,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTouch,this)},e.prototype.onStageTouch=function(t){App.DisplayUtils.addEffectToObj(this.getStage(),"click_0_1",1,t.stageX,t.stageY)},e.prototype.logCh=function(t){for(var e=0,i=t.numChildren;i>e;e++){var n=t.getChildAt(e);n.__class__;n instanceof egret.DisplayObjectContainer&&this.logCh(n)}},e}(BaseClass);__reflect(StageUtils.prototype,"StageUtils");var StringUtils=function(){function t(){}return t.trimSpace=function(t){return t.replace(/^\s*(.*?)[\s\n]*$/g,"$1")},t.getStringLength=function(t){for(var e=t.split(""),i=0,n=0;n<e.length;n++){var o=e[n];i+=this.isChinese(o)?2:1}return i},t.isChinese=function(t){var e=/^[\u4E00-\u9FA5]+$/;return e.test(t)?!1:!0},t.strByteLen=function(t){for(var e=0,i=t.length,n=0;i>n;n++)e+=t.charCodeAt(n)>=127?2:1;return e},t.complementByChar=function(e,i,n,o){void 0===n&&(n=" "),void 0===o&&(o=!0);var r=this.strByteLen(o?e.replace(t.HTML,""):e);return e+this.repeatStr(n,i-r)},t.repeatStr=function(t,e){for(var i="",n=0;e>n;n++)i+=t;return i},t.addColor=function(t,e){var i;return"string"==typeof e?i=String(e):"number"==typeof e&&(i=Number(e).toString(10)),'<font color="'+i+'">'+t+"</font>"},t.addColor1=function(t,e){var i=new Object;return i.style=new Object,i.text=t,i.textColor=Number(e).toString(16),i},t.replaceStr=function(t,e,i){if(-1==t.indexOf(e))return t;var n=t.split(e);return n[0]+i+n[1]},t.substitute=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n;if(null==t)return"";var o=e.length;1==o&&Array.isArray(e[0])?(n=e[0],o=n.length):n=e;for(var r=0;o>r;)t=t.replace(new RegExp("\\{"+r+"\\}","g"),n[r]),r++;return t},t.toCNUpper=function(t){if(0==t)return this.NUM_CN[0];var e=t.toString();if(e.length>16)throw new Error("数字太大，无法处理！");var i=this.convertIntegerStr(e);return i},t.convertIntegerStr=function(t){var e=Math.floor(t.length/4),i=t.length%4,n=[];i>0&&n.push(this.convertThousand(t.substr(0,i),e));for(var o=0;e>o;o++){var r=i+4*o,a=t.substring(r,r+4);n.push(this.convertThousand(a,e-o-1))}return this.convertNodes(n)},t.convertNodes=function(t){for(var e,i="",n=0;n<t.length;n++){var o=t[n];(e&&o.desc.length>0||o.beforeZero&&o.desc.length>0&&i.length>0)&&(i+=this.NUM_CN[0]),i+=o.desc,o.afterZero&&n<t.length-1?e=!0:o.desc.length>0&&(e=!1)}return i},t.convertThousand=function(t,e){for(var i=new ThousandNode,n=t.length,o=0;4-n>o;o++)t="0"+t;var r=parseInt(t.charAt(0)),a=parseInt(t.charAt(1)),s=parseInt(t.charAt(2)),h=parseInt(t.charAt(3));return r+a+s+h==0?i:(0==r?i.beforeZero=!0:i.desc+=this.NUM_CN[r]+this.UNITS[0],0==a&&""!=i.desc&&s+h>0?i.desc+=this.NUM_CN[0]:a>0&&(i.desc+=this.NUM_CN[a]+this.UNITS[1]),0==s&&""!=i.desc&&h>0?i.desc+=this.NUM_CN[0]:s>0&&(s>1&&(i.desc+=this.NUM_CN[s]),i.desc+=this.UNITS[2]),0==h?i.afterZero=!0:h>0&&(i.desc+=this.NUM_CN[h]),i.desc.length>0&&(i.desc+=this.LEVELS[e]),i)},t.getUnitCount=function(t){return Math.ceil(Math.log(t)/Math.LN10)},t.HTML=/<[^>]+>/g,t.NUM_CN=["零","一","二","三","四","五","六","七","八","九"],t.UNITS=["千","百","十"],t.LEVELS=["","万","亿","兆"],t}();__reflect(StringUtils.prototype,"StringUtils");var ThousandNode=function(){function t(){this.desc=""}return t}();__reflect(ThousandNode.prototype,"ThousandNode");var SysUtils=function(){function t(){}return t.copyToPasteBoard=function(t){var e=document.createElement("input");e.value=t,document.body.appendChild(e),e.select(),e.setSelectionRange(0,e.value.length),document.execCommand("Copy"),document.body.removeChild(e)},t}();__reflect(SysUtils.prototype,"SysUtils");var TextFlowUtils=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.generateTextFlow=function(t){if(""==t||null==t||void 0==t)return null;if(-1!=t.indexOf("/font")||-1!=t.indexOf("/FONT"))return this.generateHTML(t);t=t.replace(/\\/g,"\n"),t=t.replace(/</g,"///<"),t=t.replace(/>/g,"///");for(var e=t.split("///"),i=[],n=0,o=e.length;o>n;n++)""!=e[n]&&("<"==e[n].charAt(0)?i.push(this.getSingleTextFlow(e[n].substr(1))):i.push({text:e[n],style:{}}));return i},e.getSingleTextFlow=function(t){for(var e,i={style:{}},n=t.match(/\((.+?)\)/g)||[],o=0,r=n.length;r>o;o++){var a=n[o].replace(/[\(\)]/g,"");switch(e=a.charAt(0).toLocaleUpperCase()){case this.STYLE_COLOR:var s=a.slice(1);s.length>8&&(s="0x"+a.slice(s.length-5)),i.style.textColor=parseInt(s);break;case this.STYLE_SIZE:i.style.size=parseInt(a.slice(1));break;case this.STYLE_UNDERLINE:i.style.underline=!0;break;case this.STYLE_BOLD:i.style.bold=!0;break;case this.STYLE_ITALIC:i.style.italic=!0;break;case this.STYLE_EVENT:i.style.href="event:"+a.slice(1);break;case this.STYLE_IMG:a=a.slice(1);var h=a.split("_");i.style.img=h;break;default:continue}}return i.text=t.replace(/\((.+?)\)/g,""),i},e.generateHTML=function(t){for(var e=["FONT","COLOR","SIZE","<B>","</B>","<U>","</U>"],i=0,n=e.length;n>i;i++){var o=RegExp(""+e[i],"g");t=t.replace(o,e[i].toLocaleLowerCase())}return(new egret.HtmlTextParser).parser(t)},e.color=function(t,e){return"<(c"+e+")"+t+">"},e.textBanWord=function(t){return t=t.replace(/[<>]/g,"*")},e.hrefType=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){var n=t.split(":");switch(n[0]){case"win":var o=n[1].split("#");App.ViewManager.openTab(o[0],parseInt(o[1]),parseInt(o[2]));break;case"npc":App.VisitManager.goToNpc(parseInt(n[1]));break;case"pass":GameCache.map.mapConfig.type==SceneType.NORMAL_FIELD&&Proxy.copy.sendEnterFB(GlobalVar.GUAJI_SCENE);break;case"passGuide":GameCache.map.mapConfig.type==SceneType.NORMAL_FIELD&&GameCache.novice.playGuide(GameConfig.clientGlobal.barrierGuideID);break;case"passBossGuide":GameCache.map.mapConfig.type==SceneType.NORMAL_FIELD?GameCache.novice.playGuide(GameConfig.clientGlobal.barrierGuideID):GameCache.map.mapConfig.type==SceneType.GUA_JI&&App.ViewManager.open(ViewConst.CHUANGGUAN);break;case"item":var r=n[1].split("_"),a=new ViewProp;"-1"==r[1]?a.itemData=GameConfig.fashion[r[0]]:a.itemData=GameConfig.item[r[0]],App.ViewManager.open(ViewConst.ITEMTIPS,a);break;case"role":Proxy.rank.askRoleInfo(parseInt(n[1]))}}},e.numAbbreviate=function(t){},e.generateEmoji=function(t,e,i){void 0===i&&(i=!1),t.textHeight;for(var n=t.linesArr,o=t.picArr||[],r=0,a=0+t.y,s=0,h=0;h<n.length;h++){for(var p=n[h],l=0+t.x,c=0;c<p.elements.length;c++){var u=p.elements[c];if(u.style.img&&u.text){var d=u.style.img,g=t.picArr&&t.picArr[s],f=u.style.size?u.style.size:t.size;g||(g=ObjectPool.get(eui.Image),g.name="emoji",o.push(g),e.addChild(g)),g.source=StringUtils.substitute(GlobalVar.EMOJI_TYPE[d[0]],d[1]);var m=RES.getRes(g.source);m?(g.scaleX=(parseInt(d[3])||f)/m.textureWidth,g.scaleY=(parseInt(d[2])||f)/m.textureHeight):(g.height=parseInt(d[2])||f,g.width=parseInt(d[3])||f),g.touchEnabled=!1,g.x=l,g.y=r*t.lineSpacing+a+p.height-f,s++}l+=u.width}a+=p.height,r++}for(var y=o.length-s>0?o.splice(s,o.length-s):[],h=0;h<y.length;h++){var _=y[h];_.source=null,_.scaleX=_.scaleY=1,_.name="",_.x=_.y=0,ObjectPool.push(_),e.removeChild(_),_=null}o&&(t.picArr=o)},e.STYLE_COLOR="C",e.STYLE_SIZE="S",e.STYLE_ITALIC="I",e.STYLE_BOLD="B",e.STYLE_UNDERLINE="U",e.STYLE_EVENT="E",e.STYLE_IMG="P",e}(BaseClass);__reflect(TextFlowUtils.prototype,"TextFlowUtils");var uint64=function(){function t(t){this._lowUint=0,this._highUint=0,this.value=t}return t.prototype.isEqual=function(t){return t?this._lowUint==t._lowUint&&this._highUint==t._highUint:!1},t.prototype.isGreaterThan=function(e){if(e instanceof t)return this._highUint>e._highUint||this._highUint==e._highUint&&this._lowUint>e._lowUint;var i=new t;return"string"==typeof e?(i.value=e,this.isGreaterThanOrEqual(i)):"number"==typeof e?(i.value=e.toString(),this.isGreaterThanOrEqual(i)):void 0},t.prototype.isGreaterThanOrEqual=function(e){if(e instanceof t)return this._highUint>e._highUint||this._highUint==e._highUint&&this._lowUint>=e._lowUint;var i=new t;return"string"==typeof e?(i.value=e,this.isGreaterThanOrEqual(i)):"number"==typeof e?(i.value=e.toString(),this.isGreaterThanOrEqual(i)):void 0},Object.defineProperty(t.prototype,"isZero",{get:function(){return 0==this._lowUint&&0==this._highUint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isGreaterThanZero",{get:function(){return this._lowUint>0||this._highUint>0},enumerable:!0,configurable:!0}),t.prototype.writeByte=function(t){t.writeUnsignedInt(this._lowUint),t.writeUnsignedInt(this._highUint)},t.prototype.setValue=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._lowUint=t,this._highUint=e},Object.defineProperty(t.prototype,"value",{set:function(e){e instanceof egret.ByteArray?(this._lowUint=e.readUnsignedInt(),this._highUint=e.readUnsignedInt()):"string"==typeof e&&t.stringToUint64(e,10,this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valueByString",{set:function(t){},enumerable:!0,configurable:!0}),t.prototype.leftMove=function(e,i){void 0===i&&(i=null),i=i||this;var n=t.LeftMoveMask[e],o=n&this._lowUint;o>>>=32-e,i._lowUint=this._lowUint<<e,i._highUint=this._highUint<<e,i._highUint=i._highUint|o},t.prototype.add=function(e,i){void 0===i&&(i=null),i=i||this;var n=this._lowUint+e._lowUint;i._highUint=this._highUint+e._highUint,n>=t.MaxLowUint?(i._highUint++,i._lowUint=n-t.MaxLowUint):i._lowUint=n},t.prototype.subtraction=function(e,i){void 0===i&&(i=null),i=i||this;var n=this._lowUint-e._lowUint;i._highUint=this._highUint-e._highUint,0>n?(i._highUint--,i._lowUint=n+t.MaxLowUint):i._lowUint=n},t.prototype.scale=function(e,i){void 0===i&&(i=null),i=i||this;var n=this._lowUint*e;i._highUint=this._highUint*e,i._highUint+=Math.floor(Math.abs(n/t.MaxLowUint)),i._lowUint=n%t.MaxLowUint},t.prototype.toString=function(e){void 0===e&&(e=10);for(var i,n,o,r="",a=this._lowUint,s=this._highUint;0!=s||0!=a;)i=s%e,o=i*t.MaxLowUint+a,n=o%e,r=n+r,s=(s-i)/e,a=(o-n)/e;return r.length?r:"0"},t.stringToUint64=function(e,i,n){void 0===i&&(i=10),void 0===n&&(n=null),n=n||new t;for(var o,r,a=0,s=0,h=e.length,p=0;h>p;p++)r=parseInt(e.charAt(p)),o=a*i+r,s=s*i+Math.floor(o/t.MaxLowUint),a=o%t.MaxLowUint;return n.setValue(a,s),n},t.LeftMoveMask=[0,2147483648,1073741824,536870912,268435456,134217728,67108864,33554432,16777216,8388608,4194304,2097152,1048576,524288,262144,131072,65536,32768,16384,8192,4096,2048,1024,512,256,128,64,32,16,8,4,2,1],t.MaxLowUint=4294967296,t}();__reflect(uint64.prototype,"uint64");var UseCondition=function(){function t(){this.type=0,this.id=101,this.count=1}return t}();__reflect(UseCondition.prototype,"UseCondition");var WatcherUtil=function(){function t(){}return t.removeFromArrayCollection=function(e){if(e&&e.source&&e.source.length)for(var i=0,n=e.source;i<n.length;i++){var o=n[i];t.removeFromObject(o)}},t.removeFromObject=function(t){if(t instanceof egret.EventDispatcher){var e=t.$getEventMap(),i=e[eui.PropertyEvent.PROPERTY_CHANGE];if(i)for(var n=i.length-1;n>=0;n--){var o=i[n];o.thisObject instanceof eui.Watcher&&(o.thisObject.unwatch(),i.splice(n,1))}}else{var r=t.__listeners__;if(r&&r.length)for(var a=0;a<r.length;a+=2){var s=r[a+1];s instanceof eui.Watcher&&(s.unwatch(),a-=2)}}},t}();__reflect(WatcherUtil.prototype,"WatcherUtil");var App=function(){function t(){}return Object.defineProperty(t,"stage",{get:function(){return t.StageUtils.getStage()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"StageUtils",{get:function(){return StageUtils.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Socket",{get:function(){return GameSocket.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TimerManager",{get:function(){return TimerManager.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ViewManager",{get:function(){return ViewManager.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MessageCenter",{get:function(){return MessageCenter.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ChatMgr",{get:function(){return ChatMgr.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DisplayUtils",{get:function(){return DisplayUtils.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DateUtils",{get:function(){return DateUtils.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FrameHandler",{get:function(){return FrameHandler.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DBAvatarManager",{get:function(){return DBAvatarManager.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ThingManager",{get:function(){return ThingManager.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"HurtTxtManager",{get:function(){return HurtTxtManager.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RedPoint",{get:function(){return RedPointManager.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FightManager",{get:function(){return FightManager.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BattleManager",{get:function(){return BattleManager.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"VisitManager",{get:function(){return VisitThingManager.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"skillPlay",{get:function(){return SkillPlayManager.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SoundManager",{get:function(){return SoundManager.getIns()},enumerable:!0,configurable:!0}),t.isJSON=function(t){try{var e=JSON.parse(t);return"object"==typeof e&&e?!0:!1}catch(i){return!1}},Object.defineProperty(t,"gameWorld",{get:function(){return t.ViewManager.getView(ViewConst.GAME_WORLD)},enumerable:!0,configurable:!0}),t}();__reflect(App.prototype,"App");var GameApp=function(t){function e(){var e=t.call(this)||this;return e.resOk=!1,e.configOk=!1,e}return __extends(e,t),e.prototype.start=function(){this.configOk?this.resOk||this.loadRes():this.loadConfig()},e.prototype.loadConfig=function(){LocationProperty.setLoadProgress(20,"(加载游戏配置)");var t="config";ResourceUtils.ins().loadGroup(t,this.readConfig,null,this)},e.prototype.readConfig=function(){var t=this;ConfigCache.read(RES.getRes("config_data")),RES.destroyRes("config_data");var e=ConfigCache.getFileList();App.TimerManager.addFrame(1,function(){for(var i=egret.getTimer(),n=0;32>n;){var o=e.shift();if(!o)break;ConfigCache.parseFile(o),n=egret.getTimer()-i}0==e.length&&(App.TimerManager.removeAll(t),t.configOk=!0,console.log("配置解析完毕"),t.loadServer())},this),this.loadRes()},e.prototype.loadRes=function(){var t="all";ResourceUtils.ins().loadGroup(t,this.onResourceLoadComplete,this.onResourceLoadProgress,this)},e.prototype.onResourceLoadComplete=function(){this.resOk=!0,this.loadServer()},e.prototype.loadServer=function(){this.resOk&&this.configOk&&(LocationProperty.setLoadProgress(90,"(登录游戏)"),ModuleManager.init(),GameCache.map.readXML(RES.getRes("map_data")),RES.destroyRes("map_data"),ServerMgr.loadingDispose(),App.Socket.login(LocationProperty.user,"e10adc3949ba59abbe56e057f20f883e",LocationProperty.srvid,LocationProperty.serverIP,LocationProperty.serverPort)),console.log("服务器IP："+LocationProperty.serverIP+"用户名"+LocationProperty.user)},e.prototype.onResourceLoadProgress=function(t,e){LocationProperty.setLoadProgress(25+t/e*60,"(加载必要资源)")},e}(egret.HashObject);__reflect(GameApp.prototype,"GameApp");var OperatorEgret=function(){function t(){}return t.init=function(){this.lifecycle(),this.eui_Image_source(),this.eui_getClassNameOfNode(),this.eui_List_rendererRemoved(),this.egretNodeAddChild(),this.egretEuiButton(),console.warn=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i]}},t.lifecycle=function(){DeviceUtils.IsPC||(egret.lifecycle.addLifecycleListener(function(t){document.addEventListener("qbrowserVisibilityChange",function(e){try{e.hidden?t.pause():t.resume()}catch(e){}})}),egret.lifecycle.onPause=function(){try{egret.ticker.pause()}catch(t){}},egret.lifecycle.onResume=function(){try{egret.ticker.resume()}catch(t){}})},t.eui_Image_source=function(){var t=Object.getOwnPropertyDescriptor(eui.Image.prototype,"source");Object.defineProperty(eui.Image.prototype,"source",{set:function(e){'""'!=e&&(this.source&&"string"==typeof this.source&&(this.source!=e&&(this.texture=null),EUIResourceManager.ins().remove(this.source)),"string"==typeof e&&EUIResourceManager.ins().add(e),t.set.call(this,e))}})},t.res_loadByVersion=function(){RES.getVirtualUrl=function(t){var e=t;if(ServerMgr.IsNative){if(t.indexOf("package.json")>-1||t.indexOf("resource/default.res.json")>-1)return t;if(ResVersionManager.ins().getVer2(t))return t}if(-1==t.lastIndexOf("http")){t=""+LocationProperty.resAdd+t;var i=ResVersionManager.ins(),n=i.getVer(e);t+="?v="+(n?n:0)}return t}},t.eui_List_rendererRemoved=function(){var t=eui.List.prototype.rendererRemoved;eui.List.prototype.rendererRemoved=function(e,i,n){e.dispose&&e.dispose(),t.call(this,e,i,n)}},t.egretNodeAddChild=function(){var t=egret.DisplayObjectContainer.prototype.addChildAt;egret.DisplayObjectContainer.prototype.addChildAt=function(e,i){return e.hashCode?t.call(this,e,i):null}},t.egretEuiButton=function(){var t=eui.Button.prototype.onTouchBegin;eui.Button.prototype.onTouchBegin=function(e){App.SoundManager.playEffect(SoundType.BUTTONCLICK),t.call(this,e)}},t.eui_getClassNameOfNode=function(){},t.urlList=[],t}();__reflect(OperatorEgret.prototype,"OperatorEgret");var ResVersionManager=function(t){function e(){var e=t.call(this)||this;return e.resVersionData=window.verData,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.has=function(t){return this.resVersionData.hasOwnProperty(t)},e.prototype.getVer=function(t){return this.resVersionData?this.resVersionData[t]:null},e.prototype.getVer2=function(t){return this.resVersionData2?this.resVersionData2[t]:null},e.prototype.loadConfig=function(t,e,i){var n=this;this.complateFunc=e,this.complateFuncTarget=i,RES.getResByUrl(t,function(t){n.resVersionData=t,n.complateFunc.call(n.complateFuncTarget)},this,RES.ResourceItem.TYPE_JSON)},e.prototype.loadConfig2=function(t,e,i){var n=this;this.complateFunc=e,this.complateFuncTarget=i,RES.getResByUrl(t,function(t){n.resVersionData2=t,n.complateFunc.call(n.complateFuncTarget)},this,RES.ResourceItem.TYPE_JSON)},e}(BaseClass);__reflect(ResVersionManager.prototype,"ResVersionManager");var SecondTimer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.add=function(){},e}(BaseClass);__reflect(SecondTimer.prototype,"SecondTimer");var BaseWinBg=function(t){function e(){var e=t.call(this)||this;return e.skinName="BaseWinBgSkin",e}return __extends(e,t),e.prototype.setNameImg=function(t){t&&(this.winTitle.source=RES_DIR_WIN_TITTLE+t+".png")},e.prototype.setNameImgHold=function(t){t&&(this.winTitle.source=t)},e.prototype.setHelpBtn=function(t){if(this.syBtn&&this.winTitle){if(0==this.winTitle.width&&t)return this.recordId=t,this.syBtn.visible=!1,void App.TimerManager.addFrame(10,this.delayShow,this,1);t?(this.syBtn.visible=!0,this.syBtn.x=this.winTitle.x+this.winTitle.width+10,this.syBtn.name=t+""):this.syBtn.visible=!1}},e.prototype.delayShow=function(){this.recordId&&(this.setHelpBtn(this.recordId),this.recordId=0)},e.prototype.remove=function(){},e.prototype.dispose=function(){this.disposeChildren(this)},e.prototype.disposeChildren=function(t){if(t.numChildren)for(var e,i=t.numChildren;i;)i--,e=t.removeChildAt(0),e instanceof eui.Image&&e.texture&&(e.source=null),e.stop&&e.stop(),e.dispose&&e.dispose(),this.disposeChildren(e)},e}(eui.Component);__reflect(BaseWinBg.prototype,"BaseWinBg",["eui.UIComponent","egret.DisplayObject"]);var TimerManager=function(t){function e(){var e=t.call(this)||this;return e._handlerDic={},e._currTime=egret.getTimer(),e._currFrame=0,egret.startTick(e.onEnterFrame,e),e}return __extends(e,t),e.prototype.getFrameId=function(){return this._currFrame},e.prototype.getSyncTime=function(){return this._currTime},e.DeleteHandle=function(t){t.clear(),ObjectPool.push(t)},e.prototype.onEnterFrame=function(t){return this._currTime=t,this._currFrame++,this.doTime(),App.FrameHandler.onFrame(),!1},e.prototype.doTime=function(){var t=this._currTime,i=this._currFrame;for(var n in this._handlerDic){var o=this._handlerDic[n],r=o.length;if(0>=r)delete this._handlerDic[n];else for(var a=0,s=void 0,h=!1;r>a;a++){if(s=o[a],!s)return;if(s.needDelete)o.splice(a,1),a--,r--,e.DeleteHandle(s);else if(h=!1,s.exeTime>0&&s.exeTime<=t?(s.exeTime=t+s.delay,h=!0):s.exeFrame>0&&s.exeFrame<=i&&(s.exeFrame=i+s.delay,h=!0),h){s.method.apply(s.methodObj,s.methodParam);var p=s.forever;p||(s.repeatCount>1?(s.repeatCount--,p=!0):1==s.repeatCount&&s.onFinish&&s.onFinish.apply(s.finishObj)),p||(o.splice(a,1),a--,r--,e.DeleteHandle(s))}}}},e.prototype.create=function(t,e,i,n,o,r,a,s){void 0===s&&(s=!0);for(var h=[],p=8;p<arguments.length;p++)h[p-8]=arguments[p];if(!(0>e||0>i||null==n)){if(!o.hashCode)throw new Error("计时器对象必须是HashObject");var l=ObjectPool.get(TimerHandler);l.forever=0==i,l.repeatCount=i,l.delay=e,l.method=n,l.methodObj=o,l.methodParam=h,l.onFinish=r,l.finishObj=a,l.exeTime=t+this._currTime,l.exeFrame=0;var c=this._handlerDic[o.hashCode];c||(c=this._handlerDic[o.hashCode]=[]),c.push(l)}},e.prototype.add=function(t,e,i,n,o,r){void 0===n&&(n=0),void 0===o&&(o=null),void 0===r&&(r=null),this.create(t,t,n,e,i,o,r)},e.prototype.addDelay=function(t,e,i,n,o,r,a){void 0===r&&(r=null),void 0===a&&(a=null);for(var s=[],h=7;h<arguments.length;h++)s[h-7]=arguments[h];this.create.apply(this,[t,e,i,n,o,r,a,!0].concat(s))},e.prototype.addFrame=function(t,e,i,n){if(void 0===n&&(n=0),!(0>t||0>n||null==e)){var o=ObjectPool.get(TimerHandler);o.forever=0==n,o.repeatCount=n,o.delay=t,o.method=e,o.methodObj=i,o.exeTime=0,o.exeFrame=t+this._currFrame;var r=this._handlerDic[i.hashCode];r||(r=this._handlerDic[i.hashCode]=[]),r.push(o)}},e.prototype.remove=function(t,e){var i=this._handlerDic[e.hashCode];if(i){for(var n=i.length-1;n>=0;n--){var o=i[n];o.method==t&&(o.needDelete=!0)}0==i.length&&delete this._handlerDic[e.hashCode]}},e.prototype.removeAll=function(t){var e=this._handlerDic[t.hashCode];if(e){for(var i=e.length-1;i>=0;i--){var n=e[i];n.needDelete=!0}delete this._handlerDic[t.hashCode]}},e.prototype.isExists=function(t,e){var i=this._handlerDic[e.hashCode];if(i){for(var n=i.length-1;n>=0;n--){var o=i[n];if(o.method==t)return!0}return!1}},e}(BaseClass);__reflect(TimerManager.prototype,"TimerManager");var TimerHandler=function(){function t(){this.delay=0,this.forever=!1,this.repeatCount=0,this.exeTime=0,this.exeFrame=0,this.needDelete=!1}return t.prototype.clear=function(){this.method=null,this.methodObj=null,this.methodParam=null,this.onFinish=null,this.finishObj=null,this.forever=!1,this.needDelete=!1},t}();__reflect(TimerHandler.prototype,"TimerHandler");var BaseConfig=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getConfig=function(t){return ConfigCache.getConfig(t)},e}(BaseClass);__reflect(BaseConfig.prototype,"BaseConfig");var SlidePage=function(t){function e(){var e=t.call(this)||this;return e.listGroup=[],e.activeSlideLen=10,e.page=0,e.skinName="SlidePageSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=ItemBase,App.DisplayUtils.slideContent(this.gTouch,this.moveAct,this),App.DisplayUtils.slideContent(this,this.moveAct,this)},e.prototype.moveAct=function(t){t>this.activeSlideLen?(this.page>0&&(this.page=this.page-1),this.setList()):t<-this.activeSlideLen&&(this.page<this.listGroup.length-1&&(this.page=this.page+1),this.setList())},e.prototype.setData=function(t,e,i){void 0===e&&(e=3),void 0===i&&(i=10),this.listGroup=[];for(var n=0,o=t.length;o>n;n+=e)this.listGroup.push(t.slice(n,n+e));for(var r=[],a=0;a<this.listGroup.length;a++){var s={icon:"public_json.public_page_bg_png",icon2:"public_json.public_page_sl_png"};r.push(s)}this.tabBtn.dataProvider=new eui.ArrayCollection(r),this.list.layout.gap=i,this.setList(),this.tabBtn.visible=this.listGroup.length>1},e.prototype.setList=function(){this.tabBtn.selectedIndex=this.page,this.setListData(this.list,this.listGroup[this.page])},e}(BaseCustComponent);__reflect(SlidePage.prototype,"SlidePage");var AttrBufId=function(){function t(){}return t.formatValue=function(t,e,i){return void 0===i&&(i=2),0==t?e+"":1==t?e+"%":2==t?(e/100).toFixed(0)+"%":3==t?(e/10).toFixed(0)+"%":4==t?(100*e).toFixed(0)+"%":void 0},t}();__reflect(AttrBufId.prototype,"AttrBufId");var ItemType;!function(t){t[t.itUndefinedType=0]="itUndefinedType",t[t.itWeapon=1]="itWeapon",t[t.itDress=2]="itDress",t[t.itHelmet=3]="itHelmet",t[t.itNecklace=4]="itNecklace",t[t.itDecoration=5]="itDecoration",t[t.itBracelet=6]="itBracelet",t[t.itRing=7]="itRing",t[t.itGirdle=8]="itGirdle",t[t.itShoes=9]="itShoes",t[t.itEquipDiamond=10]="itEquipDiamond",t[t.itSpecialRing=11]="itSpecialRing",t[t.itSwing=12]="itSwing",t[t.itExtraWeapon=13]="itExtraWeapon",t[t.itExtraDress=14]="itExtraDress",t[t.itShield=15]="itShield",t[t.itProectRune=16]="itProectRune",t[t.itSoulPearl=17]="itSoulPearl",t[t.itDizzyRing=18]="itDizzyRing",t[t.itFashionDress=19]="itFashionDress",t[t.itWeaponExtend=20]="itWeaponExtend",t[t.itSuperWeapon=21]="itSuperWeapon",t[t.itSuperDress=22]="itSuperDress",t[t.itSuperHelmet=23]="itSuperHelmet",t[t.itSuperNecklace=24]="itSuperNecklace",t[t.itSuperBracelet=25]="itSuperBracelet",t[t.itSuperRing=26]="itSuperRing",t[t.itSuperGirdle=27]="itSuperGirdle",t[t.itSuperShoes=28]="itSuperShoes",t[t.itEquipMax=29]="itEquipMax",t[t.itRideEquipArmor=60]="itRideEquipArmor",t[t.itRideEquipRein=61]="itRideEquipRein",t[t.itRideEquipSaddle=62]="itRideEquipSaddle",t[t.itRideEquipShoe=63]="itRideEquipShoe",t[t.itRideEquipMax=64]="itRideEquipMax",t[t.itQuestItem=101]="itQuestItem",t[t.itFunctionItem=102]="itFunctionItem",t[t.itMedicaments=103]="itMedicaments",t[t.itFastMedicaments=104]="itFastMedicaments",t[t.itItemDiamond=105]="itItemDiamond",t[t.itMedicaments2=106]="itMedicaments2",t[t.itExpBox=113]="itExpBox",t[t.itMine=114]="itMine",t[t.itForce=115]="itForce",t[t.itCircleSoul=116]="itCircleSoul",t[t.itDailyUse=117]="itDailyUse",t[t.itSellBox=118]="itSellBox",t[t.itSkillBook=119]="itSkillBook",t[t.itAutoUse=120]="itAutoUse",t[t.itJieBiaoBox=121]="itJieBiaoBox",t[t.itItemTypeCount=122]="itItemTypeCount",t[t.itNormal=200]="itNormal"}(ItemType||(ItemType={}));var JobType=function(){function t(){}return t.getJobName=function(t){return Language.lang.jobName[t]},t.zhanshi=1,t.fashi=2,t.gongshou=3,t}();__reflect(JobType.prototype,"JobType");var MoneyType;!function(t){t[t.BIND_COIN=0]="BIND_COIN",t[t.NON_BIND_COIN=1]="NON_BIND_COIN",t[t.BIND_YUANBAO=2]="BIND_YUANBAO",t[t.NON_BIND_YUANBAO=3]="NON_BIND_YUANBAO",t[t.STONE_POINT=4]="STONE_POINT",t[t.HONOUR=5]="HONOUR",t[t.WAREMBLEM=6]="WAREMBLEM",t[t.ROCK_CLOTHING=7]="ROCK_CLOTHING",t[t.GUILD_CONTRIBUTION=8]="GUILD_CONTRIBUTION",t[t.BONUS=9]="BONUS",t[t.INTEGRAL=10]="INTEGRAL",t[t.DREAM_POINT=11]="DREAM_POINT"}(MoneyType||(MoneyType={}));var PropId;!function(t){t[t.AP_ACTOR_ID=0]="AP_ACTOR_ID",t[t.AP_X=1]="AP_X",t[t.AP_Y=2]="AP_Y",t[t.AP_BODY_ID=3]="AP_BODY_ID",t[t.AP_FACE_ID=4]="AP_FACE_ID",t[t.AP_DIR=5]="AP_DIR",t[t.AP_LEVEL=6]="AP_LEVEL",t[t.AP_HP=7]="AP_HP",t[t.AP_STATE=8]="AP_STATE",t[t.AP_BODY_COLOR=9]="AP_BODY_COLOR",t[t.AP_MAX_HP=10]="AP_MAX_HP",t[t.AP_ATTACK=11]="AP_ATTACK",t[t.AP_DEFENCE=12]="AP_DEFENCE",t[t.AP_CRIT=13]="AP_CRIT",t[t.AP_UNCRIT=14]="AP_UNCRIT",t[t.AP_CRIT_HURT=15]="AP_CRIT_HURT",t[t.AP_DAMAGE_INC=16]="AP_DAMAGE_INC",t[t.AP_DAMAGE_DEC=17]="AP_DAMAGE_DEC",t[t.AP_DAMAGE_EXT=18]="AP_DAMAGE_EXT",t[t.AP_HITVALUE=19]="AP_HITVALUE",t[t.AP_DOGVALUE=20]="AP_DOGVALUE",t[t.AP_MOVE_SPEED=21]="AP_MOVE_SPEED",t[t.AP_ATTACK_SPEED=22]="AP_ATTACK_SPEED",t[t.AP_WEAPON=23]="AP_WEAPON",t[t.AP_MOUNT=24]="AP_MOUNT",t[t.AP_SWING=25]="AP_SWING",t[t.AP_HAIR=26]="AP_HAIR",t[t.AP_HAT=27]="AP_HAT",t[t.AP_EYE=28]="AP_EYE",t[t.AP_GLASSES=29]="AP_GLASSES",t[t.AP_PANTS=30]="AP_PANTS",t[t.AP_ASSIST=31]="AP_ASSIST",t[t.AP_BACK=32]="AP_BACK",t[t.AP_SEX=33]="AP_SEX",t[t.AP_JOB=34]="AP_JOB",t[t.AP_BATTLE_POWER=35]="AP_BATTLE_POWER",t[t.AP_PK_MOD=36]="AP_PK_MOD",t[t.AP_EXP=37]="AP_EXP",t[t.AP_PK_VALUE=39]="AP_PK_VALUE",t[t.AP_BAG_GRID_COUNT=40]="AP_BAG_GRID_COUNT",t[t.AP_BIND_COIN=41]="AP_BIND_COIN",t[t.AP_COIN=42]="AP_COIN",t[t.AP_BIND_YUANBAO=43]="AP_BIND_YUANBAO",t[t.AP_YUANBAO=44]="AP_YUANBAO",t[t.AP_GUILD_ID=45]="AP_GUILD_ID",t[t.AP_TEAM_ID=46]="AP_TEAM_ID",t[t.AP_SOCIALMASK=47]="AP_SOCIALMASK",t[t.AP_GUILDEXP=48]="AP_GUILDEXP",t[t.AP_MOUNT_EXP=49]="AP_MOUNT_EXP",t[t.AP_MAX_EXP=50]="AP_MAX_EXP",t[t.AP_ACIEVEPOINT=52]="AP_ACIEVEPOINT",t[t.AP_VIP_TEMPROARY=53]="AP_VIP_TEMPROARY",t[t.AP_ACTIVITY=54]="AP_ACTIVITY",t[t.AP_DRAW_YB_COUNT=55]="AP_DRAW_YB_COUNT",t[t.AP_DEPORT_GRID_COUNT=56]="AP_DEPORT_GRID_COUNT",t[t.AP_CHECKINS=57]="AP_CHECKINS",t[t.AP_RIDE_LEVEL=58]="AP_RIDE_LEVEL",t[t.AP_RIDE_BATTLE=59]="AP_RIDE_BATTLE",t[t.AP_CURNEWTITLE=60]="AP_CURNEWTITLE",t[t.AP_SIGNIN=61]="AP_SIGNIN",t[t.AP_DEPOT_YB=62]="AP_DEPOT_YB",t[t.AP_DEPOT_COIN=63]="AP_DEPOT_COIN",t[t.AP_VIP_GRADE=64]="AP_VIP_GRADE",t[t.AP_VIP_POINT=65]="AP_VIP_POINT",t[t.AP_BAG_TIME=66]="AP_BAG_TIME",t[t.AP_AUTH_SCORE=67]="AP_AUTH_SCORE",t[t.AP_BE_KILLED_COUNT=68]="AP_BE_KILLED_COUNT",t[t.AP_KILL_MONSTER_COUNT=69]="AP_KILL_MONSTER_COUNT",t[t.AP_TOTAL_ONLINE_MIN=70]="AP_TOTAL_ONLINE_MIN",t[t.AP_CHKPOINT_LV=71]="AP_CHKPOINT_LV",t[t.AP_CHKPOINT_AWARD_LV=72]="AP_CHKPOINT_AWARD_LV",t[t.AP_ACTIVITY_AWARD_FLAG=73]="AP_ACTIVITY_AWARD_FLAG",t[t.AP_RISK_LVL=74]="AP_RISK_LVL",t[t.AP_MOUNT_TYPE=75]="AP_MOUNT_TYPE",t[t.AP_ZY=76]="AP_ZY",t[t.AP_GM_LEVEL=77]="AP_GM_LEVEL",t[t.AP_RIDEONID=78]="AP_RIDEONID",t[t.AP_RIDE_STATE=79]="AP_RIDE_STATE",t[t.AP_DEFAULT_RIDE=80]="AP_DEFAULT_RIDE",t[t.AP_TEAMFUBEN_OUTPUT=81]="AP_TEAMFUBEN_OUTPUT",t[t.AP_TEAMFUBEN_TEAMID=82]="AP_TEAMFUBEN_TEAMID",t[t.AP_TEAMFUBEN_FBID=83]="AP_TEAMFUBEN_FBID",t[t.AP_REDPOINT_FLAG=84]="AP_REDPOINT_FLAG",t[t.AP_CJG_BOX_OPEN_TICK=86]="AP_CJG_BOX_OPEN_TICK",t[t.AP_GM_TITLE=87]="AP_GM_TITLE",t[t.AP_BADGE_LVL=88]="AP_BADGE_LVL",t[t.numProperties=89]="numProperties"}(PropId||(PropId={}));var SoundType=function(){function t(){}return t.CREATEROLE="create_role",t.BUTTONCLICK="button_click",t.STRENGTH="ui_equipStrengthen",t}();__reflect(SoundType.prototype,"SoundType");var ConfigCache=function(){function t(){}return t.read=function(t){this.configZip||(this.configZip=new JSZip(t))},t.clear=function(){this.configZip=null},t.getConfig=function(t){return this.configZip?(t+=".json",this.configDataList[t]):null},t.getFileList=function(){var t=[],e=this.configZip.files;for(var i in e)t.push(i);return t},t.parseFile=function(t){if(!this.configDataList[t]){var e=this.configZip.file(t);e||console.log(t+"配置不存在"),this.configDataList[t]=this.isJSON(e.asText()),this.configDataList[t]||console.log(t+"配置不存在")}},t.isJSON=function(t){try{var e=JSON.parse(t);return"object"==typeof e&&e?e:null}catch(i){return null}},t.configDataList={},t.openCopySyObj={},t}();__reflect(ConfigCache.prototype,"ConfigCache");var ItemExpend=function(t){function e(){var e=t.call(this)||this;return e.label="消耗：",e.numColor_0=41727,e._item=0,e._needNum=0,e._packType=0,e._haveNum=0,e.showHaveNum=!0,e._dataItem=null,e.skinName="ItemExpendSkin",e}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.gainWay.textFlow=TextFlowUtils.generateTextFlow("<(u)"+this.gainWay.text+">"),this.update()
},e.prototype.$onAddToStage=function(e,i){t.prototype.$onAddToStage.call(this,e,i),App.MessageCenter.addListener(MsgConst.BAG_INFO,this.update,this),App.MessageCenter.addListener(MsgConst.BAG_ITEM_NUM,this.update,this),App.MessageCenter.addListener(MsgConst.PROPERTY+PropId.AP_COIN,this.update,this),App.MessageCenter.addListener(MsgConst.PROPERTY+PropId.AP_YUANBAO,this.update,this),this.gainWay.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openTips,this),this.iconImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openTips,this),this.update()},e.prototype.onTouch=function(){this._item},e.prototype.openTips=function(){var t=GameConfig.item[this._item],e=new ViewProp;e.itemData=t,App.ViewManager.open(ViewConst.ITEMTIPS,e)},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.gainWay.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openTips,this),this.iconImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openTips,this),App.MessageCenter.removeAll(this)},Object.defineProperty(e.prototype,"item",{get:function(){return this._item},set:function(t){this._item=t,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"needNum",{get:function(){return this._needNum},set:function(t){this._needNum=t,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"have",{get:function(){return this._haveNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExpend",{get:function(){return this._haveNum>=this._needNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataItem",{get:function(){return this._dataItem},enumerable:!0,configurable:!0}),e.prototype.checkEnough=function(){return this._haveNum<this._needNum&&(this._item==GlobalVar.GOLD?GlobalFun.gotoCharge():this.openTips()),this._haveNum>=this._needNum},e.prototype.setData=function(t,e,i){void 0===e&&(e=void 0),void 0===i&&(i=BagType.BAG_TYPE_OTHER),this._item=t,this._needNum=e,this._packType=i,this.update()},e.prototype.setItemName=function(){if(this._item){var t=GameConfig.item[this._item]?GameConfig.item[this._item]:null;this.lab.text=t?t.name+"：":""}},e.prototype.update=function(t){if(this.iconImg&&this._item&&GameConfig.item[this._item]){this._dataItem=GameConfig.item[this._item];var e=GameConfig.item[this._item],i=e?e.icon:"";if(this.iconImg.source=RES_DIR_IMAGES_ITEM+i+".png",this.stuffName&&(this.stuffName.text=e.name),void 0!=this._needNum){var n=GlobalFun+"";if(this.showHaveNum){this._haveNum=this.haveNumber();var o=GlobalFun.numCut(this._haveNum);n=o+"",n=n+" / "+this._needNum,n=this._haveNum>=this._needNum?"<(c"+this.numColor_0+")"+n+">":"<(c0xFF0000)"+n+">","single"==this.currentState&&(n="<(c"+this.numColor_0+")"+this._needNum+">")}this.countTxt.textFlow=TextFlowUtils.generateTextFlow(n)}else this.countTxt.textFlow=TextFlowUtils.generateTextFlow(this.haveNumber()+"")}},e.prototype.haveNumber=function(){var t;return t=GameCache.bag.itemCount(this._item)},e.prototype.cleanMsg=function(){App.MessageCenter.removeListener(MsgConst.BAG_INFO,this),App.MessageCenter.removeListener(MsgConst.BAG_ITEM_NUM,this)},e.prototype.dispose=function(){this.iconImg&&(this.iconImg.source=null)},e}(eui.Component);__reflect(ItemExpend.prototype,"ItemExpend",["eui.UIComponent","egret.DisplayObject"]);var NumberMC=function(t){function e(e,i,n){void 0===e&&(e=0),void 0===i&&(i="0"),void 0===n&&(n=0);var o=t.call(this)||this;return o.roll=!1,o._value=0,o._type="0",o._init=!1,o._gap=0,o._alignV="top",o._alignH="left",o._value=e,o._type=i+"",o._gap=n,o}return __extends(e,t),e.prototype.updateType=function(t){this._type=t},e.pool=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=0),ObjectPool.get(e,t,i)},e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._init=!0,"0"!=this._type&&this.upNumber()},Object.defineProperty(e.prototype,"value",{get:function(){return this.rolling?this._rollValue:this._value},set:function(t){this._value!=t&&(this._value=t,this.rolling=!1,this.upNumber())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type!=t&&(this._type=t,this.upNumber())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gap",{get:function(){return this._gap},set:function(t){this._gap!=t&&(this._gap=t,this.upNumber())},enumerable:!0,configurable:!0}),e.prototype.initMask=function(){},Object.defineProperty(e.prototype,"alignV",{set:function(t){this._alignV!==t&&(this._alignV=t,this.upAlign())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alignH",{set:function(t){this._alignH!==t&&(this._alignH=t,this.upAlign())},enumerable:!0,configurable:!0}),e.prototype.upAlign=function(){switch(this._alignH){case"center":this.anchorOffsetX=this.width/2;break;case"left":this.anchorOffsetX=0;break;case"right":this.anchorOffsetX=this.width;break;default:this.anchorOffsetX=0}switch(this._alignV){case"mid":this.anchorOffsetY=this.height/2;break;case"top":this.anchorOffsetY=0;break;case"bottom":this.anchorOffsetY=this.height;break;default:this.anchorOffsetY=0}},e.prototype.upNumber=function(){if(this._init){for(var t,e=this._value+"",i=0,n=this.numChildren,o=e.length,r=0;o>r;r++){n>r?t=this.getChildAt(r):(t=ObjectPool.get(eui.Image),this.addChild(t)),t.source=this.getSingleNumPic(e.charAt(r),this._type),t.x=i;var a=this._gap;if(!a){var s=RES.getRes(t.source);a=s&&s.textureWidth}i+=a}for(;n>o;){var h=this.removeChildAt(r);h.source=null,ObjectPool.push(h),o++}t&&(this.width=t.x+t.width,this.height=t.height,this.upAlign(),this.playRoll())}},e.prototype.playRoll=function(){this.roll&&!this.rolling&&(this.rolling=!0,this._rollValue=this._value,this._value=0,this.initMask(),egret.Tween.removeTweens(this),egret.Tween.get(this).to({rollValue:this._rollValue},1e3).call(this.tweenComp,this))},Object.defineProperty(e.prototype,"rollValue",{get:function(){return this._value},set:function(t){this._value!=t&&(this._value=Math.floor(t),this.upNumber())},enumerable:!0,configurable:!0}),e.prototype.tweenComp=function(){this.rolling=!1,this.rollHand&&this.rollHand.run()},e.prototype.getSingleNumPic=function(t,e){return"."==t&&(t="dot"),""+e+t+"_png"},e.prototype.removeAll=function(){for(var t=this.numChildren;t;){t--;var e=this.removeChildAt(t);e.source=null,ObjectPool.push(e)}},e.prototype.dispose=function(){this.removeAll()},Object.defineProperty(e.prototype,"cnValue",{set:function(t){if(this._cnValue!=t){if(this._cnValue=t,this.rolling=!1,10>t&&(this._value=t),t>=10&&20>t){var e=t%10==0?"":t%10;this._value="X"+e}if(t>=20){var e=t%10==0?"":t%10;this._value=Math.floor(t/10)+"X"+e}this.upNumber()}},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(NumberMC.prototype,"NumberMC"),window.NumberMC=NumberMC;var SecondCountDown=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.addCallBack=function(t,e){t&&e&&(this.handler=Handler.create(e,t,null,!1))},e.prototype.addLabel=function(t,e,i){this._text=t,this._lab=e,this._tf=i},Object.defineProperty(e.prototype,"time",{get:function(){return this._time},set:function(t){this._time=t,App.TimerManager.removeAll(this),t>0&&App.TimerManager.add(1e3,this.onTime,this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverTime",{set:function(t){this.time=GlobalFun.getDiffMiniDateTime(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"openDay",{set:function(t){var e=GameCache.server.serverOpenDay;this.time=24*(t-e)*3600},enumerable:!0,configurable:!0}),e.prototype.onTime=function(){this._time--,this._time<=0&&(this._time=0,App.TimerManager.removeAll(this)),this._text&&(this._text.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(this._lab,App.DateUtils.getFormatBySecond(this._time,this._tf)))),this.handler&&(this.handler.args=[this._time],this.handler.run())},e.prototype.dispose=function(){App.TimerManager.removeAll(this),this.handler&&(this.handler.dispose(),this.handler=null)},e}(egret.HashObject);__reflect(SecondCountDown.prototype,"SecondCountDown");var UIAvatar=function(t){function e(){var e=t.call(this)||this;return e.body=new ThingBody(e),e}return __extends(e,t),e.prototype.showMonster=function(t){null==this.pro&&(this.pro=new PropertySet),this.pro.kind=ThingKind.Monster,this.pro.pro(PropId.AP_BODY_ID,t),this.setData(this.pro)},e.prototype.updatePart=function(t,e){this.pro.pro(t,e),this.refresh()},e.prototype.setData=function(t){this.pro=t,this.body.init(t),this.body.setStage(!0),this.body.playAction(ActionStandard.getSpine(ActionStandard.SA_IDLE))},e.prototype.refresh=function(){this.body.changeSkin()},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.body.onRemove()},e.prototype.$onAddToStage=function(e,i){t.prototype.$onAddToStage.call(this,e,i),this.body.setStage(!0)},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.body&&this.body.setStage(!1)},e}(BaseCustComponent);__reflect(UIAvatar.prototype,"UIAvatar");var ClientGlobalConfig=function(t){function e(){var e=t.call(this)||this;return e.passQuestID=[],e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=ConfigCache.getConfig("clientGlobal");for(var e in t)this[e]=t[e].value},e}(BaseClass);__reflect(ClientGlobalConfig.prototype,"ClientGlobalConfig");var GlobalCache=function(t){function e(){var e=t.call(this)||this;return e.oldPower=0,e.disconnectedType=-1,e}return __extends(e,t),e.prototype.clear=function(){this.oldPower=0,this.disconnectedType=-1},e}(BaseCache);__reflect(GlobalCache.prototype,"GlobalCache");var GlobalFun=function(){function t(){}return t.formatMiniDateTime=function(t){return GlobalVar.MiniDateTimeBase+1e3*(2147483647&t)},t.getDiffMiniDateTime=function(t,e){return void 0===e&&(e=4294967295),4294967295==e?this.formatMiniDateTime(t)-GameCache.server.serverTime:1e3*(t-e)},t.getItemSourceById=function(t){var e=null;return t&&GameConfig.item[t]&&(e=RES_DIR_IMAGES_ITEM+GameConfig.item[t].icon+".png"),e},t.getBagEnounghUseCondition=function(t,e){function i(t){return"number"==typeof t.id&&"number"==typeof t.count?GameCache.bag.itemCount(t.id)>=t.count:!1}if(void 0===t&&(t=null),void 0===e&&(e=null),t){var n=[];for(var o in t)n.push(i(t[o]));return n.indexOf(!0)>=0}return e?i(e):!1},t.filterJob=function(t){var e=[];for(var i in t){var n=t[i];if(n.id){var o=GameConfig.item[n.id],r=GameCache.hero.mainPro.pro(PropId.AP_JOB);ItemUtils.getEquipJob(o)==r&&e.push(n)}}return e},t.SysMsg=function(t,e){void 0===e&&(e=2),App.ChatMgr.doMessage(t,e)},t.alert=function(t,e,i,n){void 0===n&&(n=2);var o=new ViewProp;o.exData1={},o.exData1.func=e,o.exData1.thisc=i,o.exData1.desc=t,o.exData1.state=n,App.ViewManager.open(ViewConst.SYSTIPS,o)},t.getTotalPower=function(){for(var t=GameCache.hero.list,e=0,i=0,n=t;i<n.length;i++){var o=n[i];e+=o.pro.pro(PropId.AP_BATTLE_POWER)}return e},t.ObjPlusOrMinus=function(t,e,i){void 0===i&&(i=1);var n={},o=[];if(t)for(var r in t){var a=t[r];n[a.type]=a.value}if(e)for(var r in e){var a=e[r];0!=a.value&&(n[a.type]?n[a.type]=Math.floor(i*e[r].value+n[a.type]):n[a.type]=e[r].value)}for(var r in n){var a={type:parseInt(r),value:n[r]};o.push(a)}return o},t.ObjPlusRide=function(t,e){void 0===e&&(e=1);var i={},n=[];if(t)for(var o in t){var r=t[o];i[r.type]=r.value}for(var o in i){var r={type:parseInt(o),value:Math.floor(i[o]*e)};n.push(r)}return n},t.getRoleLv=function(){var t=GameCache.hero.mainPro;return t?t.pro(PropId.AP_LEVEL):0},t.getRoleIcon=function(t,e,i){return void 0===e&&(e=void 0),void 0===i&&(i=0),void 0==e&&(e=1),0==i?RES_DIR_ROLE_ICON+"role_"+t+"_"+e+".png":1==i?RES_DIR_ROLE_ICON+"role_s_"+t+"_"+e+".png":void 0},t.BitHas=function(t,e){return(t&1<<e)>0},t.Min=function(t){for(var e=0,i=t[0],n=0;n<t.length;n++)t[n]<i&&(i=t[n],e=n);return[i,e]},t.Max=function(t){for(var e=0,i=t[0],n=0;n<t.length;n++)t[n]>i&&(i=t[n],e=n);return[i,e]},t.gotoCharge=function(){GameCache.vip.openRechargeWin()},t.numCut=function(t){var e=(t/Math.pow(10,4),Math.floor(t)+"");if(t/Math.pow(10,4)>1&&t/Math.pow(10,8)<1){var i=t/Math.pow(10,4);return e=i%1==0?i+"":i.toFixed(2),StringUtils.substitute(Language.lang.numLevels[0],e)}if(t/Math.pow(10,4)>1&&t/Math.pow(10,8)<1){var i=t/Math.pow(10,8);return e=i%1==0?i+"":i.toFixed(2),StringUtils.substitute(Language.lang.numLevels[1],e)}return e},t.itemTips=function(t,e,i){var n,o;"number"==typeof t?n=GameConfig.item[t]:t instanceof UserItem?(n=t.stdItem,o=t):n=t;var r=new ViewProp;r.itemData=n,o&&(r.exData1=o),e&&(r.exData2=e),i&&(r.firData=i),App.ViewManager.open(ViewConst.ITEMTIPS,r)},t.checkVipLvl=function(e){var i=GameCache.vip.realValue()+1,n=GameConfig.vip[i],o="";o=n?StringUtils.substitute(Language.lang.vipLvlHint,e):Language.lang.vipLvlMax,t.SysMsg(o)},t.objChangeList=function(t){var e=[];for(var i in t)e.push(t[i]);return e},t.createItemEffect=function(t,e){var i=100;t.alpha=0,egret.Tween.get(t).wait(e*i).to({alpha:1},1).call(function(){App.DisplayUtils.addEffectToObj(t,"pnint_0_1",1,40,40)})},t.openEnterBuy=function(t){var e,i,n=[],o=[],r=0;switch(t){case"wboss":e=Proxy.boss.sendBossFubenOpt,i=Proxy.boss,n=[3,29],o=GameCache.boss.getWorldBossBuyMax(),r=GameConfig.globalConfig.worldBossCons;break;case"jingji":e=Proxy.other.sendBuyChance,i=Proxy.other,o=GameCache.jingji.getJingjiBuyMax(),r=GameConfig.jingji[1].consume[0].count;break;case"exp":e=Proxy.copy.sendCopyExpBuy,i=Proxy.copy;var a=GameCache.copy.getCopyExpId()[1],s=GameConfig.fuben[a];o=GameCache.copy.getCopyExpBuyData();var h=o[1];r=s.buyTimesConsume[h]?s.buyTimesConsume[h]:s.buyTimesConsume[s.buyTimesConsume.length-1];break;case"pgtboss":e=Proxy.boss.pgtBossBuy,i=Proxy.boss,o=GameCache.pgtBoss.getBuyMax(),r=GameConfig.globalConfig.PurgatoryCons;break;case"fashionCopy":e=Proxy.copy.sendCopyEnterBuy,i=Proxy.copy,n=[GameConfig.globalConfig.fashionCopyId],r=GameConfig.globalConfig.fashionCopyBuyPrice,o=GameCache.copy.getFashionCopyBuyData()}var p=new ViewProp;p.firData={},p.firData.func=e,p.firData.thisc=i,p.firData.arg=n,p.firData.max=o,p.firData.price=r,App.ViewManager.open(ViewConst.WBBUY,p)},t.getRandom=function(t){for(var e=0,i=1;t>=i;i++)e+=Math.pow(10,i)*Math.random();return e/Math.pow(10,t)},t.openItemTips=function(t){var e=GameConfig.item[t],i=new ViewProp;i.itemData=e,App.ViewManager.open(ViewConst.ITEMTIPS,i)},t.setRemindSet=function(t,e,i){var n=e?0:1,o=GameCache.settings.getValue(i);o&=4294967295-(1<<t),1==n&&(o+=1<<t),GameCache.settings.update(i,o,!0)},t.getRemindSet=function(t,e){var i=GameCache.settings.getValue(e);return 1!=(i>>t&1)},t}();__reflect(GlobalFun.prototype,"GlobalFun");var GlobalVar=function(){function t(){}return t.version="201911011547",t.GAME_WIDTH=640,t.GAME_HEIGHT=1136,t.GAME_PC_HEIGHT=1064,t.JUMP_X=3,t.JUMP_Y=3,t.DEFAULT_MOVE_SPEED=120,t.testSkill=!1,t.MiniDateTimeBase=12622752e5,t.autoOpenGroup=[],t.GUAJI_SCENE=9,t.ZHUCHENG_SCENE=6,t.PASSBOSS_SCENE=10,t.AUTO_RECYCLE=!1,t.AUTO_RECYCLE_TRIGER=.8,t.COIN=1,t.GOLD=14,t.Recount=5,t.MONSTER_DEFAULTSKILL=[[1,1]],t.ROLE_MAX=3,t.EMOJI_SIZE=25,t.EMOJI_TYPE=["emoji_json.emoji_{0}_png","zjm_json.zjm_channel_{0}_png"],t.CHAT_COLOR=[16777215,16762368,65292,16711932],t.OPEN_ALL_WIN=!1,t}();__reflect(GlobalVar.prototype,"GlobalVar");var Language_cn=function(){function t(){}return t.jobName=["通用","勇士","法师","弓手"],t.mainLvl="<({1})等级> : <({2}){0}>",t.mainJob="<({1})职业> : <({2}){0}>",t.mainPart="<({1})部位> : <({2}){0}>",t.huode="获得 {0}",t.coin="金币",t.yb="钻石",t.de="{0}的{1}",t.createRoleError={113:"选择服务器错误",111:"职业参数错误",110:"阵营参数错误",109:"随机生成的名字已经分配完",108:"性别与职业需求不符",107:"角色不存在",106:"客户端无匹配的路由数据的错误",105:"客户端选择角色的常规错误",104:"角色上一次保存数据出现异常",103:"游戏逻辑服务器未启动",102:"未发送查询包就开始创建角色",100:"数据库插入角色信息出错",1:"名称无效，名称中包含非法字符或超过6个字符",2:"名称服务器数据库操作错误",3:"名称服务器数据库调用错误",4:"名称已被使用"},t.adventrueMaxLv="您已达到最高级",t.restTime="剩余时间：{0}",t.signDay="{0} 天",t.email_read_error1="背包已满，无法领取",t.email_read_error2="邮件不存在",t.email_read_error3="邮件无附件无法被领取",t.email_delete_error1="邮件有附件无法被删除",t.email_delete_error2="邮件不存在",t.email_title="主题：{0}",t.sysOpen="{0}开启",t.sysOpenError1="角色<(c0xFF0000){0}>级",t.sysOpenError2="VIP{0}",t.socket1="您的账号在其他设备上登录",t.socket2="已断开连接，是否重新连接？",t.socket3="正在重新连接...",t.socket4="无法连接服务器，请稍后重试",t.suit1="装备等级不足",t.lcn1="已完成",t.lcn2="{0}级解锁",t.lcn3="第{0}层",t.lcn4="剩余次数：{0}",t.lcn5="迷雾之塔{0}层",t.lcn6="未上榜",t.lcn7="VIP{0}特权",t.lcn8="VIP{0}专享礼包",t.lcn9="免费VIP礼包",t.lcn10="(当前有效期:{0})",t.lcn11="当前有效期:永久",t.lcn12="{0}元",t.lcn13="复活倒计时:{0}",t.lcn14="无须复活",t.lcn15="请先激活宠物",t.lcn16="{0}星解锁",t.lcn17="已达限购次数",t.lcn18="完成{0}的任务",t.lcn19="开服{0}天",t.lcn20="等级: 1",t.lcn21="增加经验{0}",t.lcn22="今天可用<(c0x2aff00){0}次",t.lcn23="无可用次数",t.lcn24="剩余: {0}个",t.getway="获取途径",t.usLv="{0}级",t.wearError="您还未拥有该职业的角色",t.zdlPlus="战斗力+ {0}",t.part=["主武器","副武器","手套","项链","戒指","饰品","鞋子","帽子","衣服","披风"],t.fashionPart={3:"衣服",23:"主手",25:"翅膀",26:"发型",27:"帽子",28:"表情",29:"眼镜",30:"裤子",31:"副手",32:"背部"},t.jie="{0}阶",t.jie_j="{0}j",t.strengthLvlMax="不能超过人物等级",t.strengthPart="身上部位尚有空缺",t.exitWorldBoss="是否退出世界BOSS",t.reChargeHint="钻石不足，是否前往充值",t.price="<(c0xff5a00)价格 :>",t.lvlCondition="{0}级开启",t.notEnought="所需{0}不足",t.vipLvlHint="提升VIP等级增加{0}",t.vipLvlMax="VIP等级已达最高",t.reviveTime="{0}后复活",t.resetTime="{0}后恢复一次",t.relistTime="剩余时间 : {0}",t.remain="<(c0xffc600)剩余次数> : {0}",t.buyRemian="每天能购买{0}次",t.autoTime="{0}s 后自动领取",t.autoExit="{0}s 后自动退出",t.refineHint="该部位尚无装备",t.refineLvlMax="精炼等级已达上限",t.consume="消耗:",t.wbName="Lv:{0} {1}",t.nameLvl="{0} Lv.{1}",t.wingActiCondition="激活条件 : ",t.conditionText="幻羽{0}阶自动激活",t.unActive="{0}<(c0x0xff0000)（未激活）>",t.wing_0="提升VIP等级可获得更多金币培养次数",t.wingSkillEff="技能效果 : ",t.openTxt="{0}阶开启",t.numLevels=["{0}万","{0}亿"],t.copyEnterCount="今日挑战 : <(c0xffc600){0}次>",t.copySweepCount="今日扫荡 : <(c0xffc600){0}次>",t.copyEnterCondition="<(c0xff0000)角色{0}级可挑战>",t.copyAward_0="固定奖励 : <(c0x00a2ff){0}*{1}>",t.copyAward_1="特权用户必增加<(c0x00ff0c){0}收益>",t.copyExit="<(s18)(c0x3e1700)是否离开副本>\n<(s18)(c0x792301)（直接离开副本不会扣除奖励次数）>",t.copyExit_1="<(s18)(c0x3e1700)是否离开副本>",t.copyExit_2="<(s18)(c0x3e1700)是否离开VIPBOSS>",t.fashioncopy_0="通过<(c"+ColorUtil.C_GREEN+")上一难度>开启",t.fashioncopy_1="等级{0}级及通过上一难度开启",t.fashioncopy_2="等级达到<(c"+ColorUtil.C_GREEN+"){0}级>",t.copyText_0="扫荡次数",t.badgeCondi="关卡第{0}关",t.badgeMaxLvl="徽章等级已达最高级",t.badgeNotEnough="条件未满足",t.badge_0=["关卡第{0}关 未完成","关卡第{0}关 已完成"],t.resonanSkillName="{0} Lv.{1}",t.offLineText=["金币","经验","装备","离线获得","<(c0xfff600)VIP{0}>获得"],t.offLineBag=["背包已满","已自动熔炼{0}件装备"],t.jingji_t1="我的战力 : <(c0xffffff){0}>",t.jingji_t2="我的积分 : <(c0x0cff00){0}>",t.jingji_t3="第{0}名",t.jingji_t4="未上榜",t.jingji_t5="挑战次数不足",t.jingji_t6="每日<(c0x019601)00:00>发送奖励",t.jingji_t7="积分:<(c0xffffff){0}>",t.jingji_t8="10+",t.inspire_0="（{0}/{1}）",t.inspire_1="{0}/次",t.inspire_2="当前增加伤害 : <(c0x019601){0}%>",t.expIcome="当前经验收益 : <(c0x00ff0c){0}>",t.expVipPlus="VIP{0}用户经验 <(c0x00ff0c){0}>",t.jewel_0="爬塔{0}层开启",t.jewel_1="可获得 : ",t.rune_0="{0}j{1}s",t.rune_1="符碑{0}阶自动激活",t.vipBoss_0="VIP{0}开启",t.vipBoss_1="{0}级以及 VIP{1}开启",t.chat_0="#{0}",t.chat_1="请输入聊天内容",t.server_0="最近登录",t.server_1="{0}~{1}",t.server_2="当前服",t.xsyh_0="价格:",t.xsyh_1="VIP{0}可购",t.version="版本号 : {0}",t.gsName="归属 : {0}",t.bossHpName="<(c0xffc500)Lv.{0}> <(c0xffffff){1}>",t.dailyPointStr="活跃度+{0}",t.strengProTtl="强化属性",t.refineProTtl="精炼属性",t.itemType="<({0})类型> : <({1})道具>",t.itemNum="<({1})数量> : <({2}){0}>",t.purgatoryItemNum="<({2}){0}/{1}>",t.purgatoryPropTitle="<(c0xff5a00){0}（{1}阶）>",t.purgatoryProp="<(c0xffffff){0} : ><({2}){1}>",t.purgatoryDecomeNum="X{0}",t.pgtBossRefreshTime="（{0}恢复一次）次数：",t.pgtBossChallenge="{0}/{1}",t.pgtBossCost="X{0}<({1})（{2}）>",t.pgtBossLv="{0}级",t.pgtBossExit="确认从该场景退出吗?\n挑战次数和门票不返还",t.pgtBossCd="{0}\n后复活",t.pgtBossLock="需先通关上一难度",t.roleLevelLack="角色等级不足",t.activityCatalogueTime="活动时间：{0}",t.familyApplyCondition="任务战斗力{0}以上",t.familyTitle="{0}  LV.{1}",t.familyLeaderName="<(c0xffc600)会长 : >{0}",t.familyMemNum="<(c0xffc600)会员 : >{0}/{1}",t.familyFund="<(c0xffc600)资金 : >{0}/{1}",t.familyScore="<(c0xffc600)评分 : >{0}",t.familyMemName="{0}  LV.{1}",t.familyMemScore="<(c0xffc600)战力: >{0}",t.familyMemDevote="<(c0xffc600)贡献: >{0}",t.familyMemOnline="<(c0x00ff0c)在线>",t.familyMemOffline="<(c0xeeb28e){0}>",t.familyName="{0}  LV.{1}",t.familyNoLimit="<(c0x34ffe9)无限制条件>",t.familyLimitScore="<(c0x00ff0c)战力{0}以上>",t.familyLimit="<(c0xffc600)条件 ： >{0}",t.familyNum="<(c0xffc600)人数 ： >{0}/{1}",t.familyCreateLimit="VIP{0}可创建公会",t.familyCreateCost="<(c0xFF0000)X{0}>",t.familyApplyAuto="满足条件自动加入",t.familyQuitMsg="退出家族成功",t.familyEnterMsg="加入家族成功",t.familyNoPermit="权限不足",t.familyMemLv="<(c0xffc600)等级: >{0}",t.familyDismissDesc="解散家族后自动遣散所有家族成员，遣散家族后自动保留公会技能等级，但是家族贡献，仓库积分将会清空",t.familyDismissDesc2="是否确定解散家族？",t.roleNameLinke="<(u)(c0x00FF0C)(erole:{0}){1}>",t.familyCreateVIPLack="请先提升VIP等级",t.familyNoticeLimit="{0}/{1}",t}();__reflect(Language_cn.prototype,"Language_cn");var Language=function(){function t(){}return Object.defineProperty(t,"lang",{get:function(){return Language_cn},enumerable:!0,configurable:!0}),t}();__reflect(Language.prototype,"Language");var GameWorld=function(t){function e(){var e=t.call(this,LayerManager.Game_Main)||this;return e.nextSortTime=0,e.skyDraw=new BaseMapDrawLayer,e.floorDraw=new BaseMapDrawLayer,e.treeDraw=new BaseMapDrawLayer,e.frontDraw=new BaseMapDrawLayer,e.bottomLayer=new BaseMapThingLayer,e.playerLayer=new BaseMapThingLayer,e.topLayer=new BaseMapThingLayer,e.addChild(e.skyDraw),e.addChild(e.treeDraw),e.addChild(e.floorDraw),e.addChild(e.bottomLayer),e.addChild(e.playerLayer),e.addChild(e.topLayer),e.addChild(e.frontDraw),e.camera=new Camera,e.camera.register(e.floorDraw),e.camera.register(e.treeDraw),e.camera.register(e.frontDraw),e.camera.register(e.playerLayer),e.camera.register(e.bottomLayer),e.camera.register(e.topLayer),App.ThingManager.playerLayer=e.playerLayer,App.ThingManager.titleLayer=e.topLayer,App.ThingManager.bottomLayer=e.bottomLayer,e.touchEnabled=!0,e.closeDispose=!1,ThingKind.initIndex(),e.initEvent(),e}return __extends(e,t),e.prototype.initEvent=function(){App.TimerManager.addFrame(DeviceUtils.IsPC?1:2,this.onFrame,this),this.addTouchEvent(this,this.onTouch),App.MessageCenter.addListener(MsgConst.FOCUS_CHANGE,this.onFocusChange,this),App.MessageCenter.addListener(MsgConst.RESIZE_STAGE,this.resizeStage,this),App.MessageCenter.addListener(MsgConst.ENTER_SCENE,this.onEnterScene,this),this.resizeStage()},e.prototype.open=function(t){void 0===t&&(t=null)},e.prototype.shake=function(){App.DisplayUtils.shakeIt(this.floorDraw,10,100,2),App.DisplayUtils.shakeIt(this.treeDraw,10,100,2),App.DisplayUtils.shakeIt(this.playerLayer,10,100,2)},e.prototype.resizeStage=function(){t.prototype.resizeStage.call(this),this.skyDraw&&this.skyDraw.focusToCenter()},e.prototype.drawCell=function(){var t=GameCache.map.mapWidth/GameCache.map.cellWidth,e=GameCache.map.mapHeight/GameCache.map.cellHeight,i=new egret.Shape;i.graphics.lineStyle(1,0,1);for(var n=0;t>n;n++)i.graphics.moveTo(40*n,0),i.graphics.lineTo(40*n,40*e);for(var n=0;e>n;n++)i.graphics.moveTo(0,40*n),i.graphics.lineTo(40*t,40*n);this.playerLayer.addChild(i)},e.prototype.onFrame=function(){var t=App.TimerManager.getSyncTime();App.ThingManager.onUpdate(),t>=this.nextSortTime&&(this.sortThingIndex(),this.nextSortTime=t+300),GameCache.map.dataInit&&this.camera.unpdate(t)},e.prototype.sortThingIndex=function(){this.playerLayer.$children.sort(this.onSortThingIndex)},e.prototype.onSortThingIndex=function(t,e){if(!t.pro||!e.pro)return 0;if(t.cellXY.y>e.cellXY.y)return 1;if(t.cellXY.y==e.cellXY.y){var i=ThingKind.getIndexByKind(t.pro.kind),n=ThingKind.getIndexByKind(e.pro.kind);if(i>n)return 1;if(i==n)return 0}return-1},e.prototype.onTouch=function(t){App.VisitManager.clear();var e=t.stageX,i=t.stageY,n=GameCache.hero.focusPlayer;if(n&&!GameCache.map.mapConfig.untouch){var o=this.playerLayer.globalToLocal(e,i),r=this.topLayer.getClickTarget(o.x,o.y);if(r||(r=this.playerLayer.getClickTarget(o.x,o.y)),null!=r&&!GameCache.hero.isMySelf(r.pro.recog))return void this.onTouchThing(r);if(this.onTouchThing(null),App.FightManager.heroStart(!1),!n.isJump){var a=o.x/GameCache.map.cellWidth>>0,s=o.y/GameCache.map.cellHeight>>0;n.moveTo(a,s)}}},e.prototype.onTouchThing=function(t){if(!t)return void App.FightManager.setFightTarget(null);var e=t.pro?t.pro.kind:-1;e==ThingKind.Monster?App.FightManager.setFightTarget(t):e==ThingKind.Human&&0==GameCache.map.mapConfig.nopk?App.FightManager.setFightTarget(t):(App.FightManager.heroStart(!1),App.VisitManager.goToThing(t))},e.prototype.onFocusChange=function(){this.camera.regPlayer(GameCache.hero.focusPlayer)},e.prototype.refreshDraw=function(){this.camera.exitScene();var t=GameCache.map;if(t.getMapData()){var e=t.skyDrawVo,i=t.mapWidth,n=t.mapHeight;this.skyDraw.setData(e.imgList,e.width,e.height,i,n),e=t.floorDrawVo,this.floorDraw.setData(e.imgList,e.width,e.height,i,n),e=t.treeDrawVo,this.treeDraw.setData(e.imgList,e.width,e.height,i,n),e=t.frontDrawVo,this.frontDraw.setData(e.imgList,e.width,e.height,i,n),this.skyDraw.focusToCenter()}},e.prototype.onEnterScene=function(){GameCache.map.enter(),App.VisitManager["continue"]()},e.prototype.drawSkillRange=function(t,e,i,n){this.skillRange||(this.skillRange=new egret.Shape,this.topLayer.addChild(this.skillRange));var o=this.skillRange.graphics;o.clear();var r,a,s,h;i>t?(r=t,s=i-t):(r=i,s=t-i),s++,n>e?(a=e,h=n-e):(a=n,h=e-n),h++,o.beginFill(65280,.6),o.drawRect(0,0,s*GameCache.map.cellWidth,h*GameCache.map.cellHeight),o.endFill(),this.skillRange.x=r*GameCache.map.cellWidth,this.skillRange.y=a*GameCache.map.cellHeight},e.prototype.removeAllEvent=function(){},e.prototype.dispose=function(){t.prototype.removeAllEvent.call(this),t.prototype.dispose.call(this)},e}(BaseEuiWindow);__reflect(GameWorld.prototype,"GameWorld");var MapCache=function(t){function e(){var e=t.call(this)||this;return e.cellWidth=40,e.cellHeight=40,e.mapId=0,e.fbId=0,e.lastMapFile="",e.curMapFile="",e.firstEnterScene=!0,e.dataInit=!1,e.showLoading=!1,e.loadlingList=[],e.cameraX=0,e.cameraY=0,e.isAIMap=!1,e._xml=new MapXML,e}return __extends(e,t),e.prototype.clear=function(){t.prototype.clear.call(this),this.lastMapFile="",this.firstEnterScene=!0,this.dataInit=!1,this.showLoading=!1,this.loadlingList.length=0},e.prototype.getHookPoint=function(){var t=this.mapConfig.hookPath;return t&&t.length>0?(this.hookIndex++,this.hookIndex>=t.length&&(this.hookIndex=0),t[this.hookIndex]):null},e.prototype.readXML=function(t){this._xml.read(t)},e.prototype.sendExit=function(){},e.prototype.exit=function(){this.dataInit=!1,App.ThingManager.removeAll(),App.FightManager.mapChange(),GameCache.hero.exitScene(),this.isAIMap=!1,GameCache.pass.close(),App.FightManager.heroStart(!1),App.FrameHandler.add(App.ViewManager.destroyView,App.ViewManager,!0),App.FrameHandler.add(App.DBAvatarManager.onScengChange,App.DBAvatarManager,!0)},e.prototype.enter=function(){this.mapId==GlobalVar.GUAJI_SCENE?GameCache.pass.open():this.mapId==GlobalVar.PASSBOSS_SCENE&&GameCache.pass.playBossEffect(),this.isHookMap()&&App.FightManager.heroStart(!0),InfoViewController.autoOpen(),InfoViewController.openView(this.mapConfig.type),App.SoundManager.playMusic(this.mapConfig.music)},e.prototype.update=function(t,e){this.mapId=t,this.fbId=e;var i=GameConfig.scene[t];if(this.hookIndex=-1,!i)throw new Error("未找到场景配置, id:"+t);this.mapConfig=i,this.curMapFile=i.mapfilename,this.mapId==GlobalVar.GUAJI_SCENE?(this.curMapFile=GameCache.pass.getMapFile(),this.isAIMap=!0):this.mapId==GlobalVar.PASSBOSS_SCENE&&(this.curMapFile=GameCache.pass.getMapFile())},e.prototype.isSameMap=function(){return this.lastMapFile==this.curMapFile},e.prototype.isHookMap=function(){return this.mapConfig&&this.mapConfig.auto>0},e.prototype.getMapData=function(){if(this.dataInit=!0,this.lastMapFile==this.curMapFile)return!1;this.lastMapFile=this.curMapFile;for(var t=this._xml.getConfig(this.curMapFile),e=egret.XML.parse(t),i=[],n=e.children,o=n.length,r=0;o>r;r++){var a=n[r];if("step"==a.name&&this.pareseMapSize(a),"view"==a.name&&(this.skyDrawVo=this.parseMapDraw(a)),"floor"==a.name&&(this.floorDrawVo=this.parseMapDraw(a)),"tree"==a.name&&(this.treeDrawVo=this.parseMapDraw(a)),"front"==a.name&&(this.frontDrawVo=this.parseMapDraw(a)),"t"==a.name){var s=a.children[0].text;i.push(s.split(","))}}var h=new CMapTpl;return h.parese(i),this.find=new CMapPathData(h),this.showLoading=!0,this.loadlingList.length=0,!0},e.prototype.findPath=function(t,e,i,n){if(t==i&&e==n)return[];var o=this.find.FindPath(new CWTPoint(t,e),new CWTPoint(i,n),new CWTPoint(GlobalVar.JUMP_X,GlobalVar.JUMP_Y));o.reverse();for(var r,a,s=0,h=o.length;h>s;s++)if(0==s)r=o[s];else{if(a=o[s],a.mX==r.mX&&a.mY==r.mY)o.splice(s,1),h--,s--;else if(a.mX==r.mX&&a.mY>r.mY)for(var p=r.mY+2,l=a.mY;l>p;p++)if(this.canStand(a.mX,p)){var c=new CWTPoint(a.mX,p);o.splice(s,0,c),h++,s++}r=a}return o},e.prototype.pareseMapSize=function(t){for(var e=t.children,i=e.length,n=0;i>n;n++)"w"==e[n].name?this.mapWidth=parseInt(e[n].children[0].text):"h"==e[n].name&&(this.mapHeight=parseInt(e[n].children[0].text))},e.prototype.parseMapDraw=function(t){var e=new MapDrawLayerVo,i=[];e.imgList=i;for(var n=t.children,o=n.length,r={},a=0;o>a;a++){if("p"==n[a].name){var s=new MapImageVo;s.x=parseInt(n[a].attributes.x),s.y=parseInt(n[a].attributes.y),s.w=parseInt(n[a].attributes.w),s.h=parseInt(n[a].attributes.h),s.scaleX=parseFloat(n[a].attributes.scaleX),s.scaleY=parseFloat(n[a].attributes.scaleY),s.url=n[a].children[0].text,r[s.url]?s.index=r[s.url]:(s.index=a+1,r[s.url]=a+1),i.push(s)}"w"==n[a].name?e.width=parseInt(n[a].children[0].text):"h"==n[a].name&&(e.height=parseInt(n[a].children[0].text))}return e},e.prototype.isRope=function(t,e){return this.find.IsRope(t,e+1)},e.prototype.isJump=function(t,e,i,n){if(t==i&&e==n)return!1;var o=MathUtils.getDirByGridPoint(t,e,i,n),r=MathUtils.getGridTowardByDir(o,1,t,e);return!this.canStand(r.x,r.y)},e.prototype.canStand=function(t,e){return this.find.canStand(t,e+1)},e}(BaseCache);__reflect(MapCache.prototype,"MapCache");var MapXML=function(){function t(){this.configDataList={}}return t.prototype.read=function(t){this.configZip||(this.configZip=new JSZip(t))},t.prototype.getConfig=function(t){if(!this.configZip)return null;if(t+=".xml",!this.configDataList[t]){var e=this.configZip.file(t);e||console.log(t+"配置不存在"),this.configDataList[t]=e.asText()}return this.configDataList[t]},t}();__reflect(MapXML.prototype,"MapXML");var DropItem=function(t){function e(){var e=t.call(this)||this;return e._cuPos=new XY,e._startPos=new XY,e._endPos=new XY,e.touchEnabled=e.touchChildren=!1,e.icon=new eui.Image,e.icon.width=64,e.icon.height=64,e.addChild(e.icon),e.anchorOffsetY=40,e}return __extends(e,t),e.prototype.initData1=function(t,e,i,n){this.isTrue=!0,this.packetId=t,this.pickTime=App.TimerManager.getSyncTime(),this.setItem(e),this.setCellXY(i,n),this.icon.alpha=0,this.icon.y=0,this.icon.rotation=0;egret.Tween.get(this.icon).wait(MathUtils.limitInteger(-30,200)).to({y:-90,alpha:1},100).to({y:0},100+MathUtils.limitInteger(50,100),egret.Ease.backOut);this.alpha=1},e.prototype.initData2=function(t,e,i,n,o,r){this.isTrue=!1,this.packetId=t,this.setItem(e),this.icon.alpha=1,this.icon.y=0,this.alpha=1,this._startPos.x=GameCache.map.cellWidth*(i+.5)>>0,this._startPos.y=(GameCache.map.cellHeight*(n+.5)>>0)-90,this._endPos.x=GameCache.map.cellWidth*(o+.5)>>0,this._endPos.y=GameCache.map.cellHeight*(r+.5)>>0,this._cuPos.x=this._startPos.x+this._endPos.x>>1,this._cuPos.y=this._startPos.y-80,this.icon.rotation=0,this._cuValue=0,this.x=this._startPos.x,this.y=this._startPos.y,egret.Tween.get(this).to({factor:1},300).call(this.factorEnd,this)},Object.defineProperty(e.prototype,"factor",{get:function(){return this._cuValue},set:function(t){this._cuValue=t;var e=1-t,i=e*e,n=t*e*2,o=t*t;this.x=i*this._startPos.x+n*this._cuPos.x+o*this._endPos.x,this.y=i*this._startPos.y+n*this._cuPos.y+o*this._endPos.y},enumerable:!0,configurable:!0}),e.prototype.setIconRotation=function(t){this.icon.rotation=t},e.prototype.factorEnd=function(){egret.Tween.removeTweens(this.icon),this.icon.rotation=0,App.TimerManager.addDelay(1e3+MathUtils.limit(0,400),1,1,this.flyToBag,this)
},e.prototype.flyToBag=function(){var t=App.ViewManager.getView(ViewConst.MAIN_UI_COCER),e=t?t.getBagBtn():null;if(e){var i=LayerManager.UI_Main2,n=this.parent.localToGlobal(this.x,this.y);i.addChild(this),this.x=n.x,this.y=n.y,e.parent.localToGlobal(e.x,e.y,n);var o=Math.abs(this.x-n.x)+Math.abs(this.y-n.y);egret.Tween.get(this).to({x:n.x+(e.width>>1),y:n.y+(e.height>>1)},o,egret.Ease.cubicOut).call(App.ThingManager.removeDrop,App.ThingManager,[this.packetId])}},e.prototype.setItem=function(t){var e=GameConfig.item[t];this.icon.source=RES_DIR_IMAGES_ITEM+e.icon+".png"},e.prototype.setCellXY=function(t,e,i){void 0===i&&(i=!1),this.cellX=t,this.cellY=e,this.x=GameCache.map.cellWidth*(t+.5)>>0,this.y=GameCache.map.cellHeight*(e+.5)>>0},e.prototype.isTouch=function(t,e){return Math.abs(this.x-t)<40&&this.y-e<40&&this.y>=e},e.prototype.canPick=function(){if(!this.isTrue)return!1;var t=GameCache.hero.focusPlayer;return t.cellXY.y!=this.cellY?!1:this.pickTime>App.TimerManager.getSyncTime()?!1:Math.abs(t.cellXY.x-this.cellX)<=1},e.prototype.pick=function(){this.pickTime=App.TimerManager.getSyncTime()+2e3,Proxy.drop.sendPickupDropItem(this.packetId)},e.prototype.dispose=function(){this.factorEnd(),this.icon.source=null,ObjectPool.push(this),App.DisplayUtils.removeFromParent(this),egret.Tween.removeTweens(this),App.TimerManager.removeAll(this)},e}(egret.DisplayObjectContainer);__reflect(DropItem.prototype,"DropItem",["IThing"]);var DropProxy=function(t){function e(){var e=t.call(this,PacketTypes.DROP)||this;return e.regNetMsg(10,e.doCreateDropPacket),e.regNetMsg(11,e.doDelPacket),e}return __extends(e,t),e.prototype.doCreateDropPacket=function(t){var e=t.readUnsignedInt(),i=t.readUnsignedShort(),n=t.readUnsignedShort(),o=t.readUnsignedShort();t.readUnsignedShort(),1==t.readByte(),t.readInt(),1==t.readByte();App.ThingManager.addDrop(e,i,n,o,!1)},e.prototype.doDelPacket=function(t){var e=t.readUnsignedInt();App.ThingManager.removeDrop(e)},e.prototype.sendPickupDropItem=function(t){var e=this.getBytes(9);e.writeInt(t),this.sendToServer(e)},e}(BaseProxy);__reflect(DropProxy.prototype,"DropProxy");var BLOCK_FLAG_TYPE=function(){function t(){}return t.FLAG_ALLCANPASS=0,t.FLAG_STATICBLOCK=2,t.FLAG_ROPE=8,t.FLAG_TURNPOINT=2048,t.FLAG_STONE=7,t.FLAG_SLOPE=3,t.FLAG_SLOPE1=4,t}();__reflect(BLOCK_FLAG_TYPE.prototype,"BLOCK_FLAG_TYPE");var CMapPathData=function(){function t(t){this.mpMapTpl=t}return t.prototype.GetPosIndex=function(t){return t.mX+t.mY*this.mpMapTpl.mWidth},t.prototype.GetPosByIndex=function(t){var e=new CWTPoint,i=this.mpMapTpl;return e.mX=t/i.mWidth,e.mY=t%i.mWidth,e},t.prototype.InitialPath=function(){},t.prototype.FindPath=function(t,e,i){var n=[],o=this.FindPathOfPoint(t);if(0>o)return n;var r=this.FindPathOfPoint(e);if(0>r&&(e.mY++,r=this.FindPathOfPoint(e),0>r&&(e.mY=e.mY-2,r=this.FindPathOfPoint(e),0>r)))return n;this.InitialPath();var a=this.mpMapTpl.mPathList[o];if(1==this.PointInPath(e,a))return n.push(e),n;this.mPreList=[],this.mCloseList=[];var s=new CPathPoint;for(s.mCurIndex=o,s.mEndPoint.mX=t.mX,s.mEndPoint.mY=t.mY,this.InsertCloseList(s);;){var h=new CPathPoint,p=this.FindNextPath(e,s,i,h);if(0==p){var l=this.CheckPreList();if(!l)return n;s=l,h.copy(s)}else s=h;if(this.InsertCloseList(h),1==this.PointInPath(e,this.mpMapTpl.mPathList[h.mCurIndex]))break}o=s.mCurIndex,n.push(new CWTPoint(e.mX,e.mY));for(var c=this.mCloseList.length-1;c>=0;--c)o==this.mCloseList[c].mCurIndex&&(n.push(new CWTPoint(this.mCloseList[c].mEndPoint.mX,this.mCloseList[c].mEndPoint.mY)),(0!=this.mCloseList[c].mTurnPoint.mX||0!=this.mCloseList[c].mTurnPoint.mY)&&n.push(new CWTPoint(this.mCloseList[c].mTurnPoint.mX,this.mCloseList[c].mTurnPoint.mY)),o=this.mCloseList[c].mFather);return n.length>0,n},t.prototype.FindNextPath=function(t,e,i,n){var o;e.mCurIndex>=0&&(o=this.mpMapTpl.mPathList[e.mCurIndex]);for(var r,a=!0,s=0;s<this.mpMapTpl.mPathList.length;++s)if(s!=e.mCurIndex&&1!=this.InCloseList(s)){var h=new CWTPoint,p=new CWTPoint,l=this.FindTurnPointOfPath(e.mEndPoint,t,o,this.mpMapTpl.mPathList[s],h,p,i);if(!(0>l)){var c=new CPathPoint;if(c.mCurIndex=s,c.mFather=e.mCurIndex,c.mCureSteps=e.mCureSteps+this.Length(e.mEndPoint,h)+this.Length(p,h),c.mFutureSteps=this.Length(p,t),c.mTurnPoint.mX=h.mX,c.mTurnPoint.mY=h.mY,c.mEndPoint.mX=p.mX,c.mEndPoint.mY=p.mY,this.AdjustPathPoint(c),1==this.PointInPath(t,this.mpMapTpl.mPathList[s]))return n.copy(c),!0;1==a?(r=c,a=!1):c.mCureSteps+c.mFutureSteps<r.mCureSteps+r.mFutureSteps?(this.InsertPreList(r),r=c):this.InsertPreList(c)}}return 1!=a?(n.copy(r),!0):!1},t.prototype.InCloseList=function(t){for(var e=0;e<this.mCloseList.length;++e)if(this.mCloseList[e].mCurIndex==t)return!0;return!1},t.prototype.CheckPreList=function(){for(var t=null,e=-1,i=0;i<this.mPreList.length;++i){var n=this.mPreList[i];t?t.mCureSteps+t.mFutureSteps>n.mCureSteps+n.mFutureSteps&&(t=n,e=i):(t=n,e=i)}return e>=0&&(this.mPreList[e]=this.mPreList[this.mPreList.length-1],this.mPreList.pop()),t},t.prototype.InsertCloseList=function(t){return this.mCloseList.push(t),0},t.prototype.AdjustPathPoint=function(t){for(var e=0;e<this.mPreList.length;++e){var i=this.mPreList[e];if(i.mCurIndex==t.mCurIndex&&i.mCureSteps+i.mFutureSteps<t.mCureSteps+t.mFutureSteps)return t.mCureSteps=i.mCureSteps,t.mFutureSteps=i.mFutureSteps,t.mFather=i.mFather,t.mTurnPoint.mX=i.mTurnPoint.mX,t.mTurnPoint.mY=i.mTurnPoint.mY,t.mEndPoint.mX=i.mEndPoint.mX,t.mEndPoint.mY=i.mEndPoint.mY,this.mPreList[e]=this.mPreList[this.mPreList.length-1],this.mPreList.pop(),0}return 0},t.prototype.InsertPreList=function(t){return this.mPreList.push(t),0},t.prototype.PointInPath=function(t,e){if(e.mType==BLOCK_FLAG_TYPE.FLAG_ALLCANPASS){if(t.mY!=e.mBeginPoint.mY)return!1;if(t.mX>=e.mBeginPoint.mX&&t.mX<=e.mEndPoint.mX)return!0}else{if(t.mX!=e.mBeginPoint.mX)return!1;if(t.mY>=e.mBeginPoint.mY&&t.mY<=e.mEndPoint.mY)return!0}return!1},t.prototype.Length=function(t,e){return Math.abs(t.mX-e.mX)+Math.abs(t.mY-e.mY)},t.prototype.IsRope=function(t,e){var i=this.mpMapTpl.GetGridBlock(t,e);return i==BLOCK_FLAG_TYPE.FLAG_SLOPE||i==BLOCK_FLAG_TYPE.FLAG_SLOPE1},t.prototype.canStand=function(t,e){var i=this.mpMapTpl.GetGridBlock(t,e);return i==BLOCK_FLAG_TYPE.FLAG_SLOPE||i==BLOCK_FLAG_TYPE.FLAG_SLOPE1||i==BLOCK_FLAG_TYPE.FLAG_STATICBLOCK||i==BLOCK_FLAG_TYPE.FLAG_STONE},t.prototype.InMap=function(t){return t.mX<0||t.mX>=this.mpMapTpl.mWidth?!1:t.mY<0||t.mY>=this.mpMapTpl.mHeight?!1:!0},t.prototype.FindTurnPointOfPath=function(t,e,i,n,o,r,a){if(0==this.Length(i.mBeginPoint,n.mBeginPoint))return o.mX=t.mX,o.mY=t.mY,0;if(i.mBeginPoint.mY==n.mBeginPoint.mY)return-1;var s=0,h=0;return n.mBeginPoint.mY>i.mBeginPoint.mY?(s=n.mBeginPoint.mX>i.mBeginPoint.mX?n.mBeginPoint.mX:i.mBeginPoint.mX,h=n.mEndPoint.mX>i.mEndPoint.mX?i.mEndPoint.mX:n.mEndPoint.mX,h+a.mX<s?-1:(t.mX>s&&t.mX<h?o.mX=t.mX:t.mX<=s?o.mX=s:o.mX=h,r.mX=o.mX,s>h&&(i.mEndPoint.mX<n.mBeginPoint.mX?(r.mX=s,o.mX=h):(r.mX=h,o.mX=s)),o.mY=i.mBeginPoint.mY,r.mY=n.mBeginPoint.mY,0)):(s=n.mBeginPoint.mX>i.mBeginPoint.mX?n.mBeginPoint.mX:i.mBeginPoint.mX,h=n.mEndPoint.mX>i.mEndPoint.mX?i.mEndPoint.mX:n.mEndPoint.mX,h+a.mX<s?-1:Math.abs(n.mBeginPoint.mY-i.mBeginPoint.mY)<=a.mY?(t.mX>s&&t.mX<h?o.mX=t.mX:t.mX<=s?o.mX=s:o.mX=h,r.mX=o.mX,s>h&&(i.mEndPoint.mX<n.mBeginPoint.mX?(r.mX=s,o.mX=h):(r.mX=h,o.mX=s)),r.mY=n.mBeginPoint.mY,o.mY=i.mBeginPoint.mY,0):-1)},t.prototype.FindPathOfPoint=function(t){for(var e=0;e<this.mpMapTpl.mPathList.length;++e){var i=this.mpMapTpl.mPathList[e];if(t.mY==i.mBeginPoint.mY&&t.mX>=i.mBeginPoint.mX&&t.mX<=i.mEndPoint.mX)return e}return-1},t.prototype.FindRopeData=function(t,e,i){for(var n=0;n<this.mpMapTpl.mRopeList.length;++n){var o=this.mpMapTpl.mRopeList[n];if(o.mBeginPoint.mX==t&&!(e<o.mBeginPoint.mY-1||e>o.mEndPoint.mY+1||i<o.mBeginPoint.mY-1||i>o.mEndPoint.mY+1))return o}},t.prototype.GetRopeByPoint=function(t){for(var e=0;e<this.mpMapTpl.mRopeList.length;++e){var i=this.mpMapTpl.mRopeList[e];if(i.mBeginPoint.mX==t.mX&&t.mY>=i.mBeginPoint.mY&&t.mY<=i.mEndPoint.mY)return i}},t.MOVETYPE_CLIMBROPE=1,t.MOVETYPE_CLIMBLADDER=2,t.MOVETYPE_JUMP=3,t.MOVETYPE_WALK=4,t}();__reflect(CMapPathData.prototype,"CMapPathData");var CWTPoint=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.mX=t,this.mY=e}return t.prototype.Length=function(t){return egret.Point.distance(new egret.Point(this.mX,this.mY),new egret.Point(t.mX,t.mY))},t}();__reflect(CWTPoint.prototype,"CWTPoint");var CPathData=function(){function t(){this.mBeginPoint=new CWTPoint,this.mEndPoint=new CWTPoint,this.mType=BLOCK_FLAG_TYPE.FLAG_ALLCANPASS}return t}();__reflect(CPathData.prototype,"CPathData");var CPathPoint=function(){function t(){this.mCurIndex=-1,this.mFather=-1,this.mCureSteps=0,this.mFutureSteps=0,this.mTurnPoint=new CWTPoint(0,0),this.mEndPoint=new CWTPoint(0,0)}return t.prototype.copy=function(t){this.mCurIndex=t.mCurIndex,this.mFather=t.mFather,this.mTurnPoint.mX=t.mTurnPoint.mX,this.mTurnPoint.mY=t.mTurnPoint.mY,this.mEndPoint.mX=t.mEndPoint.mX,this.mEndPoint.mY=t.mEndPoint.mY,this.mCureSteps=t.mCureSteps,this.mFutureSteps=t.mFutureSteps},t}();__reflect(CPathPoint.prototype,"CPathPoint");var CMapTpl=function(){function t(){}return t.prototype.parese=function(t){this.mGrids=t,this.mHeight=t.length,this.mWidth=t[0].length,this.mPathList=[],this.mRopeList=[];for(var e=0,i=0;i<t.length;i++){var n=t[i];for(e=0;e<n.length;e++){var o=parseInt(n[e]);this.SetBlock(o,new CWTPoint(e,i))}}},t.prototype.GetGridBlock=function(t,e){var i=this.mGrids[e];return i?i[t]:0},t.prototype.SetBlock=function(t,e){if(t==BLOCK_FLAG_TYPE.FLAG_STATICBLOCK||t==BLOCK_FLAG_TYPE.FLAG_TURNPOINT||t==BLOCK_FLAG_TYPE.FLAG_STONE||t==BLOCK_FLAG_TYPE.FLAG_SLOPE||t==BLOCK_FLAG_TYPE.FLAG_SLOPE1){var i=this.GetGridBlock(e.mX,e.mY-1);i&&i!=BLOCK_FLAG_TYPE.FLAG_STATICBLOCK&&i!=BLOCK_FLAG_TYPE.FLAG_SLOPE&&i!=BLOCK_FLAG_TYPE.FLAG_SLOPE1&&this.SetPathData(e.mX,e.mY-1,BLOCK_FLAG_TYPE.FLAG_ALLCANPASS),(t==BLOCK_FLAG_TYPE.FLAG_STONE||t==BLOCK_FLAG_TYPE.FLAG_SLOPE||t==BLOCK_FLAG_TYPE.FLAG_SLOPE1)&&(t=BLOCK_FLAG_TYPE.FLAG_STATICBLOCK),t==BLOCK_FLAG_TYPE.FLAG_TURNPOINT&&(t=BLOCK_FLAG_TYPE.FLAG_ROPE,this.SetPathData(e.mX,e.mY-1,BLOCK_FLAG_TYPE.FLAG_ROPE))}t==BLOCK_FLAG_TYPE.FLAG_ROPE&&this.SetPathData(e.mX,e.mY,t)},t.prototype.SetPathData=function(t,e,i){var n=new CWTPoint(t,e);if(i==BLOCK_FLAG_TYPE.FLAG_ALLCANPASS){for(var o=0;o<this.mPathList.length;o++){var r=this.mPathList[o];if(1==n.Length(r.mEndPoint)&&r.mEndPoint.mY==n.mY)return r.mEndPoint.mX=n.mX,void(r.mEndPoint.mY=n.mY)}var a=new CPathData;a.mBeginPoint.mX=n.mX,a.mBeginPoint.mY=n.mY,a.mEndPoint.mX=n.mX,a.mEndPoint.mY=n.mY,a.mType=i,this.mPathList.push(a),this.SetRopeData(t,e,i)}else this.SetRopeData(t,e,i)},t.prototype.SetRopeData=function(t,e,i){for(var n=new CWTPoint(t,e),o=0;o<this.mRopeList.length;o++){var r=this.mRopeList[o];if(1==n.Length(r.mEndPoint)&&r.mEndPoint.mX==n.mX)return r.mEndPoint.mX=n.mX,void(r.mEndPoint.mY=n.mY);0==n.Length(r.mBeginPoint)&&i==BLOCK_FLAG_TYPE.FLAG_ALLCANPASS&&(r.mBeginPoint.mY+=1),0==n.Length(r.mEndPoint)&&i==BLOCK_FLAG_TYPE.FLAG_ALLCANPASS&&(r.mEndPoint.mY-=1)}if(i==BLOCK_FLAG_TYPE.FLAG_ROPE){var a=new CPathData;a.mBeginPoint.mX=n.mX,a.mBeginPoint.mY=n.mY,a.mEndPoint.mX=n.mX,a.mEndPoint.mY=n.mY,a.mType=i,this.mRopeList.push(a)}},t}();__reflect(CMapTpl.prototype,"CMapTpl");var VisitThingManager=function(t){function e(){var e=t.call(this)||this;return e.m_FindMapLinkExpectList=[],e.target=new VisitTarget,e}return __extends(e,t),e.prototype.goToNpc=function(t){var e=this.target;e.clear();var i=GameConfig.npc[t];if(!i)throw new Error("找不到npc配置 "+t);e.tarX=i.posx,e.tarY=i.posy,e.tarScene=i.scene,e.npcId=t,this["continue"]()},e.prototype.goToMonster=function(t,e,i,n){var o=this.target;o.clear(),o.tarX=i,o.tarY=n,o.tarScene=e,o.monsterId=t,this["continue"]()},e.prototype.goToThing=function(t){if(this.target.clear(),t instanceof BaseThing){var e=t.cellXY.x,i=t.cellXY.y,n=t.pro.kind;n==ThingKind.Transfer?this.goToPos(e,i):n==ThingKind.Npc&&this.goToNpc(t.npcid)}else t instanceof DropItem&&(this.target.tarThing=t,this.goToPos(t.cellX,t.cellY))},e.prototype.clear=function(){this.target.clear()},e.prototype.checkArrived=function(){var t=GameCache.hero.focusPlayer,e=this.target;return 0!=e.tarScene?e.tarScene==GameCache.map.mapId&&e.tarX==t.cellXY.x&&e.tarY==t.cellXY.y?(this.doArrived(),this.clear(),!0):!1:void 0},e.prototype["continue"]=function(){0!=this.target.tarScene&&GameCache.map.dataInit&&(this.checkArrived()||this.onGo())},e.prototype.onGo=function(){App.FightManager.heroStart(!1);var t=this.target;if(GameCache.map.mapId!=t.tarScene){var e=this.findLinkPos(this.getStdById(GameCache.map.mapId),this.getStdById(t.tarScene));e&&this.goToPos(e.x,e.y)}else{if(t.npcId>0){var i=t.tarX+(Math.random()>.5?1:-1);if(GameCache.map.canStand(i,t.tarY)&&(t.tarX=i,this.checkArrived()))return}this.goToPos(t.tarX,t.tarY)}},e.prototype.doArrived=function(){var t=this.target;if(t.npcId>0){var e=App.ThingManager.getNpcById(t.npcId);e&&this.arrivedNPC(e.pro.recog,t.npcId)}else 0!=t.monsterId?App.FightManager.heroStart(!0,t.monsterId>0?t.monsterId:0):t.tarThing&&t.tarThing instanceof DropItem&&t.tarThing.pick()},e.prototype.arrivedNPC=function(t,e){if(GameCache.quest.npcId==e){Proxy.main.sendTalkToNPC(t);var i=new ViewProp;i.exData1=t,i.exData2=e,App.ViewManager.open(ViewConst.NPCTALK,i)}else{var n=GameConfig.npc[e];if(n&&n.window)TextFlowUtils.hrefType(n.window);else{var o=App.ThingManager.getThing(t);if(o){var r=GameConfig.npc[e];o.say(r.talk[MathUtils.limitInteger(0,r.talk.length)])}}}},e.prototype.goToPos=function(t,e){var i=GameCache.hero.focusPlayer;i.moveTo(t,e)},e.prototype.getStdById=function(t){return GameConfig.scene[t]},e.prototype.findLinkPos=function(t,e){if(t==e)return null;if(this.m_FindMapLinkExpectList.length=0,t.teleport){var i;if(i=this.findNearestLinkPosInEnvir(t,e,this.m_FindMapLinkExpectList))return new XY(i.lnk.posx,i.lnk.posy)}return null},e.prototype.findLinkPosInEnvir=function(t,e,i){var n,o,r,a,s=t.teleport;for(i.push(t),r=0;r<s.length;++r){if(n=s[r],n.toSceneid==e.scenceid)return n;if(o=this.getStdById(n.toSceneid),o&&o.teleport){for(a=0;a<i.length;++a)if(i[a]==o){o=null;break}if(!o)continue;if(this.findLinkPosInEnvir(o,e,i))return n}}return null},e.prototype.findNearestLinkPosInEnvir=function(t,e,i){var n,o,r,a,s,h,p=t.teleport;for(i.push(t),r=0;r<p.length;++r){if(n=p[r],n.toSceneid==e.scenceid){h=new LinkPosDesc(n,0);break}if(o=this.getStdById(n.toSceneid),o&&o.teleport){for(a=0;a<i.length;++a)if(i[a]==o){o=null;break}if(!o)continue;s=this.findNearestLinkPosInEnvir(o,e,i),s&&(!h||h.dist>s.dist)&&(h=s,h.lnk=n)}}return i.pop(),h?(h.dist++,h):null},e.prototype.searchEnvirIdCompare=function(t,e){return t<e.scenceid?-1:t>e.scenceid?1:0},e.prototype.searchEnvirNameCompare=function(t,e){return t.localeCompare(e.scencename)},e}(BaseClass);__reflect(VisitThingManager.prototype,"VisitThingManager");var LinkPosDesc=function(){function t(t,e){this.lnk=t,this.dist=e}return t}();__reflect(LinkPosDesc.prototype,"LinkPosDesc");var VisitTarget=function(){function t(){this.tarScene=0}return t.prototype.clear=function(){this.tarX=0,this.tarY=0,this.tarScene=0,this.tarThing=null,this.npcId=0,this.monsterId=0},t}();__reflect(VisitTarget.prototype,"VisitTarget");var BaseMapDrawLayer=function(t){function e(){var e=t.call(this)||this;return e.imagList=[],e.dataList=[],e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.setData=function(t,e,i,n,o){this.dataList=t,this.layerWidth=e,this.layerHeight=i,this.stepWidth=n,this.stepHeight=o,this.widthRate=e/n,this.heightRate=i/o,this.removeAll()},e.prototype.focusToCenter=function(){var t=-(this.layerWidth-App.StageUtils.getWidth())>>1,e=-(this.layerHeight-App.StageUtils.getHeight())>>1;this.x=t,this.y=e,this.onUpdate(-t,-e,App.StageUtils.getWidth(),App.StageUtils.getHeight())},e.prototype.moveTo=function(t,e,i,n){this.x=t,this.y=e,this.onUpdate(-this.x,-this.y,App.StageUtils.getWidth(),App.StageUtils.getHeight())},e.prototype.onUpdate=function(t,e,i,n){for(var o=0,r=this.dataList.length,a=!1;r>o;o++){var s=this.dataList[o],h=s.onScreen(t,e,i,n),p=this.imagList[o];h?(p||(p=new MapImage,p.setData(s),this.imagList[o]=p),p.parent||(a=!0,this.addChild(p))):p&&p.parent&&this.removeChild(p)}a&&this.$children.sort(this.sortImg)},e.prototype.sortImg=function(t,e){return t.data.index>e.data.index?1:t.data.index<e.data.index?-1:0},e.prototype.removeAll=function(){for(var t=0,e=this.imagList.length;e>t;t++)this.imagList[t]&&this.imagList[t].onRemove();this.imagList.length=0},e}(egret.DisplayObjectContainer);__reflect(BaseMapDrawLayer.prototype,"BaseMapDrawLayer",["ICamera"]);var BaseMapThingLayer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.getClickTarget=function(t,e){for(var i,n=this.$children,o=n.length,r=o-1;r>=0;r--)if(i=n[r],i.isTouch&&i.isTouch(t,e))return i;return null},e.prototype.moveTo=function(t,e,i,n){this.x=t,this.y=e},e}(egret.DisplayObjectContainer);__reflect(BaseMapThingLayer.prototype,"BaseMapThingLayer",["ICamera"]);var Camera=function(){function t(){this.isMoving=!1,this.layers=[]}return t.prototype.register=function(t){this.layers.push(t)},t.prototype.regPlayer=function(t){this.focusPlayer=t;var e=(App.StageUtils.getWidth()>>1)-this.focusPlayer.x,i=this.getPlayerFocusY();this.setXY(e,i)},t.prototype.exitScene=function(){this.curPos=null},t.prototype.unpdate=function(t){if(this.focusPlayer){var e=(App.StageUtils.getWidth()>>1)-this.focusPlayer.x,i=this.getPlayerFocusY();this.setXY(e,i)}},t.prototype.getPlayerFocusY=function(){this.focusPlayer;return(App.StageUtils.getHeight()>>1)-this.focusPlayer.y},t.prototype.setXY=function(t,e){if(GameCache.map.dataInit){GameCache.map.mapWidth<App.StageUtils.getWidth()&&(t=App.StageUtils.getWidth()-GameCache.map.mapWidth>>1),GameCache.map.mapHeight<App.StageUtils.getHeight()&&(e=App.StageUtils.getHeight()-GameCache.map.mapHeight>>1),t>0&&(t=0),e>0&&(e=0);var i=App.StageUtils.getWidth(),n=App.StageUtils.getHeight();-t+i>GameCache.map.mapWidth&&(t=-(GameCache.map.mapWidth-i)),-e+n>GameCache.map.mapHeight&&(e=-(GameCache.map.mapHeight-n));var o=this.curPos;o&&o.x==t&&o.y==e||(o||(o=this.curPos={x:t,y:e}),o.x=t,o.y=e,this.resetLayer(),App.MessageCenter.dispatch(MsgConst.UPDATE_SCENE_MAPITEM))}},t.prototype.moveToXY=function(t,e,i){this.curPos&&(this.pos={x:this.curPos.x,y:this.curPos.y},egret.Tween.get(this.pos,{onChange:this.onChange,onChangeObj:this}).to({x:t,y:e},i))},t.prototype.onChange=function(){this.setXY(this.pos.x,this.pos.y)},t.prototype.resetLayer=function(){for(var t=this.curPos,e=-t.x/GameCache.map.mapWidth*100,i=-t.y/GameCache.map.mapHeight*100,n=0,o=this.layers;n<o.length;n++){var r=o[n];r.moveTo(t.x,t.y,e,i)}GameCache.map.cameraX=-t.x,GameCache.map.cameraY=-t.y},t}();__reflect(Camera.prototype,"Camera");var MapImage=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t){if(GameCache.map.showLoading){var e=GameCache.map.loadlingList,i=e.indexOf(this.source);i>-1&&e.splice(i,1),e.push("res/"+t.url)}this.data=t,this.source="res/"+t.url,this.x=t.x,this.y=t.y,this.scaleX=t.scaleX,this.scaleY=t.scaleY},e.prototype.onRemove=function(){this.source=null,this.data=null,App.DisplayUtils.removeFromParent(this)},e}(eui.Image);__reflect(MapImage.prototype,"MapImage");var MapImgLoader=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseClass);__reflect(MapImgLoader.prototype,"MapImgLoader");var MapDrawLayerVo=function(){function t(){}return t}();__reflect(MapDrawLayerVo.prototype,"MapDrawLayerVo");var MapImageVo=function(){function t(){this.index=0}return t.prototype.onScreen=function(t,e,i,n){var o=!0,r=this.x-(-1==this.scaleX?this.w:0),a=this.y;return r+this.w<=t?o=!1:r>=t+i?o=!1:a+this.h<=e?o=!1:a>=e+n&&(o=!1),o},t}();__reflect(MapImageVo.prototype,"MapImageVo");var MapLoadingView=function(t){function e(){var e=t.call(this,LayerManager.UI_Guide)||this;return e.loadList=[],e.maxW=380,e.skinName="MapLoadingViewSkin",e.closeDispose=!1,e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.focusToStage(),App.TimerManager.add(500,this.onFrame,this,10,this.exit,this),this.message(MsgConst.UPDATE_SCENE_MAPITEM,this.onStart),this._w=0,this.tips.text=GameConfig.clientGlobal.maptips[MathUtils.limitInteger(0,GameConfig.clientGlobal.maptips.length)]},e.prototype.resizeStage=function(){t.prototype.resizeStage.call(this)},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.onFrame=function(){this.updatePro()},e.prototype.updatePro=function(){var t=this.cur/this.total;isNaN(t)&&(t=0),egret.Tween.removeTweens(this),egret.Tween.get(this).to({w:t},500).call(this.checkCom,this)},e.prototype.checkCom=function(){this.w>=1&&this.exit()},Object.defineProperty(e.prototype,"w",{get:function(){return this._w},set:function(t){t>1&&(t=1),this._w=t,this.progress.x=this.maxW*t,this.percent.text=Math.ceil(100*t)+"%"},enumerable:!0,configurable:!0}),e.prototype.onStart=function(){this.loadList=GameCache.map.loadlingList,this.total=this.loadList.length,this.cur=0,this.w=0,this.loadNext(),this.removeMessage()},e.prototype.loadNext=function(){var t=this.loadList.shift();RES.getResByUrl(t,this.loadCom,this)},e.prototype.loadCom=function(){this.cur++,this.loadList.length?this.loadNext():(App.TimerManager.removeAll(this),egret.Tween.removeTweens(this),egret.Tween.get(this).to({w:1},500).call(this.checkCom,this))},e.prototype.exit=function(){return GameCache.map.dataInit?(egret.Tween.removeTweens(this),this.closeView(),GameCache.map.showLoading=!1,this.loadList.length=0,void App.MessageCenter.dispatch(MsgConst.ENTER_SCENE)):(console.log(">>>>> 无法进入场景"),void App.TimerManager.add(500,this.onFrame,this,6,this.exit,this))},e}(BaseEuiWindow);__reflect(MapLoadingView.prototype,"MapLoadingView");var HotspotBitmap=function(t){function e(){var e=t.call(this)||this;return e._hotspot=[],e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouch,e),e}return __extends(e,t),e.prototype.addHotspotArea=function(t,e,i,n){this._hotspot.push({rect:t,callBack:e,thisObj:i,para:n})},e.prototype.onTouch=function(t){for(var e,i=t.localX,n=t.localY,o=0;o<this._hotspot.length;o++)e=this._hotspot[o],e.rect.contains(i,n)&&(e.para?e.callBack.call(e.thisObj,e.para):e.callBack.call(e.thisObj))},e}(egret.Bitmap);__reflect(HotspotBitmap.prototype,"HotspotBitmap");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var MovieClipLoader=function(){function t(){this.count=0,this.needLoadUrl=[],this.loadList={},this.loadingDic={}}return t.ins=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.load=function(t,e){var i=this.loadList[e];i||(i=this.loadList[e]=[]),i.push(t),this.loadingDic[e]||(this.needLoadUrl.push(e),this.loadNext())},t.prototype.loadData=function(t){this.count++;var e,i,n=this,o=!1,r=function(r){if(!o){if(!r)return console.log("加载失败，跳过",t),o=!0,n.count--,void n.loadNext();if(e&&i){n.count--;var a=n.loadList[t];if(!a)return;delete n.loadList[t],delete n.loadingDic[t];for(var s=0,h=a;s<h.length;s++){var p=h[s];p.resGetComplete(t,e,i)}n.loadNext()}}};n.loadingDic[t]=1,RES.getResByUrl(t+".png",function(t){e=t,r(t)},n,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl(t+".json",function(t){i=t,r(t)},n,RES.ResourceItem.TYPE_JSON)},t.prototype.loadNext=function(){if(this.count<=2){var t=this.needLoadUrl.shift();t&&this.loadData(t)}},t.prototype.removeUrl=function(t){var e=this.needLoadUrl.indexOf(t);e&&this.needLoadUrl.splice(e,1),delete this.loadList[t],delete this.loadingDic[t]},t}();__reflect(MovieClipLoader.prototype,"MovieClipLoader");var HeroThing=function(t){function e(){var e=t.call(this)||this;return e.lastPostPoint={x:0,y:0},e.oldValue={},e.canTouch=!1,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.title.setNameColor(ColorUtil.TITLE_HERO);var i=GameCache.family.fInfo;i&&this.title.setFamilyName(i.fName)},e.prototype.setPath=function(e){this.isJump||(t.prototype.setPath.call(this,e),this.postPoint())},e.prototype.setCellXY=function(e,i,n){t.prototype.setCellXY.call(this,e,i,n),n||this.postPoint(),this.lastPostPoint.x=e,this.lastPostPoint.y=i},e.prototype.jumpEnd=function(){t.prototype.jumpEnd.call(this),this.postPoint()},e.prototype.arrivedPathPoint=function(){t.prototype.arrivedPathPoint.call(this),this.postPoint(),this==GameCache.hero.focusPlayer&&App.VisitManager.checkArrived()},e.prototype.checkCellXY=function(){t.prototype.checkCellXY.call(this),(Math.abs(this.lastPostPoint.x-this.cellXY.x)>=4||Math.abs(this.lastPostPoint.y-this.cellXY.y)>=4)&&this.postPoint()},e.prototype.clearPath=function(){t.prototype.clearPath.call(this),this.postPoint()},e.prototype.postPoint=function(){GameCache.map.isAIMap||(this.lastPostPoint.x!=this.cellXY.x||this.lastPostPoint.y!=this.cellXY.y)&&(Proxy.move.sendMoveto(this.cellXY.x,this.cellXY.y,this.pro.isMainPlayer?0:this.pro.pro(PropId.AP_ACTOR_ID)),this.lastPostPoint.x=this.cellXY.x,this.lastPostPoint.y=this.cellXY.y)},e.prototype.updateProperty=function(e,i){switch(t.prototype.updateProperty.call(this,e,i),e){case PropId.AP_BODY_ID:case PropId.AP_HAIR:case PropId.AP_HAT:case PropId.AP_EYE:case PropId.AP_GLASSES:case PropId.AP_PANTS:case PropId.AP_ASSIST:case PropId.AP_WEAPON:case PropId.AP_BACK:case PropId.AP_SWING:App.MessageCenter.dispatch(MsgConst.EQUIP_ATTR_CHANGE);break;case PropId.AP_CHKPOINT_LV:this.pro.isMainPlayer&&GameCache.pass.updateLv(i);break;case PropId.AP_LEVEL:break;case PropId.AP_RISK_LVL:GameCache.adventure.updatelv(i);break;case PropId.AP_SIGNIN:GameCache.sign.updateCounts(i);break;case PropId.AP_CHECKINS:GameCache.sign.updateAwardState(i)}App.MessageCenter.dispatch(MsgConst.PROPERTY+e)},e.prototype.changeHp=function(e){if(t.prototype.changeHp.call(this,e),null==this.curHp)return void(this.curHp=e);var i=e-this.curHp;this.curHp=e,0!=i&&App.HurtTxtManager.play(this.pro.recog,i,!1,HurtType.SELF,this)},e.prototype.die=function(){t.prototype.die.call(this),App.MessageCenter.dispatch(MsgConst.HERO_DIE),GameCache.hero.resetFocus()},e.prototype.reAlive=function(){t.prototype.reAlive.call(this),GameCache.hero.resetFocus()},Object.defineProperty(e.prototype,"isFighting",{get:function(){return this.fight.fighting},enumerable:!0,configurable:!0}),e.prototype.addPathPoint=function(t,e){},e.prototype.showHp=function(){this.getTopTitle(),this.topTitle.setHp(this.pro.pro(PropId.AP_HP),this.pro.pro(PropId.AP_MAX_HP))},e}(HumanThing);__reflect(HeroThing.prototype,"HeroThing");var SheetMovieClip=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.loadFile=function(t){if(null!=this.sheetName){if(e.mcData[t])return this.movieClipData=e.mcData[t],void(this.movieClipData.frames.length>1?this.play(-1):this.gotoAndStop(1));var i=this,n=t;-1==n.indexOf("/")&&(n=n),RES.getResByUrl(this.sheetName,function(o){RES.getResByUrl(n+".json",function(i){var n=new egret.MovieClipDataFactory;n.texture=RES.getRes(this.sheetName+"."+t+"_png"),n.mcDataSet=i;var o=n.generateMovieClipData();o.frameRate=this.rate?this.rate:o.frameRate,o.frameRate>=24&&(o.frameRate=8),e.mcData[t]=o,this.movieClipData=o,o.frames.length>1?this.play(-1):this.gotoAndStop(1),n.clearCache()},i,RES.ResourceItem.TYPE_JSON)},i,RES.ResourceItem.TYPE_SHEET)}},e.prototype.dispose=function(){this.stop(),App.DisplayUtils.removeFromParent(this),ObjectPool.push(this)},e.create=function(){return ObjectPool.get(e)},e.mcData={},e}(egret.MovieClip);__reflect(SheetMovieClip.prototype,"SheetMovieClip");var MonsterThing=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(e){var i=GameConfig.monster[e.pro(PropId.AP_ACTOR_ID)];i?(this.monsterType=i.monsterType,App.ThingManager.dropCellX=e.pro(PropId.AP_X),App.ThingManager.dropCellY=e.pro(PropId.AP_Y)):this.monsterType=1,t.prototype.init.call(this,e),this.pro.aiCamp=AICampType.MONSTER,this.title.visible=!1},e.prototype.changeHp=function(e){t.prototype.changeHp.call(this,e),ActorSeleMgr.hpChange(this)},e.prototype.showHp=function(){this.monsterType!=MonsterType.BOSS&&(t.prototype.showHp.call(this),this.title.visible=!0)},e.prototype.die=function(){t.prototype.die.call(this),App.ThingManager.dropCellX=this.cellXY.x,App.ThingManager.dropCellY=this.cellXY.y,ActorSeleMgr.hpChange(this),egret.Tween.get(this).wait(1e3).to({aplha:0},600).call(this.onRemove,this)},e.prototype.onRemove=function(){this.disappear=!0},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.alpha=1},Object.defineProperty(e.prototype,"configId",{get:function(){return this.pro.pro(PropId.AP_ACTOR_ID)},enumerable:!0,configurable:!0}),e}(AnimalThing);__reflect(MonsterThing.prototype,"MonsterThing");var NPCThing=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(e){var i=GameConfig.npc[e.pro(PropId.AP_BODY_ID)];if(!i)throw"npc配置没找到,"+e.pro(PropId.AP_BODY_ID);null==this._body&&(this._body=new eui.Image,this.addChild(this._body)),this._body.source=RES_DIR_NPC_BODY+i.modelid+".png",this._body.x=i.offx,this._body.y=i.offy,e.charName=i.name,t.prototype.init.call(this,e),this.title.setNameColor(ColorUtil.TITLE_NPC)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._body&&(this._body.source=null,App.DisplayUtils.removeFromParent(this._body),this._body=null)},Object.defineProperty(e.prototype,"npcid",{get:function(){return this.pro.pro(PropId.AP_BODY_ID)},enumerable:!0,configurable:!0}),e}(BaseThing);__reflect(NPCThing.prototype,"NPCThing");var PetThing=function(t){function e(){var e=t.call(this)||this;return e.nextTime=0,e.canTouch=null,e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.con=GameConfig.pet[e.pro(PropId.AP_ACTOR_ID)],this.title.setNameColor(e.masterName==GameCache.hero.mainPro.charName?ColorUtil.TITLE_HERO:ColorUtil.TITLE_NORMAL)},e.prototype.update=function(e){t.prototype.update.call(this,e),this.nextTime<=e&&(this.nextTime=e+2e3,this.think())},e.prototype.setCellXY=function(e,i,n){t.prototype.setCellXY.call(this,e,i,n)},e.prototype.think=function(){if(!this.isMove){var t=Math.random()>.6;if(t){var e=MathUtils.limitInteger(-2,2),i=this.cellXY.x+e,n=this.cellXY.y;GameCache.map.canStand(i,n)&&(this.moveSpeed=GlobalVar.DEFAULT_MOVE_SPEED<<1,this.moveTo(i,n))}}this.isJump&&this.jumpEnd();var o=Math.random()>.9;o&&this.say(this.con.adle_talk[MathUtils.limitInteger(0,this.con.adle_talk.length)])},e}(AnimalThing);__reflect(PetThing.prototype,"PetThing");var ThingManager=function(t){function e(){var e=t.call(this)||this;return e.waitList=[],e.thingList=[],e.thingDic={},e.checkViewTime=0,e.dropList=[],e.dropCellX=0,e.dropCellY=0,e.recog=-10,e}return __extends(e,t),e.prototype.clear=function(){this.removeAll(),this.thingDic={},GameCache.hero.clear()},e.prototype.addDrop=function(t,e,i,n,o){var r=ObjectPool.get(DropItem);i||n||(i=this.dropCellX,n=this.dropCellY),t||(t=this.createRecog()),r.initData1(t,e,i,n),this.titleLayer.addChild(r),this.dropList.push(r)},e.prototype.addDropList=function(t){if(t&&t.length){var e=this.dropCellX,i=this.dropCellY;if(e||i){var n=t.length,o=n>>1;o>5&&(o=5),e-=2*o,1>e&&(e=1);for(var r=0;n>r;r++){var a=ObjectPool.get(DropItem);a.initData2(this.createRecog(),t[r].id,this.dropCellX,this.dropCellY,e+r%10*2,i),this.titleLayer.addChild(a),this.dropList.push(a)}}}},e.prototype.removeDrop=function(t){for(var e=0,i=this.dropList.length;i>e;e++){var n=this.dropList[e];if(n.packetId==t){this.dropList.splice(e,1),n.dispose();break}}},e.prototype.onUpdate=function(){if(0!=GameCache.hero.list.length&&GameCache.map.dataInit){var t=App.TimerManager.getSyncTime(),e=t>=this.checkViewTime;
e&&(this.checkViewTime=t+500);for(var i=GameCache.map.cameraX,n=GameCache.map.cameraY,o=App.StageUtils.getWidth(),r=App.StageUtils.getHeight(),a=0,s=GameCache.hero.list;a<s.length;a++){var h=s[a];h.update(t),e&&h.checkInView(i,n,o,r)}for(var p=0,l=this.thingList,c=l.length;c>p;p++){var u=l[p];u.disappear?(delete this.thingDic[u.pro.recog],l.splice(p,1),p--,c--,u.dispose()):(u.update(t),e&&u.checkInView(i,n,o,r))}var d=this.waitList.shift();d&&this.createThing(d)}},e.prototype.createThingToList=function(t){return this.waitList.push(t),null},e.prototype.createThing=function(t){var e=this.getThingCl(t.kind);if(e){var i=ObjectPool.get(e);return i.init(t),i.checkInView(GameCache.map.cameraX,GameCache.map.cameraY,App.StageUtils.getWidth(),App.StageUtils.getHeight()),t.isFlow||(t.kind!=ThingKind.Hero&&this.thingList.push(i),this.thingDic[t.recog]=i),i}return null},e.prototype.removeThing=function(t){if(!GameCache.hero.isMySelf(t)){var e=this.thingDic[t];if(e)return e.disappear=!0,e;for(var i=0,n=this.waitList,o=n.length;o>i;i++)if(n[i].recog==t){n.splice(i,1);break}}},e.prototype.removeAll=function(){for(var t=this.thingList,e=0;e<t.length;e++)this.thingList[e].dispose();this.thingList.length=0;var i={},n=GameCache.hero.list;for(var o in n)i[n[o].pro.recog]=n[o];this.thingDic=i,this.waitList.length=0;for(var r=0,a=this.dropList.length;a>r;r++){var s=this.dropList[r];s.dispose()}this.dropList.length=0},e.prototype.updatePoseInWaite=function(t,e,i){for(var n=0,o=this.waitList,r=o.length;r>n;n++)if(o[n].recog==t){o[n].pro(PropId.AP_X,e),o[n].pro(PropId.AP_Y,i);break}},e.prototype.getThing=function(t,e){void 0===e&&(e=!0);var i=this.thingDic[t];return e&&i&&(i.isDie||i.disappear)?null:i},e.prototype.getNpcById=function(t){for(var e=this.thingList,i=0,n=e.length;n>i;i++){var o=e[i];if(o.npcid==t)return o}},e.prototype.getThingDic=function(){return this.thingDic},e.prototype.getThingCl=function(t){return t==ThingKind.Human?HumanThing:t==ThingKind.Monster?MonsterThing:t==ThingKind.Hero?HeroThing:t==ThingKind.Transfer?TransferThing:t==ThingKind.Npc?NPCThing:t==ThingKind.HeroPet?HumanThing:t==ThingKind.Pet?PetThing:void 0},e.prototype.createRecog=function(){return this.recog--,this.recog},e}(BaseClass);__reflect(ThingManager.prototype,"ThingManager");var TransferThing=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),null==this._body&&(this._body=new eui.Image,this._body.source=RES_DIR_TRANSFER,this.addChild(this._body),this._body.x=-55,this._body.y=-156),this.title.setNameColor(ColorUtil.TITLE_NPC)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseThing);__reflect(TransferThing.prototype,"TransferThing");var SkillAction=function(){function t(){this.play=!1}return t}();__reflect(SkillAction.prototype,"SkillAction");var ThingBody=function(){function t(t){this._onStage=!1,this.dir=1,this._root=t,this.createBody()}return t.prototype.createBody=function(){this.body=new DBAvatar,this.body.setRoot(this._root,Handler.create(this,this.bodyPlayEnd,null,!1))},t.prototype.init=function(t){this._pro=t,this.body.rolePro=t;var e=t.pro(PropId.AP_JOB),i=t.pro(PropId.AP_SEX);ThingKind.isHumanModel(t.kind)?this.loadBody(e+"_"+i,!0):this.loadBody(t.pro(PropId.AP_BODY_ID))},t.prototype.changeSkin=function(){this.body.updateSkin()},t.prototype.bodyPlayEnd=function(t){this.callHandler&&(this.callHandler.args=[t],this.callHandler.run())},t.prototype.loadBody=function(t,e){void 0===e&&(e=!1),this.body.load(t,!0,e)},t.prototype.playAction=function(t,e){void 0===e&&(e=0),this.body.play(t,e,this._onStage),this._onStage||e&&this.bodyPlayEnd(t)},t.prototype.setDir=function(t){this.dir=t,this.body.setDir(t)},t.prototype.onRemove=function(){this.body.onRemove()},t.prototype.setStage=function(t){this._onStage=t,t&&this.body.recoverPlay()},t}();__reflect(ThingBody.prototype,"ThingBody");var ThingBubbles=function(t){function e(){var e=t.call(this)||this;return e.bg=new egret.Bitmap,e.bg.texture=RES.getRes("zjm_json.zjm_dhk_png"),e.bg.scale9Grid=new egret.Rectangle(48,7,50,30),e.addChild(e.bg),e.decsTxt=App.DisplayUtils.newTextField("",10,10,14698754,"left",16),e.decsTxt.lineSpacing=5,e.addChild(e.decsTxt),e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.setData=function(t,e){void 0===e&&(e=1e4),this.reset(),this.decsTxt.textFlow=TextFlowUtils.generateTextFlow(t),this.decsTxt.width=128,this.bg.width=this.decsTxt.width+20,this.bg.height=this.decsTxt.height+30,this.width=this.bg.width,this.height=this.bg.height,this.bg.y=-this.bg.height-6,this.decsTxt.y=this.bg.y+7,this.bg.x=-60,this.decsTxt.x=-50,e?(this.alpha=0,egret.Tween.get(this).to({alpha:1},200).wait(e).to({alpha:0},200).call(this.dispose,this)):this.alpha=1},e.prototype.reset=function(){this.bg.y=0,this.bg.x=0,this.decsTxt.y=0,this.decsTxt.width=128,egret.Tween.removeTweens(this)},e.prototype.hasShow=function(){return this.parent?!0:!1},e.prototype.dispose=function(){this.x=0,this.y=0,egret.Tween.removeTweens(this),App.DisplayUtils.removeFromParent(this),ObjectPool.push(this)},e}(egret.DisplayObjectContainer);__reflect(ThingBubbles.prototype,"ThingBubbles");var ThingFight=function(){function t(){this._open=!1,this.nextUpdateTime=0,this.skillList=[],this.skillIndex=0,this.isPassive=!1,this.attackHuman=0,this.monsterId=0}return t.prototype.register=function(t){this.user=t,App.FightManager.addFight(this),t.pro.kind==ThingKind.Monster&&(this.isPassive=!0),this.createSkillList()},t.prototype.createSkillList=function(){var t=this.user.pro.skillList;if(t)for(var e=0,i=t.length;i>e;e++){var n=UserSkill.create(t[e][0],t[e][1]);this.skillList.push(n)}},Object.defineProperty(t.prototype,"useSkill",{set:function(t){this.waitSkill=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{set:function(t){this.tar=t,this.user==GameCache.hero.focusPlayer&&ActorSeleMgr.onSele(t),this.attackHuman=0,t&&t.pro.aiCamp==AICampType.NORMAL&&(t.pro.kind==ThingKind.Human?this.attackHuman=t.pro.pro(PropId.AP_ACTOR_ID):t.pro.kind==ThingKind.HeroPet&&(this.attackHuman=t.pro.masterId))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},set:function(t){this._open=t,t||(this.tar=null,this.waitSkill=null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fighting",{get:function(){return this._open||this.tar},enumerable:!0,configurable:!0}),t.prototype.update=function(t){if(!(t<=this.nextUpdateTime||this.user.action>=ActionStandard.SA_NORMHIT)){var e=this,i=e.user;if(!i.isJump&&!i.isDie&&!i.disappear){if(GameCache.hero.focusPlayer==i){var n=this.getDropItem(i);if(n)return void(this.nextUpdateTime=t+this.user.moveSpeed)}e.tar&&(e.tar.disappear||e.tar.isDie)&&(e.tar=null),(e.open||e.tar)&&e.getSkill(),e.open&&e.getTarget();var o=e.tar;if(o&&this.waitSkill){if(e.inAttackDis())this.nextUpdateTime=t+this.user.pro.pro(PropId.AP_ATTACK_SPEED),this.waitSkill.dwResumeTick=GameConfig.skill[this.waitSkill.nSkillId].cooldownTime+t+100,i.preSkill(),i.setBanHavior(2e3),App.FightManager.useSkill(i,this.waitSkill,o),this.waitSkill=null;else if(this.nextUpdateTime=t+this.user.moveSpeed,o!=this.moveTar||!i.isMove){if(i.pro.kind==ThingKind.Monster&&i.cellXY.y!=o.cellXY.y)return void(this.tar=null);i.moveTo(o.cellXY.x,o.cellXY.y),this.moveTar=o}}else{if(i.pro.kind==ThingKind.Monster&&!i.isMove&&Math.random()>.99){this.nextUpdateTime=t+this.user.moveSpeed;var r=Math.random()>.5?1:-1;i.moveTo(i.cellXY.x+r,i.cellXY.y)}if(GameCache.hero.focusPlayer==i&&(this.nextUpdateTime=t+this.user.moveSpeed,!i.isMove)){var a=GameCache.map.getHookPoint();a&&i.moveTo(a[0],a[1])}}}}},t.prototype.getDropItem=function(t){for(var e,i=App.ThingManager.dropList,n=0,o=i.length,r=t.cellXY,a=0;o>n;n++){var s=i[n];if(!s.isTrue)return null;if(s.canPick())return s.pick(),t.stopMove(),s;var h=Math.abs(r.x-s.cellY)+Math.abs(r.y-s.cellY);(!a||a>h)&&(e=s)}return e&&t.moveTo(e.cellX,e.cellY),e},t.prototype.beHit=function(t){this.isPassive&&(this.tar=t)},t.prototype.inAttackDis=function(){var t=GameConfig.skill[this.waitSkill.nSkillId],e=this.tar;if(t&&e){var i=t.skilldis?t.skilldis:0;return Math.abs(this.user.cellXY.x-e.cellXY.x)<=i&&this.user.cellXY.y==e.cellXY.y}return!1},t.prototype.onRemove=function(){App.FightManager.removeFight(this.user.pro.recog),this.user=null,this.tar=null,this.moveTar=null,this.waitSkill=null;for(var t=0,e=this.skillList;t<e.length;t++){var i=e[t];i.dispose()}this.skillList.length=0,this.isPassive=null,this.monsterId=0,this.foreverSkill=null,ObjectPool.push(this)},t.prototype.getSkill=function(){if(!this.waitSkill){if(this.foreverSkill&&this.foreverSkill.canUse)return void(this.waitSkill=this.foreverSkill);var t=this.user.pro.kind,e=this.skillList;if(t==ThingKind.Hero&&(e=GameCache.skill.getFightSkilList(this.user.pro.pro(PropId.AP_ACTOR_ID))),e&&0!=e.length){var i=this.skillIndex+1,n=e.length;this.skillIndex>=n&&(this.skillIndex=0,i=0);for(var o=!1;!0&&(i!=this.skillIndex+1||!o);i++){i>=n&&(i=0),o=!0;var r=e[i];if(r&&r.canUse){this.waitSkill=r,this.skillIndex=i;break}}}}},t.prototype.getTarget=function(){if(!this.tar&&!this.isPassive&&this.waitSkill){var t=GameConfig.skill[this.waitSkill.nSkillId];if(!t)return;var e=AICampEnemy[this.user.pro.aiCamp],i=void 0;if(e){var n=App.ThingManager.getThingDic(),o=(t.skilldis,9999999);for(var r in n){var a=n[r];if(!a.isDie&&!a.disappear&&-1!=e.indexOf(a.pro.aiCamp)){if(this.user.pro.aiCamp==AICampType.MONSTER&&Math.random()>.6)return void(this.tar=a);if(!this.monsterId||this.monsterId==a.configId){var s=Math.abs(this.user.cellXY.x-a.cellXY.x)+Math.abs(this.user.cellXY.y-a.cellXY.y);(!i||o>s)&&(i=a,o=s)}}}}this.target=i}},t}();__reflect(ThingFight.prototype,"ThingFight");var ThingTitle=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e.nameBG=new egret.Bitmap,e.nameBG.scale9Grid=new egret.Rectangle(11,10,8,1),e.nameBG.height=25,e.nameBG.y=6,e.addChild(e.nameBG),e.txtName=App.DisplayUtils.newTextField("",0,0,ColorUtil.TITLE_NORMAL,"center",14),e.txtName.y=11,e.addChild(e.txtName),e.familyName=App.DisplayUtils.newTextField("",0,0,ColorUtil.C_GREEN,"center",14),e.familyName.y=35,e.addChild(e.familyName),e}return __extends(e,t),e.prototype.setNameColor=function(t){this.txtName.textColor=t},e.prototype.setName=function(t){this.nameBG.texture=RES.getRes("zjm_json.zjm_name_bg_png"),this.txtName.text=t,this.initLayout()},e.prototype.setBadge=function(t){return 0>=t?void(this.badge&&(this.badge.source=null)):(this.badge||(this.badge=new eui.Image,this.badge.height=22,this.badge.width=40,this.badge.y=7,this.addChild(this.badge)),t=Math.floor(t/10),this.badge.source=RES_DIR_BADGE+"t"+t+".png",void(this.badge&&(this.badge.x=-Math.floor(this.nameBG.width/2)-42)))},e.prototype.initLayout=function(){this.nameBG.width=this.txtName.width+14,this.txtName.anchorOffsetX=Math.floor(this.txtName.width/2),this.familyName.anchorOffsetX=Math.floor(this.familyName.width/2),this.nameBG.anchorOffsetX=Math.floor(this.nameBG.width/2),this.badge&&(this.badge.x=-Math.floor(this.nameBG.width/2)-42)},e.prototype.setFamilyName=function(t){this.familyName.text=t,this.initLayout()},e.prototype.reset=function(){},e}(egret.DisplayObjectContainer);__reflect(ThingTitle.prototype,"ThingTitle");var ThingTopTitle=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=e.touchChildren=!1,e.hpProBg=new egret.Bitmap,e.hpProBg.texture=RES.getRes("zjm_json.zjm_progressbg_png"),e.addChild(e.hpProBg),e.hpPro=new egret.Bitmap,e.hpPro.x=1,e.hpPro.y=1,e.hpPro.texture=RES.getRes("zjm_json.zjm_redprogress_png"),e.addChild(e.hpPro),e.hpPro.scale9Grid=new egret.Rectangle(3,1,72,8),e.anchorOffsetX=39,e}return __extends(e,t),e.prototype.setHpType=function(t){void 0===t&&(t=0),this.hpPro.texture=RES.getRes(t?"zjm_json.zjm_greenprogress_png":"zjm_json.zjm_redprogress_png")},e.prototype.setHp=function(t,e,i){void 0===i&&(i=!1),i?(this.hpTx||(this.hpTx=new NumberMC,this.hpTx.type="zjm_json.zjm_red_",this.hpTx.y=-18,this.addChild(this.hpTx)),this.hpTx.value=t,this.hpTx.x=this.width-this.hpTx.width>>1):this.hpTx&&(this.hpTx.dispose(),App.DisplayUtils.removeFromParent(this.hpTx),this.hpTx=null);var n=t/e;n>1&&(n=1),this.hpPro.width=78*n},e.prototype.dispose=function(){ObjectPool.push(this)},e}(egret.DisplayObjectContainer);__reflect(ThingTopTitle.prototype,"ThingTopTitle");var ActionStandard=function(){function t(){}return t.getSpine=function(e){return e==t.SA_IDLE?ActionSpine.IDLE:e==t.SA_RUN?ActionSpine.RUN:e==t.SA_JUMP?ActionSpine.JUMP:e==t.SA_DIE?ActionSpine.DIE:e==t.SA_NORMHIT?ActionSpine.NORMHIT:e==t.SA_STRUCK?ActionSpine.STRUCK:"skill"+(e-100)},t.SA_IDLE=0,t.SA_WALK=1,t.SA_RUN=2,t.SA_DIE=3,t.SA_JUMP_START=4,t.SA_JUMP=5,t.SA_STRUCK=6,t.SA_NORMHIT=100,t.SA_HIT1=101,t.SA_HIT2=102,t}();__reflect(ActionStandard.prototype,"ActionStandard");var ActionSpine=function(){function t(){}return t.IDLE="stand",t.NORMHIT="fight",t.DIE="dead",t.RUN="walk",t.JUMP="jump",t.STRUCK="hit",t.RIDE="ride",t.SKILL1="skill1",t.SKILL2="skill2",t}();__reflect(ActionSpine.prototype,"ActionSpine");var AICampType;!function(t){t[t.NORMAL=0]="NORMAL",t[t.SELF=1]="SELF",t[t.ROOT=2]="ROOT",t[t.MONSTER=3]="MONSTER",t[t.BATTLE1=4]="BATTLE1",t[t.BATTLE2=5]="BATTLE2"}(AICampType||(AICampType={}));var AICampEnemy=(_a={},_a[AICampType.MONSTER]=[AICampType.SELF],_a[AICampType.SELF]=[AICampType.MONSTER],_a[AICampType.ROOT]=[AICampType.MONSTER],_a[AICampType.BATTLE1]=[AICampType.BATTLE2],_a[AICampType.BATTLE2]=[AICampType.BATTLE1],_a),_a,ThingKind=function(){function t(){}return t.initIndex=function(){this.IndexDic=(t={},t[this.Hero]=100,t[this.Human]=90,t[this.Monster]=50,t[this.Npc]=10,t);var t},t.getIndexByKind=function(t){return this.IndexDic[t]?this.IndexDic[t]:80},t.isHuman=function(e){return e==t.Human||e==t.HeroPet},t.isPet=function(e){return e==t.Pet},t.isMonster=function(e){return e==t.Monster||e==t.Collectable||e==t.DisplayMonster||e==t.MonsterHorse||e==t.MonsterOneDir},t.isHero=function(e){return e==t.Hero},t.isBuildMonster=function(e){return e==t.BuildMonster},t.isMonsterHuman=function(e){return e==t.MonsterHuman},t.isNPC=function(e){return e==t.Npc||e==t.MovingNPC},t.isNoneAttackObject=function(e){return e==t.Collectable},t.isCollectObject=function(e){return e==t.Collectable},t.isTransfer=function(e){return e==t.Transfer},t.isHumanModel=function(e){return e==t.Human||e==t.Hero||e==t.HeroPet},t.Hero=-1,t.Human=0,t.Monster=1,t.Npc=2,t.MovingNPC=3,t.Pet=4,t.Mine=6,t.Defender=7,t.Plant=8,t.Transfer=9,t.Building=10,t.Effects=11,t.Collectable=12,t.DisplayMonster=13,t.HeroPet=14,t.Totem=15,t.MonsterHuman=16,t.MonsterHorse=17,t.MonsterOneDir=18,t.PetFollow=19,t.BuildMonster=20,t.ClientRecog=25,t.Novice=999,t.MP_PT=1,t.MP_JY=2,t.MP_TM=3,t.MP_SL=4,t.MP_SW=5,t}();__reflect(ThingKind.prototype,"ThingKind");var ThingState=function(){function t(){}return t.STAND=1,t.MOVE=2,t.RIDE=4,t.ZANZEN=8,t.STALL=16,t.SING=32,t.BATTLE=64,t.DEATH=128,t.MOVE_FORBID=256,t.DIZZY=512,t.AUTO_BATTLE=1024,t.RETURN_BURN=2048,t.DISABLE_SKILLCD=4096,t.CHALLENGE=8192,t.TRAFFIC=16384,t.COUPLE_ZANZEN=32768,t.BODY_CHANGE=65536,t.SWIMMING=131072,t.KISS_SWIMMING=262144,t.FAST_BATTLE=524288,t.KISS_LAND=1048576,t.Corps_Battle=2097152,t.CARRIER=4194304,t.PASSENGGER=8388608,t.DongFang=16777216,t.Own_Pet=33554432,t.HERO_FIT=67108864,t.GM=134217728,t.WingTail=268435456,t.MuYu=536870912,t.Chariot=1073741824,t}();__reflect(ThingState.prototype,"ThingState");var PropertySet=function(){function t(){this.aiCamp=0,this.fightAi=!1,this.isMainPlayer=null,this.isFlow=null,this.petId=[],this.petStar=[],this.petName=[]}return t.prototype.setRoleName=function(t){this.parseName(t)},t.prototype.parseName=function(t){var e=t.split("\\");this.charName=e[0],this.masterName=e.length>1?e[1]:null},t.prototype.clone=function(){var e=new t;for(var i in this)e.pro(i,this.pro(i));return e.isMainPlayer=null,e},t.prototype.pro=function(t,e,i){return void 0!=e&&(this[t]=e),i&&i.updateProperty(t,e),this[t]||0},t.prototype.readProperty=function(e,i){var n,o=t.getDataType(e);switch(o){case enDt.DT_UNSIGNED_INT:n=i.readUnsignedInt();break;case enDt.DT_FLOAT:n=i.readFloat();break;case enDt.DT_DOUBLE:n=i.readDouble();break;default:n=i.readInt()}this[e]=n},t.prototype.readMultiProperty=function(t,e){for(var i=0;t>i;i++)this.readProperty(e.readUnsignedByte(),e)},Object.defineProperty(t.prototype,"moveSpeed",{get:function(){return this.pro(PropId.AP_MOVE_SPEED)||150},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"job",{get:function(){return this.pro(PropId.AP_JOB)},enumerable:!0,configurable:!0}),t.getGameMoneyType=function(t){switch(t){case PropId.AP_COIN:return MoneyType.NON_BIND_COIN;case PropId.AP_YUANBAO:return MoneyType.NON_BIND_YUANBAO;case PropId.AP_BIND_YUANBAO:return MoneyType.BIND_YUANBAO;case PropId.AP_BIND_COIN:return MoneyType.BIND_COIN}return-1},t.getDataType=function(t){switch(t){case PropId.AP_X:case PropId.AP_Y:case PropId.AP_BODY_ID:case PropId.AP_DIR:case PropId.AP_WEAPON:case PropId.AP_MOUNT:case PropId.AP_SWING:case PropId.AP_PK_VALUE:return enDt.DT_INT;default:return enDt.DT_UNSIGNED_INT}},t}();__reflect(PropertySet.prototype,"PropertySet");var enDt;!function(t){t[t.DT_BOOLEAN=1]="DT_BOOLEAN",t[t.DT_BYTE=2]="DT_BYTE",t[t.DT_DOUBLE=3]="DT_DOUBLE",t[t.DT_FLOAT=4]="DT_FLOAT",t[t.DT_INT=5]="DT_INT",t[t.DT_SHORT=6]="DT_SHORT",t[t.DT_UNSIGNED_BYTE=7]="DT_UNSIGNED_BYTE",t[t.DT_UNSIGNED_INT=8]="DT_UNSIGNED_INT",t[t.DT_UNSIGNED_SHORT=9]="DT_UNSIGNED_SHORT",t[t.DT_STRING=10]="DT_STRING"}(enDt||(enDt={}));var StdActivitycata=function(){function t(){}return t}();__reflect(StdActivitycata.prototype,"StdActivitycata");var StdArena=function(){function t(){this.consume=[],this.award=[],this.awardshow=[],this.awardpoint=[],this.rankaward=[],this.startPos=[]}return t}();__reflect(StdArena.prototype,"StdArena");var StdArenarobot=function(){function t(){this.att1=[],this.skill1=[],this.att2=[],this.skill2=[],this.att3=[],this.skill3=[]}return t}();__reflect(StdArenarobot.prototype,"StdArenarobot");var StdAttribute=function(){function t(){}return t}();__reflect(StdAttribute.prototype,"StdAttribute");var StdAttributebuffid=function(){function t(){}return t}();__reflect(StdAttributebuffid.prototype,"StdAttributebuffid");var StdBadge=function(){function t(){this.attrs=[]}return t}();__reflect(StdBadge.prototype,"StdBadge");var StdBagtype=function(){function t(){}return t}();__reflect(StdBagtype.prototype,"StdBagtype");var StdBarrierboss=function(){function t(){}return t}();__reflect(StdBarrierboss.prototype,"StdBarrierboss");var StdBarrierpassaward=function(){function t(){this.drop_id=[],this.awardshow=[],this.hang_drop=[]}return t}();__reflect(StdBarrierpassaward.prototype,"StdBarrierpassaward");var StdBarrierspecialaward=function(){function t(){this.awards=[],this.showAwards=[]}return t}();__reflect(StdBarrierspecialaward.prototype,"StdBarrierspecialaward");var StdBroadcast=function(){function t(){}return t}();__reflect(StdBroadcast.prototype,"StdBroadcast");var StdBuff=function(){function t(){}return t}();__reflect(StdBuff.prototype,"StdBuff");var StdCailiaocopy=function(){function t(){this.awardshow=[],this.enterPos=[],this.bossPos=[],this.monsterPos=[],this.score=[],this.awarddec=[]}return t}();__reflect(StdCailiaocopy.prototype,"StdCailiaocopy");var StdCarousel=function(){function t(){this.interval=[],this.first=[]}return t}();__reflect(StdCarousel.prototype,"StdCarousel");var StdChatsys=function(){function t(){}return t}();__reflect(StdChatsys.prototype,"StdChatsys");var StdChkpointconf=function(){function t(){this.mSceneId=[],this.BOSSpoint=[],this.cityPos=[]}return t}();__reflect(StdChkpointconf.prototype,"StdChkpointconf");var StdChognzhi=function(){function t(){}return t}();__reflect(StdChognzhi.prototype,"StdChognzhi");var StdCustombtn=function(){function t(){}return t}();__reflect(StdCustombtn.prototype,"StdCustombtn");var StdDaily=function(){function t(){this.cond=[]}return t}();__reflect(StdDaily.prototype,"StdDaily");var StdDailyreward=function(){function t(){this.reward=[]}return t}();__reflect(StdDailyreward.prototype,"StdDailyreward");var StdDailysign=function(){function t(){this.reward=[]}return t}();__reflect(StdDailysign.prototype,"StdDailysign");var StdDress=function(){function t(){}return t}();__reflect(StdDress.prototype,"StdDress");var StdDrops=function(){function t(){}return t}();__reflect(StdDrops.prototype,"StdDrops");var StdEquipaddition=function(){function t(){this.att=[]}return t}();__reflect(StdEquipaddition.prototype,"StdEquipaddition");var StdEquipexchange=function(){function t(){this.needNum=[],this.recycle=[]}return t}();__reflect(StdEquipexchange.prototype,"StdEquipexchange");var StdEquipexchangelevel=function(){function t(){}return t}();__reflect(StdEquipexchangelevel.prototype,"StdEquipexchangelevel");var StdEquippurgatory=function(){function t(){this.icon=[],this.attrs=[]}return t}();__reflect(StdEquippurgatory.prototype,"StdEquippurgatory");var StdEquippurgatoryadd=function(){function t(){this.attrs=[]}return t}();__reflect(StdEquippurgatoryadd.prototype,"StdEquippurgatoryadd");var StdEquippurgatoryresolve=function(){function t(){this.re_item=[]}return t}();__reflect(StdEquippurgatoryresolve.prototype,"StdEquippurgatoryresolve");var StdErrotips=function(){function t(){}return t}();__reflect(StdErrotips.prototype,"StdErrotips");var StdExpcopy=function(){function t(){this.level=[],this.consume=[],this.enterPos=[],this.monsterInfo=[],this.monsterPos=[]}return t}();__reflect(StdExpcopy.prototype,"StdExpcopy");var StdFailtips=function(){function t(){}return t}();__reflect(StdFailtips.prototype,"StdFailtips");var StdFamily=function(){function t(){this.privilege=[],this.condition=[]}return t}();__reflect(StdFamily.prototype,"StdFamily");var StdFamilylv=function(){function t(){}return t}();__reflect(StdFamilylv.prototype,"StdFamilylv");var StdFamilysys=function(){function t(){}return t}();__reflect(StdFamilysys.prototype,"StdFamilysys");var StdFashioncopy=function(){function t(){this.awardshow=[],this.enterPos=[],this.monsterInfo=[],this.monsterPos=[],this.score=[]}return t}();__reflect(StdFashioncopy.prototype,"StdFashioncopy");var StdFashionequip=function(){function t(){this.conds=[],this.needNum=[],this.staitcAttrs=[],this.shape=[]}return t}();__reflect(StdFashionequip.prototype,"StdFashionequip");var StdFashionesuit=function(){function t(){this.conds=[],this.part=[],this.staitcAttrs=[]}return t}();__reflect(StdFashionesuit.prototype,"StdFashionesuit");var StdFashionexchange=function(){function t(){}return t}();__reflect(StdFashionexchange.prototype,"StdFashionexchange");var StdFuben=function(){function t(){this.enterCfg=[],this.buyTimesConsume=[],this.exitPos=[]}return t}();__reflect(StdFuben.prototype,"StdFuben");var StdGashapon=function(){function t(){}return t}();__reflect(StdGashapon.prototype,"StdGashapon");var StdGashapondisplay=function(){function t(){this.item=[],this.single=[],this.ten=[]}return t}();__reflect(StdGashapondisplay.prototype,"StdGashapondisplay");var StdGem=function(){function t(){this.attr=[],this.lvlAttr=[],this.consume=[],this.resolve=[],this.condition=[]}return t}();__reflect(StdGem.prototype,"StdGem");var StdGift=function(){function t(){}return t}();__reflect(StdGift.prototype,"StdGift");var StdGlobalconfig=function(){function t(){this.buffid=[]}return t}();__reflect(StdGlobalconfig.prototype,"StdGlobalconfig");var StdGuide=function(){function t(){this.command=[]}return t}();__reflect(StdGuide.prototype,"StdGuide");var StdItem=function(){function t(){this.staitcAttrs=[],this.conds=[],this.jump=[]}return t}();__reflect(StdItem.prototype,"StdItem");var StdMainuiiconcontrol=function(){function t(){}return t}();__reflect(StdMainuiiconcontrol.prototype,"StdMainuiiconcontrol");var StdMaoxian=function(){function t(){this.award=[]}return t}();__reflect(StdMaoxian.prototype,"StdMaoxian");var StdMiwutower=function(){function t(){this.bossPos=[],this.dropID=[],this.dailyaward=[],this.awardshow=[],this.specialShow=[]}return t}();__reflect(StdMiwutower.prototype,"StdMiwutower");var StdMiwutowerjackpot=function(){function t(){this.jackpot=[]}return t}();__reflect(StdMiwutowerjackpot.prototype,"StdMiwutowerjackpot");var StdModcontrol=function(){function t(){this.image=[],this.redItemIdList=[]}return t}();__reflect(StdModcontrol.prototype,"StdModcontrol");var StdMonster=function(){function t(){this.dropid=[]}return t}();__reflect(StdMonster.prototype,"StdMonster");var StdMount=function(){function t(){this.basicatt=[],this.activationNeed=[],this.gradeatt=[],this.advancedcount=[],this.advancedFactor=[],this.advancedMod=[],this.skillnum=[],this.adle_talk=[],this.typeToStar=[]}return t}();__reflect(StdMount.prototype,"StdMount");var StdMountboss=function(){function t(){this.reward_show=[]}return t}();__reflect(StdMountboss.prototype,"StdMountboss");var StdMountconfig=function(){function t(){}return t}();__reflect(StdMountconfig.prototype,"StdMountconfig");var StdMountfetters=function(){function t(){this.petneed=[],this.skillattribute=[]}return t}();__reflect(StdMountfetters.prototype,"StdMountfetters");var StdMountskill=function(){function t(){this.skillattr=[]}return t}();__reflect(StdMountskill.prototype,"StdMountskill");var StdNoviceguide=function(){function t(){this.command=[],this.targetView=[],this.targetViewText=[],this.offset=[]}return t}();__reflect(StdNoviceguide.prototype,"StdNoviceguide");var StdNpc=function(){function t(){this.talk=[]}return t}();__reflect(StdNpc.prototype,"StdNpc");var StdPassmonster=function(){function t(){this.heroPos=[],this.monster=[],this.pos=[]}return t}();__reflect(StdPassmonster.prototype,"StdPassmonster");var StdPersonalboss=function(){function t(){this.reward_show=[]}return t}();__reflect(StdPersonalboss.prototype,"StdPersonalboss");var StdPet=function(){function t(){this.basicatt=[],this.activationNeed=[],this.gradeatt=[],this.advancedcount=[],this.advancedFactor=[],this.advancedMod=[],this.skillnum=[],this.adle_talk=[],this.typeToStar=[]}return t}();__reflect(StdPet.prototype,"StdPet");var StdPetboss=function(){function t(){this.reward_show=[]}return t}();__reflect(StdPetboss.prototype,"StdPetboss");var StdPetconfig=function(){function t(){}return t}();__reflect(StdPetconfig.prototype,"StdPetconfig");var StdPetfetters=function(){function t(){this.petneed=[],this.skillattribute=[]}return t}();__reflect(StdPetfetters.prototype,"StdPetfetters");var StdPetskill=function(){function t(){this.skillattr=[]}return t}();__reflect(StdPetskill.prototype,"StdPetskill");var StdPurgatoryboss=function(){function t(){this.consume=[],this.reward_show=[]}return t}();__reflect(StdPurgatoryboss.prototype,"StdPurgatoryboss");var StdRank=function(){function t(){this.award=[]}return t}();__reflect(StdRank.prototype,"StdRank");var StdRecharge=function(){function t(){this.Reward=[]}return t}();__reflect(StdRecharge.prototype,"StdRecharge");var StdRecycleequip=function(){function t(){this.re_item=[]}return t}();__reflect(StdRecycleequip.prototype,"StdRecycleequip");var StdRemaster=function(){function t(){this.attrs=[],this.part0=[],this.part1=[],this.part2=[],this.part3=[],this.part4=[],this.part5=[],this.part6=[],this.part7=[],this.part8=[],this.part9=[]}return t}();__reflect(StdRemaster.prototype,"StdRemaster");var StdRune=function(){function t(){this.item=[],this.attrs=[]}return t}();__reflect(StdRune.prototype,"StdRune");var StdRuneskill=function(){function t(){this.name=[],this.attrs=[]}return t}();__reflect(StdRuneskill.prototype,"StdRuneskill");var StdRunetable=function(){function t(){this.item=[],this.atts=[]}return t}();__reflect(StdRunetable.prototype,"StdRunetable");var StdRunetablet=function(){function t(){this.item=[],this.gold=[],this.atts=[]}return t}();__reflect(StdRunetablet.prototype,"StdRunetablet");var StdScene=function(){function t(){this.npc=[],this.teleport=[],this.LRbtnSHow=[],this.configureBtn=[],this.hookPath=[]}return t}();__reflect(StdScene.prototype,"StdScene");var StdShop=function(){function t(){}return t}();__reflect(StdShop.prototype,"StdShop");var StdSkillbar=function(){function t(){}return t}();__reflect(StdSkillbar.prototype,"StdSkillbar");var StdSkilleffect=function(){function t(){}return t}();__reflect(StdSkilleffect.prototype,"StdSkilleffect");var StdStrengthequip=function(){function t(){this.consume=[],this.reconsume=[]}return t}();__reflect(StdStrengthequip.prototype,"StdStrengthequip");var StdStrsmaster=function(){function t(){this.attrs=[],this.part0=[],this.part1=[],this.part2=[],this.part3=[],this.part4=[],this.part5=[],this.part6=[],this.part7=[],this.part8=[],this.part9=[]}return t}();__reflect(StdStrsmaster.prototype,"StdStrsmaster");var StdSyshelp=function(){function t(){}return t}();__reflect(StdSyshelp.prototype,"StdSyshelp");var StdTest=function(){function t(){this.d=[]}return t}();__reflect(StdTest.prototype,"StdTest");var StdTimediscount=function(){function t(){}return t}();__reflect(StdTimediscount.prototype,"StdTimediscount");var StdTimegift=function(){function t(){this.showItem=[]}return t}();__reflect(StdTimegift.prototype,"StdTimegift");var StdTitle=function(){function t(){this.att=[]}return t}();__reflect(StdTitle.prototype,"StdTitle");var StdTotems=function(){function t(){this.consume=[],this.levelAtt=[]}return t}();__reflect(StdTotems.prototype,"StdTotems");var StdTotemsres=function(){function t(){this.attrs=[],this.number=[]}return t}();__reflect(StdTotemsres.prototype,"StdTotemsres");var StdTransfer=function(){function t(){this.attrs=[],this.skillID=[],this.ZXCID=[]}return t}();__reflect(StdTransfer.prototype,"StdTransfer");var StdTransferconfig=function(){function t(){}return t}();__reflect(StdTransferconfig.prototype,"StdTransferconfig");var StdTransfertotal=function(){function t(){this.preview=[],this.describe=[]}return t}();__reflect(StdTransfertotal.prototype,"StdTransfertotal");var StdVip=function(){function t(){this.ExclusivePackage=[],this.DailyPackage=[],this.des=[],this.sort=[],this.attr=[]}return t}();__reflect(StdVip.prototype,"StdVip");var StdVipboss=function(){function t(){this.reward_show=[]}return t}();__reflect(StdVipboss.prototype,"StdVipboss");var StdVipcard=function(){function t(){this.desc=[]}return t}();__reflect(StdVipcard.prototype,"StdVipcard");var StdWing=function(){function t(){this.consumeItems=[],this.consumeGold=[],this.levelAtt=[],this.wingAppearance=[]}return t}();__reflect(StdWing.prototype,"StdWing");var StdWingboss=function(){function t(){this.reward_show=[]}return t}();__reflect(StdWingboss.prototype,"StdWingboss");var StdWingskill=function(){function t(){this.att=[]}return t}();__reflect(StdWingskill.prototype,"StdWingskill");var StdWorldboss=function(){function t(){this.reward_show=[]}return t}();__reflect(StdWorldboss.prototype,"StdWorldboss");var ActivityCache=function(t){function e(){var e=t.call(this)||this;return e.serverOpen=0,e.xsyhData={},e.xslbData={},e}return __extends(e,t),e.prototype.clear=function(){this.xsyhData={},this.xslbData={}},e.prototype.initActivityData=function(){this.serverOpen||(this.serverOpen=GameCache.server.serverOpenDay)},e.prototype.XSYHBough=function(t){this.xsyhData[this.serverOpen]||(this.xsyhData[this.serverOpen]={}),this.xsyhData[this.serverOpen][t]?this.xsyhData[this.serverOpen][t]++:this.xsyhData[this.serverOpen][t]=1},e.prototype.XSLBBough=function(t){this.xslbData[this.serverOpen]||(this.xslbData[this.serverOpen]={}),this.xslbData[this.serverOpen][t]?this.xslbData[this.serverOpen][t]++:this.xslbData[this.serverOpen][t]=1},e}(BaseClass);__reflect(ActivityCache.prototype,"ActivityCache");var ActivityCatalogue=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="ActivityCataSkin",i}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this,e),this.addTouchEvent(this.list,this.onListClick),this.list.itemRenderer=ActivityCatalogueItem,this.refreshPanel()},e.red=function(){var t=!1;for(var e in GameConfig.activityCata){var i=GameConfig.activityCata[e];
if(App.ViewManager.checkOpenCondition({openLv:i.openLv,openQuest:i.openQuest},!1)){var n=i.pannel;if(window[n]&&window[n].red&&window[n].red())return!0}}return t},e.changeMsg=function(){return[]},e.prototype.refreshPanel=function(){var t=[];for(var e in GameConfig.activityCata){var i=GameConfig.activityCata[e];App.ViewManager.checkOpenCondition({openLv:i.openLv,openQuest:i.openQuest},!1)&&(t[i.id]||(t[i.id]=i))}this.setListData(this.list,t)},e.prototype.onListClick=function(t){var e=t.currentTarget;TextFlowUtils.hrefType(e.selectedItem.jump),App.ViewManager.close(ViewConst.ACTIVITY_CATALOGUE)},e.prototype.close=function(){t.prototype.close.call(this);for(var e=0,i=this.list.$children;e<i.length;e++){var n=i[e];n.dispose()}this.list.itemRenderer=null},e.isRed=!1,e}(BaseEuiWindow);__reflect(ActivityCatalogue.prototype,"ActivityCatalogue");var ActivityCatalogueItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.cfg=this.data,this.banner.source=RES_DIR_IMAGES_BANNE_ACTIVITY+"/catalogue/"+this.cfg.image,this.labTime.text=StringUtils.substitute(Language.lang.activityCatalogueTime,"永久");var e=!1;window[this.cfg.pannel]&&window[this.cfg.pannel].red&&(e=window[this.cfg.pannel].red()),App.ViewManager.showRedPoint(this,e)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.cfg=null},e}(BaseCustComponent);__reflect(ActivityCatalogueItem.prototype,"ActivityCatalogueItem");var ActorHp=function(t){function e(){var e=t.call(this)||this;return e.barNum=5,e.hpArr=[],e.hpInterval=[20,284],e.hpCounts=1,e.skinName="ActorHpSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data instanceof BaseThing&&(this.initData(),App.MessageCenter.removeListener(MsgConst.ENTER_SCENE,this),App.MessageCenter.addListener(MsgConst.ENTER_SCENE,this.changeScene,this),App.MessageCenter.removeListener(MsgConst.BOSS_RANK_INFO,this),App.MessageCenter.addListener(MsgConst.BOSS_RANK_INFO,this.onBossRankChange,this))},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){this.thing=this.data,this.maxHP=this.data.pro.pro(PropId.AP_MAX_HP),this.hp=this.data.pro.pro(PropId.AP_HP);var t=GameConfig.monster[this.data.pro.pro(PropId.AP_ACTOR_ID)];if(t)this.mName.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.bossHpName,t.level.toString(),this.data.pro.charName)),t.icon&&(this.headIcon.source=""+RES_DIR_MONSTERICON+t.icon+".png"),this.og.visible=!1,this.headIcon.x=103,this.headIcon.y=-34,this.hpCounts=t.hpCounts?t.hpCounts:1;else{var e=this.data.pro.pro(PropId.AP_JOB),i=this.data.pro.pro(PropId.AP_SEX);this.mName.text=this.data.pro.charName,this.headIcon.source=GlobalFun.getRoleIcon(e,i),this.og.visible=!1,this.headIcon.x=143,this.headIcon.y=9,this.hpCounts=1}this.perHp=this.maxHP/this.hpCounts,this.hpChange(this.hp)},e.prototype.hpChange=function(t){if(0>=t)this.visible=!1;else{var e=Math.ceil(t/this.perHp),i=e%5;i=0==i?5:i,this.hp_0.source="hp_json.hp_"+i+"_png",1==e||0==e?this.hp_1.visible=!1:(i--,i=0==i?5:i,this.hp_1.source="hp_json.hp_"+i+"_png",this.hp_1.visible=!0);var n=this.perHp-(e*this.perHp-t),o=this.hpInterval[1]-this.hpInterval[0];n=0>=n?0:n,this.hp_0.width=Math.floor(n/this.perHp*o)+this.hpInterval[0],this.hpLab.text=this.hpCounts<=0?"":"x"+e}},e.prototype.changeScene=function(){App.MessageCenter.removeListener(MsgConst.ENTER_SCENE,this),App.MessageCenter.removeListener(MsgConst.BOSS_RANK_INFO,this),ActorSeleMgr.offSele()},e.prototype.onBossRankChange=function(t){var e=t[0];if(!e||0==e.length)return void(this.og.visible=!1);if(this.data&&this.data.pro&&this.data.pro.pro(PropId.AP_ACTOR_ID)==e[0].bossid){this.og.visible=!0;var i=e[0].roleName;this.owner.text=StringUtils.substitute(Language.lang.gsName,i)}},e}(BaseCustComponent);__reflect(ActorHp.prototype,"ActorHp");var ActorSeleMgr=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.onSele=function(t){if(t){var e=App.ViewManager.getView(ViewConst.MAIN_UI),i=e.getChildByName("SELEHP");if(t instanceof MonsterThing){var n=GameConfig.monster[t.id];if(!n||n.monsterType!=MonsterType.BOSS)return void this.offSele()}i||(i=ObjectPool.get(ActorHp),i.name="SELEHP",e.addChild(i)),i.visible=!0,i.data=t,this.actorHp=i,this.thing=t,i.top=110,i.horizontalCenter=1}},e.offSele=function(){var t=App.ViewManager.getView(ViewConst.MAIN_UI),e=t.getChildByName("SELEHP");e&&(t.removeChild(e),ObjectPool.push(e),e=null),this.actorHp=null,this.thing=null},e.hpChange=function(t){if(t==this.thing&&this.actorHp){var e=t.isDie?0:t.pro.pro(PropId.AP_HP);this.actorHp.hpChange(e)}},e}(BaseClass);__reflect(ActorSeleMgr.prototype,"ActorSeleMgr");var MonsterType;!function(t){t[t.NORMAL=1]="NORMAL",t[t.ELIT=2]="ELIT",t[t.LEADER=3]="LEADER",t[t.BOSS=4]="BOSS",t[t.GUARD=5]="GUARD"}(MonsterType||(MonsterType={}));var AdventrueCache=function(t){function e(){var e=t.call(this)||this;return e.dataList=[],e.topProgress=0,e.isInit=!1,e}return __extends(e,t),e.prototype.clear=function(){this.isInit=!1,this.dataList=[],this.topAward=null,this.topProgress=0},e.prototype.isMaxLv=function(){var t=GameConfig.adventure[GameCache.hero.mainPro.pro(PropId.AP_RISK_LVL)+1+""];return t?!1:!0},e.prototype.updatelv=function(t){this.isInit=!0;var e=GameConfig.adventure[t+1+""];if(e||(e=GameConfig.adventure[t+""]),e){var i=this.taskList=[];for(var n in e){var o=parseInt(n);0==o?this.topAward=e[n].award[0]:(this.banner=e[n].image,i[o-1]=e[n])}}else this.taskList=null;this.topProgress=0,App.MessageCenter.dispatch(MsgConst.ADVENTURE_UPDATE_LV)},e.prototype.updateSingle=function(t,e,i,n,o){if(void 0===o&&(o=!1),this.isInit||this.updatelv(0),this.dataList&&0!=t){var r={};r.finish=e,r.prize=i,r.progress=n,this.dataList[t-1]=r,o&&this.checkFinish()}},e.prototype.getData=function(t){var e=this.dataList[t-1];return e?e:{finish:!1,prize:!1,progress:0}},e.prototype.checkFinish=function(){this.topProgress=0;for(var t=0;t<this.taskList.length;t++){var e=this.taskList[t];this.dataList[e.item-1]&&this.dataList[e.item-1].prize&&this.topProgress++}},Object.defineProperty(e.prototype,"topFinish",{get:function(){return this.taskList&&this.topProgress>=this.taskList.length},enumerable:!0,configurable:!0}),e}(BaseCache);__reflect(AdventrueCache.prototype,"AdventrueCache");var AdventureItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this.btn,this.onBtn)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data,i=GameCache.adventure.getData(e.item),n=i.progress;GameCache.adventure.isMaxLv()&&(i.finish=!0,i.prize=!0),i.finish&&(n=e.showval),this.nameLab.text=e.dec,this.proLab.textColor=i.finish?ColorUtil.C_GREEN:ColorUtil.C_RED,this.proLab.text=n+"/"+e.showval,this.item.data=e.award[0],this.prize_flag.visible=i.prize,this.btn.visible=!this.prize_flag.visible,this.btn.icon="res/btn/"+(i.finish?"get_2":"enter")+".png"},e.prototype.onBtn=function(){var t=this.data,e=GameCache.adventure.getData(t.item);e.finish?Proxy.adventure.sendPrize(t.item):(TextFlowUtils.hrefType(t.mod),App.ViewManager.recoredWin(ViewConst.ADVENTURE))},e}(BaseCustComponent);__reflect(AdventureItem.prototype,"AdventureItem");var AdventurePanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="AdventurePanelSkin",e}return __extends(e,t),e.red=function(){return GameCache.adventure.topFinish},e.changeMsg=function(){return[MsgConst.ADVENTURE_UPDATE_SINGLE,MsgConst.ADVENTURE_UPDATE_LV]},e.prototype.init=function(){this.list.itemRenderer=AdventureItem},e.prototype.open=function(){t.prototype.open.call(this),this.addTouchEvent(this.itemAddImg,this.onAct),this.addTouchEvent(this.roleAddImg,this.onAct),this.message(MsgConst.ADVENTURE_UPDATE_LV,this.onUpdateLv),this.message(MsgConst.ADVENTURE_UPDATE_SINGLE,this.onUpdateLv),this.onUpdateLv()},e.prototype.onAct=function(){return GameCache.adventure.isMaxLv()?void GlobalFun.SysMsg(Language.lang.adventrueMaxLv):void(GameCache.adventure.topAward&&(GameCache.adventure.topAward.type==AwardType.CREATE_HERO?App.ViewManager.open(ViewConst.CREATE_HERO):Proxy.adventure.sendPrize(0)))},e.prototype.onUpdateLv=function(){this.updateTop(),this.flushFun(this.onUpdate,!0)},e.prototype.updateTop=function(){var t=GameCache.adventure.topAward,e=GameCache.adventure.topAward.type==AwardType.CREATE_HERO;this.role.visible=e,this.item.visible=!e;var i=GameCache.adventure.taskList.length==GameCache.adventure.topProgress,n=!1;e?(this.roleAddImg.visible=i,this.roleLockImg.visible=!i,n=i,this.roleTextImg.source="adventure_json.adventureRole"+GameCache.hero.list.length+"_png"):this.itemPrize.data=t,n?this.showEff():this.hideEff(),this.banner.source=""+RES_DIR_ADVENTURE+GameCache.adventure.banner+".png"},e.prototype.showEff=function(){if(!this.mc){var t=App.DisplayUtils.addEffectToObj(this,"maoxian_zhaomu_0_1",-1,436,96);this.mc=t}this.mc.play(-1),this.mc.visible=!0},e.prototype.hideEff=function(){this.mc&&(this.mc.visible=!1,this.mc.stop())},e.prototype.onUpdate=function(){this.setListData(this.list,GameCache.adventure.taskList),this.pro.maximum=GameCache.adventure.taskList.length,this.pro.value=GameCache.adventure.topProgress},e}(BaseSpriteView);__reflect(AdventurePanel.prototype,"AdventurePanel");var AdventureProxy=function(t){function e(){var e=t.call(this,PacketTypes.ADVENTURE)||this;return e.regNetMsg(1,e.doInit),e.regNetMsg(2,e.doSingleInfo),e}return __extends(e,t),e.prototype.doInit=function(t){for(var e=t.readUnsignedShort(),i=GameCache.adventure,n=0;e>n;n++){var o=t.readByte(),r=t.readByte(),a=t.readShort();i.updateSingle(n,o?!0:!1,r?!0:!1,a)}i.checkFinish(),App.MessageCenter.dispatch(MsgConst.ADVENTURE_UPDATE_SINGLE)},e.prototype.doSingleInfo=function(t){var e=t.readUnsignedShort(),i=t.readByte(),n=t.readByte(),o=t.readShort(),r=GameCache.adventure;r.updateSingle(e,i?!0:!1,n?!0:!1,o,!0),App.MessageCenter.dispatch(MsgConst.ADVENTURE_UPDATE_SINGLE)},e.prototype.sendPrize=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.getBytes(2);n.writeUnsignedShort(t),n.writeUnsignedInt(e),n.writeUnsignedInt(i),this.sendToServer(n)},e}(BaseProxy);__reflect(AdventureProxy.prototype,"AdventureProxy");var AdventureWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPageWin);__reflect(AdventureWin.prototype,"AdventureWin");var AwardCache=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.clear=function(){},e.prototype.openAwardTips=function(t,e,i){var n=new ViewProp;n.firData={};var o,r=!1;if(App.ViewManager.isShow(ViewConst.AWARDTIPS)){var a=App.ViewManager.getView(ViewConst.AWARDTIPS);switch(e){case AwardSourceType.BOSS_PLUS:a.setList(1,t);break;case AwardSourceType.BOSS:a.setList(2,t);break;case AwardSourceType.COPY:a.setCopyId(i),a.resetHandler(Proxy.copy,Proxy.copy.sendGetAward);default:var s=a.itemList,h=s.dataProvider;h.replaceAll(h.source.concat(t))}}else{switch(e){case AwardSourceType.COPY:if(o=GameConfig.fuben[i],r=!0,!o)return;switch(n.firData.fbid=i,i){case GlobalVar.GUAJI_SCENE:App.ThingManager.addDropList(t)}switch(o.type){case 3:n.firData.state="copy",n.firData.funcObj=Proxy.copy,n.firData.func=Proxy.copy.sendGetAward;break;case 4:n.firData.state="copyTower",n.firData.funcObj=Proxy.copytower,n.firData.func=Proxy.copytower.gotoCopy,n.firData.out=!0;break;case 2:n.firData.funcObj=Proxy.copy,n.firData.func=Proxy.copy.sendGetAward;break;case 5:n.firData.state="exp",n.firData.funcObj=Proxy.copy,n.firData.func=PassMgr.switchGj;break;case 9:n.firData.funcObj=GameCache.pgtBoss,n.firData.func=GameCache.pgtBoss.takeAwd;break;case CopyType.FASHION:n.firData.state="copy",n.firData.funcObj=GameCache.copy,n.firData.func=GameCache.copy.exitFashionCopy;break;default:n.firData.funcObj=Proxy.copy,n.firData.func=Proxy.copy.sendGetAward}n.firData.itemArr=t;break;case AwardSourceType.SWEEP:n.firData.state="pass",n.firData.itemArr=t;break;case AwardSourceType.JINGJI:n.firData.func=GameCache.copy.exitCopy,n.firData.funcObj=GameCache.copy,n.firData.itemArr=t;break;case AwardSourceType.BOSS_PLUS:n.firData.state="boss",n.firData.func=GameCache.boss.recvAward,n.firData.funcObj=GameCache.boss,n.firData.itemArr1=t,n.firData.itemArr=[];break;case AwardSourceType.BOSS:n.firData.state="boss",n.firData.func=GameCache.boss.recvAward,n.firData.funcObj=GameCache.boss,n.firData.itemArr=t,n.firData.itemArr1=[];break;case AwardSourceType.OTHER:n.firData.state="pass",n.firData.itemArr=t,n.firData.func=PassMgr.switchGj}r?App.TimerManager.addDelay(1e3,1,1,App.ViewManager.open,App.ViewManager,null,null,ViewConst.AWARDTIPS,n):App.ViewManager.open(ViewConst.AWARDTIPS,n)}},e}(BaseClass);__reflect(AwardCache.prototype,"AwardCache");var AwardItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.itemName.textFlow=TextFlowUtils.generateTextFlow("<(c"+ColorUtil.C_COFFEE+")"+this.itemName.text+">")},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ItemBase);__reflect(AwardItem.prototype,"AwardItem");var AwardMgr=function(){function t(){}return t}();__reflect(AwardMgr.prototype,"AwardMgr");var AwardTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.outSt=0,e.skinName="AwardTipsSkin",e.closeDispose=!1,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=AwardItem,this.itemList_1.itemRenderer=AwardItem},e.prototype.open=function(t){t&&null!=t&&(this.outSt=0,this.firstData=t.firData,t.firData.state?this.currentState=t.firData.state:this.currentState="pass",t.firData.func&&(this.hander=Handler.create(t.firData.funcObj,t.firData.func,null,!1)),t.firData.out&&(this.outSt=1),this.countDown.text=StringUtils.substitute(Language.lang.autoTime,7),App.DisplayUtils.buttonDownTime(this.recvBtn,7,[this.countDown,Language.lang.autoTime]),this.addTouchEvent(this.recvBtn,this.closeView),this.addTouchEvent(this.actiBtn,this.out),this.initList(t.firData.itemArr),this.initState(t.firData))},e.prototype.close=function(e){t.prototype.close.call(this),2!=this.outSt&&this.recvFunc(),this.hander&&(this.hander.dispose(),this.hander=null)},e.prototype.initList=function(t){this.setListData(this.itemList,t)},e.prototype.out=function(){"copyTower"==this.currentState&&(1==this.outSt&&(this.outSt=2),Proxy.copy.sendQuit(GameCache.map.fbId),this.closeView(),App.ViewManager.openTab(ViewConst.COPY,1,0))},e.prototype.initState=function(t){if("boss"==this.currentState)this.gsImg.visible=!0,t.itemArr1?(this.itemList_1.visible=!0,this.setListData(this.itemList_1,t.itemArr1)):this.itemList_1.visible=!1;else if("copy"==this.currentState){var e=GameCache.copy.copyEvaData[this.firstData.fbid];this.eva.source="awardTips_json.awardTips_l_"+e+"_png"}},e.prototype.setList=function(t,e){this.gsImg.visible=!1,1==t?this.setListData(this.itemList_1,e):this.setListData(this.itemList,e)},e.prototype.recvFunc=function(){this.hander&&(this.hander.args=[this.firstData.fbid,0],this.hander.run())},e.prototype.resetHandler=function(t,e){this.hander&&this.hander.dispose(),this.hander=Handler.create(t,e)},e.prototype.setCopyId=function(t){this.firstData.fbid=t},e}(BaseEuiWindow);__reflect(AwardTips.prototype,"AwardTips");var AwardType;!function(t){t[t.ITEM=0]="ITEM",t[t.CREATE_HERO=41]="CREATE_HERO"}(AwardType||(AwardType={}));var AwardSourceType;!function(t){t[t.JINGJI=0]="JINGJI",t[t.COPY=1]="COPY",t[t.SWEEP=2]="SWEEP",t[t.BOSS=3]="BOSS",t[t.BOSS_PLUS=4]="BOSS_PLUS",t[t.OTHER=5]="OTHER"}(AwardSourceType||(AwardSourceType={}));var BadgeCache=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.clear=function(){},e.prototype.checkGrade=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_CHKPOINT_LV),e=GameCache.hero.mainPro.pro(PropId.AP_BADGE_LVL),i=GameConfig.badge[e+1];return i&&i.Checkpoint?t>i.Checkpoint:!1},e}(BaseCache);__reflect(BadgeCache.prototype,"BadgeCache");var BadgePage=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="BadgePageSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=new eui.TileLayout;e.orientation="row",e.requestedRowCount=2,e.horizontalGap=0,e.verticalGap=10,e.paddingLeft=12,this.propList.pG.layout=e,this.lNum.gap=23},e.red=function(){return GameCache.badge.checkGrade()},e.changeMsg=function(){return[MsgConst.PROPERTY+PropId.AP_BADGE_LVL,MsgConst.PROPERTY+PropId.AP_CHKPOINT_LV]},e.prototype.refreshRed=function(){this.redShow()},e.prototype.open=function(t){this.message(MsgConst.PROPERTY+PropId.AP_BADGE_LVL,this.initData),this.message(MsgConst.PROPERTY+PropId.AP_BADGE_LVL,this.showEff),this.addTouchEvent(this.btn0,this.upGradeFunc),this.initData()},e.prototype.initData=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_CHKPOINT_LV),e=GameCache.hero.mainPro.pro(PropId.AP_BADGE_LVL),i=GameConfig.badge[e],n=GameConfig.badge[e+1];if(n){this.propList.setData(i?i.attrs:[],n.attrs,0,16762368,16777215,65292,[],"PropItem3Skin"),this.btn0.visible=!0,this.cg.visible=!0;var o=t>n.Checkpoint?1:0;this.condi.textColor=t>n.Checkpoint?4122658:16711680,this.condi.text=StringUtils.substitute(Language.lang.badge_0[o],n.Checkpoint),this.lvlMax.visible=!1}else this.btn0.visible=!1,this.lvlMax.visible=!0,this.cg.visible=!1,this.img_1.visible=!1;this.initProgress(e)},e.prototype.initProgress=function(t){for(var e=GameConfig.badge[t],i=e?e.classLevel:0,n=e?e.starLevel:0,o=0;8>o;o++)this["item_"+o].source=n-1>=o?"badge_json.badge_item_sele_png":"badge_json.badge_item_unsele_png";this.icon.source=RES_DIR_BADGE+i+".png",this.lNum.value=i+"j",this.title.source=RES_DIR_BADGE+"n"+i+".png"},e.prototype.upGradeFunc=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_CHKPOINT_LV),e=GameCache.hero.mainPro.pro(PropId.AP_BADGE_LVL),i=GameConfig.badge[e+1];i&&i.Checkpoint?t>i.Checkpoint?Proxy.badge.sendBadgeUpGrade():GlobalFun.SysMsg(Language.lang.badgeNotEnough):GlobalFun.SysMsg(Language.lang.badgeMaxLvl)},e.prototype.redShow=function(){App.ViewManager.showRedPoint(this.btn0,GameCache.badge.checkGrade())},e.prototype.showEff=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_BADGE_LVL),e=GameConfig.badge[t],i=e?e.starLevel:1,n=this["item_"+(i-1)];App.DisplayUtils.addEffectToObj(this.itemGroup,"point2_0_1",1,n.x+30,n.y+30)},e}(BaseSpriteView);__reflect(BadgePage.prototype,"BadgePage");var BadgeProxy=function(t){function e(){return t.call(this,PacketTypes.BADGE)||this}return __extends(e,t),e.prototype.sendBadgeUpGrade=function(){var t=this.getBytes(2);this.sendToServer(t)},e}(BaseProxy);__reflect(BadgeProxy.prototype,"BadgeProxy");var BagCache=function(t){function e(){var e=t.call(this)||this;return e.newItenHintArr=[],e.equipNum=0,e.tempList=[],e.cdCheck=0,e.bagItems={},e.bagSeries={},e.itemZDL={},e.recycleArr={},e.roleKeepBag={},e.roleSuggestBag={},e.bagGridNum={},e}return __extends(e,t),e.prototype.clear=function(){this.bagItems={},this.bagSeries={},this.itemZDL={},this.recycleArr={},this.roleKeepBag={},this.roleSuggestBag={},this.newItenHintArr=[],this.equipNum=0,this.tempList=[],this.bagGridNum={}},e.prototype.initBagItems=function(t){if(this.bagItems){for(var e=0;e<t.length;e++){var i=t[e],n=i.bagType;n==BagType.BAG_TYPE_EQUIP&&this.equipNum++,this.bagSeries[i.series.toString()]=i,this.bagItems[n]?this.bagItems[n][i.stdItem.id]?this.bagItems[n][i.stdItem.id].push(this.bagSeries[i.series.toString()]):this.bagItems[n][i.stdItem.id]=[this.bagSeries[i.series.toString()]]:(this.bagItems[n]={},this.bagItems[n][i.stdItem.id]=[this.bagSeries[i.series.toString()]]);this.bagItems[n][i.stdItem.id].length}App.MessageCenter.dispatch(MsgConst.BAG_ITEM_NUM),this.autoRecycle()}},e.prototype.addItem=function(t){if(this.bagItems){var e=t.stdItem;if(e){var i=t.bagType;i==BagType.BAG_TYPE_EQUIP&&this.equipNum++,this.bagSeries[t.series.toString()]=t,this.bagItems[i]?this.bagItems[i][t.stdItem.id]?this.bagItems[i][t.stdItem.id].push(this.bagSeries[t.series.toString()]):this.bagItems[i][t.stdItem.id]=[this.bagSeries[t.series.toString()]]:(this.bagItems[i]={},this.bagItems[i][t.stdItem.id]=[this.bagSeries[t.series.toString()]]);this.bagItems[i][t.stdItem.id].length;ItemUtils.itemSuggestUse(t)&&(this.newItenHintArr.unshift(t),App.ViewManager.isShow(ViewConst.NEWITEM)||App.ViewManager.open(ViewConst.NEWITEM)),App.MessageCenter.dispatch(MsgConst.BAG_ITEM_NUM),App.MessageCenter.dispatch(MsgConst.BAG_ITEM_NUM+t.stdItem.id);var n=ItemUtils.getItemNamewithColor(e)+" x"+t.btCount;GlobalFun.SysMsg(StringUtils.substitute(Language.lang.huode,n),SysMessageType.CHAT_PANEL_RIGHT),this.autoRecycle()}}},e.prototype.getUserItemBySeries=function(t){return this.bagSeries[t.toString()]||null},e.prototype.changeItemCount=function(t,e){if(this.bagItems){var i,n=this.bagSeries[t.toString()];if(n){i=n.btCount,n.btCount=e;var o=n.stdItem,r=ItemUtils.getItemNamewithColor(o)+(" x"+(e-i));if(App.MessageCenter.dispatch(MsgConst.BAG_ITEM_NUM),App.MessageCenter.dispatch(MsgConst.BAG_ITEM_NUM+o.id),0>e-i)return;GlobalFun.SysMsg(StringUtils.substitute(Language.lang.huode,r),SysMessageType.CHAT_PANEL_RIGHT)}}},e.prototype.delItem=function(t){if(!this.bagItems)return null;var e=this.bagSeries[t.toString()];if(e){var i=e.bagType;i==BagType.BAG_TYPE_EQUIP&&this.equipNum--;for(var n=this.bagItems[i][e.stdItem.id],o=0;o<n.length;o++)n[o].series.isEquals(t)&&n.splice(o,1);ItemUtils.deleSuggest(e),delete this.bagSeries[t.toString()],this.recycleArr[t.toString()]&&delete this.recycleArr[t.toString()],App.MessageCenter.dispatch(MsgConst.BAG_ITEM_NUM),App.MessageCenter.dispatch(MsgConst.BAG_ITEM_NUM+e.stdItem.id)}},e.prototype.getItemBagType=function(t){return 0==t.type?0:ItemUtils.isEquip(t)?BagType.BAG_TYPE_EQUIP:BagType.BAG_TYPE_OTHER},e.prototype.itemCount=function(t,e){void 0===e&&(e=-1);var i,n=0;if("number"==typeof t||"string"==typeof t?i=GameConfig.item[t]:t instanceof UserItem?i=t.stdItem:t instanceof StdItem&&(i=t),i.id==GlobalVar.COIN)return GameCache.hero.mainPro.pro(PropId.AP_COIN);if(i.id==GlobalVar.GOLD)return GameCache.hero.mainPro.pro(PropId.AP_YUANBAO);0>e&&(e=i.bagtype);var o=e,r=this.bagItems[""+o];if(!r||!r[i.id])return 0;if(o==BagType.BAG_TYPE_EQUIP)n=r[i.id].length;else for(var a=0;a<r[i.id].length;a++){var s=r[i.id][a];n+=s.btCount}return n},e.prototype.getBagEnoughByCondtion=function(t){if(t instanceof Array){for(var e in t){var i=t[e];if(!i.id)return!1;if(this.itemCount(i.id)<i.count)return!1}return!0}return t.id&&this.itemCount(t.id)>=t.count?!0:!1},e.prototype.getBagByType=function(t){var e=[],i=this.bagItems[t];for(var n in i)e=e.concat(i[n]);return e},e.prototype.autoRecycle=function(){var t=GlobalFun.getRemindSet(0,SettingType.AUTO_RECYCLE),e=egret.getTimer();if(e-this.cdCheck<1e3)return void(App.TimerManager.isExists(this.autoRecycle,this)||App.TimerManager.addDelay(1100,1100,1,this.autoRecycle,this));if(this.cdCheck=e,!t){var i=this.bagGridNum[BagType.BAG_TYPE_EQUIP]?this.bagGridNum[BagType.BAG_TYPE_EQUIP]:0,n=Math.floor(i*GlobalVar.AUTO_RECYCLE_TRIGER),o=this.equipNum-n;if(o>0){var r=[];for(var a in GameCache.bag.recycleArr){if(0>=o)break;r.push(GameCache.bag.recycleArr[a]),o--}Proxy.bag.sendEquipRecycleBagItem(BagType.BAG_TYPE_EQUIP,r)}}},e.prototype.reFreshRecyle=function(){GameCache.bag.recycleArr={};for(var t=this.getBagByType(BagType.BAG_TYPE_EQUIP),e=0;e<t.length;e++){var i=t[e];ItemUtils.itemSuggestUse(i)&&(this.newItenHintArr.unshift(i),App.ViewManager.isShow(ViewConst.NEWITEM)||App.ViewManager.open(ViewConst.NEWITEM))}App.MessageCenter.dispatch(MsgConst.EQUIP_INFO)},e.prototype.checkRecycle=function(){var t=0;for(var e in this.recycleArr)if(t++,t>=1)break;return t>0},e}(BaseCache);__reflect(BagCache.prototype,"BagCache");var BagEquipPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="BagEquipPannelSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=ItemBase},e.red=function(){return GameCache.bag.checkRecycle()},e.changeMsg=function(){return[MsgConst.BAG_ITEM_NUM]},e.prototype.refreshRed=function(){this.redShow()},e.prototype.open=function(t){void 0===t&&(t=null),this.message(MsgConst.BAG_ITEM_NUM,this.reFreshBag),this.message(MsgConst.PROPERTY+PropId.AP_BAG_GRID_COUNT,this.initBag),this.initBag(),this.addTouchEvent(this.mBtn,function(){App.ViewManager.open(ViewConst.MELT)}),this.addTouchEvent(this.extendBtn,this.openExpand)},e.prototype.reFreshBag=function(){App.TimerManager.isExists(this.initBag,this)||App.TimerManager.addDelay(200,200,1,this.initBag,this)},e.prototype.initBag=function(){var t=GameCache.bag.getBagByType(BagType.BAG_TYPE_EQUIP),e=GameCache.bag.bagGridNum[BagType.BAG_TYPE_EQUIP];this.setListData(this.itemList,t),this.nTxt.text=t.length+"/"+e},e.prototype.openExpand=function(){App.ViewManager.open(ViewConst.BAGEXPAND)},e.prototype.redShow=function(){App.ViewManager.showRedPoint(this.mBtn,GameCache.bag.checkRecycle())},e}(BaseSpriteView);__reflect(BagEquipPannel.prototype,"BagEquipPannel");var BagExpand=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="BagExtendSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.numSele.skinName="NumSelectSkin",this.numSele.currentState="s2";var e=Handler.create(this,this.initPrice,[],!1);this.numSele._handler=e},e.prototype.open=function(t){this.addTouchEvent(this.btn,this.expandFunc),this.initData(),this.initPrice()},e.prototype.close=function(e){t.prototype.close.call(this)},e.prototype.initData=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_BAG_GRID_COUNT),e=GameConfig.bagStuff.maxEquip.value-(t-GameConfig.bagStuff.maxItem.value);this.numSele.initData(e,1,1)},e.prototype.initPrice=function(){var t=GameConfig.bagStuff.openCounsums.value.count*this.numSele.num;this.cost.setData(GlobalVar.GOLD,t)},e.prototype.expandFunc=function(){this.cost.isExpend&&Proxy.bag.sendExpandGrid(BagType.BAG_TYPE_EQUIP,this.numSele.num)},e}(BaseEuiWindow);__reflect(BagExpand.prototype,"BagExpand");var BagItemPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="BagItemPannelSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=ItemBase},e.prototype.open=function(t){void 0===t&&(t=null),this.message(MsgConst.BAG_ITEM_NUM,this.reFreshBag),this.initBag()},e.prototype.reFreshBag=function(){App.TimerManager.isExists(this.initBag,this)||App.TimerManager.addDelay(200,200,1,this.initBag,this)},e.prototype.initBag=function(){var t=GameCache.bag.getBagByType(BagType.BAG_TYPE_OTHER);this.setListData(this.itemList,t)},e}(BaseSpriteView);__reflect(BagItemPannel.prototype,"BagItemPannel");var BagProxy=function(t){function e(){var e=t.call(this,PacketTypes.BAG)||this;return e.regNetMsg(4,e.doQueryMyItem),e.regNetMsg(2,e.doAddItem),e.regNetMsg(1,e.doDeleteItem),e.regNetMsg(3,e.doItemCountChange),e.regNetMsg(45,e.doExpandGridData),e.regNetMsg(12,e.recycleItem),e}return __extends(e,t),e.prototype.doQueryMyItem=function(t){for(var e=t.readUnsignedByte(),i=t.readUnsignedShort(),n=t.readUnsignedShort(),o=[],r=0;n>r;r++){var a=new UserItem(t);a.sourceType=ItemSourceType.BAG,a.bagType=e,o.push(a)}o&&GameCache.bag.initBagItems(o),GameCache.bag.bagGridNum[e]=i,App.MessageCenter.dispatch(MsgConst.BAG_INFO)},e.prototype.doAddItem=function(t){var e=t.readUnsignedByte(),i=new UserItem(t);i.bagType=e,i.sourceType=ItemSourceType.BAG,GameCache.bag.addItem(i)},e.prototype.doDeleteItem=function(t){var e=(t.readUnsignedByte(),new ItemSeries(t));GameCache.bag.delItem(e)},e.prototype.recycleItem=function(t){for(var e=(t.readUnsignedByte(),t.readByte()),i=0;e>i;i++){var n=new ItemSeries(t);GameCache.bag.delItem(n)}App.MessageCenter.dispatch(MsgConst.BAG_RECYCLE)},e.prototype.doItemCountChange=function(t){var e=(t.readByte(),new ItemSeries(t)),i=t.readUnsignedShort();GameCache.bag.changeItemCount(e,i)},e.prototype.doExpandGridData=function(t){var e=new BackPackLockVO;t.readByte();e.freeNum=t.readByte(),e.leftTime=t.readInt(),e.allTime=t.readInt(),App.MessageCenter.dispatch(MsgConst.BAG_EXPAND)},e.prototype.sendQueryBagItem=function(t){var e=this.getBytes(2);e.writeByte(2),this.sendToServer(e)},e.prototype.sendDeleteBagItem=function(t,e){if(t){var i=this.getBytes(1);i.writeByte(e),t.writeToBytes(i),this.sendToServer(i)}},e.prototype.sendExpandGrid=function(t,e){var i=this.getBytes(4);i.writeByte(e),i.writeUnsignedShort(t)},e.prototype.sendDispart=function(t,e,i){var n=this.getBytes(5);n.writeByte(t),e.writeToBytes(n),n.writeUnsignedShort(i),this.sendToServer(n)},e.prototype.sendCombination=function(t,e,i){var n=this.getBytes(6);n.writeByte(t),e.writeToBytes(n),i.writeToBytes(n),this.sendToServer(n)},e.prototype.sendEquipRecycleBagItem=function(t,e){if(void 0===e&&(e=[]),e.length){var i=this.getBytes(11);i.writeByte(t),i.writeUnsignedShort(e.length);for(var n=0;n<e.length;n++)e[n].series.writeToBytes(i);this.sendToServer(i)}},e.prototype.sendItemUse=function(t,e){void 0===e&&(e=1);var i=this.getBytes(7),n=GameCache.hero.getServerIdByIndex(0);i.writeByte(t.stdItem.bagtype),t.series.writeToBytes(i),i.writeInt(n),this.sendToServer(i)},e.prototype.sendItemUsePlus=function(t,e,i){var n=this.getBytes(8);e.writeToBytes(n),n.writeUnsignedShort(i),this.sendToServer(n)},e}(BaseProxy);__reflect(BagProxy.prototype,"BagProxy");var BagRecycleWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.itemArr=[],e.recycleArr=[],e.skinName="BagRecycleWinSkin",e}return __extends(e,t),e.prototype.init=function(){},e.prototype.open=function(e){t.prototype.open.call(this),this.initData(),this.addTouchEvent(this.mBtn,this.meltFunc),this.addTouchEvent(this.toggle,this.AutoSwich),this.message(MsgConst.BAG_RECYCLE,this.recycleBack),this.toggle.selected=!GlobalFun.getRemindSet(0,SettingType.AUTO_RECYCLE)},e.prototype.close=function(e){t.prototype.close.call(this),this.itemArr=[]},e.prototype.initData=function(){for(var t=0,e=GameCache.bag.recycleArr,i=0;16>i;i++){var n=this["item_"+i];n.reSet()}for(var i in e){if(!(15>=t))break;this.itemArr.push(e[i]);var n=this["item_"+t];n.data=e[i],t++}},e.prototype.recycleBack=function(){this.initData(),App.DisplayUtils.addEffectToObj(this,"ronglian_0_1",1,218,260)},e.prototype.meltFunc=function(){Proxy.bag.sendEquipRecycleBagItem(BagType.BAG_TYPE_EQUIP,this.itemArr),this.cleanItem()},e.prototype.cleanItem=function(){for(var t=0;16>t;t++){var e=this["item_"+t];e.reSet()}this.itemArr=[]},e.prototype.AutoSwich=function(){GlobalFun.setRemindSet(0,!this.toggle.selected,SettingType.AUTO_RECYCLE),GameCache.bag.autoRecycle()},e}(BaseEuiWindow);__reflect(BagRecycleWin.prototype,"BagRecycleWin");var BagWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(){t.prototype.open.call(this)},e}(CommunalPageWin);__reflect(BagWin.prototype,"BagWin");var BackPackLockVO=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(BaseClass);__reflect(BackPackLockVO.prototype,"BackPackLockVO");var BagType=function(){function t(){}return t.TEMP_DEAL=0,t.TEMP_SELL_BUY=1,t.AUTO_USE_VALID_TIME=5e3,t.BAG_TYPE_ALL=0,t.BAG_TYPE_OTHER=1,t.BAG_TYPE_EQUIP=2,t.BAG_TYPE_PURGATORY=3,t.BAG_TYPE_JEWEL=4,t.MAX_BUYBACK_COUNT=10,t}();__reflect(BagType.prototype,"BagType");var BagUtils=function(){function t(){}return t.getMeltingEquip=function(t){void 0===t&&(t=6);var e=GameCache.bag.getBagByType(BagType.BAG_TYPE_EQUIP);for(var i in e)ItemUtils.isItemRecycle(e[i],t)
},t.bagEquipGridNum=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_BAG_GRID_COUNT),e=GameCache.bag.getBagByType(BagType.BAG_TYPE_EQUIP).length,i=t-GameConfig.bagStuff.maxItem.value-e;return 0>i?0:i},t.bagItemGridNum=function(){var t=GameConfig.bagStuff.maxItem.value,e=GameCache.bag.getBagByType(BagType.BAG_TYPE_OTHER).length,i=t-e;return 0>i?0:i},t.checkSpaceEnough=function(e){if(!e||0==e.length)return!0;for(var i={},n=0,o=0,r=0,a=e;r<a.length;r++){var s=a[r];i[s.id]?i[s.id]+=s.count:i[s.id]=s.count}for(var h in i){var p=GameConfig.item[h];if(ItemUtils.isEquip(p))n+=i[h];else if(ItemUtils.isNormalItem(p)){var l=GameCache.bag.itemCount(h),c=Math.floor(l/p.dup);l%p.dup>=1&&c++;var u=Math.floor((l+i[h])/p.dup);(l+i[h])%p.dup>=1&&u++,o+=u-c}}var d=t.bagEquipGridNum();if(n>d)return!1;var g=t.bagItemGridNum();return o>g?!1:!0},t}();__reflect(BagUtils.prototype,"BagUtils");var BuffCache=function(t){function e(){var e=t.call(this)||this;return e.data={},App.TimerManager.add(1e3,e.onTime,e),e}return __extends(e,t),e.prototype.clear=function(){this.data={}},e.prototype.getBuffList=function(t){return this.data[t]?this.data[t]:[]},e.prototype.onTime=function(){var t=App.TimerManager.getSyncTime(),e=!1;for(var i in this.data)for(var n=this.data[i],o=0,r=n.length;r>o;o++){var a=n[o];a.restTime>0&&a.restTime<=t&&(n.splice(o,1),o--,r--,e=!0)}e&&App.MessageCenter.dispatch(MsgConst.BUFF_UPDATE)},e.prototype.addBuff=function(t,e,i,n,o,r,a,s,h){var p=this.data[t];p||(p=this.data[t]=[]);for(var l=0,c=p.length,u=!1;c>l;l++){var d=p[l];if(n==d.group&&(!h||h==d.icon)){for(var g=0,f=d.attr.length;f>g;g++){var m=d.attr[g];if(m.type==i){m.value=a,u=!0;break}}if(!u&&h){var m=new BuffValue;m.type=i,m.value=a,m.interval=s,d.attr.push(m),u=!0}if(u)break}}if(!u){var d=new BuffVo;d.id=e,d.group=n,d.name=r,d.restTime=o,d.interval=s,d.icon=h;var m=new BuffValue;m.type=i,m.value=a,m.interval=s,d.attr.push(m),p.push(d)}App.MessageCenter.dispatch(MsgConst.BUFF_UPDATE,t)},e.prototype.delteBuff1=function(t,e,i){var n=this.data[t];if(n){for(var o=0,r=n.length,a=!1;r>o;o++){var s=n[o];if(s.group==i)for(var h=0,p=s.attr.length;p>h;h++){var l=s.attr[h];if(l.type==e){n.splice(o,1),a=!0;break}}if(a)break}App.MessageCenter.dispatch(MsgConst.BUFF_UPDATE,t)}},e.prototype.delteBuff2=function(t,e){var i=this.data[t];if(i){for(var n=0,o=i.length;o>n;n++){var r=i[n];if(r.id==e){i.splice(n,1);break}}App.MessageCenter.dispatch(MsgConst.BUFF_UPDATE,t)}},e.prototype.updateBuff=function(t,e,i){var n=this.data[t];if(n){for(var o=0,r=n.length;r>o;o++){var a=n[o];if(a.id==e)break}App.MessageCenter.dispatch(MsgConst.BUFF_UPDATE,t)}},e}(BaseCache);__reflect(BuffCache.prototype,"BuffCache");var BuffItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.icon.source=RES_DIR_BUFF_ICON+e.icon+".png",this.nameTx.text=e.name,App.TimerManager.removeAll(this),e.restTime>0?(App.TimerManager.add(1e3,this.onTimer,this),this.onTimer()):this.timeTx.text="",this.showAttr()},e.prototype.showAttr=function(){for(var t=this.data.attr,e=0,i=t.length,n=[];i>e;e++){var o=t[e],r=GameConfig.buffId[o.type];if(r){var a=void 0;isNaN(o.value)||(a=AttrBufId.formatValue(r.buffShowType,o.value)),r.specialBuff?n.push(StringUtils.substitute(r.specialBuff,TextFlowUtils.color(a,ColorUtil.C_BLUE),TextFlowUtils.color(o.interval,ColorUtil.C_BLUE))):n.push(r.attname+TextFlowUtils.color("+"+a,ColorUtil.C_BLUE))}}this.attrTx.textFlow=TextFlowUtils.generateTextFlow(n.join(", "))},e.prototype.onTimer=function(){var t=this.data.restTime-App.TimerManager.getSyncTime();0>t&&(t=0),this.timeTx.text=StringUtils.substitute(Language.lang.restTime,App.DateUtils.getFormatBySecond(t/1e3,DateUtils.TIME_FORMAT_1))},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),App.TimerManager.removeAll(this)},e}(BaseCustComponent);__reflect(BuffItem.prototype,"BuffItem");var BuffProxy=function(t){function e(){var e=t.call(this,PacketTypes.BUFF)||this;return e.regNetMsg(1,e.doAddBuff),e.regNetMsg(2,e.doDeleteBuff1),e.regNetMsg(3,e.doDeleteBuff2),e.regNetMsg(4,e.doUpdateBuff),e}return __extends(e,t),e.prototype.doAddBuff=function(t){var e=t.readDouble(),i=t.readUnsignedShort(),n=t.readUnsignedByte(),o=t.readUnsignedByte(),r=t.readInt(),a=t.readCustomBytes(),s=t.readNumeric(t.readUnsignedByte()),h=t.readUnsignedShort(),p=t.readUnsignedByte();r=0>=r?r:1e3*r+App.TimerManager.getSyncTime(),GameCache.buff.addBuff(e,i,n,o,r,a,s,h,p)},e.prototype.doDeleteBuff1=function(t){var e=t.readDouble(),i=t.readUnsignedByte(),n=t.readUnsignedByte();GameCache.buff.delteBuff1(e,i,n)},e.prototype.doDeleteBuff2=function(t){var e=t.readDouble(),i=t.readUnsignedByte();GameCache.buff.delteBuff2(e,i)},e.prototype.doUpdateBuff=function(t){t.readDouble(),t.readUnsignedByte(),t.readUnsignedInt()},e}(BaseProxy);__reflect(BuffProxy.prototype,"BuffProxy");var BuffWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="BuffViewSkin",e}return __extends(e,t),e.prototype.init=function(){this.list.itemRenderer=BuffItem,this.roleSelect.setHandler(this,this.roleClick),this.setWinTitle("buff")},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this,e),this.message(MsgConst.BUFF_UPDATE,this.onUpdate),this.onUpdate()},e.prototype.roleClick=function(){this.onUpdate()},e.prototype.onUpdate=function(t){var e=this.roleSelect.selectPro;t&&e.recog!=t||this.setListData(this.list,GameCache.buff.getBuffList(e.recog))},e}(BaseEuiWindow);__reflect(BuffWin.prototype,"BuffWin");var BuffVo=function(){function t(){this.attr=[]}return t}();__reflect(BuffVo.prototype,"BuffVo");var BuffValue=function(){function t(){}return t}();__reflect(BuffValue.prototype,"BuffValue");var ChatCache=function(t){function e(){var e=t.call(this)||this;return e.chatData={},e.previewChat=[],e.sysInfo=[],e.showOffList=[],e}return __extends(e,t),e.prototype.clear=function(){this.showOffList=[],this.chatData={},this.previewChat=[],this.sysInfo=[]},e.prototype.createItemLink=function(t){var e=GameConfig.item[t];if(e){var i=ItemUtils.getItemColor(e.showQuality),n="<(u)(c"+i+")(eitem:"+e.id+"_"+e.type+")"+e.name+">";return n}return""},e.prototype.createRoleLink=function(t,e,i){void 0===i&&(i=1);var n=ColorUtil.C_GREEN,o="<(u)(c"+n+")(erole:"+t+")"+e+">";return o},e.prototype.createCustomLink=function(t,e,i){return void 0===i&&(i=ColorUtil.GREEN),"<(u)(c"+i+")(e"+t+")"+e+">"},e.prototype.createServerText=function(t){for(var e=t.match(/\[(.+?)\]/g)||[],i=t,n=0;n<e.length;n++){var o=e[n].replace(/[\[\]]/g,"");switch(o[0]){case"#":var r=parseInt(o.slice(1)),a="<(s"+GlobalVar.EMOJI_SIZE+")(p0_"+r+")　>";i=i.replace(e[n],a);break;default:for(var s=0,h=this.showOffList;s<h.length;s++){var p=h[s];if(p.name==o){var l=ItemUtils.getItemColor(p.showQuality),c="<(u)(c"+l+")(eitem:"+p.id+"_"+p.type+")"+p.name+">";i=i.replace(e[n],c)}}}}return i},e.prototype.showOffItem=function(t){this.showOffList.push(t);var e="["+t.name+"]",i=new ViewProp;i.exData1={},i.exData1.showOff=e,App.ViewManager.isShow(ViewConst.CHAT)?App.MessageCenter.dispatch(MsgConst.CHAT_SHOWOFF,e):App.ViewManager.open(ViewConst.CHAT,i)},e.prototype.initChatData=function(t,e,i,n,o,r,a,s){var h={channelId:t,playerName:e,playerId:i,sexual:n,job:o,lvl:r,viplvl:a,message:s};this.chatData[t]||(this.chatData[t]=[]),this.chatData[t].push(h),t!=ChatType.SYSTEM&&(this.previewChat.length<3?this.previewChat.push(h):(this.previewChat.shift(),this.previewChat.push(h)),App.MessageCenter.dispatch(MsgConst.CHAT_INFO,h))},e.prototype.getPrevireChat=function(t){for(var e="",i=this.previewChat.length,n=0;i>n;n++){var o=this.initChatMsg(this.previewChat[n]);e+=i-1>n?o+"\n":o}t.textFlow=TextFlowUtils.generateTextFlow(e),t.textHeight,t.linesArr.length>2&&(t.y=t.parent.height-t.height>=0?1:t.parent.height-t.height-1),TextFlowUtils.generateEmoji(t,t.parent,!0)},e.prototype.initChatMsg=function(t){var e="<(s16)(p1_"+t.channelId+"_18_35)·  · · · >",i="<(c"+GlobalVar.CHAT_COLOR[t.channelId]+")"+t.playerName+" : >";return e+i+t.message},e.prototype.getSysMessage=function(t){var e=GameCache.chat.sysInfo[GameCache.chat.sysInfo.length-1];t.textFlow=TextFlowUtils.generateTextFlow(e),TextFlowUtils.generateEmoji(t,t.parent,!0)},e.prototype.addSysMsg=function(t,e){void 0===e&&(e=ChatType.SYSTEM),this.sysInfo.length>20&&this.sysInfo.shift();var i="<(s16)(p1_"+e+"_18_35)·  · · · >",n=i+t;this.sysInfo.push(n),App.MessageCenter.dispatch(MsgConst.SYS_INFO_MESSAGE,n)},e}(BaseCache);__reflect(ChatCache.prototype,"ChatCache");var ChatMgr=function(t){function e(){var e=t.call(this)||this;return e.carouselIndex=0,e.sceneCenter=new SystemTextTips,e.tipsPopupMgr=new TipsPopupMgr,e.barrageTips=new BarrageTips,e}return __extends(e,t),e.prototype.init=function(){App.TimerManager.removeAll(this),this.playCarousel(!0)},e.prototype.playCarousel=function(t){void 0===t&&(t=!1),this.carouselIndex++;var e=GameConfig.carousel[1][t?"first":"interval"];e||(e=[10,10]);var i=1e3*MathUtils.limitInteger(e[0],e[1]);if(App.TimerManager.addDelay(i,1,1,this.playCarousel,this),!t){var n=GameConfig.carousel[this.carouselIndex];n||(this.carouselIndex=1,n=GameConfig.carousel[this.carouselIndex]),n&&this.doMessage(n.dec,SysMessageType.SYSTEM_BARRAGE)}},e.prototype.doMessage=function(t,e){switch(e){case SysMessageType.CHAT_PANEL_RIGHT:this.tipsPopupMgr.pushStr(t);break;case SysMessageType.SYSTEM_SCENE_CENTER:this.sceneCenter.text=t,!this.sceneCenter.parent&&LayerManager.UI_Message.addChild(this.sceneCenter);break;case SysMessageType.SYSTEM_BARRAGE:this.barrageTips.push(t),GameCache.chat.addSysMsg(t);break;case SysMessageType.SYSTEM_BARRAGE_NOW:this.barrageTips.push(t,!0),GameCache.chat.addSysMsg(t)}},e.chechIsGMMsg=function(t){var e=!0,i=t.split(" ");switch(i[0]){case"@@":App.ViewManager.open(ViewConst.DEBUG);break;case"@openWin":App.ViewManager.toggle(i[1]);break;case"@AddItem":Proxy.chat.sendChatMessage(1,t,!1);break;case"@change":break;case"@herosay":var n=GameCache.hero.focusPlayer;n.say(i[1],5e4);break;case"@barrage":GlobalFun.SysMsg(i[1],SysMessageType.SYSTEM_BARRAGE);break;case"@SkillEdit":DeBugMgr.skillEffEdit(),GlobalVar.testSkill=!0,App.gameWorld.drawCell(),App.ViewManager.close(ViewConst.DEBUG);break;case"@hz":var o=GameCache.hero.mainPro;o.pro(parseInt(i[1]),parseInt(i[2]),GameCache.hero.focusPlayer);break;case"@action":n=GameCache.hero.focusPlayer,n.playAction(parseInt(i[1]),parseInt(i[2]));break;case"@root":App.BattleManager.test();break;case"@usSkill":App.FightManager.setUseSKill(parseInt(i[1]),!0);break;case"@drop":App.ThingManager.addDropList([{id:15},{id:16},{id:17},{id:18},{id:19}]);break;case"@setCellXY":GameCache.hero.setPosition(parseInt(i[1]),parseInt(i[2]));break;case"@AddEqSet":for(var r=110;119>=r;r++)Proxy.chat.sendChatMessage(1,"@AddItem "+r+" 1",!1);break;case"@AddAESet":for(var r=940;949>=r;r++)Proxy.chat.sendChatMessage(1,"@AddItem "+r+" 1",!1);break;case"@oneWearOn":break;case"@guide":GameCache.novice.playGuide(i[1]);break;case"@debugDragon":App.ViewManager.open(ViewConst.DEBUGDRAGON);break;case"@emojiSize":GlobalVar.EMOJI_SIZE=parseInt(i[1]),GlobalFun.SysMsg("DONE！");break;case"@copyUrl":SysUtils.copyToPasteBoard(OperatorEgret.urlList.join(","));case"@winCon":GlobalVar.OPEN_ALL_WIN=!GlobalVar.OPEN_ALL_WIN,App.MessageCenter.dispatch(MsgConst.SERVER_TIME_CHANGE);break;default:t.indexOf("@")>=0?Proxy.chat.sendChatMessage(1,t,!1):e=!1}return e},e}(BaseClass);__reflect(ChatMgr.prototype,"ChatMgr");var ChatProxy=function(t){function e(){var e=t.call(this,PacketTypes.CHAT)||this;return e.regNetMsg(1,e.doGetChatMessage),e.regNetMsg(8,e.doErrorMessage),e.regNetMsg(2,e.doSysInfo),e.regNetMsg(9,e.doSysNotice),e}return __extends(e,t),e.prototype.doGetChatMessage=function(t){var e=t.readByte(),i=t.readCustomBytes(),n=t.readUnsignedInt(),o=t.readByte(),r=t.readByte(),a=t.readInt(),s=t.readByte(),h=t.readCustomBytes();GameCache.chat.initChatData(e,i,n,o,r,a,s,h)},e.prototype.doErrorMessage=function(t){var e=t.readInt();e&&GameConfig.errotips[e]&&GlobalFun.SysMsg(GameConfig.errotips[e].dec)},e.prototype.doSysInfo=function(t){t.readCustomBytes()},e.prototype.doSysNotice=function(t){var e=t.readUnsignedShort(),i=t.readUnsignedShort(),n=GameConfig.brocast[e];if(n){var o=n.desc,r=[];0==i||(1==i?r.push(this.getNoticeRoleInfo(t)):2==i?(r.push(this.getNoticeRoleInfo(t)),r.push(this.getNoticeBossInfo(t))):3==i?(r.push(this.getNoticeRoleInfo(t)),r.push(this.getNoticeItemInfo(t))):4==i?(r.push(this.getNoticeRoleInfo(t)),r.push(this.getNoticeBossInfo(t)),r.push(this.getNoticeItemInfo(t))):5==i&&r.push(this.getNoticeBossInfo(t)));var a=StringUtils.substitute(o,r);GlobalFun.SysMsg(a,SysMessageType.SYSTEM_BARRAGE)}},e.prototype.getNoticeRoleInfo=function(t){var e=t.readUnsignedInt(),i=t.readUnsignedByte(),n=t.readCustomBytes();return GameCache.chat.createRoleLink(e,n,i)},e.prototype.getNoticeBossInfo=function(t){var e=t.readUnsignedShort(),i=GameConfig.monster[e];return i?i.name:""},e.prototype.getNoticeItemInfo=function(t){for(var e=t.readUnsignedShort(),i=[];e>0;)i.push(GameCache.chat.createItemLink(t.readUnsignedShort())),e--;return i.join(",")},e.prototype.sendChatMessage=function(t,e,i){if(void 0===t&&(t=1),void 0===e&&(e=""),void 0===i&&(i=!0),""!=e){var n=this.getBytes(1);n.writeByte(t),n.writeString(e),this.sendToServer(n)}},e}(BaseProxy);__reflect(ChatProxy.prototype,"ChatProxy");var ChatSysItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ChatSysItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEvent(egret.TextEvent.LINK,this.chatLab,this.onLink)},e.prototype.onLink=function(t){var e=t.text;TextFlowUtils.hrefType(e)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.chatLab.textFlow=TextFlowUtils.generateTextFlow(e),TextFlowUtils.generateEmoji(this.chatLab,this.g,!0)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(ChatSysItem.prototype,"ChatSysItem");var ChatWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Main)||this;return e.toggle=!1,e.skinName="ChatWinSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.left=this.right=this.top=this.bottom=0,this.chatLab.itemRenderer=MsgItem,this.inputText.maxChars=GameConfig.globalConfig.enterLimit},e.prototype.open=function(e){t.prototype.open.call(this),this.addTouchEvent(this.emojiBtn,this.openEmoji),this.addTouchEvent(this.tabBtn,this.initChatMsg),this.addTouchEvent(this.sendBtn,this.sendText),this.addTouchEvent(this.closeGroup,this.closeView),this.message(MsgConst.CHAT_INFO,this.addChatMsg),this.message(MsgConst.CHAT_SHOWOFF,this.checkShowOffList),this.message(MsgConst.SYS_INFO_MESSAGE,this.addSysChatMsg),this.inputText.prompt=Language.lang.chat_1,e&&e.exData1&&e.exData1.showOff&&this.checkShowOffList(e.exData1.showOff),this.tabBtn.selectedIndex=e?e.exData2:1,this.initChatMsg()},e.prototype.close=function(e){t.prototype.close.call(this),GameCache.chat.showOffList=[],this.inputText.text=""},e.prototype.changeState=function(){this.currentState=0==this.tabBtn.selectedIndex?"sys":"nor",this.chatLab.itemRenderer=0==this.tabBtn.selectedIndex?ChatSysItem:MsgItem},e.prototype.checkShowOffList=function(t){this.inputText.text+=t},e.prototype.openEmoji=function(){if(App.ViewManager.isShow(ViewConst.EMOJI))App.ViewManager.close(ViewConst.EMOJI);else{var t=new ViewProp;t.exData1={},t.exData1.func=this.emojiClick,t.exData1.thisc=this,App.ViewManager.open(ViewConst.EMOJI,t)}},e.prototype.emojiClick=function(t){var e=StringUtils.substitute(Language.lang.chat_0,t);this.inputText.text+="["+e+"]"},e.prototype.sendText=function(){if(!ChatMgr.chechIsGMMsg(this.inputText.text)){var t=GameCache.chat.createServerText(this.inputText.text),e=this.tabBtn.selectedIndex;e!=ChatType.SYSTEM&&(Proxy.chat.sendChatMessage(e,t),this.inputText.text=null)}},e.prototype.initChatMsg=function(){this.changeState();var t,e=this.tabBtn.selectedIndex;t=0==e?GameCache.chat.sysInfo.concat():GameCache.chat.chatData[e]?GameCache.chat.chatData[e].concat():[],this.toggle=!0,this.setListData(this.chatLab,t),this.chatLab.validateNow(),this.autoScroll(!0)},e.prototype.addChatMsg=function(t){t.channelId==this.tabBtn.selectedIndex&&(this.toggle=!0,this.chatLab.dataProvider.addItem(t),this.chatLab.validateNow(),this.autoScroll())},e.prototype.addSysChatMsg=function(t){ChatType.SYSTEM==this.tabBtn.selectedIndex&&(this.toggle=!0,this.chatLab.dataProvider.addItem(t),this.chatLab.validateNow(),this.autoScroll())},e.prototype.autoScroll=function(t){void 0===t&&(t=!1);var e=this.sc.viewport,i=e.contentHeight-e.height;i=0>i?0:i+6,(t||i-e.scrollV<130&&i>0)&&(e.scrollV=i)},e}(BaseEuiWindow);__reflect(ChatWin.prototype,"ChatWin");var EmojiPart=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="EmojiPartSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){t.prototype.open.call(this),this.addEvent(eui.ItemTapEvent.ITEM_TAP,this.itemList,this.onCLick),e&&e.exData1&&e.exData1.func&&(this.handler&&this.handler.dispose(),this.handler=Handler.create(e.exData1.thisc,e.exData1.func,[],!1),this.initList())},e.prototype.close=function(e){t.prototype.close.call(this),this.setListData(this.itemList,[]),this.handler&&(this.handler.dispose(),this.handler=null)},e.prototype.initList=function(){for(var t=[],e=0;21>e;e++){var i={src:"emoji_json.emoji_"+e+"_png"};t.push(i)}this.setListData(this.itemList,t)},e.prototype.onCLick=function(t){var e=t.itemIndex;this.handler&&(this.handler.args=[e],this.handler.run())},e}(BaseEuiWindow);__reflect(EmojiPart.prototype,"EmojiPart");var MsgItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data.message){this.t0.removeEventListener(egret.TextEvent.LINK,this.onLink,this),this.t0.addEventListener(egret.TextEvent.LINK,this.onLink,this),this.skinName=this.data.playerId==GameCache.hero.mainPro.pro(PropId.AP_ACTOR_ID)?"MsgItem2Skin":"MsgItemSkin",this.roleName.text=this.data.playerName,this.icon.source=GlobalFun.getRoleIcon(this.data.job,this.data.sexual),this.lvl.text=this.data.lvl;var e=this.data.viplvl?this.data.viplvl:0;this.vip.source="chat_json.chat_vip_"+e+"_png",this.t0.textFlow=TextFlowUtils.generateTextFlow(this.data.message),App.FrameHandler.add(this.printEmoji,this,!0)}},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.t0.removeEventListener(egret.TextEvent.LINK,this.onLink,this)},e.prototype.printEmoji=function(){TextFlowUtils.generateEmoji(this.t0,this.g,!0)},e.prototype.onLink=function(t){var e=t.text;TextFlowUtils.hrefType(e)},e}(BaseCustComponent);__reflect(MsgItem.prototype,"MsgItem");var ChatType;!function(t){t[t.SYSTEM=0]="SYSTEM",t[t.WORLD=1]="WORLD",t[t.GUILD=2]="GUILD",t[t.CS=3]="CS"}(ChatType||(ChatType={}));var SysMessageType;!function(t){t[t.CHAT_PANEL_RIGHT=1]="CHAT_PANEL_RIGHT",t[t.SYSTEM_SCENE_CENTER=2]="SYSTEM_SCENE_CENTER",t[t.CHAT_PANEL_SYS=3]="CHAT_PANEL_SYS",t[t.SYSTEM_BARRAGE=4]="SYSTEM_BARRAGE",t[t.SYSTEM_BARRAGE_NOW=5]="SYSTEM_BARRAGE_NOW",t[t.length=6]="length"}(SysMessageType||(SysMessageType={}));var CopyCache=function(t){function e(){var e=t.call(this)||this;return e.buffBuy=[0,0],e.recordItemArr=[],e.copyData={},e.copyEvaData={},e.copyTime={},e.copyExpData={},e.copyExpBuyData={},e.copyBuyData={},e.fashionCopyData={},e}return __extends(e,t),e.prototype.clear=function(){this.copyData={},this.copyEvaData={},this.copyTime={},this.buffBuy=[0,0],this.copyExpData={},this.copyExpBuyData={},this.copyBuyData={},this.fashionCopyData={},this.recordItemArr=[]},e.prototype.initCopyData=function(t,e,i,n,o){if(this.copyData[t])this.copyData[t].enter=e,this.copyData[t].free=i,this.copyData[t].sweep=n;else{var r=GameConfig.fuben[t],a={id:t,enter:e,totalLimit:o,free:i,freeTimes:0,sweep:n,consumeTimes:0,consumes:{}};if(r.enterCfg)for(var s in r.enterCfg[0])a[s]=r.enterCfg[0][s];this.copyData[t]=a}},e.prototype.getCopyData=function(t){return this.copyData[t]||null},e.prototype.initCopyEvaData=function(t,e){var i,n=GameConfig.fuben[t],o=0;switch(n.type){case CopyType.MATERIAL:i=GameConfig.copyMaterials[t],o=i.score[e-1];break;case CopyType.FASHION:i=GameConfig.fashionCopy[t],o=i.score[e-1]}this.copyEvaData[t]=o},e.prototype.openExitTips=function(t,e){if(void 0===t&&(t=!1),t)return void this.exitCopy();var i=new ViewProp,n={},o=GameCache.map.fbId,r=GameConfig.fuben[o];e=e?e:r.exitDec,n.desc=e?e:Language.lang.copyExit,n.thisc=this,n.func=this.exitCopy,i.exData1=n,App.ViewManager.open(ViewConst.SYSTIPS,i)},e.prototype.exitCopy=function(){Proxy.copy.sendQuit(GameCache.map.fbId)},e.prototype.getCopyExpId=function(){var t,e=GameCache.hero.mainPro.pro(PropId.AP_LEVEL),i=GameConfig.copyExp,n=0;for(var o in i)if(e<=i[o].level[1]&&e>=i[o].level[0]){n=i[o].fubenId,t=o;break}if(0==n){var r=Object.keys(i).length;n=i[r].fubenId,t=r}return[t,n]},e.prototype.getCopyExpBuyData=function(){var t=this.copyExpBuyData?this.copyExpBuyData.boughtCount:0,e=GameCache.vip.realValue(),i=GameConfig.vip[e],n=GameConfig.vip[e+1]?GameConfig.vip[e+1]:i,o=i.expCopy,r=n.expCopy;return[o,t,r]},e.prototype.saveCopyEnterBuy=function(t,e,i){var n=GameConfig.fuben[t];switch(n.type){case CopyType.FASHION:this.copyBuyData[GameConfig.globalConfig.fashionCopyId]={enterCount:e,boughtCount:i};break;default:GameCache.copy.copyBuyData[t]={enableCount:e,boughtCount:i}}App.MessageCenter.dispatch(MsgConst.COPY_COUNT)},e.prototype.enterCopyExp=function(){var t=this.getCopyExpId()[1];Proxy.copy.sendEnterFB(t)},e.prototype.openPassRank=function(t,e){var i=new ViewProp;i.exData1={},i.exData1.title="passRank",i.exData1.myRank=t,i.exData1.myValue=GameCache.hero.mainPro.pro(PropId.AP_CHKPOINT_LV)-1,i.exData1.listData=e,App.ViewManager.open(ViewConst.RANKB,i)},e.prototype.getFashionCopyBuyData=function(){var t=GameConfig.globalConfig.fashionCopyId,e=this.copyBuyData[t]?this.copyBuyData[t].boughtCount:0,i=GameCache.vip.realValue(),n=GameConfig.vip[i],o=GameConfig.vip[i+1]?GameConfig.vip[i+1]:n,r=n.fashionCopyBuyNum,a=o.fashionCopyBuyNum;return[r,e,a]},e.prototype.checkMaterial=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_LEVEL),e=GameConfig.copyMaterials;for(var i in e){var n=e[i],o=GameCache.copy.getCopyData(i);if(!(n.level>t)){if(!o)return!0;if(o.free)return!0}}return!1},e.prototype.checkCopyExp=function(){var t=GameCache.copy.getCopyExpId(),e=GameConfig.copyExp[t[0]],i=t[1],n=GameConfig.fuben[i],o=this.copyExpBuyData?this.copyExpBuyData:null,r=o&&o.boughtCount?o.boughtCount:0,a=o&&o.enterCount?o.enterCount:0,s=r+n.enterCfg[0].freeTimes-a;if(0>=s)return!1;var h=GameCache.bag.itemCount(e.consume[0].id);return h>=e.consume[0].count},e.prototype.exitFashionCopy=function(){this.recordItemArr=[],PassMgr.switchGj(!0)},e}(BaseCache);__reflect(CopyCache.prototype,"CopyCache");var CopyProxy=function(t){function e(){var e=t.call(this,PacketTypes.COPY)||this;return e.regNetMsg(5,e.doCopyTime),e.regNetMsg(11,e.doCopyEnterCount),e.regNetMsg(12,e.doSingleCopyEnterCount),e.regNetMsg(15,e.doRecvAward),e.regNetMsg(20,e.doPassClean),e.regNetMsg(23,e.doCopyEvaluation),e.regNetMsg(27,e.doSweepPrint),e.regNetMsg(28,e.doBuffCount),e.regNetMsg(29,e.doCopyExpTime),e.regNetMsg(30,e.doCopyExpWave),e.regNetMsg(31,e.doExpIncome),e.regNetMsg(32,e.doExpAward),e.regNetMsg(33,e.doPassRank),e.regNetMsg(34,e.doCopyBuyInfo),e.regNetMsg(35,e.doFashionCopyInfo),e.regNetMsg(36,e.doCopyEnterBuy),e}return __extends(e,t),e.prototype.doCopyTime=function(t){var e=t.readUnsignedShort(),i=t.readInt();i=1e3*i+GameCache.server.serverTime,GameCache.copy.copyTime[e]=i,App.MessageCenter.dispatch(MsgConst.COPY_TIME)},e.prototype.doCopyEnterCount=function(t){for(var e=t.readUnsignedShort(),i=0;e>i;i++){var n=t.readUnsignedShort(),o=t.readByte(),r=t.readByte(),a=t.readUnsignedByte(),s=t.readUnsignedByte();GameCache.copy.initCopyData(n,o,a,s,r)}App.MessageCenter.dispatch(MsgConst.COPY_COUNT)},e.prototype.doSingleCopyEnterCount=function(t){var e=t.readUnsignedShort(),i=t.readByte(),n=t.readUnsignedByte(),o=t.readUnsignedByte();GameCache.copy.initCopyData(e,i,n,o),App.MessageCenter.dispatch(MsgConst.COPY_COUNT)},e.prototype.doRecvAward=function(t){for(var e=t.readInt(),i=t.readByte(),n=[],o=0;i>o;o++){var r=new QuestAward;r.type=t.readByte(),r.id=t.readInt(),r.count=t.readInt(),n.push(r)}GameCache.award.openAwardTips(n,AwardSourceType.COPY,e)},e.prototype.doPassClean=function(t){var e=t.readInt(),i=0==t.readByte();if(i||GlobalVar.autoOpenGroup.push([ViewConst.FAIL]),GlobalVar.PASSBOSS_SCENE==GameCache.map.mapId){var n=GameCache.hero.mainPro.pro(PropId.AP_CHKPOINT_LV);GameCache.pass.updateLv(n+1)}var o=GameConfig.fuben[e];o.type==CopyType.FASHION&&(GameCache.copy.fashionCopyData[e]={id:e,acti:i},i?GameCache.award.openAwardTips(GameCache.copy.recordItemArr,AwardSourceType.COPY,e):GameCache.copy.recordItemArr=[])},e.prototype.doCopyEvaluation=function(t){var e=t.readUnsignedShort(),i=t.readByte();GameCache.copy.initCopyEvaData(e,i),App.MessageCenter.dispatch(MsgConst.COPY_EVALUATION,i,e)},e.prototype.doSweepPrint=function(t){for(var e=t.readUnsignedShort(),i=[],n=0;e>n;n++){var o=(t.readByte(),t.readUnsignedShort()),r=t.readUnsignedShort();i.push([o,r])}GameCache.award.openAwardTips(i,AwardSourceType.SWEEP)},e.prototype.doBuffCount=function(t){var e=t.readByte(),i=t.readByte();GameCache.copy.buffBuy=[e,i],App.MessageCenter.dispatch(MsgConst.COPY_BUFF_COUNT)},e.prototype.doCopyExpTime=function(t){var e=t.readUnsignedShort(),i=t.readUnsignedShort(),n=1e3*(e+i)+GameCache.server.serverTime,o=i;i=1e3*i+GameCache.server.serverTime,e=1e3*e+GameCache.server.serverTime,GameCache.copy.copyExpData.time=[e,i,n,o],App.MessageCenter.dispatch(MsgConst.COPY_EXP_TIME)},e.prototype.doCopyExpWave=function(t){var e=t.readUnsignedShort(),i=t.readUnsignedShort();GameCache.copy.copyExpData.wave=[e,i],App.MessageCenter.dispatch(MsgConst.COPY_EXP_WAVE)},e.prototype.doExpIncome=function(t){var e=t.readUnsignedInt(),i=t.readUnsignedInt();GameCache.copy.copyExpData.exp=[e],GameCache.copy.copyExpData.killCount=i,App.MessageCenter.dispatch(MsgConst.COPY_EXP_INCOME)},e.prototype.doExpAward=function(t){var e=t.readUnsignedInt();GlobalFun.SysMsg("总收获"+e+"点经验")},e.prototype.doPassRank=function(t){for(var e=t.readUnsignedByte(),i=t.readUnsignedByte(),n=[],o=0;i>o;o++){var r=t.readUnsignedByte(),a=t.readUnsignedShort(),s=t.readCustomBytes(),h={rank:r,value:a,roleName:s};n.push(h)}var p=GameCache.hero.mainPro.pro(PropId.AP_CHKPOINT_LV)-1;App.MessageCenter.dispatch(MsgConst.PASS_RANK_INFO,n,e,p)},e.prototype.doCopyBuyInfo=function(t){var e=t.readUnsignedByte(),i=t.readUnsignedByte();GameCache.copy.copyExpBuyData={enterCount:e,boughtCount:i},App.MessageCenter.dispatch(MsgConst.COPY_COUNT)},e.prototype.doFashionCopyInfo=function(t){var e=t.readUnsignedByte(),i=t.readUnsignedByte();GameCache.copy.saveCopyEnterBuy(GameConfig.globalConfig.fashionCopyId,e,i);for(var n=t.readUnsignedShort(),o=0;n>o;o++){var r=t.readUnsignedInt(),a=t.readUnsignedByte();GameCache.copy.fashionCopyData[r]={id:r,acti:0==a}}App.MessageCenter.dispatch(MsgConst.FASHION_COPY)},e.prototype.doCopyEnterBuy=function(t){var e=t.readUnsignedByte(),i=t.readUnsignedByte(),n=t.readUnsignedShort();GameCache.copy.saveCopyEnterBuy(n,e,i)},e.prototype.sendEnterFB=function(t){var e=this.getBytes(8);e.writeInt(t),this.sendToServer(e)},e.prototype.sendQuit=function(t){var e=this.getBytes(10);e.writeInt(t),this.sendToServer(e)},e.prototype.sendPassEnter=function(){var t=this.getBytes(20);t.writeByte(GameCache.hero.list.length);for(var e=0;e<GameCache.hero.list.length;e++){var i=GameCache.hero.list[e];t.writeByte(GameCache.hero.getServerIdByIndex(e)),t.writeShort(i.cellXY.x),t.writeShort(i.cellXY.y)}this.sendToServer(t)},e.prototype.sendGetAward=function(t,e){void 0===e&&(e=0);var i=this.getBytes(15);i.writeInt(t),i.writeByte(e),this.sendToServer(i)},e.prototype.sendSweep=function(t,e){void 0===e&&(e=0);var i=this.getBytes(27);i.writeUnsignedShort(t),i.writeByte(e),this.sendToServer(i)},e.prototype.sendBuyBuff=function(t){var e=this.getBytes(28);e.writeByte(t),this.sendToServer(e)},e.prototype.sendPassRank=function(t){var e=this.getBytes(29);t=t?t:GameConfig.globalConfig.nRankingListMaxSize,e.writeByte(t),this.sendToServer(e)},e.prototype.sendCopyExpBuy=function(){var t=this.getBytes(30);this.sendToServer(t)},e.prototype.sendCopyEnterBuy=function(t){var e=this.getBytes(31);e.writeUnsignedShort(t),this.sendToServer(e)},e}(BaseProxy);__reflect(CopyProxy.prototype,"CopyProxy");var CopyType;!function(t){t[t.PASS=1]="PASS",t[t.GRBOSS=2]="GRBOSS",t[t.MATERIAL=3]="MATERIAL",t[t.TOWER=4]="TOWER",t[t.EXP=5]="EXP",t[t.JINGJI=6]="JINGJI",t[t.VIPBOSS=7]="VIPBOSS",t[t.PURGATORY=9]="PURGATORY",t[t.FASHION=10]="FASHION"}(CopyType||(CopyType={}));var CopyWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this)},e}(CommunalPageWin);__reflect(CopyWin.prototype,"CopyWin");var SceneType;!function(t){t[t.WORLD_BOSS=1]="WORLD_BOSS",t[t.GUA_JI=2]="GUA_JI",t[t.NORMAL_FIELD=3]="NORMAL_FIELD",t[t.PERSONAL_BOSS=4]="PERSONAL_BOSS",t[t.MATERIAL_COPY=5]="MATERIAL_COPY",t[t.TOWER=6]="TOWER",t[t.EXP_COPY=7]="EXP_COPY",t[t.ARENA=8]="ARENA",t[t.VIP_BOSS=9]="VIP_BOSS",t[t.PURRGATORY_BOSS=10]="PURRGATORY_BOSS",t[t.FASHION=11]="FASHION"}(SceneType||(SceneType={}));var CopyExpBuff=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="CopyExpBuffSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=CopyExpBuffItem},e.prototype.open=function(e){t.prototype.open.call(this)},e.prototype.close=function(e){t.prototype.close.call(this)},e}(BaseEuiWindow);__reflect(CopyExpBuff.prototype,"CopyExpBuff");var CopyExpBuffBuy=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.toggle=0,e.skinName="CopyExpBuyBuffSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.num.gap=15},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.COPY_BUFF_COUNT,this.initCount),this.addTouchEvent(this.g1,this.onTouche),this.addTouchEvent(this.g0,this.onTouche),this.addTouchEvent(this.buyBtn,this.buyFunc),this.initCount(),this.onTouche(),this.bg.setNameImg("inspire");var i=GameConfig.globalConfig;this.cost_0.text=StringUtils.substitute(Language.lang.inspire_1,i.coinInspireConsume),this.cost_1.text=StringUtils.substitute(Language.lang.inspire_1,i.goldInspireConsume),this.num.value="10%"},e.prototype.onTouche=function(t){var e=t?parseInt(t.target.name):0;this.toggle=e,this.sele_0.visible=0==this.toggle,this.sele_1.visible=!this.sele_0.visible},e.prototype.buyFunc=function(){var t=GameConfig.globalConfig,e=0;if(0==this.toggle){if(e=GameCache.hero.mainPro.pro(PropId.AP_COIN),e<t.coinInspireConsume)return void GlobalFun.SysMsg(StringUtils.substitute(Language.lang.notEnought,Language.lang.coin))}else if(e=GameCache.hero.mainPro.pro(PropId.AP_YUANBAO),e<t.goldInspireConsume)return GlobalFun.SysMsg(StringUtils.substitute(Language.lang.notEnought,Language.lang.yb)),void GlobalFun.gotoCharge();Proxy.copy.sendBuyBuff(this.toggle)},e.prototype.initCount=function(){var t=GameCache.copy.buffBuy?GameCache.copy.buffBuy:[0,0],e=GameConfig.globalConfig;this.c0.text=StringUtils.substitute(Language.lang.inspire_0,t[0],e.coinInspireCount),this.c1.text=StringUtils.substitute(Language.lang.inspire_0,t[1],e.goldInspireCount);var i=10*(t[0]+t[1]);this.t0.x=100==i?137:146,this.t0.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.inspire_2,i))},e}(BaseEuiWindow);__reflect(CopyExpBuffBuy.prototype,"CopyExpBuffBuy");var CopyExpBuffItem=function(t){function e(){return t.call(this)||this
}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(CopyExpBuffItem.prototype,"CopyExpBuffItem");var CopyExpInfo=function(t){function e(){var e=t.call(this,LayerManager.UI_Main)||this;return e.time=[],e.skinName="CopyExpInfoSkin",e.top=100,e.right=0,e.bottom=0,e.left=0,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.timeNum.gap=23},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.COPY_EXP_TIME,this.beginCountDown),this.message(MsgConst.COPY_EXP_WAVE,this.initWave),this.message(MsgConst.COPY_EXP_INCOME,this.initIcome),this.beginCountDown(),this.initIcome(),this.initWave()},e.prototype.close=function(e){t.prototype.close.call(this),App.TimerManager.remove(this.timeCount,this),GameCache.copy.copyExpData={}},e.prototype.beginCountDown=function(){this.time=GameCache.copy.copyExpData.time,this.time&&(App.TimerManager.isExists(this.timeCount,this)||App.TimerManager.addDelay(0,1e3,0,this.timeCount,this))},e.prototype.timeCount=function(){var t=this.time[0]-GameCache.server.serverTime,e=(this.time[1]-GameCache.server.serverTime,this.time[2]-GameCache.server.serverTime);if(e>=0){var i="";t>0?(this.tG.visible=!0,this.timeNum.value=Math.floor(t/1e3),i=App.DateUtils.getFormatBySecond(this.time[3])):(this.tG.visible=!1,i=App.DateUtils.getFormatBySecond(e/1e3)),i=i.replace(/:/g,"s"),this.num.value=i}else App.TimerManager.remove(this.timeCount,this)},e.prototype.initWave=function(){var t=GameCache.copy.copyExpData.wave;if(!t){var e=GameConfig.copyExp,i=GameCache.map.fbId;for(var n in e)if(e[n].fubenId==i){t=[1,e[n].monsterInfo.length];break}}this.wave.value=t[0]+"l"+t[1]},e.prototype.initIcome=function(){var t=GameCache.copy.copyExpData.exp;t=t?t:0;var e=GlobalFun.numCut(t);this.total.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.expIcome,e));var i=GameCache.copy.copyExpData.killCount;i=i?i:0,this.killNum.value=i+""},e}(BaseEuiWindow);__reflect(CopyExpInfo.prototype,"CopyExpInfo");var CopyExpPage=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.enterCount=0,i.skinName="CopyExpPageSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.red=function(){return GameCache.copy.checkCopyExp()},e.changeMsg=function(){return[MsgConst.COPY_COUNT]},e.prototype.open=function(t){this.addTouchEvent(this.btn_0,this.enterCopy),this.addTouchEvent(this.buyBtn,this.countBuy),this.message(MsgConst.COPY_COUNT,this.initData),this.initData()},e.prototype.initData=function(){var t=GameCache.copy.getCopyExpId(),e=GameConfig.copyExp[t[0]];this.item_0.data=e.consume[0],this.cost.setData(e.consume[0].id,e.consume[0].count);var i=GameCache.copy.getCopyExpId()[1],n=GameConfig.fuben[i],o=GameCache.copy.copyExpBuyData?GameCache.copy.copyExpBuyData:null,r=o&&o.boughtCount?o.boughtCount:0,a=o&&o.enterCount?o.enterCount:0,s=r+n.enterCfg[0].freeTimes-a;this.enterCount=s;var h=StringUtils.substitute(Language.lang.remain,s+"/3");this.count.textFlow=TextFlowUtils.generateTextFlow(h)},e.prototype.enterCopy=function(){return 0==this.enterCount?(GlobalFun.SysMsg(Language.lang.jingji_t5),void this.countBuy()):void(this.cost.checkEnough()&&(GameCache.copy.enterCopyExp(),App.ViewManager.close(ViewConst.COPY)))},e.prototype.countBuy=function(){GlobalFun.openEnterBuy("exp")},e}(BaseSpriteView);__reflect(CopyExpPage.prototype,"CopyExpPage");var CopyMaterialsInfo=function(t){function e(){var e=t.call(this,LayerManager.UI_Main)||this;return e.fbid=0,e.skinName="CopyMaterialsInfoSkin",e.top=120,e.right=0,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.num.gap=14},e.prototype.open=function(t){this.message(MsgConst.COPY_EVALUATION,this.initEva),this.message(MsgConst.COPY_TIME,this.startCount),this.addTouchEvent(this.exitBtn,this.openExitTips),this.fbid=GameCache.map.fbId,this.initData(),this.startCount()},e.prototype.close=function(e){t.prototype.close.call(this),App.TimerManager.removeAll(this)},e.prototype.initData=function(){var t=GameCache.map.fbId,e=GameConfig.copyMaterials[t];this.eva.source="copymaterials_json.copymaterials_5_png";var i=e.awarddec[0],n=GameConfig.item[i.id];this.txt_0.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.copyAward_0,n.name,i.count)),this.txt_1.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.copyAward_1,"30%"))},e.prototype.openExitTips=function(){GameCache.copy.openExitTips()},e.prototype.initEva=function(t){var e=GameCache.map.fbId,i=GameConfig.copyMaterials[e];this.eva.source="copymaterials_json.copymaterials_"+i.score[t-1]+"_png",t=0>=t-1?0:t-1;var n=i.awarddec[t],o=GameConfig.item[n.id];this.txt_0.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.copyAward_0,o.name,n.count))},e.prototype.initTime=function(){var t=GameCache.copy.copyTime[this.fbid],e=GameCache.server.serverTime;t=t?t-e:0,t=0>t?0:t;var i="";return t&&null!=t||(i="00s00s00"),t/=1e3,i=App.DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_1),i=i.replace(/:/g,"s"),this.num.value=i,0>=t?void App.TimerManager.remove(this.initTime,this):void 0},e.prototype.startCount=function(){App.TimerManager.isExists(this.initTime,this)&&App.TimerManager.remove(this.initTime,this),App.TimerManager.addDelay(0,1e3,0,this.initTime,this)},e}(BaseEuiWindow);__reflect(CopyMaterialsInfo.prototype,"CopyMaterialsInfo");var CopyMaterialsItem=function(t){function e(){var e=t.call(this)||this;return e.sweepCount=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.btn,this.enterFunc),this.cost.gainWay.visible=!1,this.cost.numColor_0=46332},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.id&&this.initdata()},e.prototype.dispose=function(){this.itemList&&this.itemList.dispose(),t.prototype.dispose.call(this)},e.prototype.initdata=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_LEVEL);this.bg.source="res/images/bg/copyMaterialsBg_"+this.data.backpic+".png",this.title.source="copymaterials_json.copymaterials_title_"+this.data.namepic+"_png";var e=GameCache.copy.getCopyData(this.data.id);this.cost.visible=!1,this.btn.touchEnabled=!0,e&&(this.btn.icon=e.free?"res/btn/enterBtn3.png":"res/btn/sweepBtn2.png",this.sweepCount=e.sweep,this.data.level>t?(this.desc.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.copyEnterCondition,this.data.level)),this.btn.icon="res/btn/enterBtn3g.png",this.btn.touchEnabled=!1):(this.btn.visible=!0,e.free?this.desc.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.copyEnterCount,e.free)):(this.cost.visible=!0,this.cost.setData(e.consumes[0].id,e.consumes[0].count),this.desc.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.copySweepCount,e.sweep))))),this.itemList||(this.itemList=ObjectPool.get(ItemList)),this.itemList.setData(this.data.awardshow,this.iG)},e.prototype.enterFunc=function(){if(this.cost.visible)if(this.cost.isExpend)this.sweepCount?Proxy.copy.sendSweep(this.data.id,0):GlobalFun.checkVipLvl(Language.lang.copyText_0);else{var t=StringUtils.substitute(Language.lang.notEnought,Language.lang.yb);GlobalFun.SysMsg(t)}else Proxy.copy.sendEnterFB(this.data.id),App.ViewManager.close(ViewConst.COPY)},e}(BaseCustComponent);__reflect(CopyMaterialsItem.prototype,"CopyMaterialsItem");var CopyMaterialpage=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="CopyMaterialsPageSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=CopyMaterialsItem},e.prototype.open=function(t){this.message(MsgConst.COPY_COUNT,this.initList),this.initList()},e.red=function(){return GameCache.copy.checkMaterial()},e.changeMsg=function(){return[MsgConst.COPY_COUNT]},e.prototype.initList=function(){var t=GameConfig.copyMaterials,e=[];for(var i in t)e.push(t[i]);e=e.sort(this.sortList),this.setListData(this.itemList,e)},e.prototype.sortList=function(t,e){return t.order>e.order?1:-1},e}(BaseSpriteView);__reflect(CopyMaterialpage.prototype,"CopyMaterialpage");var CopyPannel=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this,e)},e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPagePannel);__reflect(CopyPannel.prototype,"CopyPannel");var CopyTowerPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.nTower=1,i.skinName="CopyTowerPannelSkin",i}return __extends(e,t),e.red=function(){return GameCache.copytower.copyTowerData?GameCache.copytower.bGetDailyRw()||GameCache.copytower.copyTowerData.luckLeftTime>0:!1},e.changeMsg=function(){return[MsgConst.CPOY_TOWER]},e.prototype.refreshRed=function(){t.prototype.refreshRed.call(this),GameCache.copytower.copyTowerData&&(App.ViewManager.showRedPoint(this.btnRw,GameCache.copytower.bGetDailyRw()),App.ViewManager.showRedPoint(this.btnLuck,GameCache.copytower.copyTowerData.luckLeftTime>0))},e.prototype.init=function(){this.list.itemRenderer=ItemBase},e.prototype.open=function(t){void 0===t&&(t=null),this.addTouchEvent(this.btnRw,this.onClick),this.addTouchEvent(this.btnLuck,this.onClick),this.addTouchEvent(this.btnClg,this.onClick),this.addTouchEvent(this.btnRank,this.onClick),this.message(MsgConst.CPOY_TOWER,this.upCn),this.message(MsgConst.CPOY_TOWER_RANK,this.upRank),Proxy.copytower.getRank(3),this.upCn()},e.prototype.upCn=function(){if(this.nTower=GameCache.copytower.copyTowerData?GameCache.copytower.copyTowerData.layer+1:1,this.stdMiwu=GameConfig.miwuTower[this.nTower],this.stdMiwu){this.setListData(this.list,this.stdMiwu.awardshow);for(var t=0;4>t;t++){var e="",i=this.nTower-2+t;i>0&&(e=StringUtils.substitute(Language.lang.lcn3,i)),this["lb"+t].text=e}}if(this.stdMiwu.specialShow&&this.stdMiwu.specialShow[0]){var n=this.stdMiwu.specialShow[0];this.rw.data=n,this.lbRwNe.text=GameConfig.item[n.id]?GameConfig.item[n.id].name:""}},e.prototype.upRank=function(){var t=GameCache.copytower.rankList;for(var e in t){var i=t[e];this["lbNe"+e]&&(this["lbNe"+e].text=i.name,this["lbLv"+e].text=StringUtils.substitute(Language.lang.lcn5,i.layer))}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnRw:var e=new ViewProp;e.exData1=this.stdMiwu,App.ViewManager.open(ViewConst.COPYTOWERRW,e);break;case this.btnLuck:var i=GameCache.copytower.copyTowerData?GameCache.copytower.copyTowerData.luckHaveTime:1;1>i&&(i=1);var n=10*Math.ceil(i/10),o=GameConfig.miwuTowerJackpot[n];if(o&&o.jackpot){var r=new ViewProp;r.exData1=o.jackpot,App.ViewManager.open(ViewConst.LUCKYDAIL,r)}break;case this.btnClg:Proxy.copytower.gotoCopy(),App.ViewManager.close(ViewConst.COPY);break;case this.btnRank:Proxy.copytower.getRank(30),App.ViewManager.open(ViewConst.RANKMODELWINA)}},e}(CommunalPagePannel);__reflect(CopyTowerPannel.prototype,"CopyTowerPannel");var CopyTowerRwWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="CopyTowerRwWinSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.list.itemRenderer=ItemBase,this.setWinTitle("everydayRw")},e.prototype.open=function(e){t.prototype.open.call(this),this.stdMiwu=e.exData1,this.upBtn(),this.addTouchEvent(this.btn,this.onclick),this.message(MsgConst.CPOY_TOWER,this.upBtn),this.setListData(this.list,this.stdMiwu.dailyaward)},e.prototype.upBtn=function(){GameCache.copytower.copyTowerData&&(this.btn.icon=GameCache.copytower.copyTowerData.getState?"res/btn/get_4.png":"res/btn/get_3.png")},e.prototype.onclick=function(){Proxy.copytower.getDailyRw()},e}(BaseEuiWindow);__reflect(CopyTowerRwWin.prototype,"CopyTowerRwWin");var CopyTowerCache=function(t){function e(){var e=t.call(this)||this;return e.rankList=[],e.myRank=0,e}return __extends(e,t),e.prototype.clear=function(){this.copyTowerData=null,this.rankList=[]},e.prototype.initData=function(t){this.copyTowerData||(this.copyTowerData=new CopyTowerItem),this.copyTowerData.init(t)},e.prototype.rankData=function(t){this.myRank=t.readByte();var e=t.readByte();this.rankList=[];for(var i=0;e>i;i++){var n={num:1,layer:1,name:""};n.num=t.readByte(),n.layer=t.readUnsignedShort(),n.name=t.readCustomBytes(),this.rankList.push(n)}},Object.defineProperty(e.prototype,"copyTowerLayer",{get:function(){return this.copyTowerData.layer},enumerable:!0,configurable:!0}),e.prototype.bGetDailyRw=function(){return this.copyTowerData&&this.copyTowerData.layer&&0==this.copyTowerData.getState?!0:!1},e}(BaseCache);__reflect(CopyTowerCache.prototype,"CopyTowerCache");var CopyTowerItem=function(){function t(){}return t.prototype.init=function(t){if(t){this.layer=t.readUnsignedShort(),this.getState=t.readByte(),this.luckHaveTime=t.readUnsignedShort(),this.luckLeftTime=t.readUnsignedShort();var e=t.readByte();this.dailList={};for(var i=0;e>i;i++)this.dailList[t.readByte()]=t.readByte()}},t}();__reflect(CopyTowerItem.prototype,"CopyTowerItem");var CopyTowerProxy=function(t){function e(){var e=t.call(this,PacketTypes.COPY)||this;return e.regNetMsg(21,e.doTower),e.regNetMsg(22,e.doRwResult),e.regNetMsg(26,e.doRank),e}return __extends(e,t),e.prototype.doTower=function(t){GameCache.copytower.initData(t),App.MessageCenter.dispatch(MsgConst.CPOY_TOWER)},e.prototype.doRwResult=function(t){App.MessageCenter.dispatch(MsgConst.CPOY_TOWER_LUCK,t.readByte())},e.prototype.doRank=function(t){GameCache.copytower.rankData(t),App.MessageCenter.dispatch(MsgConst.CPOY_TOWER_RANK)},e.prototype.getLuck=function(){this.sendMsgId(22)},e.prototype.getLuckRw=function(){this.sendMsgId(23)},e.prototype.getDailyRw=function(){this.sendMsgId(24)},e.prototype.gotoCopy=function(){this.sendMsgId(25)},e.prototype.getRank=function(t){var e=this.getBytes(26);e.writeByte(t),this.sendToServer(e)},e}(BaseProxy);__reflect(CopyTowerProxy.prototype,"CopyTowerProxy");var FashionAwardItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.tag?this.tag?this.tag.visible=!0:(this.tag=ObjectPool.get(eui.Image),this.tag.source="public_json.public_bonus_tag_png",this.tag.x=this.tag.y=-3,this.addChild(this.tag)):this.tag&&(this.tag.visible=!1)},e.prototype.dispose=function(){this.tag.source=null,this.tag.x=this.tag.y=0,ObjectPool.push(this.tag),App.DisplayUtils.removeFromParent(this.tag),this.tag=null,t.prototype.dispose.call(this)},e}(ItemBase);__reflect(FashionAwardItem.prototype,"FashionAwardItem");var FashionCopyInfo=function(t){function e(){var e=t.call(this,LayerManager.UI_Main)||this;return e.skinName="FashionCopyInfoSkin",e.top=120,e.right=0,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.COPY_EVALUATION,this.initEva),this.message(MsgConst.COPY_TIME,this.startCount),this.wave.value=1,this.startCount(),this.eva.source="copyInfo_json.copyInfo_5_png"},e.prototype.close=function(e){t.prototype.open.call(this)},e.prototype.initEva=function(t,e){var i=GameConfig.fashionCopy[e],n=i.score[t-1];this.eva.source="copyInfo_json.copyInfo_"+n+"_png",this.wave.value=t},e.prototype.startCount=function(){App.TimerManager.isExists(this.initTime,this)&&App.TimerManager.remove(this.initTime,this),App.TimerManager.addDelay(0,1e3,0,this.initTime,this)},e.prototype.initTime=function(){var t=GameCache.map.fbId,e=GameCache.copy.copyTime[t],i=GameCache.server.serverTime;e=e?e-i:0,e=0>e?0:e;var n="";return e&&null!=e||(n="00s00s00"),e/=1e3,n=App.DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_1),n=n.replace(/:/g,"s"),this.time.value=n,0>=e?void App.TimerManager.remove(this.initTime,this):void 0},e}(BaseEuiWindow);__reflect(FashionCopyInfo.prototype,"FashionCopyInfo");var FashionCopyItem=function(t){function e(){var e=t.call(this)||this;return e.acti=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){return t.prototype.dataChanged.call(this),null==this.data?void(this.sG.visible=!1):(this.sG.visible=!0,void this.initData())},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){this.img.source=1==this.data.copyType?RES_DIR_FASHIONCOPY+("fashionCopy_nor_"+this.data.backpic+".png"):RES_DIR_FASHIONCOPY+("fashion_treasure_"+this.data.backpic+".png"),this.shapeMask.source=1==this.data.copyType?"fashionCopy_json.fashionCopy_shapeMask_0_png":"fashionCopy_json.fashionCopy_shapeMask_1_png";var t=GameCache.hero.mainPro.pro(PropId.AP_LEVEL);if(this.data.vipLimit?(this.vip.visible=!0,this.img_0.visible=!0,this.vip.value=this.data.vipLimit):(this.vip.visible=!1,this.img_0.visible=!1),this.data.copyLevel){var e=GameCache.copy.fashionCopyData[this.data.copyLevel],i=e?e.acti:!1;i=i&&t>=this.data.level,this.acti=i,this.desc.visible=!i,this.openImg.visible=i,this.lock.visible=!i,!i&&(this.desc.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.fashioncopy_2,this.data.level)))}else this.desc.visible=!1,this.openImg.visible=!0,this.lock.visible=!1,this.acti=t>=this.data.level},e}(BaseCustComponent);__reflect(FashionCopyItem.prototype,"FashionCopyItem");var FashionCopyPage=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="FashionCopyPageSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=FashionCopyItem},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.COPY_COUNT,this.initEnterCount),this.addTouchEvent(this.tabBtn,this.initList),this.addTouchEvent(this.plusBtn,this.buyEnter),this.addTouchEvent(this.enterBtn,this.enterFunc),this.initEnterCount(),App.TimerManager.addDelay(50,50,1,this.initList,this)},e.prototype.close=function(e){this.awardList&&this.awardList.dispose(),t.prototype.close.call(this)},e.prototype.initList=function(){var t=this.tabBtn.selectedIndex,e=GameConfig.fashionCopy,i=[];for(var n in e)e[n].copyType==t+1&&i.push(e[n]);i.push(null),i.unshift(null),this.bg.source=RES_DIR_BG+"fashionCopy_"+t+".png",this.twSlide.initData(FashionCopyItem,i,this.initAwardList,this,"FashionCopyItemSkin")},e.prototype.initAwardList=function(){var t=this.twSlide.curItemData;if(t){for(var e=[],i=0;i<t.awardshow.length;i++){var n=t.awardshow[i],o={tag:1==this.tabBtn.selectedIndex,id:n[0],count:n[1]};e.push(o)}this.awardList||(this.awardList=ObjectPool.get(ItemListCommual)),this.awardList.setData(e,this.ig,FashionAwardItem,"ItembaseSkin")}},e.prototype.initEnterCount=function(){var t=GameCache.copy.copyBuyData[GameConfig.globalConfig.fashionCopyId],e=t?t.enterCount:0,i=GameCache.vip.realValue(),n=GameConfig.vip[i].fashionCopyNum;this.remainText.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.remain,e+"/"+n))},e.prototype.enterFunc=function(){var t=this.twSlide.seleItem,e=this.twSlide.curItemData;if(t){if(!t.acti){var i=StringUtils.substitute(Language.lang.fashioncopy_1,e.level);return void GlobalFun.SysMsg(i)}var n=GameCache.copy.copyBuyData[GameConfig.globalConfig.fashionCopyId],o=n?n.enterCount:0;if(e.vipLimit){var r=GameCache.vip.realValue();if(r<e.vipLimit)return void GlobalFun.SysMsg(StringUtils.substitute(Language.lang.vipBoss_0,e.vipLimit))}if(0>=o)return void this.buyEnter();Proxy.copy.sendEnterFB(e.id),App.ViewManager.close(ViewConst.COPY)}},e.prototype.buyEnter=function(){GlobalFun.openEnterBuy("fashionCopy")},e}(BaseSpriteView);__reflect(FashionCopyPage.prototype,"FashionCopyPage");var TweenSlidePart=function(t){function e(){var e=t.call(this)||this;return e.delta=.02,e.scaleSize=.9,e.listData=[],e.curIdx=0,e.itemWidth=200,e.visiNum=0,e.reX=0,e.lastPoint=0,e.permit=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEvent(egret.Event.CHANGE,this.sc,this.changeAlpha),this.addEvent(eui.ItemTapEvent.ITEM_TAP,this.itemList,this.itemClick),this.addEvent(eui.UIEvent.CHANGE_START,this.sc,this.beginChange),this.addEvent(eui.UIEvent.CHANGE_END,this.sc,this.maganetAnimate),this.addTouchEvent(this.lBtn,this.onBtnTouche),this.addTouchEvent(this.rBtn,this.onBtnTouche)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(t,e,i,n,o){var r=this;this.handler&&this.handler.dispose(),this.handler=Handler.create(n,i,[],!1),this.itemList.itemRenderer=t,this.itemList.itemRendererSkinName=o,this.listData=e,this.setListData(this.itemList,this.listData),this.curIdx=0,this.itemList.invalidateSize(),this.visiNum=Math.floor(this.sc.width/this.itemWidth)+1,this.reX=this.visiNum*this.itemWidth-this.sc.width>>1,App.TimerManager.addDelay(50,50,1,function(){r.sc.viewport.scrollH=r.reX,r.curIdx=0,r.changeAlpha(1)},this)},e.prototype.changeAlpha=function(t){var e,i=this.sc.viewport,n=i.scrollH-this.lastPoint>0?1:-1;e=Math.floor((i.scrollH+this.reX)/this.itemWidth),e=0>=e?1:e+1,this.lastPoint=i.scrollH,this.curIdx==e?(this.curItem&&(this.curItem.shapeMask.alpha=this.curItem.shapeMask.alpha<=0?0:this.curItem.shapeMask.alpha-=this.delta,this.curItem.sG.scaleX=this.curItem.sG.scaleY=this.curItem.sG.scaleY>=1?1:this.curItem.sG.scaleY+=this.delta/10),this.lastItem&&(this.lastItem.shapeMask.alpha=this.lastItem.shapeMask.alpha>=1?1:this.lastItem.shapeMask.alpha+=this.delta,this.lastItem.sG.scaleX=this.lastItem.sG.scaleY=this.lastItem.sG.scaleY<=this.scaleSize?this.scaleSize:this.lastItem.sG.scaleY-=this.delta/10)):(this.curItem=this.itemList.getElementAt(e),this.lastItem=this.itemList.getElementAt(e-n),this.curIdx=e,1===t&&(this.curItem.sG.scaleX=this.curItem.sG.scaleY=1,this.curItem.shapeMask.alpha=0),this.btnVisible(),this.runHandler())},e.prototype.itemClick=function(t){this.tw=egret.Tween.get(this.sc.viewport,{onChange:this.changeAlpha,onChangeObj:this}),this.sc.viewport.scrollH;var e=t.itemIndex-1;if(this.curIdx=t.itemIndex,!(0>e)){var i=e*this.itemWidth+this.reX;this.tweenAnime(i,500)}},e.prototype.onBtnTouche=function(t){this.tw=egret.Tween.get(this.sc.viewport,{onChange:this.changeAlpha,onChangeObj:this});var e=parseInt(t.target.name);this.curIdx+=e;var i=(this.curIdx-1)*this.itemWidth+this.reX;this.tweenAnime(i,500)},e.prototype.beginChange=function(){this.permit=!0},e.prototype.maganetAnimate=function(){if(this.permit){var t=(this.curIdx-1)*this.itemWidth+this.reX,e=this.sc.viewport.scrollH>0?Math.floor(t/this.sc.viewport.scrollH*500):100;e=100>e?100:e,e=e>500?100:e,this.tw=egret.Tween.get(this.sc.viewport,{onChange:this.changeAlpha,onChangeObj:this}),this.permit=!1,this.tweenAnime(t,e)}},e.prototype.tweenAnime=function(t,e){var i=this;this.tw||(this.tw=egret.Tween.get(this.sc.viewport,{onChange:this.changeAlpha,onChangeObj:this})),this.lBtn.touchEnabled=this.rBtn.touchEnabled=!1,this.itemList.touchEnabled=!1,this.itemList.touchChildren=!1,this.delta=.1,this.tw.to({scrollH:t},e).call(function(){i.itemList.touchEnabled=!0,i.itemList.touchChildren=!0,i.lBtn.touchEnabled=i.rBtn.touchEnabled=!0,i.delta=.02},this)},e.prototype.runHandler=function(){this.handler&&this.handler.run()},Object.defineProperty(e.prototype,"curItemData",{get:function(){return this.curItem?this.curItem.data:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seleItem",{get:function(){return this.curItem},enumerable:!0,configurable:!0}),e.prototype.btnVisible=function(){1==this.curIdx?(this.lBtn.visible=!1,this.rBtn.visible=!0):this.curIdx==this.itemList.numElements-2?(this.lBtn.visible=!0,this.rBtn.visible=!1):this.itemList.numElements-1==0?this.rBtn.visible=this.lBtn.visible=!1:this.rBtn.visible=this.lBtn.visible=!0},e.prototype.replaceItemData=function(t,e){this.listData[t]=e;var i=this.itemList.dataProvider;i.replaceAll(this.listData)},e}(BaseCustComponent);__reflect(TweenSlidePart.prototype,"TweenSlidePart");var PgtBossCache=function(t){function e(){var e=t.call(this)||this;return e.pgtBossMap={},e.pgtBossPage={},e.pgtChallenge=0,e.pgtBuy=0,e.pgtRefresh=0,e.pgtMaxPage=0,e.fbId2bossId={},e}return __extends(e,t),e.prototype.clear=function(){t.prototype.clear.call(this),this.pgtBossMap={},this.pgtBossPage={},this.pgtChallenge=0,this.pgtBuy=0,this.pgtRefresh=0,this.pgtMaxPage=0,this.pgtBossCfgMap=null,this.fbId2bossId={}},e.prototype.updatePgtBossData=function(t){if(t){for(var e in t){var i=t[e],n=GameConfig.purgatoryBoss[i.bossid];this.pgtBossMap[i.bossid]=i,this.pgtBossPage[n.page]||(this.pgtBossPage[n.page]=[]),-1==this.pgtBossPage[n.page].lastIndexOf(i.bossid)&&this.pgtBossPage[n.page].push(i.bossid),this.fbId2bossId[n.fubenid]=n.entityid}for(var e in this.pgtBossPage){var o=this.pgtBossPage[e];o.sort(function(t,e){var i=GameConfig.purgatoryBoss[t],n=GameConfig.purgatoryBoss[e];return i.level-n.level})}}},Object.defineProperty(e.prototype,"maxPage",{get:function(){return this.pgtMaxPage?this.pgtMaxPage:(this.initCfg(),this.pgtMaxPage)},enumerable:!0,configurable:!0}),e.prototype.initCfg=function(){this.pgtBossCfgMap={},this.pgtMaxPage=0;for(var t in GameConfig.purgatoryBoss){var e=GameConfig.purgatoryBoss[t];!this.pgtBossCfgMap[e.difficulty]&&(this.pgtBossCfgMap[e.difficulty]={});var i=this.pgtBossCfgMap[e.difficulty];i[e.level]=e,e.page>this.pgtMaxPage&&(this.pgtMaxPage=e.page)}},e.prototype.getPgtBossCfg=function(t,e){return this.pgtBossCfgMap||this.initCfg(),this.pgtBossCfgMap[t]?this.pgtBossCfgMap[t][e]:null},e.prototype.openExitTips=function(t){if(void 0===t&&(t=!1),t)return void this.exit();var e=new ViewProp,i={},n=GameConfig.purgatoryBoss[this.currentBossId],o=Language.lang.pgtBossExit;if(n){var r=GameConfig.fuben[n.fubenid];o=r.exitDec}i.desc=o,i.thisc=this,i.func=this.exit,e.exData1=i,App.ViewManager.open(ViewConst.SYSTIPS,e)},e.prototype.exit=function(){!this.currentBossId&&GameCache.map.fbId>0&&(this.currentBossId=this.fbId2bossId[GameCache.map.fbId]),Proxy.boss.sendBossFubenOpt(2,this.currentBossId)},e.prototype.takeAwd=function(){Proxy.boss.sendRecieveAw(this.currentBossId),this.exit()},e.prototype.getBuyMax=function(){var t=this.pgtBuy?this.pgtBuy:0,e=GameCache.vip.realValue(),i=GameConfig.vip[e],n=GameConfig.vip[e+1]?GameConfig.vip[e+1]:i,o=i.PurgatoryBoss,r=n.PurgatoryBoss;return[o,t,r]},e}(BaseCache);__reflect(PgtBossCache.prototype,"PgtBossCache");var PgtBossItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.initData()},e.prototype.initData=function(){this.bossid=this.data;var t=GameConfig.purgatoryBoss[this.data],e=GameConfig.monster[t.entityid];this.labLv.text=StringUtils.substitute(Language.lang.pgtBossLv,t.level),this.labName.text=e.name},e.prototype.onRemove=function(){this.bossid=null},e}(BaseCustComponent);__reflect(PgtBossItem.prototype,"PgtBossItem");var PgtBossPanel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.isLock=!1,i.skinName="PgtBossPanelSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this);for(var e=[],i=1;i<=GameCache.pgtBoss.maxPage;i++)e.push({icon:RES_DIR_PAGEICON+"pgt_boss_tab_"+i+".png"});for(var i=1;5>i;i++){var n=this["line"+i];n.visible=i<GameCache.pgtBoss.maxPage}this.tab.dataProvider=new eui.ArrayCollection(e),this.power.alignV="mid",this.power.gap=21,this.hpBar.labelDisplay.visible=!1},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this,e),this.message(MsgConst.PURGATORY_BOSS_UPDATE,this.initPanel),this.message(MsgConst.BAG_ITEM_NUM,this.initPanel),this.addTouchEvent(this.btnChallenge,this.onBtnChallengeClick),this.addTouchEvent(this.addBtn,this.onBtnAddClick),this.addTouchEvent(this.imgCost,this.onCostTouch),this.addEvent(egret.TouchEvent.CHANGE,this.bossList,this.onListClick),this.addEvent(egret.TouchEvent.CHANGE,this.tab,this.onTabChanged),this.awdList.itemRenderer=ItemBase,this.bossList.itemRenderer=PgtBossItem,this.tab.selectedIndex=0,this.initPanel()},e.prototype.initPanel=function(){this.updatePgtInfo();var t=GameCache.pgtBoss.pgtBossPage[this.page];t&&0!=t.length&&(this.entityId=t[0],this.setListData(this.bossList,t.concat([])),this.bossList.scrollV=0,this.updateBossInfo())},e.prototype.updateBossInfo=function(){var t=GameConfig.purgatoryBoss[this.entityId],e=GameConfig.monster[t.entityid];this.boss.showMonster(e.modelid),this.boss.scaleY=this.boss.scaleX=.7;var i=GameCache.pgtBoss.pgtBossMap[this.entityId];this.labName.text=e.name,this.power.value=t.power,this.hpBar.maximum=100,this.hpBar.value=i.hp,this.labHp.text=i.hp+"%";var n=t.consume[0],o=n.type,r=n.id,a=n.count;this.item={type:o,id:r,count:a};var s=GameConfig.item[r];this.imgCost.source=""+RES_DIR_IMAGES_ITEM+s.icon+".png";var h=GameCache.bag.itemCount(r),p=h>=a?"c0xffc600":"c0xff0000",l=StringUtils.substitute(Language.lang.pgtBossCost,a,p,h);this.labCost.textFlow=TextFlowUtils.generateTextFlow(l),this.setListData(this.awdList,t.reward_show),this.isLock=!1;var c=GameCache.pgtBoss.getPgtBossCfg(t.difficulty-1,t.level);if(c){var u=GameCache.pgtBoss.pgtBossMap[c.entityid];this.isLock=0==u.complete}var d=this.getCd(i);if(this.labLock.visible=!1,d>0){var g=d>0?App.DateUtils.getFormatBySecond(d):"00:00:00";this.labBossCd.text=StringUtils.substitute(Language.lang.pgtBossCd,g),this.imgCost.visible=this.labCost.visible=this.btnChallenge.visible=!1,this.labBossCd.visible=!0,App.TimerManager.isExists(this.timeCount,this)||App.TimerManager.addDelay(0,1e3,0,this.timeCount,this)}else this.labBossCd.text=null,this.btnChallenge.visible=!0,this.labBossCd.visible=!1,this.btnChallenge.enabled=this.imgCost.visible=this.labCost.visible=!this.isLock,this.labLock.visible=this.isLock,this.labLock.text=Language.lang.pgtBossLock,this.btnChallenge.filters=this.isLock?FilterUtils.DefaultGrayFilters:null},e.prototype.updatePgtInfo=function(){App.TimerManager.isExists(this.timeCount,this)||App.TimerManager.addDelay(0,1e3,0,this.timeCount,this),this.labCount.text=StringUtils.substitute(Language.lang.pgtBossChallenge,GameCache.pgtBoss.pgtChallenge,GameConfig.globalConfig.PurgatoryChallenge),this.labTime.text=StringUtils.substitute(Language.lang.pgtBossRefreshTime,App.DateUtils.getFormatBySecond(this.getRefreshTime()))},e.prototype.timeCount=function(){var t=GameCache.pgtBoss.pgtBossMap[this.entityId],e=this.getCd(t);if(e>0){var i=App.DateUtils.getFormatBySecond(e);this.labBossCd.text=StringUtils.substitute(Language.lang.pgtBossCd,i)}else this.labBossCd.text=null;var n=this.getRefreshTime();this.labTime.text=StringUtils.substitute(Language.lang.pgtBossRefreshTime,n>0?App.DateUtils.getFormatBySecond(n):"00:00:00")},e.prototype.onCostTouch=function(){this.item&&GlobalFun.openItemTips(this.item.id)},e.prototype.onTabChanged=function(t){this.initPanel()},e.prototype.onListClick=function(t){this.entityId=t.target.selectedItem,this.updateBossInfo()},e.prototype.onBtnChallengeClick=function(){GameCache.pgtBoss.currentBossId=this.entityId;var t=GameConfig.purgatoryBoss[this.entityId];if(GameCache.hero.mainPro.pro(PropId.AP_LEVEL)<t.level)return void GlobalFun.SysMsg(Language.lang.roleLevelLack);var e=GameCache.bag.itemCount(this.item.id);return e<this.item.count?void(this.item.id==GlobalVar.GOLD?GlobalFun.gotoCharge():GlobalFun.openItemTips(this.item.id)):0==GameCache.pgtBoss.pgtChallenge?void GlobalFun.openEnterBuy("pgtboss"):(Proxy.boss.sendBossFubenOpt(1,this.entityId),void App.ViewManager.close(ViewConst.COPY))
},e.prototype.onBtnAddClick=function(){GlobalFun.openEnterBuy("pgtboss")},e.prototype.getCd=function(t){if(!t)return 0;var e=t.cd-GameCache.server.serverTime;return 0>=e?0:e/1e3},e.prototype.getRefreshTime=function(){if(!GameCache.pgtBoss.pgtRefresh)return 0;var t=GameCache.pgtBoss.pgtRefresh-GameCache.server.serverTime;return 0>=t?0:t/1e3},e.prototype.close=function(){t.prototype.close.call(this),this.awdList.itemRenderer=null,this.bossList.itemRenderer=null,App.TimerManager.remove(this.timeCount,this)},Object.defineProperty(e.prototype,"page",{get:function(){return this.tab.selectedIndex+1},enumerable:!0,configurable:!0}),e}(BaseSpriteView);__reflect(PgtBossPanel.prototype,"PgtBossPanel");var DailyShowTipWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="DailyShowTipWinSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.num.gap=15,this.bg.setNameImg("treasure")},e.prototype.open=function(e){t.prototype.open.call(this);var i=GameConfig.DailyReward[e.exData1];i&&i.reward&&(this.slidePage.setData(i.reward),this.num.value=i.value)},e}(BaseEuiWindow);__reflect(DailyShowTipWin.prototype,"DailyShowTipWin");var DailyTaskItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="DailyTaskItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.btnGet,this.onClick)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;if(this.filters=null,e.id){var i=GameCache.daily.dailyListData[e.id],n="daily_json.daily_wjs_png";if(i){switch(i.state){case 0:n="daily_json.daily_wjs_png";break;case 1:this.btnGet.icon="res/btn/enter.png",this.lbPgr.text=i.val+"/"+e.target.count;break;case 2:this.btnGet.icon="res/btn/get_2.png",this.lbPgr.text=Language.lang.lcn1;break;case 3:n="daily_json.daily_ylq_v_png",this.lbPgr.text=Language.lang.lcn1}this.lbPgr.textColor=1==i.state?16722731:851712,this.lbPgr.visible=i.state?!0:!1,0==i.state&&(this.filters=FilterUtils.DefaultGrayFilters),this.btnGet.visible=!(this.imgBtn.visible=1!=i.state&&2!=i.state)}else this.lbPgr.visible=!1,this.lbCnd.textColor=16777215,this.btnGet.visible=!(this.imgBtn.visible=!0),this.filters=FilterUtils.DefaultGrayFilters;this.imgBtn.source=n,this.imgSt.source=e.picture,this.lbCnd.text=e.desc,this.lbPt.text=StringUtils.substitute(Language.lang.dailyPointStr,e.award)}},e.prototype.onClick=function(){var t=GameCache.daily.dailyListData[this.data.id];t&&(1==t.state?this.data.mod&&(TextFlowUtils.hrefType(this.data.mod),App.ViewManager.recoredWin(ViewConst.DAILY)):2==t.state&&Proxy.daily.getTaskRw(this.data.id))},e}(BaseCustComponent);__reflect(DailyTaskItem.prototype,"DailyTaskItem");var DailyTaskPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.listStrea=[0,0,0,0],i.actNum=0,i.allActNum=0,i.skinName="DailyTaskPannelSkin",i}return __extends(e,t),e.prototype.init=function(){this.list.itemRenderer=DailyTaskItem,this.hudNum.gap=14;for(var t=0;4>t;t++)this["actNum"+t].text=GameConfig.DailyReward[t+1].value+"";this.hudNum.alignH="center"},e.red=function(){return GameCache.daily?GameCache.daily.getDailyTaskRed()||GameCache.daily.getDailyStreaRed():!1},e.changeMsg=function(){return[MsgConst.DAILY,MsgConst.PROPERTY+PropId.AP_ACTIVITY_AWARD_FLAG]},e.prototype.open=function(t){void 0===t&&(t=null),this.message(MsgConst.DAILY,this.upCn),this.addTouchEvent(this.imgStrea0,this.onClick),this.addTouchEvent(this.imgStrea1,this.onClick),this.addTouchEvent(this.imgStrea2,this.onClick),this.addTouchEvent(this.imgStrea3,this.onClick),this.message(MsgConst.PROPERTY+PropId.AP_ACTIVITY_AWARD_FLAG,this.upCn),this.upCn(),this.allActNum=GameCache.daily.getAllActNum(),this.progressBar.maximum=this.allActNum},e.prototype.upCn=function(){var t=[];for(var e in GameConfig.daily){var i=CommonUtils.copyDataHandler(GameConfig.daily[e]),n=GameCache.daily.dailyListData[i.id]?GameCache.daily.dailyListData[i.id].state:0;2==n?i.sortof=i.id:1==n?i.sortof=1e4+i.id:3==n?i.sortof=2e4+i.id:0==n?i.sortof=3e4+i.id:i.sortof=4e4+i.id,t.push(i)}t.sort(this.sort),this.setListData(this.list,t),this.actNum=GameCache.daily.getActNum(),this.hudNum.value=this.actNum,this.progressBar.value=this.actNum,this.listStrea=GameCache.daily.getStreaList(),this.refreshGetTrea()},e.prototype.sort=function(t,e){return t.sortof-e.sortof},e.prototype.refreshGetTrea=function(){var t=this.listStrea;for(var e in t){var i=t[e];this["imgGot"+e].visible=2===i,this["imgStrea"+e].icon="daily_json.daily_tr_"+e+i+"_png"}},e.prototype.onClick=function(t){var e=-1,i=1;switch(t.currentTarget){case this.imgStrea0:e=1==this.listStrea[0]?0:-1,i=1;break;case this.imgStrea1:e=1==this.listStrea[1]?1:-1,i=2;break;case this.imgStrea2:e=1==this.listStrea[2]?2:-1,i=3;break;case this.imgStrea3:e=1==this.listStrea[3]?3:-1,i=4}if(e>=0)Proxy.daily.getActRw(e);else if(0==this.listStrea[i-1]){var n=new ViewProp;n.exData1=i,App.ViewManager.open(ViewConst.DAILYSHOWTIP,n)}},e}(CommunalPagePannel);__reflect(DailyTaskPannel.prototype,"DailyTaskPannel");var DailyWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPageWin);__reflect(DailyWin.prototype,"DailyWin");var DailyCache=function(t){function e(){var e=t.call(this)||this;return e.dailyListData={},e}return __extends(e,t),e.prototype.clear=function(){this.dailyListData={}},e.prototype.initServer=function(t){this.dailyListData=t},e.prototype.upData=function(t){var e=t.readByte();if(e&&this.dailyListData[e])this.dailyListData[e].update(t);else{var i=new DailyItem;i.id=e,i.update(t),this.dailyListData[e]=i}},e.prototype.getActNum=function(){var t=0;for(var e in this.dailyListData){var i=this.dailyListData[e];3==i.state&&(t=GameConfig.daily[i.id]?t+GameConfig.daily[i.id].award:t)}return t},e.prototype.getAllActNum=function(){var t=GameConfig.DailyReward[4].value;return t},e.prototype.getStreaList=function(){var t=GameCache.hero.mainPro,e=0;t&&(e=t.pro(PropId.AP_ACTIVITY_AWARD_FLAG));var i=[0,0,0,0];for(var n in i)this.getActNum()>=GameConfig.DailyReward[parseInt(n)+1].value?GlobalFun.BitHas(e,parseInt(n))?i[n]=2:i[n]=1:i[n]=0;return i},e.prototype.getDailyTaskRed=function(){for(var t in this.dailyListData){var e=this.dailyListData[t];if(2==e.state)return!0}return!1},e.prototype.getDailyStreaRed=function(){var t=this.getStreaList();for(var e in t){var i=t[e];if(1==i)return!0}return!1},e}(BaseCache);__reflect(DailyCache.prototype,"DailyCache");var DailyItem=function(){function t(){}return t.prototype.init=function(t){t&&(this.id=t.readByte(),this.update(t))},t.prototype.update=function(t){this.state=t.readByte(),this.val=t.readUnsignedShort(),this.useVal=t.readUnsignedShort()},t}();__reflect(DailyItem.prototype,"DailyItem");var DailyProxy=function(t){function e(){var e=t.call(this,PacketTypes.DAILY)||this;return e.regNetMsg(1,e.doInit),e.regNetMsg(2,e.doRefreshPet),e}return __extends(e,t),e.prototype.doInit=function(t){for(var e=t.readByte(),i={},n=0;e>n;n++){var o=new DailyItem;o.init(t),i[o.id]=o}GameCache.daily.initServer(i),App.MessageCenter.dispatch(MsgConst.DAILY)},e.prototype.doRefreshPet=function(t){GameCache.daily.upData(t),App.MessageCenter.dispatch(MsgConst.DAILY)},e.prototype.askTaskInfo=function(t){var e=this.getBytes(2);e.writeByte(t),this.sendToServer(e)},e.prototype.getTaskRw=function(t){var e=this.getBytes(3);e.writeByte(t),this.sendToServer(e)},e.prototype.getActRw=function(t){var e=this.getBytes(4);e.writeByte(t),this.sendToServer(e)},e}(BaseProxy);__reflect(DailyProxy.prototype,"DailyProxy");var ConfigEdItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEvent(egret.FocusEvent.FOCUS_IN,this.tInput,this.BeginInput),this.addEvent(egret.FocusEvent.FOCUS_OUT,this.tInput,this.EndInput)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.prop&&(this.prop.text=this.data.prop,this.tInput.prompt=this.data.value+"")},e.prototype.BeginInput=function(){this.tInput.text=this.tInput.prompt},e.prototype.EndInput=function(){this.tInput.prompt=this.tInput.text,this.tInput.text="";var t=GameConfig.skillEff[this.data.sId];t[this.data.prop]="number"==typeof this.data.value?parseInt(this.tInput.prompt):this.tInput.prompt},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(ConfigEdItem.prototype,"ConfigEdItem");var ConfigEditWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Message)||this;return e.sidArr=[[],[]],e.skillId=0,e.sId=0,e.tar=[],e.skinName="ConfigEditSkin",e.top=0,e.left=0,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.typeTab.dataProvider=new eui.ArrayCollection(["施法效果","击中效果"])},e.prototype.open=function(t){GameCache.map.isAIMap=!0,this.itemList.itemRenderer=ConfigEdItem,this.typeTab.selectedIndex=0,this.addTouchEvent(this.typeTab,this.typeSele),this.addTouchEvent(this.closeBtn,this.exitFunc),this.addTouchEvent(this.gBtn,this.controlFunc),this.addTouchEvent(this.dBtn,this.doAll),this.addTouchEvent(this.sBtn,this.searchFunc),this.addTouchEvent(this.tabBtn,this.tabTouche),this.addTouchEvent(this.rBtn,this.reset),this.generateFunc()},e.prototype.close=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];GameCache.map.isAIMap=!1,t.prototype.close.call(this)},e.prototype.searchFunc=function(){var t=this.idInput.text;t&&t!=this.skillId+""&&(this.backUp={},this.sidArr=[[],[]],this.skillId=parseInt(this.idInput.text),this.analyseData())},e.prototype.typeSele=function(t){var e=this.typeTab.selectedIndex;this.tabBtn.dataProvider=new eui.ArrayCollection(this.sidArr[e]),this.tabBtn.selectedIndex=0,this.tabTouche()},e.prototype.analyseData=function(){var t=GameConfig.skill[this.skillId];this.skid.text=this.skillId+"",t.skilleff1&&this.getNextId(t.skilleff1,this.sidArr[0]),t.skilleff2&&this.getNextId(t.skilleff2,this.sidArr[1]),this.typeSele()},e.prototype.getNextId=function(t,e){var i=GameConfig.skillEff[t];i&&(this.backUpFunc(t),e.push(t+""),i.nextId&&this.getNextId(i.nextId,e))},e.prototype.tabTouche=function(){var t=this.tabBtn.selectedIndex;this.sId=this.sidArr[this.typeTab.selectedIndex][t],this.effId.text=this.sId+"",this.initList()},e.prototype.initList=function(){this.conf=GameConfig.skillEff[this.sId];var t=[];for(var e in this.conf)if("number"==typeof this.conf[e]||"string"==typeof this.conf[e]){var i={prop:e,value:this.conf[e],sId:this.sId};t.push(i)}this.setListData(this.itemList,t)},e.prototype.generateFunc=function(){var t=GameConfig.monster[1],e=new PropertySet,i="测试怪物";e.recog=App.ThingManager.createRecog(),e.setRoleName(i),e.kind=ThingKind.Monster,e.fightAi=!1;var n=GameCache.hero.focusPlayer.cellXY.x,o=GameCache.hero.focusPlayer.cellXY.y;this.tar=[n,o],e.pro(PropId.AP_HP,Number.MAX_VALUE),e.pro(PropId.AP_MAX_HP,Number.MAX_VALUE),e.pro(PropId.AP_X,n),e.pro(PropId.AP_Y,o),e.pro(PropId.AP_MOVE_SPEED,500),e.pro(PropId.AP_ATTACK_SPEED,1e3),e.pro(PropId.AP_BODY_ID,t.modelid),this.tarPro=e,App.ThingManager.createThingToList(e)},e.prototype.controlFunc=function(){if(!(this.typeTab.selectedIndex<0)&&this.skillId)switch(this.typeTab.selectedIndex){case 0:this.testFunc();break;case 1:this.hitFunc()}},e.prototype.doAll=function(){this.skillId&&(this.testFunc(),this.hitFunc())},e.prototype.testFunc=function(){var t=App.ThingManager.getThing(this.tarPro.recog);App.FightManager.playUseSkill(GameCache.hero.focusPlayer,t.cellXY.x,t.cellXY.y,GameCache.skill.getDefaultUserSkill(this.skillId),this.tarPro.recog)},e.prototype.hitFunc=function(){},e.prototype.backUpFunc=function(t){var e={},i=GameConfig.skillEff[t];for(var n in i)e[n]=i[n];this.backUp&&this.backUp[t]||(this.backUp[t]=e)},e.prototype.reset=function(){if(this.sId){var t=GameConfig.skillEff[this.sId];for(var e in this.backUp[this.sId])t[e]=this.backUp[this.sId][e];this.initList()}},e.prototype.exitFunc=function(){App.ThingManager.removeThing(this.tarPro.recog),App.ViewManager.getView(ViewConst.MAIN_UI).visible=!0,App.ViewManager.getView(ViewConst.MAIN_UI_COCER).visible=!0,this.closeView()},e}(BaseEuiWindow);__reflect(ConfigEditWin.prototype,"ConfigEditWin");var Main=function(t){function e(){var e=t.call(this)||this;return eui.Label.default_fontFamily="Microsoft YaHei",egret.TextField.default_fontFamily="Microsoft YaHei",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){console.log("发布版",egret.Capabilities.runtimeType),RES.setMaxLoadingThread(8),RES.setMaxRetryTimes(1),this.stage.maxTouches=1,this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.stage.addEventListener(egret.Event.RESIZE,this.onResize,this),DeviceUtils.IsCanvas||DeviceUtils.IsMobile?this.stage.frameRate=30:this.stage.frameRate=60,this.stage.registerImplementation("eui.IAssetAdapter",new AssetAdapter),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),LocationProperty.init(),OperatorEgret.init(),EUIResourceManager.ins().init(),App.StageUtils.init(),LayerManager.init(),App.SoundManager.init(0,.5,0,.5),this.loadDefaultRes()},e.prototype.loadDefaultRes=function(){LocationProperty.setLoadProgress(5,"(加载资源配置)"),ResourceUtils.ins().addConfig("resource/default.res.json?cc="+Math.random(),"resource/"),ResourceUtils.ins().loadConfig(this.onConfigComplete,this)},e.prototype.onConfigComplete=function(){ServerMgr.insertLoading(this),LocationProperty.setLoadProgress(10,"(加载资源版本号)"),ResVersionManager.ins().loadConfig("resVersion.json?cc="+Math.random(),this.loadResVersionComplate,this)},e.prototype.loadResVersionComplate=function(){ServerMgr.IsNative?(LocationProperty.setLoadProgress(12,"(加载资源版本号2)"),ResVersionManager.ins().loadConfig2("package.json",this.loadThem,this)):this.loadThem()},e.prototype.loadThem=function(){LocationProperty.setLoadProgress(15,"(加载游戏主题文件)");var t=new eui.Theme("resource/default.thm.json",this.stage);t.once(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onThemeLoadComplete=function(){console.log("加载成功"),this.gameApp=new GameApp,ServerMgr.insertServerSele(this)},e.closesocket=function(){App.Socket.close()},e.prototype.onResize=function(t){App.StageUtils.resize(),App.MessageCenter.dispatch(MsgConst.RESIZE_STAGE)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var DeBugWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Message)||this;return e.cmArr=[["@AddItem ","加道具"],["@openWin ","打开窗口"],["@SkillEdit","打开技能特效调试"],["@debugDragon","龙骨测试"],["@guide 1","引导"],["@usSkill 2","强制使用技能"],["@setCellXY","设置人物格子坐标"],["@AddEqSet","勇士装备全家桶"],["@AddAESet","冒险者全家桶"],["@AddMoney ","添加金钱"],["@Level ","升级"],["@AddHero ","添加副角色"],["@setSysTime ","设置服务器时间"],["@textFlow","富文本格式测试"],["@emojiSize ","表情大小"],["@winCon","功能开启限制"]],e.skinName="DebugWinSkin",e.left=0,e.top=0,e}return __extends(e,t),e.prototype.initUI=function(){},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this),e&&e.exData1&&(this.inText.text=e.exData1),this.addEvent(egret.TouchEvent.TOUCH_TAP,this.sBtn,this.sendFunc),this.addEvent(eui.ItemTapEvent.ITEM_TAP,this.itemList,this.listTouche),this.addEvent(egret.TextEvent.LINK,this.lText,this.onLink),this.addTouchEvent(this.closeBtn,this.closeView),this.initList(),this.pixXY.text="像素坐标：X"+GameCache.hero.focusPlayer.x+",Y"+GameCache.hero.focusPlayer.y,this.gridXY.text="格子坐标：X"+GameCache.hero.focusPlayer.cellXY.x+",Y"+GameCache.hero.focusPlayer.cellXY.y},e.prototype.printXY=function(){},e.prototype.close=function(e){void 0===e&&(e=null),t.prototype.close.call(this)},e.prototype.listTouche=function(t){if("@setSysTime "==t.item.text){var e=GameCache.server.serverTime/1e3,i=App.DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_15);return i=i.replace(" ","-"),void(this.inText.text=t.item.text+i)}"@textFlow"==t.item.text&&(this.currentState="note"),t.item.text&&(this.inText.text=t.item.text)},e.prototype.sendFunc=function(){if(ChatMgr.chechIsGMMsg(this.inText.text))console.log("done");else{if("reset"==this.inText.text&&(this.currentState="nor"),"note"==this.currentState)return void this.labelTextFlow();console.log("非GM命令")}},e.prototype.initList=function(){for(var t=[],e=0,i=this.cmArr;e<i.length;e++){var n=i[e],o={};o.text=n[0],o.des=n[1],t.push(o)}this.setListData(this.itemList,t)},e.prototype.addXYonMainUI=function(){},e.prototype.labelTextFlow=function(){this.lText.textFlow=TextFlowUtils.generateTextFlow(this.inText.text),TextFlowUtils.generateEmoji(this.lText,this.g,!0)},e.prototype.onLink=function(t){var e=t.text;TextFlowUtils.hrefType(e)},e}(BaseEuiWindow);__reflect(DeBugWin.prototype,"DeBugWin");var DragonTestActionItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.addTouchEvent(this.play,this.onPlay)},e.prototype.onPlay=function(){var t=GameCache.hero.focusPlayer;t.playAction(this.data.actionIndex,parseInt(this.inText.text))},e}(BaseCustComponent);__reflect(DragonTestActionItem.prototype,"DragonTestActionItem");var DragonTestItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(BaseCustComponent);__reflect(DragonTestItem.prototype,"DragonTestItem");var DragonTestWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Message)||this;return e.skinName="DragonTestSkin",e.left=0,e.top=0,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.partList.itemRenderer=DragonTestItem,this.actionList.itemRenderer=DragonTestActionItem},e.prototype.open=function(){t.prototype.open.call(this),this.addTouchEvent(this.sBtn,this.onRefresh)},e.prototype.onRefresh=function(){DeBugMgr.dragonTest={};for(var t=this.partList.numElements,e=0;t>e;e++){var i=this.partList.getElementAt(e);DeBugMgr.dragonTest[i.data.partPro]=i.inText.text}GameCache.hero.mainPlayer.loadBody(1)},e}(BaseEuiWindow);__reflect(DragonTestWin.prototype,"DragonTestWin");var EmailCache=function(t){function e(){var e=t.call(this)||this;return e.list=[],e.dic={},e}return __extends(e,t),e.prototype.clear=function(){this.list.length=0,this.dic={}},e.prototype.onEmailDate=function(t,e){var i=t.emailState==EmailInfo.STATE_READ&&!t.attachmentLength||t.emailState==EmailInfo.STATE_READ_PRIZE,n=e.emailState==EmailInfo.STATE_READ&&!e.attachmentLength||e.emailState==EmailInfo.STATE_READ_PRIZE;return i&&!n?1:!i&&n?-1:t.emailTime<e.emailTime?1:t.emailTime>e.emailTime?-1:0},e.prototype.updateState=function(t,e){this.dic[t]?this.dic[t].emailState=e:console.log("无法查询到邮件",t)},e.prototype.deleteEmail=function(t){this.dic[t]&&delete this.dic[t];for(var e=0,i=this.list.length;i>e;e++)if(this.list[e].emailId==t){this.list.splice(e,1);break}},e.prototype.setEmailInfo=function(t,e){this.dic[t]?this.dic[t].updateInfo(e):console.log("无法查询到邮件",t)},e}(BaseCache);__reflect(EmailCache.prototype,"EmailCache");var EmailDetailWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="EmailDetailWinSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.setWinTitle("email")},e.prototype.open=function(e){t.prototype.open.call(this,e),this.id=e.exData1,this.addTouchEvent(this.deleteBtn,this.onDelete),this.addTouchEvent(this.getBtn,this.onGet),this.message(MsgConst.EMAIL_UPDATE,this.update),this.message(MsgConst.EMAIL_REFRESH,this.update),this.update()},e.prototype.dispose=function(){this.itemList.dispose(),t.prototype.dispose.call(this)},e.prototype.update=function(){var t=GameCache.email.dic[this.id];if(!t)return void this.closeView();t.content?this.contentTx.textFlow=TextFlowUtils.generateTextFlow(t.content):Proxy.email.sendGetContent(this.id),this.titleTx.text=StringUtils.substitute(Language.lang.email_title,t.title),this.setAward(t.itemArray),this.getFlag.visible=!1;var e=!1;t.attachmentLength&&(this.getFlag.visible=t.emailState==EmailInfo.STATE_READ_PRIZE,e=!this.getFlag.visible),this.getBtn.filters=e?null:FilterUtils.DefaultGrayFilters},e.prototype.setAward=function(t){t&&t.length>0?(this.itemList||(this.itemList=ObjectPool.get(ItemList)),this.itemList.setData(t,this.iG),this.iG.visible=!0):this.iG.visible=!1},e.prototype.onDelete=function(){Proxy.email.sendDelete(this.id)},e.prototype.onGet=function(){Proxy.email.sendPrize(this.id)},e}(BaseEuiWindow);__reflect(EmailDetailWin.prototype,"EmailDetailWin");var EmailInfo=function(){function t(t){void 0===t&&(t=null),this.itemArray=[],t&&(this.emailId=t.readDouble(),this.emailState=t.readUnsignedByte(),this.emailTime=GlobalFun.formatMiniDateTime(t.readUnsignedInt())/1e3,this.endTime=t.readUnsignedInt(),this.attachmentLength=t.readUnsignedByte(),this.title=t.readCustomBytes())}return t.prototype.updateInfo=function(t){if(this.emailState=t.readByte(),this.content=t.readCustomBytes(),this.attachmentLength=t.readUnsignedByte(),0!=this.attachmentLength)for(var e=0;e<this.attachmentLength;e++){var i=new EmailAttachmentItem;i.type=t.readByte(),i.id=t.readUnsignedShort(),i.bind=t.readByte(),i.count=t.readUnsignedInt(),i.strong=t.readByte(),i.quality=t.readByte(),this.itemArray.push(i)}},t.STATE_NOREAD=0,t.STATE_READ=1,t.STATE_READ_PRIZE=2,t}();__reflect(EmailInfo.prototype,"EmailInfo");var EmailAttachmentItem=function(){function t(){}return t}();__reflect(EmailAttachmentItem.prototype,"EmailAttachmentItem");var EmailItem=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this,this.onTouch)},e.prototype.onTouch=function(){var t=new ViewProp;t.exData1=this.data.emailId,App.ViewManager.open(ViewConst.EMAIL_DETAIL,t)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.refresh()},e.prototype.refresh=function(){var t=this.data;this.titleTx.text=t.title,this.timeTx.text=App.DateUtils.getFormatBySecond(t.emailTime,DateUtils.TIME_FORMAT_15),t.attachmentLength>0?(this.getFlag.visible=t.emailState==EmailInfo.STATE_READ_PRIZE,this.fujianFlag.visible=!this.getFlag.visible):(this.getFlag.visible=!1,this.fujianFlag.visible=!1),this.stateImg.source="email_json.email_"+(t.emailState==EmailInfo.STATE_NOREAD?"close":"open")+"_png"},e}(BaseCustComponent);__reflect(EmailItem.prototype,"EmailItem");var EmailPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="EmailWinSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.list.itemRenderer=EmailItem},e.prototype.open=function(){t.prototype.open.call(this),this.addTouchEvent(this.deleteBtn,this.onDelete),this.addTouchEvent(this.getBtn,this.onGet),this.message(MsgConst.EMAIL_REFRESH,this.onRefresh),this.message(MsgConst.EMAIL_UPDATE,this.onRefresh),this.onRefresh()},e.prototype.onRefresh=function(){var t=GameCache.email.list;this.setListData(this.list,t),t.sort(GameCache.email.onEmailDate);var e=this.list.dataProvider;e?e.replaceAll(t):this.list.dataProvider=new eui.ArrayCollection(t),this.countTx.text=t.length+"/"+GameConfig.globalConfig.nMailMaxCount},e.prototype.onDelete=function(){Proxy.email.sendDelete(0)},e.prototype.onGet=function(){Proxy.email.sendPrize(0)},e}(BaseSpriteView);__reflect(EmailPanel.prototype,"EmailPanel");var EmailProxy=function(t){function e(){var e=t.call(this,PacketTypes.NEW_EAMIL)||this;return e.regNetMsg(1,e.doInit),e.regNetMsg(2,e.doTakePrize),e.regNetMsg(3,e.doDelete),e.regNetMsg(4,e.doEmailInfo),e.regNetMsg(5,e.doNewEmail),e}return __extends(e,t),e.prototype.doInit=function(t){var e=GameCache.email,i=t.readByte(),n=i?e.list:[];!i&&(e.dic={});for(var o,r=t.readUnsignedShort(),a=0;r>a;a++)o=new EmailInfo(t),n.push(o),e.dic[o.emailId]=o;e.list=n,App.MessageCenter.dispatch(MsgConst.EMAIL_REFRESH)},e.prototype.doTakePrize=function(t){for(var e=t.readUnsignedShort(),i=0;e>i;i++){var n=t.readDouble();GameCache.email.updateState(n,EmailInfo.STATE_READ_PRIZE)}App.MessageCenter.dispatch(MsgConst.EMAIL_UPDATE)},e.prototype.doDelete=function(t){for(var e=t.readUnsignedShort(),i=0;e>i;i++){var n=t.readDouble();GameCache.email.deleteEmail(n)}App.MessageCenter.dispatch(MsgConst.EMAIL_REFRESH)},e.prototype.doEmailInfo=function(t){var e=t.readDouble();GameCache.email.setEmailInfo(e,t),App.MessageCenter.dispatch(MsgConst.EMAIL_UPDATE)},e.prototype.doNewEmail=function(t){var e=new EmailInfo(t);GameCache.email.list.push(e),GameCache.email.dic[e.emailId]=e,App.MessageCenter.dispatch(MsgConst.EMAIL_REFRESH)},e.prototype.sendPrize=function(t){void 0===t&&(t=0);var e=this.getBytes(1);e.writeDouble(t),this.sendToServer(e)},e.prototype.sendDelete=function(t){void 0===t&&(t=0);var e=this.getBytes(2);e.writeDouble(t),this.sendToServer(e)},e.prototype.sendGetContent=function(t){var e=this.getBytes(3);e.writeDouble(t),this.sendToServer(e)},e}(BaseProxy);__reflect(EmailProxy.prototype,"EmailProxy");var EmailWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.red=function(){var t=GameCache.email,e=t.list;if(e)for(var i=0,n=e.length;n>i;i++){var o=e[i];if(o.emailState==EmailInfo.STATE_NOREAD)return!0;if(o.attachmentLength&&o.emailState!=EmailInfo.STATE_READ_PRIZE)return!0}return!1},e.changeMsg=function(){return[MsgConst.EMAIL_REFRESH,MsgConst.EMAIL_UPDATE]},e.prototype.init=function(){t.prototype.init.call(this),this.setWinTitle("email");for(var e=[EmailPanel],i=[],n=0;n<e.length;n++){var o={};o.icon="apEmail_json.apEmail_u_"+n+"_png",o.icon2="apEmail_json.apEmail_"+n+"_png",i.push(o)}this.setViewData(i,e)},e}(CommunalPageWin);__reflect(EmailWin.prototype,"EmailWin");var EquipCache=function(t){function e(){var e=t.call(this)||this;return e.roleEquipList={},e.roleStrengthList={},e.roleRefineList={},e.roleRed=[],e}return __extends(e,t),e.prototype.clear=function(){this.roleEquipList={},this.roleStrengthList={},this.roleRefineList={}},e.prototype.initEqList=function(t,e){e&&(this.roleEquipList[t]=e)},e.prototype.wearEq=function(t,e){var i=GameCache.bag.getUserItemBySeries(e);if(i){var n=this.roleEquipList[t];n||(n=this.roleEquipList[t]=[]),i.sourceType=ItemSourceType.ROLEEQUIP,n[i.stdItem.part]=i}},e.prototype.dropEquip=function(t,e){var i=this.roleEquipList[t];for(var n in i){var o=i[n];o&&o.series.isEquals(e)&&(i[n]=null)}},e.prototype.compartPower=function(t){var e=ItemUtils.getEquipJob(t),i=GameCache.hero.getProByJob(e);if(!i)return 0;var n=t.part,o=GameCache.hero.getDataByJob(e,this.roleEquipList);if(!o)return 1;var r=o[n];return r?ItemUtils.getItemZDL(t)-ItemUtils.getItemZDL(r.stdItem):1},e.prototype.bEquip=function(t){var e=ItemUtils.getEquipJob(t),i=GameCache.hero.getProByJob(e);if(!i)return!1;var n=t.part,o=GameCache.hero.getDataByJob(e,this.roleEquipList);if(!o)return!1;var r=o[n];return r?!0:!1},e.prototype.getRolePower=function(t){var e=0;for(var i in this.roleEquipList[t])e+=ItemUtils.getItemZDL(this.roleEquipList[t][i]);return e},e.prototype.quickWear=function(t){if(void 0===t&&(t=0),0!=t){var e=GameCache.bag.roleSuggestBag[t];if(e){var i=GameCache.hero.getServerIdByJob(t);if(-1!=i){var n=[];for(var o in e)n.push(e[o]);Proxy.equip.sendQuickEquip(i,n),GameCache.bag.roleSuggestBag[t]={}}}}else for(var o=1;3>=o;o++)this.quickWear(o)},e}(BaseCache);__reflect(EquipCache.prototype,"EquipCache");var EquipProxy=function(t){function e(){var e=t.call(this,PacketTypes.EQUIP)||this;return e.regNetMsg(3,e.doInitPlayerEquip),e.regNetMsg(1,e.doWearEquip),e.regNetMsg(11,e.doWearEquip2),e.regNetMsg(2,e.doDropEquip),e.regNetMsg(4,e.doEquipDuraChange),e.regNetMsg(5,e.doOthersEquips),e.regNetMsg(6,e.doDeleteEquips),e.regNetMsg(7,e.doRankCheckEquipBack),e.regNetMsg(8,e.doSpecialEquipBack),e.regNetMsg(9,e.doRankHeroEquipBack),e.regNetMsg(16,e.doStrengthInfo),e.regNetMsg(30,e.doRefineInfo),e.regNetMsg(31,e.doQuickEquip),e}return __extends(e,t),e.prototype.doServerMessage=function(t){},e.prototype.doInitPlayerEquip=function(t){for(var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=t.readByte(),n=[],o=0;i>o;o++){var r=t.readByte(),a=new UserItem(t);a.sourceType=ItemSourceType.ROLEEQUIP,n[r]=a}GameCache.equip.initEqList(e,n)},e.prototype.doWearEquip=function(t){var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=new ItemSeries(t);t.readUnsignedShort();GameCache.equip.wearEq(e,i),App.MessageCenter.dispatch(MsgConst.EQUIP_INFO)},e.prototype.doWearEquip2=function(t){var e=new UserItem(t);e.sourceType=ItemSourceType.ROLEEQUIP,App.MessageCenter.dispatch(MsgConst.EQUIP_INFO)},e.prototype.doDropEquip=function(t){var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=new ItemSeries(t);GameCache.equip.dropEquip(e,i),App.MessageCenter.dispatch(MsgConst.EQUIP_INFO)},e.prototype.doDeleteEquips=function(t){new ItemSeries(t)},e.prototype.doEquipDuraChange=function(t){new ItemSeries(t),t.readUnsignedInt()},e.prototype.doRankCheckEquipBack=function(t){},e.prototype.doStrengthInfo=function(t){for(var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt())+"",i=[],n=0;10>n;n++){var o=t.readUnsignedShort();i.push(o)}GameCache.equip.roleStrengthList[e]=i.concat(),App.MessageCenter.dispatch(MsgConst.EQUIP_STRENGTH)},e.prototype.doRefineInfo=function(t){for(var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=t.readByte(),n=[],o=0;i>o;o++){var r=t.readUnsignedShort();n.push(r)}GameCache.equip.roleRefineList[e]=n.concat(),App.MessageCenter.dispatch(MsgConst.EQUIP_REFINE)},e.prototype.doQuickEquip=function(t){GameCache.hero.transIdFromeServer(t.readInt());GameCache.bag.reFreshRecyle()},e.prototype.sendQueryMyEquip=function(){this.sendMsgId(4)},e.prototype.sendWearEquip=function(t,e,i){void 0===e&&(e=2),void 0===i&&(i=0);var n=this.getBytes(1);n.writeInt(i),t.writeToBytes(n),n.writeByte(e),this.sendToServer(n)},e.prototype.sendDropEquipByItemSeries=function(t,e){void 0===e&&(e=0);var i=this.getBytes(2);i.writeInt(e),t.writeToBytes(i),this.sendToServer(i)},e.prototype.sendDropEquipByPos=function(t){var e=this.getBytes(3);e.writeByte(t),this.sendToServer(e)},e.prototype.sendQueryOthersEquips=function(t){var e=this.getBytes(1);e.writeString(t),this.sendToServer(e)},e.prototype.sendHideSuitEquips=function(t){void 0===t&&(t=0);var e=this.getBytes(1);e.writeByte(t),this.sendToServer(e)},e.prototype.sendRankCheckEquips=function(t,e){void 0===e&&(e=0);var i=this.getBytes(1);i.writeString(t),i.writeUnsignedInt(e),this.sendToServer(i)},e.prototype.sendRankCheckHeroEquips=function(t,e){var i=this.getBytes(1);i.writeUnsignedInt(t),i.writeByte(e),this.sendToServer(i)},e.prototype.sendInsureEquip=function(t,e){var i=this.getBytes(1);t.writeToBytes(i),i.writeByte(e),this.sendToServer(i)},e.prototype.doOthersEquips=function(t){},e.prototype.doSpecialEquipBack=function(t){},e.prototype.doRankHeroEquipBack=function(t){},e.prototype.doEquipInsure=function(t){new UserItem(t),t.readUnsignedShort()},e.prototype.sendEquipStrength=function(t){var e=GameCache.hero.getServerIdByIndex(t),i=this.getBytes(16);i.writeInt(e),this.sendToServer(i)},e.prototype.sendRefine=function(t,e){var i=this.getBytes(32),n=GameCache.hero.getServerIdByIndex(t);i.writeInt(n),i.writeShort(e),this.sendToServer(i)},e.prototype.sendQuickEquip=function(t,e){var i=this.getBytes(33);i.writeInt(t),i.writeByte(e.length);for(var n=0;n<e.length;n++)e[n].series.writeToBytes(i);this.sendToServer(i)},e}(BaseProxy);__reflect(EquipProxy.prototype,"EquipProxy");var EquipItem=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._strenghLvl=0,e._refineLv=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},Object.defineProperty(e.prototype,"strengthLvl",{set:function(t){t&&t.length&&(this.strength||(this.strength=new eui.Label,this.strength.textColor=458496,this.strength.stroke=2,this.strength.strokeColor=0,this.strength.size=16,this.strength.top=7,this.strength.left=9,this.addChild(this.strength)),0!=t[0]?(this.strength.text=t[0],this._strenghLvl=t[0]):this.strength.text="")
},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strenghLvl",{get:function(){return this._strenghLvl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"refineLvl",{get:function(){return this._refineLv},set:function(t){t>0&&(this._refineLv=t),this.refine||(this.refine=new eui.Label,this.refine.textColor=52479,this.refine.stroke=2,this.refine.strokeColor=0,this.refine.size=16,this.refine.bottom=7,this.refine.right=9,this.addChild(this.refine)),this.refine.text=t>0?"+"+t:""},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(ItemBase);__reflect(EquipItem.prototype,"EquipItem");var FailTips=function(t){function e(){var e=t.call(this,LayerManager.UI_TipsNoClick)||this;return e.skinName="FailTipsSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=FailTipsItem},e.prototype.open=function(e){t.prototype.open.call(this),this.addTouchEvent(this.btn,this.btnFunc);var i=GameCache.hero.mainPro.pro(PropId.AP_VIP_POINT);this.img.source=0==i?"fail_json.fail_texture_0_png":"fail_json.fail_texture_2_png",this.initList()},e.prototype.close=function(e){t.prototype.close.call(this);GameCache.map.mapConfig},e.prototype.initList=function(){var t=GameConfig.fail,e=[];for(var i in t)e.push(t[i]);this.setListData(this.itemList,e)},e.prototype.btnFunc=function(){this.closeView()},e.prototype.rechargeFunc=function(){GlobalFun.gotoCharge(),this.closeView()},e}(BaseEuiWindow);__reflect(FailTips.prototype,"FailTips");var FailTipsItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.btn,this.linkFunc)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.id&&(this.desc.text=this.data.dec,this.icon.source=RES_DIR_SYSOPEN_ICON+this.data.icon,this.iName.source=RES_DIR_SYSOPEN_NAME+this.data.icon_name)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.linkFunc=function(){TextFlowUtils.hrefType(this.data.jump),App.ViewManager.close(ViewConst.FAIL)},e}(BaseCustComponent);__reflect(FailTipsItem.prototype,"FailTipsItem");var FamilyApplyConfigPanel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.STATE_UP="up",i.STATE_DOWN="down",i.skinName="FamilyApplyConfigPanelSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.bg.setNameImg("family_title_setting"),this.labCheck.text=Language.lang.familyApplyAuto},e.prototype.open=function(e){t.prototype.open.call(this,e),this.currentState=this.STATE_UP,this.addTouchEvent(this.imgDrop,this.onDropImgClick),this.addTouchEvent(this.dropList,this.onListClick),this.addTouchEvent(this.btnSure,this.onBtnSureClick),this.dropList.itemRenderer=FamilyDropItem,this.updateView()},e.prototype.updateView=function(){var t=GameConfig.familyCfg,e=t.condition,i=GameCache.family.limitId;this.chkAuto.selected=GameCache.family.isAuto,this.labSelected.text=StringUtils.substitute(Language.lang.familyApplyCondition,e[i||0]);for(var n=[],o=0;o<e.length;o++){var r=e[o];n.push({id:o,sc:r})}this.setListData(this.dropList,n)},e.prototype.onDropImgClick=function(t){this.currentState===this.STATE_UP?this.currentState=this.STATE_DOWN:this.currentState=this.STATE_UP},e.prototype.onListClick=function(t){var e=t.currentTarget,i=GameConfig.familyCfg,n=i.condition;GameCache.family.limitId=e.selectedItem.id,this.labSelected.text=StringUtils.substitute(Language.lang.familyApplyCondition,n[e.selectedItem.id]),this.currentState=this.STATE_UP},e.prototype.onBtnSureClick=function(){Proxy.family.setLimit(this.chkAuto.selected?1:0,GameCache.family.limitId),App.ViewManager.close(this.viewKey)},e}(BaseEuiWindow);__reflect(FamilyApplyConfigPanel.prototype,"FamilyApplyConfigPanel");var FamilyApplyItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEvent(egret.TextEvent.LINK,this.labName,this.onLink),this.addTouchEvent(this.btnAgree,this.onBtnAgreeClick),this.addTouchEvent(this.btnSubject,this.onBtnSubjectClick)},e.prototype.onBtnSubjectClick=function(){var t=this.data;Proxy.family.familyApplyResponse(!1,t.aid)},e.prototype.onBtnAgreeClick=function(){var t=this.data;Proxy.family.familyApplyResponse(!0,t.aid)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.icon.source=GlobalFun.getRoleIcon(e.job,e.sex),this.mLvl.text=e.lv.toString(),this.labName.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.roleNameLinke,e.aid,e.name)),this.labLv.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.familyMemLv,e.lv)),this.labScore.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.familyMemScore,e.score))},e.prototype.onLink=function(t){var e=t.text;TextFlowUtils.hrefType(e)},e}(BaseCustComponent);__reflect(FamilyApplyItem.prototype,"FamilyApplyItem");var FamilyApplyPanel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="FamilyApplyPanelSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.bg.setNameImg("family_title_apply")},e.prototype.open=function(e){t.prototype.open.call(this,e),this.message(MsgConst.FAMILY_APPLY_UPDATE,this.updateView),Proxy.family.applyListReq(),this.list.itemRenderer=FamilyApplyItem},e.prototype.updateView=function(){this.setListData(this.list,GameCache.family.applyList||[])},e}(BaseEuiWindow);__reflect(FamilyApplyPanel.prototype,"FamilyApplyPanel");var FamilyCache=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.clear=function(){this.isInFamily=!1,this.fInfo=null,this.isAuto=!1,this.limitId=null,this.mList=null,this.applyList=null,this.fList=null},e.prototype.dismiss=function(){this.isInFamily=!1,this.fInfo=null,this.mList=null,this.applyList=null,this.isAuto=!1,GameCache.hero.focusPlayer.title.setFamilyName("")},e}(BaseCache);__reflect(FamilyCache.prototype,"FamilyCache");var FamilyConst=function(){function t(){}return t.FAMILY_POS_MEMBER=0,t.FAMILY_POS_ELDER=1,t.FAMILY_POS_LEADER=2,t.STATE_MEM="mem",t.STATE_POS="pos",t.PERMIT_0=0,t.PERMIT_1=1,t.PERMIT_2=2,t.PERMIT_3=3,t.PERMIT_4=4,t.PERMIT_5=5,t}();__reflect(FamilyConst.prototype,"FamilyConst");var FamilyCreatePanel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="FamilyCreatePanelSkin",i}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this,e),this.addTouchEvent(this.btnSure,this.onBtnSureClick),this.updateView()},e.prototype.init=function(){t.prototype.init.call(this),this.bg.setNameImg("family_title_create"),this.labCost.text=Language.lang.consume},e.prototype.updateView=function(){var t=GameConfig.familyCfg;this.labDesc.text=StringUtils.substitute(Language.lang.familyCreateLimit,t.createMinVipLevel),this.cost.item=GlobalVar.GOLD,this.cost.countTxt.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.familyCreateCost,t.needYbCount))},e.prototype.onBtnSureClick=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_VIP_GRADE);return t<GameConfig.familyCfg.createMinVipLevel?void GlobalFun.SysMsg(Language.lang.familyCreateVIPLack):(Proxy.family.createFamilyReq(this.input.text),void App.ViewManager.close(this.viewKey))},e.prototype.close=function(){t.prototype.close.call(this)},e}(BaseEuiWindow);__reflect(FamilyCreatePanel.prototype,"FamilyCreatePanel");var FamilyDismissTipsPanel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="FamilyDismissTipsSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.bg.setNameImg("family_title_dismiss")},e.prototype.open=function(e){t.prototype.open.call(this,e),this.addTouchEvent(this.btnSure,this.onBtnSureClick),this.updateView()},e.prototype.updateView=function(){this.desc.text=Language.lang.familyDismissDesc,this.desc2.text=Language.lang.familyDismissDesc2},e.prototype.onBtnSureClick=function(){Proxy.family.dismissFamilyReq(),App.ViewManager.close(this.viewKey)},e}(BaseEuiWindow);__reflect(FamilyDismissTipsPanel.prototype,"FamilyDismissTipsPanel");var FamilyDropItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.labLimit.text=StringUtils.substitute(Language.lang.familyApplyCondition,this.data.sc)},e}(BaseCustComponent);__reflect(FamilyDropItem.prototype,"FamilyDropItem");var FamilyInfoPanel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="FamilyInfoPanelSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.icon.source="family_json.family_icon_png"},e.prototype.open=function(e){t.prototype.open.call(this,e),this.message(MsgConst.FAMILY_INFO_UPDATE,this.updateView),this.addTouchEvent(this.noteceBan,this.onNoticeClick),this.addTouchEvent(this.optionList,this.onListClick),this.optionList.itemRenderer=FamilyOption,this.updateView()},e.prototype.updateView=function(){var t=GameCache.family.fInfo;if(!t)return void App.ViewManager.close(ViewConst.FAMILY);this.title.text=StringUtils.substitute(Language.lang.familyTitle,t.fName,t.fLv),this.leaderName.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.familyLeaderName,t.lName));var e=GameConfig.familyLv[t.fLv];this.memNum.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.familyMemNum,t.memNum,e.memCountLimit)),this.money.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.familyFund,t.fund,e.upLvConsume)),this.score.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.familyScore,t.fScore)),this.notice.text=t.notice;var i=[];for(var n in GameConfig.familySys){var o=GameConfig.familySys[n];o.open<=t.position&&i.push(o)}this.setListData(this.optionList,i)},e.prototype.onListClick=function(t){var e=t.currentTarget.selectedItem;GameCache.family.fInfo&&GameCache.family.fInfo.position>=e.open&&TextFlowUtils.hrefType(e.jump)},e.prototype.onNoticeClick=function(){App.ViewManager.open(ViewConst.FAMILY_NOTICE)},e}(BaseSpriteView);__reflect(FamilyInfoPanel.prototype,"FamilyInfoPanel");var FamilyListItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.btnApply,this.onBtnApplyClick)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.btnApply.visible=!GameCache.family.isInFamily;var e=this.data;this.fName.text=StringUtils.substitute(Language.lang.familyName,e.fName,e.fLv);var i=GameConfig.familyCfg.condition[e.limitId],n=i>0?StringUtils.substitute(Language.lang.familyLimitScore,i):Language.lang.familyNoLimit;this.limit.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.familyLimit,n)),this.memNum.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.familyNum,e.memNum,e.memMax)),this.score.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.familyScore,e.fScore))},e.prototype.onBtnApplyClick=function(){Proxy.family.familyApplyReq(this.data.fId),App.ViewManager.close(ViewConst.FAMILY_LIST)},e}(BaseCustComponent);__reflect(FamilyListItem.prototype,"FamilyListItem");var FamilyListPanel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="FamilyListPanelSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.bg.setNameImg("family_title_other")},e.prototype.open=function(e){t.prototype.open.call(this,e),this.message(MsgConst.FAMILY_LIST_UPDATE,this.updateView),Proxy.family.familyListReq(),this.addTouchEvent(this.btnCreate,this.onBtnCreateClick),this.addTouchEvent(this.btnApply,this.onBtnApplyClick),this.list.itemRenderer=FamilyListItem},e.prototype.updateView=function(){this.btnApply.visible=this.btnCreate.visible=!GameCache.family.isInFamily;var t=GameCache.family.fList;t&&this.setListData(this.list,t)},e.prototype.onBtnApplyClick=function(){},e.prototype.onBtnCreateClick=function(){App.ViewManager.open(ViewConst.FAMILY_CREATE),App.ViewManager.close(this.viewKey)},e}(BaseEuiWindow);__reflect(FamilyListPanel.prototype,"FamilyListPanel");var FamilyMemberPanel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="FamilyMemberPanelSkin",i}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this,e),this.message(MsgConst.FAMILY_MEM_UPDATE,this.updateView),Proxy.family.familyMemInfoReq(),this.curState=this.currentState=FamilyConst.STATE_MEM,this.addTouchEvent(this.btnSetting,this.onBtnSettingClick),this.addTouchEvent(this.btnCheck,this.onBtnApplyClick),this.addTouchEvent(this.btnPosition,this.onBtnPosClick),this.addTouchEvent(this.btnMem,this.onBtnMemClick),this.list.itemRenderer=FamilyMemItem},e.prototype.updateView=function(){var t=[];for(var e in GameCache.family.mList){var i=GameCache.family.mList[e];t.push({state:this.currentState,mInfo:i})}this.setListData(this.list,t)},e.prototype.onBtnSettingClick=function(){var t=GameConfig.familyCfg.privilege[GameCache.family.fInfo.position];return-1==t.indexOf(FamilyConst.PERMIT_5)?void GlobalFun.SysMsg(Language.lang.familyNoPermit):void App.ViewManager.open(ViewConst.FAMILY_SETTING)},e.prototype.onBtnApplyClick=function(){var t=new ViewProp;t.winTitle="family_title_apply",App.ViewManager.open(ViewConst.FAMILY_APPLY)},e.prototype.onBtnPosClick=function(){this.curState!==FamilyConst.STATE_POS&&(this.curState=this.currentState=FamilyConst.STATE_POS,this.updateView())},e.prototype.onBtnMemClick=function(){this.curState!==FamilyConst.STATE_MEM&&(this.curState=this.currentState=FamilyConst.STATE_MEM,this.updateView())},e}(BaseSpriteView);__reflect(FamilyMemberPanel.prototype,"FamilyMemberPanel");var FamilyMemItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.btnQuit,this.onBtnQuitClick),this.addTouchEvent(this.btnKick,this.onBtnKickClick),this.addTouchEvent(this.btnPro,this.onBtnProClick),this.addTouchEvent(this.btnDe,this.onBtnDeClick)},e.prototype.onBtnQuitClick=function(){Proxy.family.quitFamilyReq()},e.prototype.onBtnKickClick=function(){Proxy.family.kickMember(this.data.mInfo.memId)},e.prototype.onBtnProClick=function(){},e.prototype.onBtnDeClick=function(){},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data.mInfo;this.icon.source=GlobalFun.getRoleIcon(e.job,e.sex,1),this.mFlag.source="family_json.family_mem_flag"+e.position+"_png",this.mLvl.text=e.lv.toString(),this.labName.text=StringUtils.substitute(Language.lang.familyMemName,e.memName,e.lv),this.labScore.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.familyMemScore,e.score)),this.labDevote.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.familyMemDevote,e.devote));var i;if(1===e.state)i=Language.lang.familyMemOnline;else{var n=GameCache.server.serverTime-e.lastLogin;i=StringUtils.substitute(Language.lang.familyMemOffline,App.DateUtils.getFormatBySecond(n,DateUtils.TIME_FORMAT_4))}this.labState.textFlow=TextFlowUtils.generateTextFlow(i);var o=GameCache.family.fInfo;if(this.btnDe.visible=this.btnKick.visible=this.btnPro.visible=this.btnQuit.visible=!1,e.memId===GameCache.hero.mainPro.pro(PropId.AP_ACTOR_ID))return void(this.btnQuit.visible=!0);var r=GameConfig.familyCfg.privilege[o.position];this.data.state===FamilyConst.STATE_MEM?r.indexOf(FamilyConst.PERMIT_2)&&e.position<o.position&&(this.btnKick.visible=!0):r.indexOf(FamilyConst.PERMIT_1)&&e.position<o.position&&(e.position===FamilyConst.FAMILY_POS_ELDER?this.btnDe.visible=!0:this.btnPro.visible=!0)},e}(BaseCustComponent);__reflect(FamilyMemItem.prototype,"FamilyMemItem");var FamilyNoticePanel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="FamilyNoticeSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.bg.setNameImg("family_title_notece")},e.prototype.open=function(e){t.prototype.open.call(this,e),this.message(MsgConst.FAMILY_INFO_UPDATE,this.updateView),this.addTouchEvent(this.btnSure,this.onBtnSureClick),this.addEvent(egret.TextEvent.CHANGE,this.notice,this.onTextChanging),this.updateView()},e.prototype.updateView=function(){this.notice.text=GameCache.family.fInfo.notice,this.count.text=StringUtils.substitute(Language.lang.familyNoticeLimit,this.notice.text.length,60)},e.prototype.onBtnSureClick=function(){Proxy.family.sendFamilyNotice(this.notice.text),App.ViewManager.close(this.viewKey)},e.prototype.onTextChanging=function(t){this.count.text=StringUtils.substitute(Language.lang.familyNoticeLimit,this.notice.text.length,60)},e}(BaseEuiWindow);__reflect(FamilyNoticePanel.prototype,"FamilyNoticePanel");var FamilyOption=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.icon.source="family_json."+this.data.icon+"_png",this.labName.text=this.data.name},e}(BaseCustComponent);__reflect(FamilyOption.prototype,"FamilyOption");var FamilyPanel=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this,e)},e}(CommunalPagePannel);__reflect(FamilyPanel.prototype,"FamilyPanel");var FamilyProxy=function(t){function e(){var e=t.call(this,PacketTypes.FAMILY)||this;return e.regNetMsg(1,e.updateFamilyInfo),e.regNetMsg(2,e.updateFamilyMemInfo),e.regNetMsg(3,e.updateFamilyList),e.regNetMsg(6,e.dismissFamilyRes),e.regNetMsg(11,e.updateApplyList),e.regNetMsg(13,e.kickMemberRes),e.regNetMsg(18,e.setLimitRes),e.regNetMsg(20,e.onFamilyInfoNew),e.regNetMsg(21,e.onFamilyListNew),e.regNetMsg(22,e.onFamilyApplyNew),e.regNetMsg(23,e.quitFamilyRes),e}return __extends(e,t),e.prototype.familyInfoReq=function(){this.sendMsgId(1)},e.prototype.updateFamilyInfo=function(t){var e=t.readUnsignedByte();if(GameCache.family.isInFamily=0===e,1===e)return void(GameCache.family.fInfo=null);var i={};i.position=t.readUnsignedByte(),i.fName=t.readCustomBytes(),i.fLv=t.readUnsignedByte(),i.lId=t.readInt(),i.lName=t.readCustomBytes(),i.notice=t.readCustomBytes(),i.memNum=t.readInt(),i.fund=t.readInt(),i.fScore=t.readInt(),i.devote=t.readInt(),i.devoteTotal=t.readInt(),GameCache.family.fInfo=i,GameCache.family.isAuto=1===t.readUnsignedByte(),GameCache.family.limitId=t.readUnsignedByte(),GameCache.hero.focusPlayer.title.setFamilyName(i.fName),App.MessageCenter.dispatch(MsgConst.FAMILY_INFO_UPDATE)},e.prototype.familyMemInfoReq=function(){this.sendMsgId(2)},e.prototype.updateFamilyMemInfo=function(t){for(var e=t.readInt(),i=[],n=0;e>n;n++){var o={};o.memId=t.readInt(),o.sex=t.readByte(),o.lv=t.readByte(),o.job=t.readByte(),o.position=t.readByte(),o.state=t.readByte(),o.lastLogin=GlobalFun.formatMiniDateTime(t.readInt()),o.memName=t.readCustomBytes(),o.score=t.readInt(),o.devote=t.readInt(),o.devoteTotal=t.readInt(),i.push(o)}GameCache.family.mList=i,App.MessageCenter.dispatch(MsgConst.FAMILY_MEM_UPDATE)},e.prototype.familyListReq=function(){this.sendMsgId(3)},e.prototype.updateFamilyList=function(t){for(var e=t.readUnsignedShort(),i=[],n=0;e>n;n++){var o={};o.fId=t.readInt(),o.memNum=t.readInt(),o.memMax=t.readInt(),o.fName=t.readCustomBytes(),o.leadName=t.readCustomBytes(),o.fLv=t.readByte(),o.fScore=t.readInt(),o.limitId=t.readInt(),i.push(o)}GameCache.family.fList=i,App.MessageCenter.dispatch(MsgConst.FAMILY_LIST_UPDATE)},e.prototype.applyListReq=function(){this.sendMsgId(11)},e.prototype.updateApplyList=function(t){for(var e=t.readInt(),i=[],n=0;e>n;n++){var o={};o.aid=t.readInt(),o.sex=t.readByte(),o.job=t.readByte(),o.lv=t.readInt(),o.name=t.readCustomBytes(),o.score=t.readInt(),i.push(o)}GameCache.family.applyList=i,App.MessageCenter.dispatch(MsgConst.FAMILY_APPLY_UPDATE)},e.prototype.createFamilyReq=function(t){var e=this.getBytes(5);e.writeString(t),this.sendToServer(e)},e.prototype.dismissFamilyReq=function(){this.sendMsgId(6)},e.prototype.dismissFamilyRes=function(t){GameCache.family.dismiss(),this.familyInfoReq(),App.ViewManager.close(ViewConst.FAMILY)},e.prototype.familyApplyReq=function(t){var e=this.getBytes(10);e.writeInt(t),this.sendToServer(e)},e.prototype.sendFamilyNotice=function(t){var e=this.getBytes(17);e.writeString(t),this.sendToServer(e)},e.prototype.setLimit=function(t,e){var i=this.getBytes(18);i.writeByte(t),i.writeByte(e),this.sendToServer(i)},e.prototype.setLimitRes=function(t){GameCache.family.isAuto=1===t.readByte(),GameCache.family.limitId=t.readUnsignedByte()},e.prototype.onFamilyInfoNew=function(t){this.familyInfoReq()},e.prototype.onFamilyListNew=function(t){this.familyListReq()},e.prototype.onFamilyApplyNew=function(t){this.applyListReq()},e.prototype.quitFamilyReq=function(){this.sendMsgId(16)},e.prototype.quitFamilyRes=function(t){var e=t.readUnsignedByte();GameCache.family.isInFamily=0===e,1===e&&(GlobalFun.SysMsg(Language.lang.familyQuitMsg),GameCache.family.fInfo=null,App.ViewManager.close(ViewConst.FAMILY)),0===e&&(App.ViewManager.close(ViewConst.FAMILY_LIST),GlobalFun.SysMsg(Language.lang.familyEnterMsg))},e.prototype.familyApplyResponse=function(t,e){var i=this.getBytes(12);i.writeInt(e),i.writeByte(t?1:0),this.sendToServer(i)},e.prototype.kickMember=function(t){var e=this.getBytes(13);e.writeInt(t),this.sendToServer(e)},e.prototype.kickMemberRes=function(t){var e=t.readUnsignedByte();1===e&&this.familyMemInfoReq()},e.prototype.familyPromoteReq=function(){},e.prototype.familyDemote=function(){},e}(BaseProxy);__reflect(FamilyProxy.prototype,"FamilyProxy");var FamilyWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPageWin);__reflect(FamilyWin.prototype,"FamilyWin");var CoordinateItem=function(t){function e(){var e=t.call(this)||this;return e.itemArr=[],e.bState=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.tBtn,this.onTouche)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.id&&(this.itemArr=[],this.initItem(),this.btnState())},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.itemArr=[]},e.prototype.initItem=function(){this.active.visible=!0;for(var t=0;8>t;t++){var e=GameConfig.fashion[this.data.part[t]],i=GameCache.fashion.checkHave(e);i||(this.active.visible=!1),this["item_"+t].data=e,this.itemArr.push(e)}},e.prototype.reflashItemList=function(){for(var t=0;8>t;t++)this["item_"+t].initState()},e.prototype.btnState=function(){for(var t=0;t<this.itemArr.length;t++){var e=GameCache.fashion.tempProp.pro(this.itemArr[t].part);if(e!=this.itemArr[t].shape)return this.bState=!0,void(this.tBtn.icon="fashion_json.fashion_try2_png")}this.bState=!1,this.tBtn.icon="res/btn/takeOff.png"},e.prototype.onTouche=function(){this.bState?(GameCache.fashion.tryFashion(this.itemArr),App.ViewManager.close(ViewConst.COORDINATE)):(GameCache.fashion.takeOff(this.itemArr),this.bState=!0,this.tBtn.icon="fashion_json.fashion_try2_png")},e.prototype.tryFashion=function(){GameCache.fashion.tryFashion(this.itemArr)},e.prototype.takeOff=function(){GameCache.fashion.takeOff(this.itemArr)},e}(BaseCustComponent);__reflect(CoordinateItem.prototype,"CoordinateItem");var CoordinateTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="CoordinateTipsSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=CoordinateItem},e.prototype.open=function(e){t.prototype.open.call(this),this.initList(e.exData1)},e.prototype.initList=function(t){var e=GameConfig.fashionSuit,i=[];for(var n in e)(0==e[n].conds[0].value||e[n].conds[0].value==t)&&i.push(e[n]);this.setListData(this.itemList,i)},e.prototype.refleshItem=function(){var t=this.itemList.selectedIndex,e=this.itemList.getElementAt(t);e.reflashItemList()},e}(BaseEuiWindow);__reflect(CoordinateTips.prototype,"CoordinateTips");var FashionBuyTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.itemArr=[],e.skinName="FashionBuyTipsSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=ItemBase,this.setWinTitle("fashion"),this.t0.text=Language.lang.consume},e.prototype.open=function(e){t.prototype.open.call(this),this.addTouchEvent(this.buyBtn,this.buyFashion),this.addTouchEvent(this.cBtn,this.closeView),this.initPrice(e.exData1),this.initList(e.exData1),this.role=e.exData2},e.prototype.initList=function(t){this.itemArr=[],this.setListData(this.itemList,t),this.itemArr=t.concat()},e.prototype.initPrice=function(t){var e=this;void 0===t&&(t=[]);for(var i={},n=0,o=t;n<o.length;n++)for(var r=o[n],a=0,s=r.needNum;a<s.length;a++){var h=s[a];i[h.id]||(i[h.id]=0),i[h.id]+=h.count}for(var r in i){var p=new ItemExpend;p.skinName="ItemExpend5Skin",this.costGroup.addChild(p),p.currentState="single"}App.TimerManager.addDelay(50,50,1,function(){var t=0;for(var n in i){var o=e.costGroup.getChildAt(t);o.setData(parseInt(n),i[n]),t++}},this)},e.prototype.close=function(e){t.prototype.close.call(this),this.itemArr=[];for(var i=0;i<this.costGroup.numChildren;i++){var n=this.costGroup.getChildAt(i);App.DisplayUtils.removeFromParent(n),n.dispose(),n=null}},e.prototype.buyFashion=function(){for(var t=0;t<this.costGroup.numChildren;t++){var e=this.costGroup.getChildAt(t);if(!e.checkEnough())return}GameCache.fashion.fashionBuy(this.itemArr),GameCache.fashion.dish={},App.ViewManager.close(ViewConst.FASHIONBUY)},e}(BaseEuiWindow);__reflect(FashionBuyTips.prototype,"FashionBuyTips");var FashionCache=function(t){function e(){var e=t.call(this)||this;return e.roleFashionData={},e.fashionBag={},e.dish={},e.timeLimitItem={},e}return __extends(e,t),e.prototype.clear=function(){this.fashionBag={},this.tempProp=null,this.dish={},this.timeLimitItem={},this.roleFashionData={}},e.prototype.initRoleFashion=function(t,e){var i=GameConfig.fashion[t];if(i){this.roleFashionData[e]||(this.roleFashionData[e]={});var n=this.roleFashionData[e];n[i.part]=i}},e.prototype.cleanRoleFashion=function(t){this.roleFashionData[t]&&(this.roleFashionData[t]={})},e.prototype.addFashionItem=function(t,e,i){this.fashionBag[t]?this.fashionBag[t][e]?this.fashionBag[t][e].push(i):this.fashionBag[t][e]=[i]:(this.fashionBag[t]={},this.fashionBag[t][e]=[i]),App.MessageCenter.dispatch(MsgConst.FASHION_GET)},e.prototype.deleteFashionItem=function(t,e,i){if(this.fashionBag[t]&&this.fashionBag[t][e]){var n=this.fashionBag[t][e].indexOf(i);0>n||this.fashionBag[t][e].splice(n,1)}},e.prototype.fashionBuy=function(t){t.length&&(Proxy.fashion.sendOneBuy(this.role,t),App.ViewManager.isShow(ViewConst.ITEMTIPS)&&App.ViewManager.close(ViewConst.ITEMTIPS))},e.prototype.tryFashion=function(t){for(var e=GameCache.hero.getProByIndex(this.role).job-1,i=0,n=t;i<n.length;i++){var o=n[i];this.tempProp.pro(o.part,o.shape[e]),this.dish[o.part]=o}App.MessageCenter.dispatch(MsgConst.FASHION_TRY,t)},e.prototype.takeOff=function(t){if(8==t.length)Proxy.fashion.sendOneTakeOff(this.role),App.MessageCenter.dispatch(MsgConst.FASHION_TRY,t,!1);else for(var e=0,i=t;e<i.length;e++){var n=i[e];this.tempProp.pro(n.part,""),delete this.dish[n.part],Proxy.fashion.sendTakeOff(this.role,n.part)}App.MessageCenter.dispatch(MsgConst.FASHION_TRY,t,!1)},e.prototype.checkHave=function(t){var e=GameCache.hero.getRoleIdByIndex(this.role),i=this.fashionBag[e]&&this.fashionBag[e][t.part]?this.fashionBag[e][t.part]:[];return i?-1!=i.indexOf(t.id):!1},e.prototype.checkFashionId=function(t,e,i){for(var n in GameConfig.fashion){var o=GameConfig.fashion[n];if(o.part==e&&(0==o.conds[0].value||o.conds[0].value==i)&&-1!=o.shape.indexOf(t))return o}},e.prototype.saveFunc=function(t){var e=[],i=[];for(var n in this.dish){var o=this.dish[n];this.checkHave(o)?i.push(o):e.push(o)}if(e.length){var r=new ViewProp;r.exData1=e,r.exData2=t,App.ViewManager.open(ViewConst.FASHIONBUY,r)}i.length&&Proxy.fashion.sendOneWear(t,i)},e}(BaseCache);__reflect(FashionCache.prototype,"FashionCache");var FashionEquipItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&this.itemData&&(this.initHandler(),this.initPartImg(this.itemData.part))},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initPartImg=function(t){this.partImg||(this.partImg=new eui.Image,this.partImg.x=5,this.partImg.y=51,this.addChild(this.partImg)),this.partImg.source="fashion_json.fashion_part_"+t+"_png"},e.prototype.initHandler=function(){this.setHandler(this,this.openTips)},e.prototype.openTips=function(){if(this.itemData){var t="",e=[],i=GameCache.fashion.checkHave(this.itemData),n=i?"res/btn/share.png":"res/btn/buy.png";t="res/btn/takeOff.png",e=[this.takeOff,this.buyFashion];var o=new ViewProp;o.itemData=this.itemData;var r={thisc:this,func:e,icon:[t,n]};o.firData=r,App.ViewManager.open(ViewConst.ITEMTIPS,o)}},e.prototype.sendMsg=function(){GameCache.fashion.tryFashion([this.itemData]),App.ViewManager.close(ViewConst.ITEMTIPS)},e.prototype.buyFashion=function(){var t=GameConfig.item[this.itemData.needNum[0].id],e=this.itemData.needNum[0].count,i=GameCache.bag.itemCount(this.itemData.needNum[0].id),n=GameCache.fashion.checkHave(this.itemData);if(!n)if(i>=e)GameCache.fashion.fashionBuy([this.itemData]);else{var o=StringUtils.substitute(Language.lang.notEnought,t.name);GlobalFun.SysMsg(o)}App.ViewManager.close(ViewConst.ITEMTIPS)},e.prototype.takeOff=function(){GameCache.fashion.takeOff([this.itemData]),App.ViewManager.close(ViewConst.ITEMTIPS)},e}(ItemBase);__reflect(FashionEquipItem.prototype,"FashionEquipItem");var FashionItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&(this.initState(),this.initHandler())},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initState=function(){if(GameCache.fashion.tempProp){var t=GameCache.hero.getRoleIdByIndex(GameCache.fashion.role),e=GameCache.fashion.dish?GameCache.fashion.dish[this.itemData.part]:null;!e&&(e=GameCache.fashion.roleFashionData[t]?GameCache.fashion.roleFashionData[t][this.itemData.part]:null),e&&e.id==this.itemData.id?(this.onImg||(this.onImg=new eui.Image,this.onImg.source="public_json.public_equip_tag2_png",this.onImg.x=-7,this.onImg.y=-5,this.addChild(this.onImg)),this.onImg.visible=!0):this.onImg&&(this.onImg.visible=!1),this.checkHave()}},e.prototype.checkHave=function(){this.itemData&&(GameCache.fashion.checkHave(this.itemData)?(this.ico.filters=null,this.color.filters=null,this.lock&&(this.lock.source=null,ObjectPool.push(this.lock),this.removeChild(this.lock),this.lock=null)):(this.lock||(this.lock=ObjectPool.get(eui.Image),this.lock.source="public_json.public_lock_2_png",this.lock.x=53,this.lock.y=48,this.addChild(this.lock)),this.ico.filters=FilterUtils.DefaultGrayFilters,this.color.filters=FilterUtils.DefaultGrayFilters))},e.prototype.initHandler=function(){this.setHandler(this,this.openTips)
},e.prototype.openTips=function(){var t="",e=[],i=GameCache.fashion.checkHave(this.itemData),n=i?"res/btn/share.png":"res/btn/buy.png";this.onImg&&this.onImg.visible?(t="res/btn/takeOff.png",e=[this.takeOff,this.buyFashion]):(t=i?"res/btn/wear.png":"res/btn/fashion_try.png",e=[this.sendMsg,this.buyFashion]);var o=new ViewProp;o.itemData=this.itemData;var r={thisc:this,func:e,icon:[t,n]};o.firData=r,App.ViewManager.open(ViewConst.ITEMTIPS,o)},e.prototype.sendMsg=function(){GameCache.fashion.tryFashion([this.itemData]),App.ViewManager.close(ViewConst.ITEMTIPS)},e.prototype.buyFashion=function(){var t=GameConfig.item[this.itemData.needNum[0].id],e=this.itemData.needNum[0].count,i=GameCache.bag.itemCount(this.itemData.needNum[0].id),n=GameCache.fashion.checkHave(this.itemData);if(n)GameCache.chat.showOffItem(this.itemData);else if(i>=e)GameCache.fashion.fashionBuy([this.itemData]);else{var o=StringUtils.substitute(Language.lang.notEnought,t.name);GlobalFun.SysMsg(o)}App.ViewManager.close(ViewConst.ITEMTIPS)},e.prototype.takeOff=function(){GameCache.fashion.takeOff([this.itemData]),App.ViewManager.close(ViewConst.ITEMTIPS)},e}(ItemBase);__reflect(FashionItem.prototype,"FashionItem");var FashionPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.fashionBag={},i.tabIndex_0=0,i.tabindex_1=0,i.arr=[["AP_HAT","AP_HAIR","AP_EYE","AP_GLASSES"],["AP_BODY_ID","AP_PANTS","AP_WEAPON","AP_ASSIST"],["AP_SWING","AP_BACK"]],i.skinName="FashionPannelSkin",i}return __extends(e,t),e.prototype.init=function(){this.itemList.itemRenderer=FashionItem;var t=Handler.create(this,this.onCLick,[],!1);this.roleSelect.handler=t,this.initTypeData()},e.prototype.open=function(t){this.message(MsgConst.FASHION_TRY,this.initTab),this.message(MsgConst.FASHION_GET,this.onCLick),this.message(MsgConst.EQUIP_ATTR_CHANGE,this.onCLick),this.message(MsgConst.FASHION_INFO,this.onCLick),this.message(MsgConst.FASHION_DELETE,this.onCLick),this.addTouchEvent(this.tabBtn_0,this.initTab),this.addTouchEvent(this.tabBtn_1,this.initList),this.addTouchEvent(this.sBtn,this.saveFunc),this.tabBtn_0.selectedIndex=this.tabBtn_1.selectedIndex=0,this.onCLick()},e.prototype.onCLick=function(){GameCache.fashion.role=this.roleSelect.nSlRole,GameCache.fashion.dish={},this.intiRole(),this.initTab()},e.prototype.initTab=function(){this.tabIndex_0=this.tabBtn_0.selectedIndex;for(var t=this.arr[this.tabIndex_0],e=[],i=0;i<t.length;i++){var n={icon:"fashion_json.fashion_"+t[i]+"_png",icon2:"fashion_json.fashion_"+t[i]+"_s_png"};e.push(n)}this.tabBtn_1.dataProvider=new eui.ArrayCollection(e),this.initList(),this.initFashion()},e.prototype.initTypeData=function(){var t=GameConfig.fashion;for(var e in t){var i=t[e];this.fashionBag[i.part]||(this.fashionBag[i.part]=[]),this.fashionBag[i.part].push(i)}},e.prototype.initList=function(){for(var t=this.tabBtn_0.selectedIndex,e=this.tabBtn_1.selectedIndex>this.arr[t].length-1?0:this.tabBtn_1.selectedIndex,i=PropId[this.arr[t][e]],n=this.fashionBag[i]?this.fashionBag[i]:[],o=[],r=0;r<n.length;r++){var a=n[r];(a.conds[0].value==this.roleSelect.job||0==a.conds[0].value)&&o.push(a)}this.setListData(this.itemList,o)},e.prototype.initFashion=function(){var t=this.tabBtn_0.selectedIndex,e=this.arr[t],i=GameCache.fashion.roleFashionData[this.roleSelect.roleId];GameCache.fashion.tempProp;this.mModel.refresh();for(var n=0;4>n;n++)if(e[n]){var o=PropId[e[n]];this["item_"+n].visible=!0;var r=GameCache.fashion.dish[o];!r&&(r=i&&i[o]?i[o]:null),r?this["item_"+n].data=r:(this["item_"+n].reSet(),this["item_"+n].initPartImg(e[n]))}else this["item_"+n].visible=!1},e.prototype.intiRole=function(){GameCache.fashion.tempProp=GameCache.hero.list[this.roleSelect.nSlRole].pro.clone(),this.mModel.setData(GameCache.fashion.tempProp)},e.prototype.saveFunc=function(){GameCache.fashion.saveFunc(this.roleSelect.nSlRole)},e.prototype.openCoordinate=function(){var t=new ViewProp;t.exData1=this.roleSelect.job,App.ViewManager.open(ViewConst.COORDINATE,t)},e}(BaseSpriteView);__reflect(FashionPannel.prototype,"FashionPannel");var FashionProxy=function(t){function e(){var e=t.call(this,PacketTypes.FASHION)||this;return e.regNetMsg(1,e.doFashionBag),e.regNetMsg(2,e.doAddFashion),e.regNetMsg(3,e.doDelete),e.regNetMsg(5,e.doFashionList),e}return __extends(e,t),e.prototype.doFashionBag=function(t){for(var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=t.readInt(),n=t.readInt(),o=[],r=0;n>r;r++){var a=t.readInt(),s=t.readUnsignedInt();s&&(s=GlobalFun.formatMiniDateTime(s)/1e3),s>0&&(GameCache.fashion.timeLimitItem[e]||(GameCache.fashion.timeLimitItem[e]={}),GameCache.fashion.timeLimitItem[e][a]=s),o.push(a)}GameCache.fashion.fashionBag[e]||(GameCache.fashion.fashionBag[e]={}),GameCache.fashion.fashionBag[e][i]=o},e.prototype.doAddFashion=function(t){var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=t.readInt(),n=t.readInt(),o=(t.readInt(),GlobalFun.formatMiniDateTime(t.readUnsignedInt())/1e3);o>0&&(GameCache.fashion.timeLimitItem[e]||(GameCache.fashion.timeLimitItem[e]={}),GameCache.fashion.timeLimitItem[e][n]=o),GameCache.fashion.addFashionItem(e,i,n)},e.prototype.doDelete=function(t){var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=t.readInt(),n=t.readInt();GameCache.fashion.deleteFashionItem(e,i,n),App.MessageCenter.dispatch(MsgConst.FASHION_DELETE)},e.prototype.doFashionList=function(t){var e=GameCache.hero.transIdFromeServer(t.readInt()),i=t.readByte();GameCache.fashion.cleanRoleFashion(e);for(var n=0;i>n;n++){var o=t.readInt();GameCache.fashion.initRoleFashion(o,e)}App.MessageCenter.dispatch(MsgConst.FASHION_INFO)},e.prototype.sendFashionBuy=function(t,e,i){void 0===i&&(i=1);var n=this.getBytes(1),o=GameCache.hero.getServerIdByIndex(t);n.writeInt(o),n.writeInt(e),n.writeInt(i),this.sendToServer(n)},e.prototype.sendFashionEquip=function(t,e){var i=this.getBytes(2),n=GameCache.hero.getServerIdByIndex(t);i.writeInt(n),i.writeInt(e),this.sendToServer(i)},e.prototype.sendTakeOff=function(t,e){var i=this.getBytes(3),n=GameCache.hero.getServerIdByIndex(t);i.writeInt(n),i.writeInt(e),this.sendToServer(i)},e.prototype.sendOneBuy=function(t,e){void 0===e&&(e=[]);var i=this.getBytes(4),n=GameCache.hero.getServerIdByIndex(t);i.writeInt(n),i.writeInt(e.length);for(var o=0;o<e.length;o++)i.writeInt(e[o].id);this.sendToServer(i)},e.prototype.sendOneWear=function(t,e){void 0===e&&(e=[]);var i=this.getBytes(6),n=GameCache.hero.getServerIdByIndex(t);i.writeInt(n),i.writeInt(e.length);for(var o=0;o<e.length;o++)i.writeInt(e[o].id);this.sendToServer(i)},e.prototype.sendOneTakeOff=function(t){var e=this.getBytes(5),i=GameCache.hero.getServerIdByIndex(t);e.writeInt(i),this.sendToServer(e)},e}(BaseProxy);__reflect(FashionProxy.prototype,"FashionProxy");var FashionType=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.bg,this.onTouche),this.addTouchEvent(this.typeImg,this.onTouche),this.addTouchEvent(this.unBtn,this.takeOff)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.cleanGroup(),this.data&&GameCache.fashion.tempProp&&this.initData()},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.handler=null},e.prototype.initData=function(){this.handler=Handler.create(this.data.thisc,this.data.func,[this.itemIndex],!1),this.typeImg.source="fashion_json.fashion_part"+this.data.id+"_png";var t=(GameCache.hero.getRoleIdByIndex(GameCache.fashion.role),this.data.item),e=GameCache.fashion.tempProp.pro(this.data.id);if(this.unBtn.visible=this.fashionName.visible=!1,t)for(var i=0;i<t.length;i++){var n=t[i];n.shape==e&&(this.unBtn.visible=this.fashionName.visible=!0,this.fashionName.textFlow=TextFlowUtils.generateTextFlow(ItemUtils.getItemNamewithColor(n)))}},e.prototype.onTouche=function(){this.handler.run()},e.prototype.testFunc=function(){if(this.g)this.cleanGroup();else{this.g=ObjectPool.get(eui.Scroller),this.g.width=this.width,this.g.y=48,this.g.height=220,this.g.left=0,this.g.right=0,this.addChild(this.g),this.list=ObjectPool.get(eui.List),this.list.itemRenderer=FashionItem,this.list.itemRendererSkinName="ItembaseSkin";var t=new eui.TileLayout;t.horizontalGap=22,t.paddingLeft=9,t.requestedColumnCount=5,this.list.layout=t,this.g.addChild(this.list),this.dataGroup?this.dataGroup.source=this.data.item:this.dataGroup=new eui.ArrayCollection(this.data.item),this.list.dataProvider=this.dataGroup,this.arrow.source="public_json.public_arrow_up_png"}},e.prototype.refreshList=function(){this.list&&(this.dataGroup.source=this.data.item,this.list.dataProviderRefreshed(),this.initData())},e.prototype.cleanGroup=function(){this.g&&(this.arrow.source="public_json.public_arrow_down_png",ObjectPool.push(this.list),ObjectPool.push(this.g),App.DisplayUtils.removeFromParent(this.list),App.DisplayUtils.removeFromParent(this.g),this.list=null,this.g=null)},e.prototype.takeOff=function(){GameCache.fashion.takeOff([this.data.item[0]])},e}(BaseCustComponent);__reflect(FashionType.prototype,"FashionType");var FirstChargeItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="FirstChargeItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this,this.onClick)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data.money){var e=this.data;if(!e)return;e.money?this.lb1.text=StringUtils.substitute(Language.lang.lcn12,e.money)+"=":this.lb1.text="",e.fourfoldDimond&&e.dimond?(this.lb2.text=e.fourfoldDimond.count+e.dimond.count+"",this.item.source=GlobalFun.getItemSourceById(e.fourfoldDimond.id)):(this.item.source=null,this.lb2.text=""),e.icon?this.imgEx.source=e.icon:this.imgEx.source=null}},e.prototype.onClick=function(){var t=this.data;if(t.fourfoldDimond&&t.dimond){var e="@AddMoney 3 ";e+=t.money,Proxy.chat.sendChatMessage(1,e,!1)}},e}(BaseCustComponent);__reflect(FirstChargeItem.prototype,"FirstChargeItem");var FirstChargeWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Win)||this;return e.skinName="FirstChargeWinSkin",e}return __extends(e,t),e.red=function(){return App.ViewManager.bOpened(ViewConst.FIRSTCHARGE)},e.prototype.init=function(){this.list0.itemRenderer=ItemBase,this.list1.itemRenderer=ItemBase,this.list2.itemRenderer=ItemBase,this.tabBtn.selectedIndex=0},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this),this.message(MsgConst.PROPERTY+PropId.AP_VIP_POINT,this.upCn),this.message(MsgConst.FIRST_CHARGE,this.upCn),this.addTouchEvent(this.tabBtn,this.tabTouche),this.addTouchEvent(this.btn0,this.onClick),this.addTouchEvent(this.btn1,this.onClick),this.addTouchEvent(this.btn2,this.onClick),this.upCn()},e.prototype.tabTouche=function(){this.upCn()},e.prototype.onClick=function(t){var e=1;switch(t.currentTarget){case this.btn0:e=1;break;case this.btn1:e=2;break;case this.btn2:e=3}Proxy.firstcharge.getRw(this.tabBtn.selectedIndex+1,e)},e.prototype.upCn=function(){var t=GameCache.hero.mainPro;t&&(this.lbCharge.text=StringUtils.substitute(Language.lang.lcn12,t.pro(PropId.AP_VIP_POINT))),this.gCharge.visible=0==GameCache.firstcharge.firstChargeSt;for(var e in GameCache.firstcharge.getFirstChargeCfg()){var i=GameCache.firstcharge.getFirstChargeCfg()[e];i&&(this["charge"+e].data=i)}var n=GameConfig.recharge[this.tabBtn.selectedIndex+1];if(n&&n.Reward)for(var e in n.Reward){this.setListData(this["list"+e],GlobalFun.filterJob(n.Reward[e]));var o=0;0==this.tabBtn.selectedIndex?o=GameCache.firstcharge.firstGetList[e]:1==this.tabBtn.selectedIndex&&(o=GameCache.firstcharge.totalGetList[e]),this["imgGet"+e].visible=1!=o,this["btn"+e].visible=1==o,0==o?this["imgGet"+e].source="firstCharge_json.firstCharge"+(parseInt(e)+5)+"_png":2==o&&(this["imgGet"+e].source="public_json.luck_img2_png")}},e}(BaseEuiWindow);__reflect(FirstChargeWin.prototype,"FirstChargeWin");var FirstChargeCache=function(t){function e(){var e=t.call(this)||this;return e.firstGetList=[],e.totalGetList=[],e.firstChargeCfg=[],e.firstChargeSt=0,e.secondChargeSt={},e}return __extends(e,t),e.prototype.clear=function(){this.firstGetList=[],this.totalGetList=[],this.firstChargeCfg=[],this.secondChargeSt={},this.firstChargeSt=0},e.prototype.update=function(t,e){1==e?this.firstGetList=t:2==e&&(this.totalGetList=t)},e.prototype.getFirstChargeCfg=function(){if(0==this.firstChargeCfg.length)for(var t in GameConfig.chognzhi){var e=GameConfig.chognzhi[t];e.fourfoldDimond&&this.firstChargeCfg.push(e)}return this.firstChargeCfg},e}(BaseCache);__reflect(FirstChargeCache.prototype,"FirstChargeCache");var FirstChargeProxy=function(t){function e(){var e=t.call(this,PacketTypes.OTHER)||this;return e.regNetMsg(81,e.privilegeCardTime),e.regNetMsg(86,e.seceondChargeState),e.regNetMsg(87,e.firstChargeState),e}return __extends(e,t),e.prototype.privilegeCardTime=function(t){for(var e=t.readByte(),i=t.readByte(),n=[],o=0;i>o;o++)n.push(t.readByte());GameCache.firstcharge.update(n,e),App.MessageCenter.dispatch(MsgConst.FIRST_CHARGE)},e.prototype.getRw=function(t,e){var i=this.getBytes(47);i.writeByte(t),i.writeByte(e),this.sendToServer(i)},e.prototype.seceondChargeState=function(t){var e=t.readByte();GameCache.firstcharge.secondChargeSt={};for(var i=0;e>i;i++)GameCache.firstcharge.secondChargeSt[t.readUnsignedShort()]=t.readByte();App.MessageCenter.dispatch(MsgConst.FIRST_CHARGE)},e.prototype.firstChargeState=function(t){GameCache.firstcharge.firstChargeSt=t.readByte(),App.MessageCenter.dispatch(MsgConst.FIRST_CHARGE)},e}(BaseProxy);__reflect(FirstChargeProxy.prototype,"FirstChargeProxy");var DoubbleItemExpend=function(t){function e(){var e=t.call(this)||this;return e.skinName="DoubbleItemExpendSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.currentState="doubble"},e.prototype.setData=function(t){if(t&&t[0])for(var e=0;2>e;e++)if(t[e]){var i=t[e];this["item"+e].source=GlobalFun.getItemSourceById(i.id),this["num"+e].text=i.count+""}},e}(BaseCustComponent);__reflect(DoubbleItemExpend.prototype,"DoubbleItemExpend");var GashaponBagWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.type=1,e.skinName="GashaponBagWinSkin",e}return __extends(e,t),e.prototype.init=function(){this.list.itemRenderer=ItemBase},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this),this.addTouchEvent(this.mBtn,this.onClick),e&&e.exData1&&(this.type=e.exData1),this.message(MsgConst.GASHAPON_BAG,this.upCn),this.upCn()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.mBtn:Proxy.gashapon.getAllRw(this.type)}},e.prototype.upCn=function(){if(GameCache.gashapon.bagSeries[this.type]){var t=GlobalFun.objChangeList(GameCache.gashapon.bagSeries[this.type]);this.setListData(this.list,t)}},e}(BaseEuiWindow);__reflect(GashaponBagWin.prototype,"GashaponBagWin");var GashaponPannelPet=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.type=GashaponType.Pet,i.getId=1,i.addTime=0,i.onPress=!0,i.tw=[],i.showItemMax=[],i.showItemList=[],i.exRewardList=[],i.getItemId=0,i.skinName="GashaponPannelPetSkin",i}return __extends(e,t),e.prototype.init=function(){this.cfg=GameConfig.gashaponDisplay[this.type],this.imgType0.source="gashapon_json.gashapon_img4_png";for(var t=[30,100,400],e=[0,96,193],i=0;3>i;i++){var n=[];for(var o in this.cfg.item[i]){var r=ObjectPool.get(ItemBase);r.skinName="ItembaseSkin",0==i?r.x=t[i]+130*parseInt(o):1==i?r.x=t[i]+200*parseInt(o):2==i&&(r.x=t[i]-130*parseInt(o)),r.y=e[i],r.data=this.cfg.item[i][o],r.initData(),this.gItem.addChild(r),n.push(r)}var a=0;this.cfg.item[i]&&(a=this.cfg.item[i].length),0==i?a=-100+130*a:2==i&&(a=500-130*a),this.showItemMax.push(a),this.showItemList.push(n)}this.cfg&&this.cfg.single&&(this.getId=this.cfg.single[1]?this.cfg.single[1].id:1),this.item.source=GlobalFun.getItemSourceById(this.getId),this.price0.setData(this.cfg.single),this.price1.setData(this.cfg.ten),GameCache.gashapon.bOpenList[this.type]||(GameCache.gashapon.bOpenList[this.type]=1,Proxy.gashapon.getBag(this.type)),this.gRw.visible=!0},e.prototype.open=function(t){void 0===t&&(t=null),this.addTouchEvent(this.imgBag0,this.onClick),this.addTouchEvent(this.btn0,this.onClick),this.addTouchEvent(this.btn1,this.onClick),this.addTouchEvent(this.imgItem,this.onClick),this.onPress=!0,this.exRewardList=[];for(var e=[1,0,0],i=0;3>i;i++)this["imgCard"+i].alpha=e[i];App.TimerManager.addFrame(2,this.time,this,0),this.onArrow(),this.message(MsgConst.BAG_ITEM_NUM+this.getId,this.upCn),this.message(MsgConst.GASHAPON_ONE_GET,this.getOne),this.message(MsgConst.GASHAPON_TEN_GET,this.getTen),this.upCn()},e.prototype.time=function(){for(var t in this.showItemList){var e=this.showItemList[t];for(var i in e){var n=1,o=e[i];"2"==t?(o.x=o.x+n,o.x>500&&(o.x=this.showItemMax[t])):"0"==t&&(o.x=o.x-n,o.x<-100&&(o.x=this.showItemMax[t]))}}},e.prototype.onArrow=function(){this.gArrow.visible=!0,this.tw=[];for(var t=[],e=0;3>e;e++){var i=this["imgCard"+e];t.push(egret.Tween.get(i,{loop:!0})),i&&this.tw.push(i)}var n=300;t[0]&&t[0].to({alpha:0},n).wait(n).to({alpha:0},n),t[1]&&t[1].to({alpha:1},n).to({alpha:0},n).wait(n),t[2]&&t[2].wait(n).to({alpha:1},n).to({alpha:0},n)},e.prototype.close=function(e){void 0===e&&(e=null);for(var i in this.tw)egret.Tween.removeTweens(this.tw[i]);t.prototype.close.call(this)},e.prototype.upCn=function(){this.itemNum.text=GameCache.bag.itemCount(this.getId)+""},e.prototype.getOne=function(t,e){void 0===e&&(e=!0),t&&(this.showEff(),this.imgItem.source=GlobalFun.getItemSourceById(t.id),this.getItemId=t.id,this.gRw.visible=!1,e&&(this.exRewardList=[],this.exRewardList.push(t)))},e.prototype.getTen=function(t){t&&t[0]&&this.getOne(t[0],!1)},e.prototype.showEff=function(){var t=Handler.create(this,this.comple,[],!1);App.DisplayUtils.addEffectToObj(this.gShow,"Singlepumping_0_1",1,122,-180,t)},e.prototype.comple=function(){if(this.onPress=!0,this.gRw.visible=!0,this.exRewardList.length){var t=new ViewProp;t.exData1=this.exRewardList,App.ViewManager.open(ViewConst.REWARDEX,t),this.exRewardList=[]}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.imgBag0:var e=new ViewProp;e.exData1=this.type,App.ViewManager.open(ViewConst.GASHAPONBAG);break;case this.btn0:if(!GlobalFun.getBagEnounghUseCondition(this.cfg.single))return void GlobalFun.gotoCharge();this.onPress&&(Proxy.gashapon.askGashapon(1,this.type),this.onPress=!1,this.ballTween());break;case this.btn1:if(!GlobalFun.getBagEnounghUseCondition(this.cfg.ten))return void GlobalFun.gotoCharge();this.onPress&&(Proxy.gashapon.askGashapon(10,this.type),this.onPress=!1,this.ballTween());break;case this.imgItem:this.getItemId&&GlobalFun.itemTips(GameConfig.item[this.getItemId])}},e.prototype.ballTween=function(){var t=egret.Tween.get(this.imgBall);t.to({y:90},300).wait(250).to({y:0},150).wait(250)},e}(CommunalPagePannel);__reflect(GashaponPannelPet.prototype,"GashaponPannelPet");var GashaponRwWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.type=1,e.time=1,e.press=!1,e.skinName="GashaponRwWinSkin",e}return __extends(e,t),e.prototype.init=function(){App.DisplayUtils.addEffectToObj(this,"matrix_0_1",-1,320,185),App.DisplayUtils.addEffectToObj(this.gEff,"point_0_1",-1,260,250);var t=App.DisplayUtils.addEffectToObj(this.gEff,"point_0_1",-1,380,250);t.scaleX=-1},e.prototype.open=function(e){if(void 0===e&&(e=null),this.myParent.setRectAlpha&&this.myParent.setRectAlpha(.9),t.prototype.open.call(this),e&&e.exData1){var i=GameConfig.gashaponDisplay[e.exData1];this.cfg=i,this.type=e.exData1,i&&i.ten&&this.price1.setData(i.ten)}if(e&&e.exData2){e.exData2.length>1?this.btn0.icon="res/btn/luck_2.png":this.btn0.icon="res/btn/luck_1.png",this.time=e.exData2.length;for(var n=0;10>n;n++){var o=this["item"+n];e.exData2[n]&&(o.data=e.exData2[n],GlobalFun.createItemEffect(o,n))}}this.addTouchEvent(this.btn0,this.onClick),App.TimerManager.add(1200,this.tieme,this,1),this.press=!1},e.prototype.tieme=function(){this.press=!0},e.prototype.close=function(e){void 0===e&&(e=null),this.myParent.resetAlpha&&this.myParent.resetAlpha(),t.prototype.close.call(this)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn0:if(!GlobalFun.getBagEnounghUseCondition(this.cfg.ten))return void GlobalFun.gotoCharge();this.press&&(Proxy.gashapon.askGashapon(this.time,this.type),this.closeView())}},e}(BaseEuiWindow);__reflect(GashaponRwWin.prototype,"GashaponRwWin");var GashaponWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="CommunalPageWin5Skin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPageWin);__reflect(GashaponWin.prototype,"GashaponWin");var RewardExWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="RewardExWinSkin",e}return __extends(e,t),e.prototype.init=function(){var t=new eui.TileLayout;t.requestedRowCount=2,t.horizontalGap=25,this.layout=t,this.gRw.layout=t,this.itemList||(this.itemList=ObjectPool.get(ItemList))},e.prototype.open=function(e){if(void 0===e&&(e=null),t.prototype.open.call(this),this.myParent.setRectAlpha&&this.myParent.setRectAlpha(.9),this.addTouchEvent(this,this.closeView),e&&e.exData1){var i=[];if(!(e.exData1 instanceof Array))return;if(i=e.exData1,i.length){this.itemList.setData(i,this.gRw);for(var n=0;n<this.itemList.itemArr.length;n++)GlobalFun.createItemEffect(this.itemList.itemArr[n],n);i.length<6?(this.y=188,this.layout.requestedRowCount=1):(this.y=152,this.layout.requestedRowCount=2)}}},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.itemList.dispose()},e.prototype.close=function(e){void 0===e&&(e=null),this.myParent.resetAlpha&&this.myParent.resetAlpha(),t.prototype.close.call(this)},e}(BaseEuiWindow);__reflect(RewardExWin.prototype,"RewardExWin");var GashaponType;!function(t){t[t.Pet=1]="Pet"}(GashaponType||(GashaponType={}));var GashaponCache=function(t){function e(){var e=t.call(this)||this;return e.bagSeries={},e.bOpenList={},e}return __extends(e,t),e.prototype.clear=function(){this.bagSeries={},this.bOpenList={}},e.prototype.addBagItems=function(t,e){this.bagSeries[t]||(this.bagSeries[t]={}),this.bagSeries[t][e.series.toString()]=e},e.prototype.removeBagItems=function(t,e){this.bagSeries[t]&&this.bagSeries[t][e]&&delete this.bagSeries[t][e]},e}(BaseCache);__reflect(GashaponCache.prototype,"GashaponCache");var GashaponProxy=function(t){function e(){var e=t.call(this,PacketTypes.GASHAPON)||this;return e.regNetMsg(1,e.doBag),e.regNetMsg(2,e.doAddBag),e.regNetMsg(3,e.doRemoveBag),e.regNetMsg(4,e.doShow),e.regNetMsg(5,e.doStack),e}return __extends(e,t),e.prototype.doBag=function(t){for(var e=t.readByte(),i=t.readUnsignedShort(),n=0;i>n;n++){var o=new UserItem(t);GameCache.gashapon.addBagItems(e,o)}App.MessageCenter.dispatch(MsgConst.GASHAPON_BAG)},e.prototype.doAddBag=function(t){var e=t.readByte(),i=new UserItem(t);GameCache.gashapon.addBagItems(e,i),App.MessageCenter.dispatch(MsgConst.GASHAPON_BAG)},e.prototype.doStack=function(t){var e=t.readByte(),i=new UserItem(t);GameCache.gashapon.addBagItems(e,i),App.MessageCenter.dispatch(MsgConst.GASHAPON_BAG)},e.prototype.doRemoveBag=function(t){for(var e=t.readByte(),i=t.readShort(),n=0;i>n;n++){var o=new ItemSeries(t).toString();GameCache.gashapon.removeBagItems(e,o)}App.MessageCenter.dispatch(MsgConst.GASHAPON_BAG)},e.prototype.doShow=function(t){for(var e=t.readByte(),i=t.readByte(),n=[],o=0;i>o;o++){var r=new UseCondition;r.id=t.readInt(),r.count=t.readUnsignedShort(),n.push(r)}if(n.length>1){if(e){var a=new ViewProp;a.exData1=e,a.exData2=n,App.ViewManager.open(ViewConst.GASHAPONRW,a)}App.MessageCenter.dispatch(MsgConst.GASHAPON_TEN_GET,n)}else App.MessageCenter.dispatch(MsgConst.GASHAPON_ONE_GET,n[0])},e.prototype.askGashapon=function(t,e){var i=this.getBytes(1);i.writeByte(e),i.writeByte(t),this.sendToServer(i)},e.prototype.getAllRw=function(t){var e=this.getBytes(2);e.writeInt(t),this.sendToServer(e)},e.prototype.getBag=function(t){var e=this.getBytes(3);e.writeInt(t),this.sendToServer(e)},e}(BaseProxy);__reflect(GashaponProxy.prototype,"GashaponProxy");var GRBossItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.enterBtn,this.enterFunc)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.fubenid&&this.initData()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){this.item_0.data=this.data.reward_show[0],this.item_1.data=this.data.reward_show[1],this.item_2.data=this.data.reward_show[2];var t=GameConfig.monster[this.data.entityid];this.mImg.source=RES_DIR_MONSTERICON+t.icon+".png",this.mName.text=t.name,this.mLvl.text=t.level,this.initState()},e.prototype.initState=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_LEVEL);if(t<this.data.conds)this.enterBtn.visible=!1,this.killed.visible=!1,this.lLvl.visible=!0,this.lImg.visible=!0,this.lLvl.text=StringUtils.substitute(Language.lang.lvlCondition,this.data.conds);else{this.lLvl.visible=!1,this.lImg.visible=!1;var e=GameCache.copy.getCopyData(this.data.fubenid),i=e&&e.free?!0:!1;i?(this.enterBtn.visible=!0,this.killed.visible=!1):(this.enterBtn.visible=!1,this.killed.visible=!0)}},e.prototype.enterFunc=function(){Proxy.copy.sendEnterFB(this.data.fubenid),App.ViewManager.close(ViewConst.BOSS)},e}(BaseCustComponent);__reflect(GRBossItem.prototype,"GRBossItem");var GRBossPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="GRBossPannelSkin",i.grBossData={},i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.initListData(),this.itemList.itemRenderer=GRBossItem,this.tabBar.dataProvider=new eui.ArrayCollection([{icon:"worldBoss_json.worldBoss_map_0_png"},{icon:"worldBoss_json.worldBoss_map_1_png"},{icon:"worldBoss_json.worldBoss_map_2_png"}])},e.prototype.open=function(t){this.message(MsgConst.COPY_COUNT,this.onTabTouche),this.message(MsgConst.PROPERTY+PropId.AP_LEVEL,this.sweetBtnVisible),this.addTouchEvent(this.tabBar,this.onTabTouche),this.addTouchEvent(this.sweepBtn,this.sweepFunc),this.tabBar.selectedIndex=0,App.TimerManager.addDelay(50,50,1,this.initList,this),this.sweetBtnVisible()},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.grBossData={}},e.prototype.onTabTouche=function(){this.initList()},e.prototype.initList=function(){var t=this.tabBar.selectedIndex||0;this.setListData(this.itemList,this.grBossData[t+1].concat())},e.prototype.initListData=function(){var t=GameConfig.grBoss;for(var e in t){var i=t[e];this.grBossData[i.page]||(this.grBossData[i.page]=[]),this.grBossData[i.page].push(i)}},e.prototype.sweepFunc=function(){var t=this.grBossData[1][0];Proxy.copy.sendSweep(t.fubenid,0)},e.prototype.sweetBtnVisible=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_LEVEL);this.sweepBtn.visible=t>=GameConfig.globalConfig.personalBossLimit},e}(BaseSpriteView);__reflect(GRBossPannel.prototype,"GRBossPannel");var HeroCache=function(t){function e(){var e=t.call(this)||this;return e.list=[],e.pet=[],App.TimerManager.add(200,e.onFollow,e),e}return __extends(e,t),e.prototype.clear=function(){this._focus=null;for(var t=0,e=this.list;t<e.length;t++){var i=e[t];i.dispose()}this.list=[],this.mainPro=null},e.prototype.onFollow=function(){if(!App.FightManager.onHook&&this._focus)for(var t=this._focus.cellXY,e=5-this.list.length,i=0,n=this.list;i<n.length;i++){var o=n[i];if(o!=this._focus&&!o.isDie&&!o.isFighting){var r=Math.abs(o.cellXY.x-t.x)>e||Math.abs(o.cellXY.y-t.y)>e;r?o.isfollow||(o.isfollow=o.moveTo(t.x,t.y)):(o.clearPath(),o.isfollow=!1),e++}}},e.prototype.exitScene=function(){for(var t=0,e=this.list;t<e.length;t++){var i=e[t];i.clearPath()}},e.prototype.addHero=function(t){if(t.pro.isMainPlayer)this.list.unshift(t),this.focusPlayer=t;else{for(var e=0;e<this.list.length;e++)if(!this.list[e].pro.isMainPlayer&&t.pro.pro(PropId.AP_ACTOR_ID)<this.list[e].pro.pro(PropId.AP_ACTOR_ID))return void this.list.splice(e,0,t);this.list.push(t)}App.MessageCenter.dispatch(MsgConst.NEW_HERO)},e.prototype.clearJump=function(){for(var t=0,e=this.list;t<e.length;t++){var i=e[t];i.clearJump()}},e.prototype.setPosition=function(t,e){for(var i=0,n=this.list;i<n.length;i++){var o=n[i];o.setCellXY(t,e,!0)}},Object.defineProperty(e.prototype,"focusPlayer",{get:function(){return this._focus},set:function(t){this._focus=t,App.MessageCenter.dispatch(MsgConst.FOCUS_CHANGE)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainPlayer",{get:function(){return this.list[0]},enumerable:!0,configurable:!0}),e.prototype.isMySelf=function(t){for(var e=0,i=this.list;e<i.length;e++){var n=i[e];if(n.pro.recog==t)return!0}},e.prototype.getThing=function(t){for(var e=0,i=this.list;e<i.length;e++){var n=i[e];if(n.pro.recog==t)return n}},e.prototype.resetFocus=function(){for(var t=0;t<this.list.length;t++){var e=this.list[t];if(!e.isDie){e!=this._focus&&(this.focusPlayer=e);break}}},e.prototype.getHeroByJob=function(t){for(var e=0;e<this.list.length;e++){var i=this.list[e];if(i.pro.pro(PropId.AP_JOB)==t)return i}},e.prototype.getProByJob=function(t){for(var e=0;e<this.list.length;e++){var i=this.list[e];if(i.pro.pro(PropId.AP_JOB)==t)return i.pro}},e.prototype.getProByIndex=function(t){return this.list[t]&&this.list[t].pro},e.prototype.getServerIdByJob=function(t){var e=this.getProByJob(t);return e?e==this.mainPro?0:e.pro(PropId.AP_ACTOR_ID):-1},e.prototype.getServerIdByIndex=function(t){var e=this.getProByIndex(t);return e==this.mainPro?0:e.pro(PropId.AP_ACTOR_ID)},e.prototype.transIdFromeServer=function(t){return 0==t?this.mainPro.pro(PropId.AP_ACTOR_ID):t},e.prototype.getDataByIndex=function(t,e){var i=this.getProByIndex(t);return i?e[i.pro(PropId.AP_ACTOR_ID)]:null},e.prototype.getDataByJob=function(t,e){var i=this.getProByJob(t);return i?e[i.pro(PropId.AP_ACTOR_ID)]:null},e.prototype.getRoleIdByIndex=function(t){var e=this.getProByIndex(t);return e?e.pro(PropId.AP_ACTOR_ID):null},e.prototype.getJobByRoleId=function(t){for(var e=0;e<this.list.length;e++){var i=this.list[e];if(i.id==t)return i.pro.job}},e.prototype.transServerFromeId=function(t){return t==this.mainPro.pro(PropId.AP_ACTOR_ID)?0:t},e.prototype.getRoleStateByIndex=function(t){if(GameCache.hero.list[t])return 2;var e=GameCache.adventure,i=e.topAward;if(!i)return 0;var n=e.topAward.type==AwardType.CREATE_HERO;return n&&e.taskList.length==e.topProgress?1:0},e}(BaseCache);__reflect(HeroCache.prototype,"HeroCache");var LoginProxy=function(t){function e(){var e=t.call(this,PacketTypes.LOGIN)||this;return e.regNetMsg(1,e.doCheckAccount),e.regNetMsg(2,e.doRoleList),e.regNetMsg(3,e.doCreateRoleBack),e}return __extends(e,t),e.prototype.doCheckAccount=function(t){var e=t.readByte();console.log("登录错误#"+e)},e.prototype.doCreateRoleBack=function(t){var e=(t.readUnsignedInt(),t.readByte());if(!e){var i=this.getBytes(3);return void this.sendToServer(i)}App.MessageCenter.dispatch(MsgConst.CREATE_ROLE_ERROR,e)},e.prototype.doRoleList=function(t){var e=t.readInt(),i=t.readByte(),n=[];switch(console.log("返回角色列表",i),i){case 0:SceneManager.ins().runScene(CreateRoleScene);break;default:for(var o=i,r=0;o>r;r++){var a=new SelectRoleData(t);n.push(a)}o>=1&&(SceneManager.ins().runScene(MainScene),Proxy.main.sendEnterGameScene(e,n[0].id))}App.MessageCenter.dispatch(MsgConst.GET_ROLELIST,e,n),LocationProperty.enterGame()},e.prototype.sendCreateRole=function(t,e,i,n,o,r){void 0===n&&(n=0),void 0===o&&(o=0);var a=this.getBytes(4);a.writeString(t),a.writeByte(e),a.writeByte(i),a.writeByte(n),a.writeByte(o),a.writeString(LocationProperty.pfid),a.writeInt(parseInt(LocationProperty.appid)),this.sendToServer(a)},e}(BaseProxy);__reflect(LoginProxy.prototype,"LoginProxy");var CreateHeroView=function(t){function e(){var e=t.call(this,LayerManager.UI_Main2)||this;
return e.skinName="CreateHeroSkin",e}return __extends(e,t),e.prototype.open=function(){this.width=App.StageUtils.getWidth(),this.height=App.StageUtils.getHeight(),t.prototype.open.call(this),this.initTabIcon(),this.addTouchEvent(this.createBtn,this.onCreate),this.addTouchEvent(this.tabBtn,this.tabTouch)},e.prototype.init=function(){t.prototype.init.call(this),this.body=new DBAvatar,this.body.setRoot(this.roleMdl,null)},e.prototype.initTabIcon=function(){for(var t=[],e=1;4>e;e++){var i=GameCache.hero.getProByJob(e);if(!i){var n={};n.id=e,n.icon="createRole_json.createrole_role"+(e-1)+"_b_png",n.icon2="createRole_json.createrole_role"+(e-1)+"_a_png",t.push(n)}}this.tabBtn.dataProvider=new eui.ArrayCollection(t),this.listData=t,this.tabBtn.selectedIndex=MathUtils.limitInteger(0,t.length),this.tabTouch()},e.prototype.onCreate=function(){Proxy.adventure.sendPrize(0,this.selectJob,1),this.closeView()},e.prototype.tabTouch=function(){var t=this.listData[this.tabBtn.selectedIndex];this.selectJob=t.id,this.body.load("c"+this.selectJob,!0,!1),this.body.play("stand")},e.prototype.destroy=function(){this.body&&(this.body.dispose(),this.body=null),t.prototype.destroy.call(this)},e}(BaseEuiWindow);__reflect(CreateHeroView.prototype,"CreateHeroView");var CreateRoleView=function(t){function e(){var e=t.call(this,LayerManager.UI_Win)||this;return e.nSlRole=0,e._onStage=!1,e.skinName="CreateRoleSkin",e._randomName=new RandomName,e.body=new DBAvatar,e.body.setRoot(e.roleMdl,null),e.isInit=!0,e.bClickClose=!1,e.horizontalCenter=0,e.verticalCenter=0,e}return __extends(e,t),e.prototype.init=function(){this.focusToStage()},e.prototype.open=function(t){void 0===t&&(t=null),this.lbRoleName.text=this._randomName.getRandomName(1),this.addTouchEvent(this.imgRedom,this.onClick),this.addTouchEvent(this.imgCreateRole,this.onClick),this.addTouchEvent(this.tabBtn,this.tabTouche),App.MessageCenter.addListener(MsgConst.CREATE_ROLE_ERROR,this.onError,this),App.SoundManager.playMusic(SoundType.CREATEROLE),this.nSlRole=MathUtils.limitInteger(0,3),this.tabBtn.selectedIndex=this.nSlRole,this.tabTouche(),App.ViewManager.getView(ViewConst.WELCOME)},e.prototype.onError=function(t){Language.lang.createRoleError[t]?this.errorTips.text=Language.lang.createRoleError[t]:this.errorTips.text="error #"+t},e.prototype.initTabIcon=function(){for(var t=[],e=0;4>e;e++){var i={id:0,icon:"createRole_json.createrole_role0_b_png",icon2:"createRole_json.createrole_role0_a_png"};i.id=e,i.icon="createRole_json.createrole_role"+e+"_b_png",i.icon2="createRole_json.createrole_role"+e+"_a_png",t.push(i)}this.tabBtn.dataProvider=new eui.ArrayCollection(t)},e.prototype.tabTouche=function(){this.nSlRole=this.tabBtn.selectedIndex,this.body.load("c"+(this.nSlRole+1),!0,!1),this.body.play("stand")},e.prototype.close=function(t){void 0===t&&(t=null),this.destroy()},e.prototype.bodyPlayEnd=function(t){this.callHandler&&(this.callHandler.args=[t],this.callHandler.run())},e.prototype.onClick=function(t){switch(t.currentTarget){case this.imgRedom:this.lbRoleName.text=this._randomName.getRandomName(1),this.errorTips.text="";break;case this.imgCreateRole:this.enterGame()}},e.prototype.enterGame=function(){Proxy.login.sendCreateRole(this.lbRoleName.text,1,this.nSlRole+1,0,0,"")},e.prototype.destroy=function(){this.body&&(this.body.dispose(),this.body=null),t.prototype.destroy.call(this)},e}(BaseEuiWindow);__reflect(CreateRoleView.prototype,"CreateRoleView");var RandomName=function(){function t(){this.firstName=["无惧的","无畏的","冰封","死神","月魔","元素","破梦","天空","西蒙","蓝颜","方向","翱翔","庄严","红尘","埋葬","神奇的","冰冷","判罚者","初学者","耐心的","胆小的","洒脱","飞燕","从容","宿命","漂流","征服","炽热","沉沦","搁浅","浮夸","仲裁","千叶","一生","说服者","正义","炽天使","第六天","无边者","飞翔","徒劳","懦弱","耐心","小丑","大主教","唯一的","黑暗","耐心","血染","风怒","爱笑","闪电","灾难","炙热","幻想","奇迹","大领主","首领","勇敢","坚硬","孤独","无边者","无垢者","烈阳","浓烈","美丽","可爱","女王蜂","领导者","猎杀者","驯龙者","无眠者","自信的","啰嗦","智慧","老迈","深海","燃烧","虔诚","大财团","小丑","免疫","奔驰的","交接","皎洁","高大","害羞","致命","害羞","天空","吞噬者","觉醒者","追踪者","代理人","微笑","粉碎者","银河","双子星","守护者","诅咒","因陀罗","无谋者","梦幻","拖刀者","说服者","代行者","潜入者","监视者","毁灭者","螺旋","掠夺者","咸鱼哥","浩瀚","太阳神","轰隆","探索者","裂变","厄运","一生","奢侈","浮梦","千城","洒脱","聚变","匆匆","迷失","宿命","漂流","无双","魔神","问情","敷衍","孪生","往事","凌乱","五国","甲贺","忍龙","雕龙","一马","宝宝","列侬","深邃","苦海","苍白","腐朽","万宗","砂砾","路口","浮夸","疯子","释怀","流浪","琉璃","烟火","三体","唯一","残缺","灰烬","回旋","誓言","流水","花落","轻舞","霞雾","晚霞","霓虹","枷锁","阴霾","沉迷","迁就","回忆","声色","空城","白云","逆夏","达尔","模糊","开心","光年","契约","森林","彩色","星星","猎豹","延续","画心","着迷","凝目","极光","剑海","未来","旅途","掠过","舍得","半生","斑驳","华光","梦魇","蔚蓝","残留","主宰","天地","樱花","金兰","海棠","定心","忧深","神海","断点","心淡","怪咖","未尽","纠结","未尽","习惯","放肆","方向","默然","翱翔","尘封","续写","碧落","皇权","黄泉","青丝","神","我","无","穷","鬼","魔","绝","水","火","封","风","剑","龙","元","圣","拉达曼","黑海","噩梦","战神","多闻","新一","久久"],this.secondName=["あ","#","︽","围","茡","ビ","乜","＼","㈤","ネ","＊","〒","〗","︾","〒","★","☆","※","⑧","う","囚","嗳","◇","▲","を","〇","℅","づ","↓","↙","￥","廴","凹","凸","冂","◆","♀","♂","、","。","÷","0","！","·","卐","々","∏","●","☆","Ю","ヱ","╬","サ","℉","卟","=","Δ","√","⊕","ぬ","ケ","モ","虍","ロ","之","Ψ","∑","リ","丄","%","※","ぺ","≡","Ω","③","︾","卝","唯*","亽","Д","▕","惢","♀","♂","ぷ","ⅷ","Ｑ","Ф","〓","⊙","ビ","卟","の","＆","皕","ジ","◎","∴","∞","--","+","OO","ж","π","①","_°","ヾ","￥"],this.thirdName=["黑魂","刺心","零落","蓝颜","不破","孤影","浮沉","妖娆","圣歌","晨曦","女神","霞破","精英","精锐","擒拿","一线","断情","猫猫","渲染","血清","阴霾","诠释","尘世","素颜","怪咖","苦口","旧梦","亦难","迦叶","送葬","完美","潮流","白","囚","禁","厌","冷","毁","灭","宅","尘","欲","信","傲","负荷","天空","如此","优柔","迷途","黎明","沧海","耳蜗","残骸","默写","沙漏","花梨","葬歌","冥冥","猎鹰","九天","灭霸","雷暴","幽灵","雷霆","刺刀","白虎","青龙","朱雀","玄武","鱼儿","泪痕","饕餮","圣月","天狼","葬花","圣殿","残月","赤兔","独醉","赤虎","借口","一线","堪阳","不见","凌迟","背叛","鉽探","魅眸","畵窗","游灵","释然","幕刃","瑾色","呢喃","肆意","似我","炙雪","逐月","灵瞳","冷瞳","沉世","蔷薇","讴歌","琴瑟","儿","荒芜","離殇","初见","夏末","断桥","玄桥","沉淀","怒煞","烟花","情歌","暖阳","王","赤","冷","诛","紫霞","灭","卌","蚀","囚","心","绛紫","靛蓝","墨绿","风声","青衣","负荷","撕裂","晓梦","时光","荏苒","荼蘼","刺魂","月色","青奴","轮回","亡灵","清澈","茉莉","浅岛","孽缘","咫尺","妃红","绯红","死囚","寸断","方圆","蒙蔽","萌萌","离心","安然","亟合","瞳眸","千寻","黎明","夕阳","残阳","光芒","消逝","伯仲","杰克","魔都","未央","轮回","璎珞","宁珂","花颜","天沙","甜心","侵袭","孽","断弦","葬薆","葵花","羁绊","歔沩","北岛","西京","倒戈","蓦然","残颜","冒险","雅泽","恍惚","痴迷","七年","泪珠","荒芜","时光","魅力","堪","余辉","定一","红尘","缥缈","神龛","洞察","无念","流年","岁月","雅苑","辗转","沧澜","空罐","愫暮","亦难","零落","引魂","阙反","静候","戒律","极乐","光速","英利","莫西","仲裁","恨天","高深","天龙","撒旦","游离","冈","困惑","主宰","深海","银河","漫游","哈雷","不闻","耳语","喧闹","天才","鬼才","雷神","王牌","丝丝","宝贝","天使","山丘","魍魉","魑魅","安逸","洞天","不败","新一","一休","命门","八极","穷极","黑洞","深渊","剑海","骑士","团长","烙印","十字","圣手","枫蓝","天骄","皇者","允诺","星辰","苍洱","龙鳞","碧蓝","冥途","狂风","暴雨","演奏","万杀","万念","归一","权重","祭司","神父","螺旋","毗湿奴","月神","佯攻","无邪","莫离","元初","离冥","珈蓝","楼兰","绿洲","沙漠","沉剑","勿念","四方","八方","小学生","冥王","海王","天王","天翼","战狂","过客","晚霞","顶天","光宇","华夏","炎黄"],this.specialNameArr=["一刀流","阿斯顿马丁","哈利波特","魑魅魍魉","蓝天白云","只如初见","幸福生活","索马里群星","君临天下","灯火阑珊","随便看看","似水年华","就是快乐","PK打架爽","十步一人","小桥流水","浮生若梦","醉生梦死","群星之怒","云淡风清","新不了情","提拉米苏","爱新觉罗","浪迹天涯","怒斩一方","炼狱之炎","一生一世","卡布奇诺","上善若水","普罗旺斯","烽火连天","宅男的左手","一棵小葱葱","裸奔的带子","谁在乎黑白","小心点走路","魔法新达人","回忆的沙漏","结婚综合症","最后一场雪","猫和老鼠","易碎水瓶座","天天换床睡","叼着烟吻你","嘟是我滴错","裤裆里放屁","西街的日月","小兔吃蘑菇","大饼想油条","强力找抽","玩乃in北京","奥黛利赫本","自幼爱打针","懒鱼爱吃猫","超级上上签","欲望决定人生","贫道想要出家","奥特曼的哥们","老衲法眼己开","我就一个人","全部不许动","十万个尸王","不是独自一人","春哥无敌","硬又黑","酷似刘德华","我哥黄晓明","胖大海","雄赳赳气昂昂","爱是一种天意","自挂东南枝","爱只是个错觉","香水真的有毒","春运好难买票","你们都是炮灰","永动型自走炮","夜半屠猪男","闷骚式自走炮","不華麗的男人","陈冠希的胶卷","菊部有血","小白样的大白","冥想的印度人","夜夜十几次","做人狠低调","芒果小慕斯","抓住那条御姐","幸福的回忆录","单挑狂战士","不放手的约定","挪威的夏天","终极版赛亚人","牛肉面酸辣粉","云之彼岸约定","罗罗诺亚索隆","村口的老大叔","老衲法号叫船","寂寞的尼古丁","超级左手之神","孙悟空的后代","爱了就不伪装","我是印度阿三","农民工伤不起","米老鼠唐老鸭","我曾是一个神","雨稀释了回忆","错过一抹泪光","专业电脑维修","夫人不可以","只为和平而战","刺杀与烈火","下一站守候","爱借烟的男人","为发型PK","剥香蕉拉巴巴","阴得一手好湿","代表月亮砍你","守护钉耙猫","打趴凤姐","春哥真男人","伟大人生","风花雪月","冰河地狱","地狱寒冰","鸡肉嘎嘣脆","六月飞霜","似水似烟","当里个党","极速魅影","极速魅影","一刀一个","吻着泪流","妖姬","粥粉面饭","东邪西毒","千本樱花","一场幻觉","暧昧宝贝","浩空之月","秋之枫韵","月之传说","秋月物语","寂寞飞雨","笑里藏刀","清清君子","你是个神经","第一次上你","股市炮灰","行者无悔","号码已换","紫砂世界","凛凛月光","红酒醉了","请喊我黄太太","小蚂蚁背大象","雪山流浪","我没钱就变坏","谁说你是垃圾","爱丫头的男孩","挖别人的鼻孔","柒若只如当初","好想娶个老婆","向天堂的蝴蝶","牛魔王的同胞","酱爆触龙神","红烧白猪王","何谓生生世世","凹凸曼凹凸慢","就叫二狗好了","杭州生活的人","吃饱了还饿啊","我要失恋了啊","东北人的生活","爱害羞的男生","打抱不平而来","我是飘着的云","我就信春哥","低调小屁股","我想静静","无边落寞","风筝不想飞","流氓满天飞","不爽就打人","上善若水",,"伪暴力分子","裤宽三尺二","石头剪刀布","荒身心","三千歌","一笑醉","空城绝唱","沧桑一剑","紫廖渔歌","半瓶矿泉水","暖风","男人乖","走遍四方","男人不屑一顾","我已无力说爱","抽着寂寞的烟","繁华沧桑","卡尺","往事随风","剑胆琴心","心如止水","风伤依旧","哥一直很低调","遥忘而立","忧郁的萨克斯","哥比彩钻还炫","烈日追风","专属那女子","独孤端夜","慕容左铭","司马玄翌","sorry小电","冰祭流光","哥ヽ狠赞","Kingヽ殿下","倾城慕理","子潇","我帅故我拽","戒情不戒烟","再见丶单纯","刺眼的温存","逝去的往昔","焚焰滔天","龙武天","韩式ヽ少帅","红尘予依梦","暧晗依依","流星划无痕","墨染江南","流觞谨年","缠绵的悲伤","回忆全部没收","摩登小男","独特之蕞","潇洒还击","淡漠雨懵","梦回西塘","月如梭","红尘辗","孤帆远影","烟波缥缈","雨夜飘零","花落叶相随","奈何繁华落尽","刻骨思念","浮华童话","尘埃落定","年华交逝","叶落吾心","幻影逐风","淡笔、青春","怅然若失","繁华如锦","苍笙踏歌","牵着灵魂漫步","寂寞的救赎","月下箫歌","笑叹武陵衣马","醉月南山","写意河山","自是湖海客","剑惊风雨","夏雨初晴","栀璃鸢年","夜的旋律","寂若流年","静听细水长流","忆挽青笙尽","暮色上浓妆","月夜浅吟","人比烟花寂寞","弦已断","墨城烟柳","旧人殇","琴断弦奈何","花落相思起","独﹄妩二","陌上烟雨","卖女孩的小火柴","丑的拖网速","偷心的贼","鸡冻不如行动","铁盗游击队","致命隐匿","情原谅我自负","背后插人式","阳光下的罪恶","牛拦织女","戳你的肺","爱在戏院前","老婆别罚我","真心换黑心","你给我过来","愤怒的老鸟","洞房不败","你一溅我就笑","咬字分开念","缝小肛","成吉思春","神鲸大侠","太平间公主","骑驴玩漂移","小六卖神剑","朕日理万鸡","老痰酸菜面","见朕骑妓时刻","智取其乳","老衲让你受精","钢管美臀","精缸互撸娃","善解人衣","大精失射","骚后更精彩","承诺似雾如风","西天取精","予你挚终","盲眼画师","孤人情酒","夜如笼","淡忘。浅陌","懒癌晚期","步子大易扯蛋","兽性打败理性","负二代","秂字拖","那一夜","哈里波特大","拖拉机的惆怅","娇腿绕腰肢","杀驴般的叫声","剪个蘑菇头","不敢上厕所","小雏菊、","对猪乱弹琴","躺着唱征菔","尿尿逆流成河","坐墙上等红杏","扯淡还是扯蛋","八戒的花衬衫","爬墙、去约会","纠结伦","下辈子做猪","化腐朽为绵掌","野花压海棠","街头捡破烂","限量版男人","帅得不够明显","傻了吧唧","不爱请靠边","霸气范er","童年时的裸奔","爬墙头等红杏","黄小瓜丶嘎嘎","初吻给了烟","八戒你又调皮","二货少年","情兽","元芳看什么看","三无先森","半疯半颠","忐忑妞","我比窦娥还冤","雷帝嘎嘎","倒霉蛋","骑蜗牛闯世界","小丫么小二郎","骚气外露丶","治疗各种蛋疼","帅得想自刎","佬衲法呺嫖愙","叼根香烟吻迩","忘穿秋裤","骑猪去兜风","牙签翘起地球","傻里傻气","卖身不卖艺","一袭白衣","厌生′々","枝上绵蛮","回头已无路ゝ","一曲断弦╮","风劲角弓鸣","追梦少年","追光少女","青梅佐以酒","踽踽独行","胭脂染了灰","回眸泪倾↗城","韵华镜中池","蓦地一相逢","墨城烟柳","相约丶奈何桥","笙歌醉梦间℃","←琴默千弦︶","无处寄笺","是梦终会醒","微凉·雅娅","聚散如烟","美貌征服祢娘","帅炸宇宙","我还爱你","恶魔尊主","帅死一条街","至尊狂魔┈","我这种无赖","狂刄星空","散场的拥抱","九星剑临","有你在就足够","叶燃化诗","王的梦","嗜血超神","向钱看向厚赚","几分伤几分痴","血幡海盗","野战霸王","朕太高冷","邮递时光","七年为一梦","柠檬不萌i","爱鉨已成瘾","←龙霸天下`","孤的王朝"],this.testArr=[]}return t.prototype.getRandomName=function(t){var e="无名氏",i=Math.floor(6*Math.random())+1;switch(i){case 1:e=this.getName2();break;default:e=this.getName1()}return e.indexOf("null")>-1&&(e=e.replace("null","")),e},t.prototype.getName1=function(){var t=this.firstName,e=this.secondName,i=this.thirdName;return t[Math.floor(Math.random()*t.length)]+e[Math.floor(Math.random()*e.length)]+i[Math.floor(Math.random()*i.length)]},t.prototype.getName2=function(){return this.specialNameArr[Math.floor(Math.random()*this.specialNameArr.length)]},t}();__reflect(RandomName.prototype,"RandomName");var SelectRoleData=function(){function t(t){this.id=t.readUnsignedInt(),this.name=t.readCustomBytes(),t.readUnsignedByte(),this.sex=t.readByte(),this.level=t.readInt(),this.zsLevel=t.readByte(),this.roleClass=t.readByte(),t.readByte(),t.readByte()}return t}();__reflect(SelectRoleData.prototype,"SelectRoleData");var InstructionPart=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this,this.openTips)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.openTips=function(){var t=GameConfig.instruction[this.name];if(!t)return void GlobalFun.SysMsg("玩法配置ID"+this.name+"错误");var e=new ViewProp;e.exData1=RES_DIR_INSTRUCTION_TITTLE+(t.icon||1)+".png",e.exData2=t.dec,App.ViewManager.open(ViewConst.INSTRUCTION,e)},e}(BaseCustComponent);__reflect(InstructionPart.prototype,"InstructionPart");var InstructionTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="InstructionTipsSkin",e}return __extends(e,t),e.prototype.init=function(){},e.prototype.open=function(t){this.title.source=t.exData1,this.desc.textFlow=TextFlowUtils.generateTextFlow(t.exData2)},e}(BaseEuiWindow);__reflect(InstructionTips.prototype,"InstructionTips");var SkillMovieClip=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dispose=function(){t.prototype.dispose.call(this),e.num--},e.create=function(){return e.num++,ObjectPool.get(e)},e.num=0,e}(MovieClip);__reflect(SkillMovieClip.prototype,"SkillMovieClip");var ItemBaseCornerMark=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.reSet=function(){t.prototype.reSet.call(this),this.cornerMark.source=null},e.prototype.setMarkImg=function(t){this.cornerMark?this.cornerMark.source=t:(this.cornerMark=new eui.Image(t),this.cornerMark.right=5,this.cornerMark.top=5,this.addChild(this.cornerMark))},e}(ItemBase);__reflect(ItemBaseCornerMark.prototype,"ItemBaseCornerMark");var ItemMgr=function(){function t(){}return t.sortItemFunc=function(t,e){return 1},t.makeUserItemFromAward=function(t){var e=this.makeUserItemFromID(t.id);return e.btCount=t.count,e.btFlag=t.bind?1:0,e.btQuality=t.quality,e.btStrong=t.strong,e},t.makeUserItemFromID=function(t){var e=GameConfig.item[t]?GameConfig.item[t]:null;return e?this.makeUserItemFromStdItem(e):null},t.makeUserItemFromStdItem=function(t){var e=new UserItem;return e.stdItem=t,e.wItemId=t.id,e},t}();__reflect(ItemMgr.prototype,"ItemMgr");var ItemSeries=function(){function t(t){void 0===t&&(t=null),this._str="",t&&(this.createTime=t.readUnsignedInt(),this.wSeries=t.readUnsignedShort(),this.btServer=t.readByte(),this.btReserve=t.readByte(),this._str=this.createTime+"_"+this.wSeries+"_"+this.btServer+"_"+this.btReserve)}return t.prototype.toString=function(){return this._str},t.prototype.writeToBytes=function(t){t.writeUnsignedInt(this.createTime),t.writeShort(this.wSeries),t.writeByte(this.btServer),t.writeByte(this.btReserve)},t.prototype.isEquals=function(t){return t?t.createTime==this.createTime&&t.wSeries==this.wSeries&&t.btServer==this.btServer:!1},t.prototype.isZero=function(){return 0==this.createTime&&0==this.wSeries&&0==this.btServer&&0==this.btReserve},t}();__reflect(ItemSeries.prototype,"ItemSeries");var ItemTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.baCount=0,e.reCount=0,e.comIdx=["zdlPart","timePart","descPart","propPart","propPartExtr1","propPartExtr2","gainway","numSele","pricePart","btnPart","customBtnpart"],e.skinName="ItemTipsSkin",e.closeDispose=!1,e}return __extends(e,t),e.prototype.initUI=function(){},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this),this.itemData=e.itemData,this.itemName.textFlow=TextFlowUtils.generateTextFlow(ItemUtils.getItemNamewithColor(this.itemData)),e.exData1&&(this.userItem=e.exData1),e.exData2&&(this.plusData=e.exData2),e.firData&&(this.otherData=e.firData),this.item.data=this.userItem?this.userItem:e.itemData,this.item.strengthLvl=this.userItem?[this.userItem.btStrong]:[0],-1==this.itemData.type?this.initFashion():(this.recycleCustomBtnPart(),this.initLayout()),this.createTimePart(),this.addTouchEvent(this.itemName,this.uuddlrlrbaba),this.addTouchEvent(this.reRect,this.deleItemDeBug)},e.prototype.close=function(e){void 0===e&&(e=null),t.prototype.close.call(this),this.userItem&&(this.userItem=null),this.plusData&&(this.plusData=null),this.otherData&&(this.otherData=null),this.userItem=null,this.itemData=null,this.baCount=0,this.reCount=0},e.prototype.initLayout=function(){this.recycleDesc(),this.recycleNumSele(),this.itemData.staitcAttrs&&this.itemData.staitcAttrs.length?(this.createZdl(),this.createPropPart()):(this.recycleZDL(),this.recyclePropPart(),this.itemData.desc&&this.createDesc()),this.itemData.jump&&this.itemData.jump.length?this.createWayPart():this.recycleGainWay(),this.createBtnPart(),this.itemData.conds||this.userItem&&this.userItem.stdItem.type===ItemType.itNormal?this.createDetail():this.recycleDetail(),this.createPrice(),this.sortComs()},e.prototype.initFashion=function(){this.recycleBtn(),this.recycleNumSele(),this.itemData.desc?this.createDesc():this.recycleDesc(),this.itemData.staitcAttrs?(this.createZdl(),this.createPropPart()):(this.recycleZDL(),this.recyclePropPart()),this.itemData.conds?this.createDetail():this.recycleDetail(),this.otherData?this.createCustomBtnPart():this.recycleCustomBtnPart(),this.createPrice(),this.sortComs()},e.prototype.sortComs=function(){for(var t in this.comIdx){var e=this.contentG.getChildByName(this.comIdx[t]);e&&this.contentG.setChildIndex(e,Number(t))}},e.prototype.uuddlrlrbaba=function(){this.baCount++},e.prototype.deleItemDeBug=function(){this.reCount++},e.prototype.createDetail=function(){this.detailPart||(this.detailPart=ObjectPool.get(DetailPart),this.detailG.addChild(this.detailPart));var t=[];if(this.itemData.conds&&(t=this.itemData.conds.concat(),this.itemData.part||0==this.itemData.part)){var e=-1!=this.itemData.type?StdItemCondition.part:StdItemCondition.fashionPart;t.push({cond:e,value:this.itemData.part})}this.detailPart.data=t,this.userItem&&this.userItem.stdItem.type===ItemType.itNormal&&this.detailPart.setItemDetail({type:200,num:this.userItem.btCount})},e.prototype.recycleDetail=function(){this.detailPart&&(App.DisplayUtils.removeFromParent(this.detailPart),ObjectPool.push(this.detailPart),this.detailPart=null)},e.prototype.createDesc=function(){this.descPart||(this.descPart=ObjectPool.get(ItemDesc),this.descPart.name="descPart",this.contentG.addChildAt(this.descPart,this.comIdx.indexOf("descPart"))),this.descPart.data=this.itemData.desc},e.prototype.recycleDesc=function(){this.descPart&&(this.descPart.desc.text="",App.DisplayUtils.removeFromParent(this.descPart),ObjectPool.push(this.descPart),this.descPart=null)},e.prototype.createZdl=function(){this.zdlPart||(this.zdlPart=ObjectPool.get(ZdlPart),this.zdlPart.name="zdlPart",this.contentG.addChildAt(this.zdlPart,this.comIdx.indexOf("zdlPart"))),this.zdlPart.data=this.itemData.staitcAttrs},e.prototype.recycleZDL=function(){this.zdlPart&&(App.DisplayUtils.removeFromParent(this.zdlPart),ObjectPool.push(this.zdlPart),this.zdlPart=null)},e.prototype.createPropPart=function(){this.propPart||(this.propPart=ObjectPool.get(PropPart),this.propPart.name="propPart",this.propPart.skinName="PropPart2Skin"),this.contentG.addChildAt(this.propPart,this.comIdx.indexOf("propPart")),this.propPart.setData(this.itemData.staitcAttrs,void 0),this.plusData&&this.plusData[0]?(this.propPartExtr1||(this.propPartExtr1=ObjectPool.get(PropPartExtr),this.propPartExtr1.name="propPartExtr1",this.propPartExtr1.title.text=Language.lang.strengProTtl),this.propPartExtr1&&this.contentG.addChildAt(this.propPartExtr1,this.comIdx.indexOf("propPartExtr1")),this.propPartExtr1.setData(this.plusData[0],void 0)):this.recyclePropPartExtr1(),this.plusData&&this.plusData[1]?(this.propPartExtr2||(this.propPartExtr2=ObjectPool.get(PropPartExtr),this.propPartExtr2.name="propPartExtr2",this.propPartExtr2.title.text=Language.lang.refineProTtl),this.propPartExtr2&&this.contentG.addChildAt(this.propPartExtr2,this.comIdx.indexOf("propPartExtr2")),this.propPartExtr2.setData(this.plusData[1],void 0)):this.recyclePropPartExtr2()},e.prototype.recyclePropPart=function(){this.propPart&&(this.propPart.data=null,App.DisplayUtils.removeFromParent(this.propPart)),this.recyclePropPartExtr1(),this.recyclePropPartExtr2()},e.prototype.recyclePropPartExtr1=function(){this.propPartExtr1&&(this.propPartExtr1.data=null,App.DisplayUtils.removeFromParent(this.propPartExtr1))},e.prototype.recyclePropPartExtr2=function(){this.propPartExtr2&&(this.propPartExtr2.data=null,App.DisplayUtils.removeFromParent(this.propPartExtr2))},e.prototype.createWayPart=function(){this.gainway||(this.gainway=ObjectPool.get(GainWay),this.gainway.name="gainway",this.contentG.addChildAt(this.gainway,this.comIdx.indexOf("gainway"))),this.gainway.data=this.itemData.jump},e.prototype.onLink=function(t){TextFlowUtils.hrefType(t.text)},e.prototype.recycleGainWay=function(){this.gainway&&(this.gainway.data=null,App.DisplayUtils.removeFromParent(this.gainway),ObjectPool.push(this.gainway),this.gainway=null)},e.prototype.createBtnPart=function(){this.userItem?(this.btnPart||(this.btnPart=ObjectPool.get(BtnPart),this.btnPart.name="btnPart",this.contentG.addChildAt(this.btnPart,this.comIdx.indexOf("btnPart"))),this.btnPart.data=this.userItem):this.recycleBtn(),this.itemData.type>ItemType.itEquipMax?this.createNumUse():this.recycleNumSele()},e.prototype.recycleBtn=function(){this.btnPart&&(App.DisplayUtils.removeFromParent(this.btnPart),this.btnPart=null)},e.prototype.createCustomBtnPart=function(){this.customBtnpart||(this.customBtnpart=new CustomBtnpart,this.customBtnpart.name="customBtnpart",this.contentG.addChildAt(this.customBtnpart,this.comIdx.indexOf("customBtnpart"))),this.customBtnpart.initPart(this.otherData.thisc,this.otherData.func,this.otherData.icon,this.itemData)},e.prototype.recycleCustomBtnPart=function(){this.customBtnpart&&(App.DisplayUtils.removeFromParent(this.customBtnpart),this.customBtnpart=null)},e.prototype.createNumUse=function(){this.btnPart&&(this.numSele||(this.numSele=ObjectPool.get(NumSelect),this.numSele.name="numSele",this.numSele.skinName="NumSelectSkin",this.contentG.addChildAt(this.numSele,this.comIdx.indexOf("numSele"))),this.userItem&&this.numSele.initData(this.userItem.btCount,1,1))},e.prototype.recycleNumSele=function(){this.numSele&&(App.DisplayUtils.removeFromParent(this.numSele),ObjectPool.push(this.numSele),this.numSele=null)},e.prototype.createPrice=function(){return this.itemData.dealPrice||this.itemData.needNum?(this.pricePart||(this.pricePart=new PricePart,this.pricePart.name="pricePart",this.contentG.addChildAt(this.pricePart,this.comIdx.indexOf("pricePart"))),this.pricePart.cost.numColor_0=ColorUtil.C_WHITE,void(this.itemData.dealPrice?this.pricePart.cost.setData(this.itemData.dealType,this.itemData.dealPrice):this.pricePart.cost.setData(this.itemData.needNum[0].id,this.itemData.needNum[0].count))):void this.recyclePrice()},e.prototype.recyclePrice=function(){this.pricePart&&(App.DisplayUtils.removeFromParent(this.pricePart),this.pricePart=null)},e.prototype.createTimePart=function(){if(-1==this.itemData.type){var t=GameCache.hero.getRoleIdByIndex(GameCache.fashion.role);if(!GameCache.fashion.timeLimitItem[t]||!GameCache.fashion.timeLimitItem[t][this.itemData.id])return void this.recycleTimePart();var e=0;if(e=GameCache.fashion.timeLimitItem[t][this.itemData.id],!e)return void this.recycleTimePart();this.timePart||(this.timePart=new TimePart,this.timePart.name="timePart",this.contentG.addChildAt(this.timePart,this.comIdx.indexOf("timePart"))),this.timePart.setData(e)}},e.prototype.recycleTimePart=function(){this.timePart&&(this.timePart.cleanTime(),App.DisplayUtils.removeFromParent(this.timePart),this.timePart=null)},e.prototype.recycle=function(){this.recyclePropPart(),this.recycleGainWay(),this.recycleZDL(),this.recycleNumSele(),this.recycleBtn(),this.recycleDesc(),this.recycleDetail(),this.recycleCustomBtnPart(),this.recyclePrice()},e.prototype.dispose=function(){this.recycle(),t.prototype.dispose.call(this)},e}(BaseEuiWindow);__reflect(ItemTips.prototype,"ItemTips");var NewItem=function(t){function e(){var e=t.call(this,LayerManager.UI_Message)||this;return e.begin=!0,e.skinName="NewItemSkin",e.right=10,e.bottom=200,e}return __extends(e,t),e.prototype.initUI=function(){},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.EQUIP_INFO,this.initData),this.addTouchEvent(this.cBtn,this.closeFunc),this.addTouchEvent(this.btn,this.useFunc),this.initData()},e.prototype.close=function(e){t.prototype.close.call(this),this.begin=!0},e.prototype.initData=function(){var t=GameCache.bag.newItenHintArr[0]||null;return t?(this.item.data=t,this.itemName.text=t.stdItem.name,this.begin||this.checkList(t),void(this.begin=!1)):void this.closeView()},e.prototype.useFunc=function(){var t=this.item.data,e=t.bagType;switch(e){case BagType.BAG_TYPE_EQUIP:var i=ItemUtils.getEquipJob(t.stdItem),n=GameCache.hero.getServerIdByJob(i);Proxy.equip.sendQuickEquip(n,[t])}},e.prototype.closeFunc=function(){GameCache.bag.newItenHintArr.shift(),this.initData()},e.prototype.btnIconChange=function(t){t.bagType==BagType.BAG_TYPE_EQUIP?this.btn.icon="newtips_json.newtips_btn_1_png":this.btn.icon="newtips_json.newtips_btn_2_png"},e.prototype.checkList=function(t){ItemUtils.itemSuggestUse(t)||this.closeFunc()},e}(BaseEuiWindow);__reflect(NewItem.prototype,"NewItem");var BtnPart=function(t){function e(){var e=t.call(this)||this;return e.itemType=BagType.BAG_TYPE_EQUIP,e.unload=!1,e.skinName="BtnPartSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.wBtn,this.btnClick),this.addTouchEvent(this.sBtn,this.sendShowOff)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&this.data.stdItem&&(this._itemData=this.data,this.initBtn())},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initBtn=function(){var t=this.data.stdItem;if(t.type<ItemType.itEquipMax?this.itemType=BagType.BAG_TYPE_EQUIP:this.itemType=BagType.BAG_TYPE_OTHER,this.wBtn.icon="itemtips_json.itemtips_use_png",this.itemType==BagType.BAG_TYPE_EQUIP){var e=GameCache.equip.roleEquipList;this.unload=!1;for(var i in e)if(e[i][t.part]){var n=e[i][t.part];n.series.isEquals(this._itemData.series)&&(this.wBtn.icon="itemtips_json.itemtips_unload_png",this.unload=!0);break}}},e.prototype.btnClick=function(){this.itemType==BagType.BAG_TYPE_EQUIP?this.unload?this.sendDropEquipByItemSeries():this.sendWearEquip():this.sendUseItem()},e.prototype.sendWearEquip=function(){if(this._itemData.stdItem.type<ItemType.itEquipMax&&0!=this._itemData.stdItem.type){var t=ItemUtils.getEquipJob(this._itemData.stdItem),e=GameCache.hero.getServerIdByJob(t);if(-1==e)return void GlobalFun.SysMsg(Language.lang.wearError);Proxy.equip.sendQuickEquip(e,[this._itemData])}App.ViewManager.close(ViewConst.ITEMTIPS)},e.prototype.sendDropEquipByItemSeries=function(){if(this._itemData.stdItem.type<ItemType.itEquipMax&&0!=this._itemData.stdItem.type){var t=ItemUtils.getEquipJob(this._itemData.stdItem),e=GameCache.hero.getServerIdByJob(t);Proxy.equip.sendDropEquipByItemSeries(this._itemData.series,e)}App.ViewManager.close(ViewConst.ITEMTIPS)},e.prototype.sendUseItem=function(){Proxy.bag.sendItemUse(this._itemData,1)},e.prototype.sendShowOff=function(){GameCache.chat.showOffItem(this._itemData.stdItem),App.ViewManager.close(ViewConst.ITEMTIPS)},e}(BaseCustComponent);__reflect(BtnPart.prototype,"BtnPart");var CustomBtnpart=function(t){function e(){var e=t.call(this)||this;return e.skinName="BtnPartSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.wBtn,this.lFunc),this.addTouchEvent(this.sBtn,this.rFunc)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initPart=function(t,e,i,n){void 0===e&&(e=[]),void 0===i&&(i=[]),this.lHandler&&this.lHandler.dispose(),this.rHandler&&this.rHandler.dispose(),this.lHandler=Handler.create(t,e[0],[n],!0),this.rHandler=Handler.create(t,e[1],[n],!0),this.wBtn.icon=i[0],this.sBtn.icon=i[1]},e.prototype.lFunc=function(){this.lHandler&&this.lHandler.run()},e.prototype.rFunc=function(){this.rHandler&&this.rHandler.run()},e}(BaseCustComponent);__reflect(CustomBtnpart.prototype,"CustomBtnpart");var DetailPart=function(t){function e(){var e=t.call(this)||this;return e.skinName="DetailPartSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.length&&this.initData()},e.prototype.dispose=function(){this.dLab.text="",t.prototype.dispose.call(this)},e.prototype.initData=function(){var t=this.data;this.dLab.text="";for(var e="",i=0;i<t.length;i++){var n=t[i],o=ObjectPool.get(eui.Label);o.size=18,n.cond==StdItemCondition.ucJob?e+=StringUtils.substitute(Language.lang.mainJob,ItemUtils.getJobString(n.value),"c0xffffff","c0xffffff")+"\n":n.cond==StdItemCondition.ucLevel?e+=StringUtils.substitute(Language.lang.mainLvl,n.value,"c0xffffff","c0xffffff")+"\n":n.cond==StdItemCondition.part?e+=StringUtils.substitute(Language.lang.mainPart,Language.lang.part[n.value],"c0xffffff","c0xffffff")+"\n":n.cond==StdItemCondition.fashionPart&&(e+=StringUtils.substitute(Language.lang.mainPart,Language.lang.fashionPart[n.value],"c0xffffff","c0xffffff")+"\n")}this.dLab.textFlow=TextFlowUtils.generateTextFlow(e)},e.prototype.addEquipPart=function(t){var e=ObjectPool.get(eui.Label);e.size=18},e.prototype.setItemDetail=function(t){if(t){var e=this.dLab.text;e=StringUtils.substitute(Language.lang.itemType,"c0xffffff","c0xffffff")+"\n",e+=StringUtils.substitute(Language.lang.itemNum,t.num,"c0xffffff","c0xffffff"),this.dLab.textFlow=TextFlowUtils.generateTextFlow(e)}},e}(BaseCustComponent);__reflect(DetailPart.prototype,"DetailPart");var GainWay=function(t){function e(){var e=t.call(this)||this;return e.skinName="GainWaySkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEvent(egret.TextEvent.LINK,this.wTxt,this.onLink),this.title.text=Language.lang.getway},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&this.data.length?this.setData():this.wTxt.text=""},e.prototype.dispose=function(){this.wTxt.text="",t.prototype.dispose.call(this)},e.prototype.setData=function(){for(var t=this.data,e="",i=1,n=0,o=t;n<o.length;n++){var r=o[n];e+=i%3==0?r.value+"\n":r.value+"      ",i++}this.wTxt.textFlow=TextFlowUtils.generateTextFlow(e)},e.prototype.onLink=function(t){var e=t.text.split("_"),i=e[0]+":"+e[1];TextFlowUtils.hrefType(i),App.ViewManager.close(ViewConst.ITEMTIPS)},e}(BaseCustComponent);__reflect(GainWay.prototype,"GainWay");var ItemDesc=function(t){function e(){var e=t.call(this)||this;return e.skinName="ItemDescSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),"string"==typeof this.data&&(this.desc.textFlow=TextFlowUtils.generateTextFlow(this.data))},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(ItemDesc.prototype,"ItemDesc");var NumSelect=function(t){function e(){var e=t.call(this)||this;return e._num=0,e._max=0,e._min=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.mBtn,this.onToucheFunc),this.addTouchEvent(this.pBtn,this.onToucheFunc),this.addTouchEvent(this.maxBtn,this.onToucheFunc),this.addTouchEvent(this.minBtn,this.onToucheFunc),this.addTouchEvent(this.tmBtn,this.onToucheFunc),this.addTouchEvent(this.tpBtn,this.onToucheFunc),this.addEvent(egret.FocusEvent.FOCUS_OUT,this.nInput,this.inputData)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"num",{get:function(){return this._num},enumerable:!0,configurable:!0}),e.prototype.initData=function(t,e,i){this._max=t,this._min=e,this._num=i?i:0,this.nInput.text=this._num+""},e.prototype.onToucheFunc=function(t){var e=t.target.name;switch(e){case"minus":this._num=this._num-1<this._min?this._min:this._num-1;break;case"plus":this._num=this._num+1>this._max?this._max:this._num+1;break;case"max":this._num=this._max;break;case"min":this._num=this._min;break;case"tmBtn":this._num=this._num-10<this._min?this._min:this._num-10;break;case"tmBtn":this._num=this._num+10>this._max?this._max:this._num+10}this.nInput.text=this._num+"",this.handlerRun()},e.prototype.inputData=function(){var t=parseInt(this.nInput.text);isNaN(t)&&(t=1),this._num=t,this.nInput.text=t+""},e.prototype.handlerRun=function(){this._handler&&this._handler.run()},e}(BaseCustComponent);
__reflect(NumSelect.prototype,"NumSelect");var PricePart=function(t){function e(){var e=t.call(this)||this;return e.skinName="PricePartSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.cost.gainWay.visible=!1,this.cost.lab.textFlow=TextFlowUtils.generateTextFlow(Language.lang.price)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(PricePart.prototype,"PricePart");var CMovieClip=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),e.prototype.setSource=function(t,e){void 0===e&&(e=5),this.removeSource(),this._dirNum=e,this._data=CMovieDataCache.ins().getData(t),this._data.addTarget(this)},e.prototype.removeSource=function(){this._data&&(this._data.removeTarget(this),this._data=null),this.visible=!1,this.movieClipData=null,this.curLoaDir=-1},e.prototype.load=function(t){void 0===t&&(t=-1)},e.prototype.disposeSource=function(){this.removeSource(),this.stop()},e.prototype.dispose=function(){this.disposeSource(),App.DisplayUtils.removeFromParent(this),ObjectPool.push(this)},e.prototype.getMCData=function(){var t=this._data.getMovieClipData(this.curLoaDir);t&&this.setMCData(t)},e.prototype.setMCData=function(t){this.movieClipData=t,t&&(this.visible=!0)},e.prototype.setFrame=function(t){null!=this.movieClipData&&this.gotoAndStop(t)},e}(egret.MovieClip);__reflect(CMovieClip.prototype,"CMovieClip");var PropPartExtr=function(t){function e(){var e=t.call(this)||this;return e.skinName="PropPartExtrSkin",e}return __extends(e,t),e}(PropPart);__reflect(PropPartExtr.prototype,"PropPartExtr");var TimePart=function(t){function e(){var e=t.call(this)||this;return e.time=0,e.skinName="TimePartSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),App.TimerManager.removeAll(this)},e.prototype.setData=function(t){void 0===t&&(t=0),this.time=t,this.time&&(App.TimerManager.isExists(this.timeCount,this)||App.TimerManager.addDelay(0,1e3,0,this.timeCount,this))},e.prototype.timeCount=function(){var t=Math.ceil(GameCache.server.serverTime/1e3),e=this.time-t;e>0?this.countDown.text=StringUtils.substitute(Language.lang.relistTime,App.DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_12)):(App.TimerManager.removeAll(this),this.countDown.text=StringUtils.substitute(Language.lang.relistTime,App.DateUtils.getFormatBySecond(0,DateUtils.TIME_FORMAT_12)))},e.prototype.cleanTime=function(){App.TimerManager.removeAll(this)},e}(BaseCustComponent);__reflect(TimePart.prototype,"TimePart");var ZdlPart=function(t){function e(){var e=t.call(this)||this;return e.skinName="ZdlPartSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.zdl.gap=16,this.zdl.alignV="mid"},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.length&&this.setData()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.setData=function(){var t=ItemUtils.getZdlByProp(this.data)+"";this.zdl.value=t},e}(BaseCustComponent);__reflect(ZdlPart.prototype,"ZdlPart");var ItemSourceType=function(){function t(){}return t.BAG=1,t.ROLEEQUIP=2,t.OTHER_ROLEEQUIP=999,t}();__reflect(ItemSourceType.prototype,"ItemSourceType");var StdItemCondition;!function(t){t[t.undi=0]="undi",t[t.ucLevel=1]="ucLevel",t[t.ucGender=2]="ucGender",t[t.ucJob=3]="ucJob",t[t.part=100]="part",t[t.fashionPart=101]="fashionPart"}(StdItemCondition||(StdItemCondition={}));var UserItem=function(){function t(t){void 0===t&&(t=null),this.btCount=1,this.wHoles=[],this.refineAttrs=[],this.UserItem(t)}return t.prototype.UserItem=function(t){t&&(this.series=new ItemSeries(t),this.wItemId=t.readUnsignedShort(),this.stdItem=GameConfig.item[this.wItemId],this.btQuality=t.readUnsignedByte(),this.btStrong=t.readUnsignedByte(),t.readShort(),t.readShort(),this.btCount=t.readUnsignedShort(),t.readUnsignedInt(),t.readShort(),t.readUnsignedInt(),t.readUnsignedInt(),t.readUnsignedInt(),t.readUnsignedInt(),t.readUnsignedInt(),t.readUnsignedInt(),t.readUnsignedInt(),t.readUnsignedByte(),t.readUnsignedByte(),t.readUnsignedByte(),t.readShort(),t.readUnsignedByte(),t.readUnsignedByte(),t.readUnsignedByte(),t.readUnsignedByte())},t.prototype.cloneItem=function(){var e=new t;e.series=this.series,e.part=this.part,e.stdItem=this.stdItem,e.wItemId=this.wItemId},t}();__reflect(UserItem.prototype,"UserItem");var ItemUtils=function(){function t(){}return t.getItemColor=function(t){return this.colorArr[t-1]||14079702},t.getItemNamewithColor=function(t){var e="<(c"+this.getItemColor(t.showQuality)+")"+t.name+">";return e},t.getItemNamewithColorById=function(t){var e=1,i="";t&&GameConfig.item[t]&&(e=GameConfig.item[t].showQuality||1,i=GameConfig.item[t].name||"");var n="<(c"+this.getItemColor(e)+")"+i+">";return n},t.getJobString=function(t){var e=Language.lang;return e.jobName[t]},t.getEquipJob=function(t){var e=t.conds,i=0;if(!e)return this.currencyEquip(t);for(var n=0;n<e.length;n++)if(e[n].cond==StdItemCondition.ucJob)return i=0!=e[n].cond?e[n].value:this.currencyEquip(t)},t.getUsLv=function(t){var e=t.conds;if(!e)return 0;for(var i=0;i<e.length;i++)if(e[i].cond==StdItemCondition.ucLevel)return e[i].value},t.currencyEquip=function(t){for(var e=0;e<GameCache.hero.list.length;e++){var i=GameCache.hero.getDataByIndex(e,GameCache.equip.roleEquipList),n=i&&i[t.part]?i[t.part]:null,o=this.getItemZDL(t);if(!n)return GameCache.hero.list[e].pro.pro(PropId.AP_JOB);if(this.getItemZDL(n.stdItem)<o)return GameCache.hero.list[e].pro.pro(PropId.AP_JOB)}return 1},t.getZdlByProp=function(t){var e=0;if(!t)return 0;for(var i=0,n=t;i<n.length;i++){var o=n[i],r=GameConfig.buffId[o.type];r&&(e+=r.power*o.value)}return Math.floor(e)},t.isEquip=function(t){return t.type>0&&t.type<ItemType.itEquipMax},t.isNormalItem=function(t){return t.type>=ItemType.itNormal},t.getItemZDL=function(t){var e=GameCache.bag.itemZDL[t.id];return e||(e=this.getZdlByProp(t.staitcAttrs),GameCache.bag.itemZDL[t.id]=e),e},t.itemCanUse=function(t){var e=t.bagType;switch(e){case BagType.BAG_TYPE_EQUIP:var i=t.stdItem.conds;for(var n in i){if(i[n].cond==StdItemCondition.ucLevel){var o=GameCache.hero.mainPro.pro(PropId.AP_LEVEL);if(o<i[n].value)return!1}if(i[n].cond==StdItemCondition.ucJob){var r=GameCache.hero.getProByJob(i[n].value);if(!r)return!1}}return!0}return!0},t.itemSuggestUse=function(e){var i=e.stdItem,n=e.bagType;if(!i.useremind)return!1;switch(n){case BagType.BAG_TYPE_EQUIP:var o=t.getEquipJob(i);if(!GameCache.hero.getHeroByJob(o))return this.isItemRecycle(e,7,i.showQuality>=6),!1;var r=!this.isItemRecycle(e,7,i.showQuality>=6),a=t.itemCanUse(e);return r&&a;default:return!0}},t.isItemRecycle=function(e,i,n,o){void 0===i&&(i=6),void 0===n&&(n=!1),void 0===o&&(o=0);var r=e.stdItem;if(r.showQuality>=i)return!1;var a=t.getItemZDL(r),s=t.getEquipJob(r),h=s?s:1;0!=o&&(h=o);var p=0,l=GameCache.hero.getProByJob(h);l&&(p=l.pro(PropId.AP_ACTOR_ID));var c=GameCache.equip.roleEquipList[p],u=c&&c[r.part]?c[r.part]:null;if(u){if(u.series.isEquals(e.series))return!0;var d=t.getItemZDL(u.stdItem);if(d>=a)return!n&&(GameCache.bag.recycleArr[e.series.toString()]=e),GameCache.bag.roleSuggestBag[h]&&GameCache.bag.roleSuggestBag[h][r.part]==e&&delete GameCache.bag.roleSuggestBag[h][r.part],!0;var g=this.initSuggest(e,h,a,n);return"same"===g?!0:(!n&&!g&&(GameCache.bag.recycleArr[e.series.toString()]=e),!g)}var f=GameCache.bag.roleKeepBag[""+h];f||(f=GameCache.bag.roleKeepBag[""+h]={});var m=f[""+r.part]?f[""+r.part]:null,g=this.initSuggest(e,h,a,n);if(!m)return f[""+r.part]=e,!1;var y=t.getItemZDL(m.stdItem);return e.series.isEquals(m.series)?!1:a>y?(f[""+r.part]=e,void(!n&&(GameCache.bag.recycleArr[m.series.toString()]=m))):(!n&&!g&&(GameCache.bag.recycleArr[e.series.toString()]=e),!0)},t.initSuggest=function(e,i,n,o){void 0===o&&(o=!1);var r=e.stdItem,a=GameCache.bag.roleSuggestBag[i];if(!t.itemCanUse(e))return!0;a||(a=GameCache.bag.roleSuggestBag[i]={});var s=a[r.part];if(s){var h=t.getItemZDL(r);return e.series.isEquals(s.series)?"same":n>h?(!o&&(GameCache.bag.recycleArr[s.series.toString()]=s),a[r.part]=e,!0):!1}return a[r.part]=e,!0},t.deleSuggest=function(t){var e=this.getEquipJob(t.stdItem),i=GameCache.bag.roleSuggestBag[e];if(i)for(var n in i){var o=i[n];o.series.isEquals(t.series)&&delete i[n]}},t.colorArr=[14079702,2817792,46335,16711902,16771584,16711680],t}();__reflect(ItemUtils.prototype,"ItemUtils");var ItemList=function(t){function e(){var e=t.call(this)||this;return e.itemArr=[],e}return __extends(e,t),e.prototype.setData=function(t,e){if(void 0===t&&(t=[]),0!=t.length){for(var i=0,n=0,o=t.length;o>n;n++){var r=void 0,a=t[n];a.job&&a.job!=GameCache.hero.mainPro.job||(this.itemArr[i]?r=this.itemArr[i]:(r=ObjectPool.get(ItemBase),this.itemArr.push(r),r&&e.addChild(r)),r.skinName="ItembaseSkin",r.data=t[n],i++)}for(var s=i;i<this.itemArr.length;)this.itemArr[i].reSet(),App.DisplayUtils.removeFromParent(this.itemArr[i]),ObjectPool.push(this.itemArr[i]),i++;s<this.itemArr.length&&(this.itemArr=this.itemArr.slice(0,s))}},e.prototype.dispose=function(){if(this.itemArr)for(var t=0,e=this.itemArr;t<e.length;t++){var i=e[t];i.reSet(),ObjectPool.push(i),App.DisplayUtils.removeFromParent(i)}this.itemArr=[]},e}(BaseClass);__reflect(ItemList.prototype,"ItemList");var ItemListCommual=function(t){function e(){var e=t.call(this)||this;return e.itemArr=[],e}return __extends(e,t),e.prototype.setData=function(t,e,i,n){if(void 0===t&&(t=[]),t.length){for(var o=0,r=0,a=t.length;a>r;r++){var s=void 0,h=t[r];this.itemArr[o]?s=this.itemArr[o]:(s=ObjectPool.get(i),this.itemArr.push(s),s&&e.addChild(s)),n&&(s.skinName=n),s.data=h,o++}for(var p=o;o<this.itemArr.length;)this.itemArr[o].reSet(),App.DisplayUtils.removeFromParent(this.itemArr[o]),ObjectPool.push(this.itemArr[o]),o++;p<this.itemArr.length&&(this.itemArr=this.itemArr.slice(0,p))}},e.prototype.dispose=function(){if(this.itemArr)for(var t=0,e=this.itemArr;t<e.length;t++){var i=e[t];ObjectPool.push(i),App.DisplayUtils.removeFromParent(i)}this.itemArr=[]},e}(BaseClass);__reflect(ItemListCommual.prototype,"ItemListCommual");var ItemListTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="ItemListTipsSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){if(t.prototype.open.call(this),this.itemList.itemRenderer,e&&e.firData){var i={itemRenderer:e.firData.itemRenderer,itemSkin:e.firData.itemSkin,itemData:e.firData.itemData};this.initData(i),e.firData.msg&&this.message(e.firData.msg,this.initListData)}},e.prototype.initData=function(t){this.itemList.itemRenderer=t.itemRenderer,this.itemList.itemRendererSkinName=t.itemSkin,this.initListData(t.itemData)},e.prototype.initListData=function(t){this.setListData(this.itemList,t)},e}(BaseEuiWindow);__reflect(ItemListTips.prototype,"ItemListTips");var JewelBag=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="JewelBagSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=JewelBagItem},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.JEWEL_BAG,this.initBagList),this.addTouchEvent(this.iG,this.onGroupTouche),this.addTouchEvent(this.cg,this.checkBoxFunc),this.addTouchEvent(this.btn_0,this.btnFunc),this.addTouchEvent(this.itemList,this.stuffPrint),this.cost.label=Language.lang.jewel_1,this.initBagList()},e.prototype.close=function(e){t.prototype.close.call(this),this.setListData(this.itemList,[]),this.check_2.selected=this.check_3.selected=this.check_4.selected=this.check_5.selected=!1},e.prototype.initBagList=function(){var t=GameCache.jewel.jewelBag,e={},i=[];for(var n in t)for(var o in t[n])e[o]||(e[o]=[]),e[o]=e[o].concat(t[n][o]);for(var r in e)i=i.concat(e[r]);for(var r=0;r<i.length;r++)i[r]={id:i[r]};i=i.reverse(),this.setListData(this.itemList,i),this.cost.visible=!1},e.prototype.onGroupTouche=function(t){var e=t.target.name;this["check_"+e].selected=!this["check_"+e].selected,this.checkBoxFunc(parseInt(e))},e.prototype.checkBoxFunc=function(t){var e;"number"==typeof t?e=t:t instanceof egret.TouchEvent&&(e=parseInt(t.target.name));for(var i=this.itemList.dataProvider.source,n=0;n<i.length;n++){var o=this.itemList.getElementAt(n)||this.itemList.getVirtualElementAt(n),r=o._itemData.showQuality;r==e&&(i[n].checkSele=this["check_"+e].selected)}this.itemList.dataProvider.replaceAll(i),this.stuffPrint()},e.prototype.btnFunc=function(){for(var t=[],e=0;e<this.itemList.numElements;e++){var i=this.itemList.getElementAt(e)||this.itemList.getVirtualElementAt(e);i.checkBox.selected&&t.push(i._itemData.id)}Proxy.jewel.sendDecomposition(t)},e.prototype.stuffPrint=function(){for(var t,e=0;e<this.itemList.numElements;e++){var i=this.itemList.getElementAt(e)||this.itemList.getVirtualElementAt(e);if(i.checkBox.selected){var n=GameConfig.jewel[i._itemData.id];t?t[1]+=n.resolve[0].count:t=[n.resolve[0].id,n.resolve[0].count]}}t?(this.cost.visible=!0,this.cost.setData(t[0],t[1])):this.cost.visible=!1},e}(BaseSpriteView);__reflect(JewelBag.prototype,"JewelBag");var JewelBagItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.checkBox.touchEnabled=!1},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.checkBox.selected=this.data.checkSele,this.setHandler(this,this.checkBoxTouche)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.checkBox.selected=!1},e.prototype.checkBoxTouche=function(){this.checkBox.selected=!this.checkBox.selected},e}(ItemBase);__reflect(JewelBagItem.prototype,"JewelBagItem");var JewelCache=function(t){function e(){var e=t.call(this)||this;return e.jewelBag={},e.roleJewelList={},e}return __extends(e,t),e.prototype.clear=function(){this.jewelBag={},this.roleJewelList={}},e.prototype.initJewelBag=function(t){var e=GameConfig.jewel[t],i=GameConfig.item[t];if(e&&i){var n=this.jewelBag[e.part];n||(n=this.jewelBag[e.part]={}),n[i.showQuality]?n[i.showQuality].push(t):n[i.showQuality]=[t]}},e.prototype.deleteJewel=function(t){var e=GameConfig.jewel[t],i=GameConfig.item[t],n=this.jewelBag[e.part];n&&n[i.showQuality]&&0!=n[i.showQuality].length&&n[i.showQuality].shift()},e.prototype.checkJewelInsert=function(t,e){if(!t){for(var i=GameCache.hero.list,n=0;n<i.length;n++)for(var o=0;8>o;o++)if(this.checkJewelInsert(i[n].id,o))return!0;return!1}if(!e&&"number"!=typeof e){for(var n=0;8>n;n++)if(this.checkJewelInsert(t,n))return!0;return!1}var r=this.roleJewelList[t],a=GameConfig.jewel[0].condition,s=GameCache.copytower.copyTowerLayer;if(s<a[e])return!1;var h=r&&r[e]?r[e]:null;if(!h){var p=!1;for(var n in this.jewelBag){var l=parseInt(n),c=!1;for(var o in r){var u=GameConfig.jewel[r[o].id];if(u.part==l){c=!0;break}}c||(p=!0)}return p}var d=GameConfig.item[h.id],u=GameConfig.jewel[h.id],g=d.showQuality,l=u.part,f=this.jewelBag[l];for(var n in f){var m=parseInt(n);if(m>g)return!0}return!1},e.prototype.checkJewelUpGrade=function(t,e){if(!t){for(var i=GameCache.hero.list,n=0;n<i.length;n++)for(var o=0;8>o;o++)if(this.checkJewelUpGrade(i[n].id,o))return!0;return!1}if(!e&&"number"!=typeof e){for(var n=0;8>n;n++)if(this.checkJewelUpGrade(t,n))return!0;return!1}var r=this.roleJewelList[t],a=r&&r[e]?r[e]:null;if(!a)return!1;var s=GameConfig.jewel[a.id],h=GameCache.bag.itemCount(s.consume[0].id),p=s.consume[0].count*(1+a.lvl*s.lvlConsume);return h>=p},e}(BaseCache);__reflect(JewelCache.prototype,"JewelCache");var JewelItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),App.DisplayUtils.addLinkonText(this,this.jName)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data?this.initData():this.cleanData()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.stateJuge=function(t,e){if(void 0===e&&(e=!1),this.icon.source="public_json.public_lock_1_png",e){var i=StringUtils.substitute(Language.lang.jewel_0,t);this.jName.textFlow=TextFlowUtils.generateTextFlow("<(u)(e_win_COPY#1)(c0x00ff0c)"+i+">"),this.jName.visible=!0,this.blank.visible=!0}else this.jName.visible=!1,this.blank.visible=!1},e.prototype.initData=function(){var t=GameConfig.item[this.data.id],e=ItemUtils.getItemColor(t.showQuality),i=StringUtils.substitute(Language.lang.nameLvl,t.name,this.data.lvl);this.jName.visible=!0,this.blank.visible=!0,this.jName.textFlow=TextFlowUtils.generateTextFlow("<(c"+e+")"+i+">"),this.icon.source=RES_DIR_IMAGES_ITEM+t.icon+".png"},e.prototype.cleanData=function(){this.icon.source=null,this.jName.visible=!1,this.blank.visible=!1},Object.defineProperty(e.prototype,"seleted",{set:function(t){this.sele.visible=t},enumerable:!0,configurable:!0}),e}(BaseCustComponent);__reflect(JewelItem.prototype,"JewelItem");var JewelPage=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.oldIndex=0,i.totalProp=[],i.skinName="JewelPageSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.roleSelect.setHandler(this,this.onCLick)},e.red=function(){return GameCache.jewel.checkJewelInsert()||GameCache.jewel.checkJewelUpGrade()},e.changeMsg=function(){return[MsgConst.JEWEL_LIST,MsgConst.NEW_HERO]},e.prototype.roleRed=function(t){return GameCache.jewel.checkJewelInsert(t)||GameCache.jewel.checkJewelUpGrade(t)},e.prototype.refreshRed=function(){t.prototype.refreshRed.call(this),this.redShow()},e.prototype.open=function(t){this.message(MsgConst.JEWEL_LIST,this.initData),this.addTouchEvent(this.iG,this.onGroupTouche),this.addTouchEvent(this.btn_2,this.openReplaceTips),this.addTouchEvent(this.btn_0,this.openReplaceTips),this.addTouchEvent(this.btn_1,this.upGradeFunc),this.addTouchEvent(this.pBtn,this.openTotalProp),this.initData(),this.onGroupTouche()},e.prototype.onCLick=function(){this.initData()},e.prototype.initData=function(){var t=GameCache.jewel.roleJewelList[this.roleSelect.roleId];t=t?t:{};for(var e=GameCache.copytower.copyTowerLayer,i=GameConfig.jewel[0].condition,n=!0,o=0;8>o;o++){var r=this["jItem_"+o],a=GameCache.jewel.checkJewelInsert(this.roleSelect.roleId,o)||GameCache.jewel.checkJewelUpGrade(this.roleSelect.roleId,o);App.ViewManager.showRedPoint(r,a),r.seleted=!1,i[o]<=e?r.data=t[o]:(r.stateJuge(i[o],n),n=!1)}this.initZdl(),this.onGroupTouche()},e.prototype.onGroupTouche=function(t){var e=t?parseInt(t.target.name):this.oldIndex;this["jItem_"+this.oldIndex].seleted=!1,this["jItem_"+e].seleted=!0,this.oldIndex=e,this.initItem(),this.redShow()},e.prototype.initItem=function(){var t=GameCache.jewel.roleJewelList[this.roleSelect.roleId];t=t?t:{};var e=t[this.oldIndex];if(e){var i=GameConfig.jewel[e.id],n=GlobalFun.ObjPlusOrMinus(i.attr,i.lvlAttr,e.lvl),o=GlobalFun.ObjPlusOrMinus(i.attr,i.lvlAttr,e.lvl+1);this.propList.visible=!0,this.btn_0.visible=!1,this.g2.visible=!0;var r=i.consume[0].count*(1+e.lvl*i.lvlConsume);this.cost.setData(i.consume[0].id,r),this.propList.setData(n,o,this.roleSelect.job,16762368,16777215,65292,[],"PropItem2Skin")}else this.propList.visible=!1,this.btn_0.visible=!0,this.g2.visible=!1},e.prototype.openReplaceTips=function(){var t=GameConfig.jewel[0].condition[this.oldIndex],e=GameCache.copytower.copyTowerLayer;if(t>e)return void GlobalFun.SysMsg("爬塔层数不足"+t+"层");var i=new ViewProp;i.exData1=this.oldIndex,i.exData2=this.roleSelect.nSlRole,App.ViewManager.open(ViewConst.JEWELREPLACE,i)},e.prototype.upGradeFunc=function(){this.cost.checkEnough()&&Proxy.jewel.sendUpGrade(this.roleSelect.nSlRole,this.oldIndex)},e.prototype.initZdl=function(){var t=GameCache.jewel.roleJewelList[this.roleSelect.roleId];t=t?t:{};var e=[];for(var i in t){var n=GameConfig.jewel[t[i].id],o=t[i].lvl,r=GlobalFun.ObjPlusOrMinus(n.attr,n.lvlAttr,o);e=GlobalFun.ObjPlusOrMinus(e,r)}this.totalProp=e,this.zdl.value=ItemUtils.getZdlByProp(this.totalProp)},e.prototype.openTotalProp=function(){var t=new ViewProp;t.firData={},t.firData.src="totems_json.totems_texture_0_png",t.firData.prop=this.totalProp,App.ViewManager.open(ViewConst.TOTALPROP,t)},e.prototype.redShow=function(){App.ViewManager.showRedPoint(this.btn_0,GameCache.jewel.checkJewelInsert(this.roleSelect.roleId,this.oldIndex)),App.ViewManager.showRedPoint(this.btn_1,GameCache.jewel.checkJewelUpGrade(this.roleSelect.roleId,this.oldIndex)),App.ViewManager.showRedPoint(this.btn_2,GameCache.jewel.checkJewelInsert(this.roleSelect.roleId,this.oldIndex))},e}(BaseSpriteView);__reflect(JewelPage.prototype,"JewelPage");var JewelPannel=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this,e)},e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPagePannel);__reflect(JewelPannel.prototype,"JewelPannel");var JewelProxy=function(t){function e(){var e=t.call(this,PacketTypes.JEWEL)||this;return e.regNetMsg(1,e.doInitJewelBag),e.regNetMsg(2,e.doRoleJewelList),e.regNetMsg(3,e.doAddJewel),e.regNetMsg(4,e.doDeleteJewel),e.regNetMsg(5,e.doJewelOption),e}return __extends(e,t),e.prototype.doInitJewelBag=function(t){for(var e=t.readUnsignedShort(),i=0;e>i;i++){var n=t.readInt();GameCache.jewel.initJewelBag(n)}App.MessageCenter.dispatch(MsgConst.JEWEL_BAG)},e.prototype.doRoleJewelList=function(t){for(var e=GameCache.hero.transIdFromeServer(t.readInt()),i=t.readByte(),n={},o=0;i>o;o++){var r={};r.part=t.readByte(),r.id=t.readInt(),r.lvl=t.readUnsignedShort(),n[r.part]=r}GameCache.jewel.roleJewelList[e]=n,App.MessageCenter.dispatch(MsgConst.JEWEL_LIST)},e.prototype.doAddJewel=function(t){var e=t.readInt();GameCache.jewel.initJewelBag(e);var i=GameConfig.item[e],n=ItemUtils.getItemNamewithColor(i)+" x1";GlobalFun.SysMsg(StringUtils.substitute(Language.lang.huode,n),SysMessageType.CHAT_PANEL_RIGHT),App.MessageCenter.dispatch(MsgConst.JEWEL_BAG)},e.prototype.doDeleteJewel=function(t){var e=t.readInt();GameCache.jewel.deleteJewel(e),App.MessageCenter.dispatch(MsgConst.JEWEL_BAG)},e.prototype.doJewelOption=function(t){var e=GameCache.hero.transIdFromeServer(t.readInt()),i=t.readByte(),n=t.readInt(),o=t.readUnsignedShort(),r={part:i,id:n,lvl:o},a=GameCache.jewel.roleJewelList[e];a||(a=GameCache.jewel.roleJewelList[e]={}),a[i]=r,App.MessageCenter.dispatch(MsgConst.JEWEL_LIST)},e.prototype.sendSetJewel=function(t,e,i){var n=GameCache.hero.getServerIdByIndex(t),o=this.getBytes(1);o.writeInt(n),o.writeByte(e),o.writeInt(i),this.sendToServer(o)},e.prototype.sendOffJewel=function(t,e){var i=GameCache.hero.getServerIdByIndex(t),n=this.getBytes(2);n.writeInt(i),n.writeByte(e),this.sendToServer(n)},e.prototype.sendUpGrade=function(t,e){var i=GameCache.hero.getServerIdByIndex(t),n=this.getBytes(3);n.writeInt(i),n.writeByte(e),this.sendToServer(n)},e.prototype.sendDecomposition=function(t){if(t){var e=t.length,i=this.getBytes(4);i.writeUnsignedShort(e);for(var n=0,o=t;n<o.length;n++){var r=o[n];i.writeInt(r)}this.sendToServer(i)}},e.prototype.sendReplace=function(t,e,i){var n=GameCache.hero.getServerIdByIndex(t),o=this.getBytes(5);o.writeInt(n),o.writeByte(e),o.writeInt(i),this.sendToServer(o)},e}(BaseProxy);__reflect(JewelProxy.prototype,"JewelProxy");var JewelReplaceItem=function(t){function e(){var e=t.call(this)||this;return e.setOrReplace=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.btn,this.btnFunc)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.item&&this.initData()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){var t=this.data.item,e=GameConfig.jewel[this.data.id],i=GameCache.hero.getRoleIdByIndex(this.data.roleIdx),n=GameCache.jewel.roleJewelList[i];this.item_0.data=t,this.iName.text=StringUtils.substitute(Language.lang.nameLvl,t.name,this.data.lvl),this.setOrReplace=n&&n[this.data.part]?!1:!0,this.propList.setData(t.staitcAttrs,[],0,16762368,16777215),this.zdl.value=this.data.power,-1==this.data.curType?(this.btn.visible=!1,this.state.visible=!0,this.state.source="jewel_json.jewel_cur_png"):e.part!=this.data.curType&&this.data.have?(this.btn.visible=!1,this.state.visible=!0,this.state.source="jewel_json.jewel_haved_png"):(this.state.source=null,this.state.visible=!1,this.btn.visible=!0)},e.prototype.btnFunc=function(){this.setOrReplace?(Proxy.jewel.sendSetJewel(this.data.roleIdx,this.data.part,this.data.id),App.ViewManager.close(ViewConst.JEWELREPLACE)):Proxy.jewel.sendReplace(this.data.roleIdx,this.data.part,this.data.id)},e}(BaseCustComponent);__reflect(JewelReplaceItem.prototype,"JewelReplaceItem");var JewelReplaceTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="JewelRepalceTipsSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=JewelReplaceItem,this.setWinTitle("jewel")},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.JEWEL_LIST,this.initList),this.curPart=e.exData1,this.roleIdx=e.exData2,this.initList()},e.prototype.initList=function(){var t=GameCache.hero.getRoleIdByIndex(this.roleIdx),e=GameCache.jewel.jewelBag,i=GameCache.jewel.roleJewelList[t];i=i?i:{};var n=i[this.curPart],o=n?GameConfig.jewel[n.id]:null;if(n){var r=GameConfig.item[n.id],a=ItemUtils.getItemZDL(r);this.currentState="sp",this.cur&&(this.cur.data={item:r,curType:-1,lvl:n.lvl,power:a})}else this.currentState="nor";var s=[],h=[],p=[];for(var l in i){var c=GameConfig.jewel[i[l].id];h.push(c.part)}for(var l in e){var u=-1!=h.indexOf(parseInt(l));for(var d in e[l])if(e[l][d][0]){var c=GameConfig.item[e[l][d][0]],g=GameConfig.jewel[c.id],f=ItemUtils.getZdlByProp(c.staitcAttrs),m={id:e[l][d][0],item:c,curType:o?o.part:0,lvl:1,roleIdx:this.roleIdx,part:this.curPart,have:u,power:f};!u||o&&o.part==g.part?s.push(m):p.push(m)}}s=s.sort(this.sortFunc),s=s.concat(p),this.setListData(this.itemList,s)},e.prototype.sortFunc=function(t,e){return t.power>e.power?-1:1},e}(BaseEuiWindow);__reflect(JewelReplaceTips.prototype,"JewelReplaceTips");var EnterBuyTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.limit=0,e.skinName="WorldBossCountBuySkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.num_0.gap=this.num_1.gap=30,this.cost.lab.textColor=4069120},e.prototype.open=function(e){t.prototype.open.call(this),this.addTouchEvent(this.btn_0,this.buyFunc),this.addTouchEvent(this.btn_1,this.closeView),this.cost.setData(GlobalVar.GOLD,e.firData.price),this.hand&&this.hand.dispose(),this.hand=Handler.create(e.firData.thisc,e.firData.func,e.firData.arg,!1);var i=GameCache.vip.realValue(),n=GameConfig.vip[i+1]?!1:!0;this.num_0.value=i,this.num_1.value=i+1;var o=e.firData.max[0]-e.firData.max[1],r=o>0?851712:16711680;this.max.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.buyRemian,"<(c"+r+")"+o+"/"+e.firData.max[0]+">")),n?this.currentState="max":(this.currentState="nor",this.max_1.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.buyRemian,"<(c0x0cff00)"+e.firData.max[2]+">")))},e.prototype.buyFunc=function(){this.cost.isExpend?this.hand.run():GlobalFun.gotoCharge(),this.closeView()},e.prototype.close=function(e){t.prototype.close.call(this),this.hand&&(this.hand.dispose(),this.hand=null)},e}(BaseEuiWindow);__reflect(EnterBuyTips.prototype,"EnterBuyTips");var JingjiCache=function(t){function e(){var e=t.call(this)||this;return e.targetDetail=[],e.jingjiList=[],e.targetIdx=0,e.jingjiData={winNum:0,winPoint:0,remain:0,bought:0,recoverTime:0,refreshTime:0,pointRank:0},e}return __extends(e,t),e.prototype.clear=function(){this.jingjiData={},this.targetDetail=[],this.jingjiList=[]},e.prototype.initJingjiData=function(t,e,i,n,o,r,a){var s={winNum:t,winPoint:e,remain:i,bought:n,recoverTime:o,refreshTime:r,pointRank:a};this.jingjiData=s,App.MessageCenter.dispatch(MsgConst.JINGJI_PERSONAL_DATA)},e.prototype.getJingjiBuyMax=function(){var t=this.jingjiData?this.jingjiData.bought:0,e=GameCache.vip.realValue(),i=GameConfig.vip[e],n=GameConfig.vip[e+1]?GameConfig.vip[e+1]:i,o=GameConfig.jingji[1].consumeTimes+i.arena,r=GameConfig.jingji[1].consumeTimes+n.arena;return[o,t,r]},e.prototype.checkEnter=function(){return!this.jingjiData||this.jingjiData.remain>0},e}(BaseCache);__reflect(JingjiCache.prototype,"JingjiCache");var JingjiInfo=function(t){function e(){var e=t.call(this,LayerManager.UI_Main)||this;return e.skinName="JingjiInfoSkin",e.top=100,e.horizontalCenter=1,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.time.gap=15},e.prototype.open=function(e){t.prototype.open.call(this);var i=GameCache.jingji.targetDetail;i&&App.BattleManager.start(i,this.getResult,this),App.TimerManager.isExists(this.countTime,this)||App.TimerManager.addDelay(0,1e3,0,this.countTime,this)},e.prototype.close=function(e){t.prototype.close.call(this),App.TimerManager.remove(this.countTime,this),App.BattleManager.resetState()},e.prototype.countTime=function(){var t=GameCache.copy.copyTime[GameCache.map.fbId],e=t-GameCache.server.serverTime;if(t){this.tg.visible=!0;var i="";if(e>=0)return i=App.DateUtils.getFormatBySecond(e/1e3,DateUtils.TIME_FORMAT_1),i=i.replace(/:/g,"s"),void(this.time.value=i);this.tg.visible=!1,GlobalVar.autoOpenGroup.push([ViewConst.FAIL])}else this.tg.visible=!1,GlobalVar.autoOpenGroup.push([ViewConst.FAIL]);App.TimerManager.remove(this.countTime,this)},e.prototype.getResult=function(t,e){if(!(t>0&&e>0)){if(t>e){var i=GameConfig.jingji[GameCache.jingji.targetIdx];i=i?i:GameConfig.jingji[1],GameCache.award.openAwardTips(i.awardshow,AwardSourceType.JINGJI)}else GlobalVar.autoOpenGroup.push([ViewConst.FAIL]),PassMgr.switchGj(!0);App.TimerManager.remove(this.countTime,this);var n=t>e?1:0;Proxy.other.sendResult(n)}},e}(BaseEuiWindow);__reflect(JingjiInfo.prototype,"JingjiInfo");var JingjiItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.enterBtn,this.enterFunc),this.zdl.gap=16},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.icon&&this.initData()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){var t=this.data,e=GameConfig.jingji[this.itemIndex];e=e?e:GameConfig.jingji[1],this.item_0.data=e.awardshow[0],this.item_1.data=e.awardshow[1],this.item_2.data=e.awardshow[2],this.zdl.value=t.power,this.icon.source=GlobalFun.getRoleIcon(t.icon),this.mName.text=t.roleName+"",this.mLvl.text=t.lvl+""},e.prototype.enterFunc=function(){var t=GameCache.jingji.jingjiData.remain;t?(Proxy.other.sendChallenge(this.itemIndex),GameCache.jingji.targetIdx=this.itemIndex,App.ViewManager.close(ViewConst.JINGJI)):GlobalFun.SysMsg(Language.lang.jingji_t5)},e}(BaseCustComponent);__reflect(JingjiItem.prototype,"JingjiItem");var JingjiPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="JingJiPannelSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=JingjiItem},e.red=function(){return GameCache.jingji.checkEnter()},e.changeMsg=function(){return[MsgConst.JINGJI_PERSONAL_DATA]},e.prototype.open=function(t){this.message(MsgConst.JINGJI_LIST,this.initList),this.message(MsgConst.JINGJI_PERSONAL_DATA,this.initData),this.addTouchEvent(this.reBtn,this.reFreshFunc),this.addTouchEvent(this.bBtn,this.openBuyTips),this.addTouchEvent(this.rankBtn,function(){App.ViewManager.open(ViewConst.JINGJIRANK)
}),Proxy.other.sendListRefresh(0),this.initRoleData(),this.initData()},e.prototype.initRoleData=function(){this.roleName.text=GameCache.hero.mainPro.charName,this.mLvl.text=GameCache.hero.mainPro.pro(PropId.AP_LEVEL)+"";var t=0;this.icon.source=GlobalFun.getRoleIcon(GameCache.hero.mainPro.pro(PropId.AP_JOB));for(var e=0,i=GameCache.hero.list;e<i.length;e++){var n=i[e];t+=n.pro.pro(PropId.AP_BATTLE_POWER)}this.zdl.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.jingji_t1,t))},e.prototype.initData=function(){var t=GameCache.jingji.jingjiData;this.point.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.jingji_t2,t.winPoint)),this.win.text=t.pointRank?StringUtils.substitute(Language.lang.jingji_t3,t.pointRank):Language.lang.jingji_t4;var e=StringUtils.substitute(Language.lang.remain,t.remain+"/10");if(this.count.textFlow=TextFlowUtils.generateTextFlow(e),this.time.text="",t.recoverTime){var i=(t.recoverTime-GameCache.server.serverTime)/1e3;if(i>0){var n=App.DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_1);this.time.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.resetTime,n)),App.TimerManager.isExists(this.timeCount,this)||App.TimerManager.addDelay(0,1e3,0,this.timeCount,this)}}},e.prototype.timeCount=function(){var t=(GameCache.jingji.jingjiData.recoverTime-GameCache.server.serverTime)/1e3;if(t>=0){var e=App.DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_1);this.time.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.resetTime,e))}else this.time.text="",App.TimerManager.remove(this.timeCount,this)},e.prototype.initList=function(){var t=GameCache.jingji.jingjiList;this.setListData(this.itemList,t)},e.prototype.reFreshFunc=function(){Proxy.other.sendListRefresh(1)},e.prototype.openBuyTips=function(){GlobalFun.openEnterBuy("jingji")},e}(BaseSpriteView);__reflect(JingjiPannel.prototype,"JingjiPannel");var JingjiRankItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.rank&&this.initData()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){var t=GameConfig.jingji[this.itemIndex];t=t?t:GameConfig.jingji[1],this.item_0.data=t.awardshow[0],this.item_1.data=t.awardshow[1],this.item_2.data=t.awardshow[2],this.mName.text=this.data.roleName,this.icon.source=GlobalFun.getRoleIcon(this.data.job),this.mLvl.text=this.data.lvl,this.data.rank<=3?(this.rank.visible=!1,this.rIcon.visible=!0,this.rIcon.source="jingji_json.jingji_medal_"+this.data.rank+"_png"):(this.rank.visible=!0,this.rIcon.visible=!1,this.rank.value=this.data.rank);var e=StringUtils.substitute(Language.lang.jingji_t7,this.data.winPoint);this.point.textFlow=TextFlowUtils.generateTextFlow(e)},e}(BaseCustComponent);__reflect(JingjiRankItem.prototype,"JingjiRankItem");var JingjiRankTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="JingjiRankTipsSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=JingjiRankItem,this.bg.setNameImg("rank")},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.JINGJI_RANK,this.initList),this.t0.textFlow=TextFlowUtils.generateTextFlow(Language.lang.jingji_t6),Proxy.other.sendPointRank(10)},e.prototype.initList=function(t){void 0===t&&(t=[]),this.setListData(this.itemList,t)},e}(BaseEuiWindow);__reflect(JingjiRankTips.prototype,"JingjiRankTips");var JingjiWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(){t.prototype.open.call(this)},e.prototype.close=function(){},e}(CommunalPageWin);__reflect(JingjiWin.prototype,"JingjiWin");var LoadingPage=function(t){function e(){var e=t.call(this)||this;return e.imgStr=["bar.png","blank.png"],e.createView(),e}return __extends(e,t),Object.defineProperty(e,"ins",{get:function(){return e.instance=e.instance||new e,e.instance},enumerable:!0,configurable:!0}),e.prototype.createView=function(){this.loadBg=new egret.Bitmap,this.addChild(this.loadBg),this.proBg=new egret.Bitmap,this.addChild(this.proBg),this.pro=new egret.Bitmap,this.addChild(this.pro),this.versionText=new egret.TextField,this.addChild(this.versionText),this.versionText.size=18,this.versionText.textColor=0,this.loadImg()},e.prototype.loadImg=function(){var t=this;RES.getResByUrl("res/images/bg/loginBg.jpg",function(e){t.loadBg.texture=e,t.loadBg.x=App.StageUtils.getWidth()-t.loadBg.width>>1,t.versionText.x=t.loadBg.x}),RES.getResByUrl("res/login/blank.png",function(e){t.proBg.texture=e,t.proBg.x=App.StageUtils.getWidth()-t.proBg.width>>1,t.proBg.y=(App.StageUtils.getHeight()-t.proBg.height>>1)+250},this,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl("res/login/bar.png",function(e){t.pro.texture=e,t.pro.x=App.StageUtils.getWidth()-261>>1,t.pro.y=(App.StageUtils.getHeight()-t.pro.height>>1)+250-1},this,RES.ResourceItem.TYPE_IMAGE)},e.prototype.showProgress=function(t,i){10!=t&&e.instance.changePro(t)},e.prototype.showVersion=function(t){e.instance.changeVersion(t)},e.prototype.changeVersion=function(t){this.versionText&&(this.versionText.text=StringUtils.substitute(Language.lang.version,t))},e.prototype.changePro=function(t){this.tw&&(egret.Tween.removeTweens(this.pro),this.tw=null);var e=t>=100?100:500,i=t>=100?100:t;this.tw=egret.Tween.get(this.pro),this.tw.to({width:i/100*261},e)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.tw&&(egret.Tween.removeTweens(this.pro),this.tw=null)},e}(BaseEuiWindow);__reflect(LoadingPage.prototype,"LoadingPage");var ServerItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.server_id&&(this.sName.textFlow=TextFlowUtils.generateTextFlow(this.data.name),this.stateTag.source="login_json.login_state_"+this.data.server_status+"_png",this.stateIcon.source="login_json.login_state_p_"+this.data.server_status+"_png")},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(ServerItem.prototype,"ServerItem");var ServerMgr=function(){function t(){}return t.insertLoading=function(t){this.IsHtml5||this.IsNative&&(window.showVersion=LoadingPage.ins.showVersion,window.showLoadProgress=LoadingPage.ins.showProgress,t.addChild(LoadingPage.ins))},t.insertServerSele=function(t){if(this.IsHtml5)t.gameApp.start();else{var e=new ServerWin;t.serverWin=e,this.tempServerWin=e,t.addChild(e),e.open([],this.onServerSele,this,t)}},t.onServerSele=function(t,e){this.closeServerWin(),window.showVersion(GlobalVar.version),LocationProperty.srvid=e.server_id,LocationProperty.serverIP=e.server_ip,LocationProperty.serverPort=e.server_port,t.gameApp.start()},t.loadingDispose=function(){this.IsNative&&LoadingPage.ins.dispose()},t.closeServerWin=function(){this.IsNative?this.tempServerWin&&(this.tempServerWin.dispose(),this.tempServerWin=null):this.IsHtml5},Object.defineProperty(t,"IsHtml5",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE||egret.Capabilities.runtimeType==egret.RuntimeType.RUNTIME2},enumerable:!0,configurable:!0}),t}();__reflect(ServerMgr.prototype,"ServerMgr");var ServerWin=function(t){function e(){var e=t.call(this)||this;return e.sendData={},e.serverlist=[{server_id:"1",name:"外网",server_status:"2",server_ip:"152.136.19.57",server_port:"13001",hosts:"http://res.lysj.vspk.com/h5_vt/"}],e.lastServer=[{server_id:"1",name:"外网",server_status:"2",server_ip:"152.136.19.57",server_port:"13001",hosts:"http://res.lysj.vspk.com/h5_vt/"}],e.skinName="ServerWinSkin",e.top=0,e.bottom=0,e.horizontalCenter=1,e.focusToStage(),e.scaleX=e.scaleY=1,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.itemList.itemRenderer=ServerItem,this.addEvent(eui.ItemTapEvent.ITEM_TAP,this.itemList,this.onListTouche),this.addTouchEvent(this.sName,this.changeState),this.addTouchEvent(this.cBtn,this.changeState),this.addTouchEvent(this.tabBtn,this.onTabTouche),this.addTouchEvent(this.enterBtn,this.enterFunc),this.serverData=t[0],this.handler&&this.handler.dispose(),t[1]&&(this.handler=Handler.create(t[2],t[1],[t[3]],!1)),this.t0.text=Language.lang.server_2;for(var i in this.serverlist[0])this.sendData[i]=this.serverlist[0][i]},e.prototype.initTab=function(){this.serverData},e.prototype.onTabTouche=function(){var t=this.tabBtn.selectedIndex;this.initList(t)},e.prototype.initList=function(t){void 0===t&&(t=0),0==t?this.setListData(this.itemList,this.serverlist):this.setListData(this.itemList,this.lastServer)},e.prototype.onListTouche=function(t){for(var e in t.item)this.sendData[e]=t.item[e];this.currentState="nor",this.sName.text=t.item.name},e.prototype.changeState=function(t){var e=t.target.name;this.currentState=e,"sele"==e&&this.onTabTouche()},e.prototype.enterFunc=function(){this.handler&&(this.handler.args.push(this.sendData),this.handler.run())},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.handler&&(this.handler.dispose(),this.handler=null)},e}(BaseEuiWindow);__reflect(ServerWin.prototype,"ServerWin");var DailItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="DailItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.initData()},e.prototype.initData=function(){if(this.data){var t=this.data;this.icon.source=GlobalFun.getItemSourceById(t.id),this.lbNum.text=t.count+""}},Object.defineProperty(e.prototype,"setState",{set:function(t){this.recv.visible=t,this.gNum.visible=!t},enumerable:!0,configurable:!0}),e}(BaseCustComponent);__reflect(DailItem.prototype,"DailItem");var LuckyDail=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.doneTurn=!0,e.rwList=[],e.getTime=0,e.skinName="LuckyDailSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){t.prototype.open.call(this),this.indicator.rotation=0,this.rwList=e.exData1||[],this.upList(),this.addTouchEvent(this.sBtn,this.onClick),this.addTouchEvent(this.closeBtn,this.onClick),this.message(MsgConst.CPOY_TOWER_LUCK,this.turnIndi),this.message(MsgConst.CPOY_TOWER,this.upList)},e.prototype.upList=function(){if(this.rwList.length){for(var t=1;10>=t;t++)this["item_"+t].data=this.rwList[t-1],GameCache.copytower.copyTowerData&&(this["item_"+t].setState=GameCache.copytower.copyTowerData.dailList[t-1]);GameCache.copytower.copyTowerData&&(this.countText.text=StringUtils.substitute(Language.lang.lcn4,GameCache.copytower.copyTowerData.luckLeftTime))}},e.prototype.turnIndi=function(t){var e=this;if(void 0===t&&(t=1),this.doneTurn){var i=Math.floor(3*Math.random())+1;this.doneTurn=!1;var n=egret.Tween.get(this.indicator);n.to({rotation:360*i+36*t},1e3*i,egret.Ease.cubicOut).call(function(){e.doneTurn=!0;e.setRecvState(t+1),Proxy.copytower.getLuckRw()})}},e.prototype.close=function(){this.doneTurn&&Proxy.copytower.getLuckRw(),t.prototype.close.call(this)},e.prototype.setRecvState=function(t){this["item_"+t].setState=!0},e.prototype.onClick=function(t){switch(t.currentTarget){case this.sBtn:GameCache.copytower.copyTowerData&&GameCache.copytower.copyTowerData.luckLeftTime&&Proxy.copytower.getLuck();break;case this.closeBtn:this.closeView()}},e}(BaseEuiWindow);__reflect(LuckyDail.prototype,"LuckyDail");var BuffCustomBtn=function(t){function e(){var e=t.call(this)||this;return e._enabled=!0,e.skinName="CustomBtnSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEvent(egret.TouchEvent.TOUCH_BEGIN,this,function(){e.iconDisplay.scaleX=e.iconDisplay.scaleY=.9}),this.addEvent(egret.TouchEvent.TOUCH_END,this,function(){e.iconDisplay.scaleX=e.iconDisplay.scaleY=1}),this.addTouchEvent(this,this.action)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.initData()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){var t=this.data,e=GameConfig.customBtn[t];e&&(this.iconDisplay.source=RES_DIR_BTN+e.icon+".png")},Object.defineProperty(e.prototype,"enabled",{set:function(t){this._enabled=t},enumerable:!0,configurable:!0}),e.prototype.action=function(){var t=this.data,e=GameConfig.customBtn[t];if(e)switch(e.configure.type){case"win":if("REVIVE"==e.configure.value&&0==GameCache.revive.reveiveList.length)return void GlobalFun.SysMsg(Language.lang.lcn14);App.ViewManager.open(e.configure.value);break;case"item":break;case"buff":}},e}(BaseCustComponent);__reflect(BuffCustomBtn.prototype,"BuffCustomBtn");var FightPowerChangeView=function(t){function e(){var e=t.call(this,LayerManager.UI_Main2)||this;return e.skinName="FightPowerChangeViewSkin",e.horizontalCenter=0,e.bottom=212,e.touchEnabled=e.touchChildren=!1,e.closeDispose=!1,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.fight.handler=Handler.create(this,this.rollComplete,null,!1)},e.prototype.open=function(e){t.prototype.open.call(this,e),this.onShow()},e.prototype.onShow=function(){egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.change),this.change.visible=!1,this.alpha=1,this.cur=GlobalFun.getTotalPower();var t=GameCache.global.oldPower;this.fight.playData(t,this.cur)},e.prototype.rollComplete=function(){var t,e=this.cur-GameCache.global.oldPower;GameCache.global.oldPower=this.cur,e>0?(this.change.updateType("num_json.pro_zlgreen_"),t="+"+e):(this.change.updateType("num_json.pro_zlred_"),t=e),this.change.value=t,this.change.visible=!0,this.change.x=this.fight.x+this.fight.width+4,this.change.y=48,this.change.alpha=0;var i=this.change.y-this.fight.y;egret.Tween.get(this.change).to({y:this.fight.y,alpha:1},300).wait(1e3).to({y:this.fight.y-i,alpha:0},300).call(this.hide,this)},e.prototype.hide=function(){egret.Tween.get(this).to({alpha:0},500).call(this.closeView,this)},e}(BaseEuiWindow);__reflect(FightPowerChangeView.prototype,"FightPowerChangeView");var FightPowerRoll=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.playData=function(t,e){if(t!=e){for(var i=t+"",n=e+"",o=i.length,r=n.length,a=Math.max(o,r);a>o;)i="0"+i,o++;for(;a>r;)n="0"+n,r++;this.oldValue=i,this.newValue=n;for(var s,h=this.numChildren,p=0,l=0;a>p;p++)h>p?s=this.getChildAt(p):(s=ObjectPool.get(egret.Bitmap),this.addChild(s)),s.texture=this.getSingleNumPic(i.charAt(p)),s.x=l,l=s.x+s.width+1;for(;h>a;){var c=this.removeChildAt(p);this.poolBit(c),a++}this.width=s.x+s.width,this.height=s.height,this.startRoll()}},e.prototype.startRoll=function(){this.roollIndex=this.numChildren-1,this.roollStartNum=parseInt(this.oldValue.charAt(this.roollIndex)),this.roollEndNum=parseInt(this.newValue.charAt(this.roollIndex)),this.roollStartNum==this.roollEndNum&&this.roollNext(),App.TimerManager.removeAll(this),App.TimerManager.addFrame(4,this.onRoll,this)},e.prototype.roollNext=function(){return this.roollIndex--,this.roollIndex<0?void this.complete():(this.roollStartNum=parseInt(this.oldValue.charAt(this.roollIndex)),this.roollEndNum=parseInt(this.newValue.charAt(this.roollIndex)),void(this.roollStartNum==this.roollEndNum&&this.roollNext()))},e.prototype.onRoll=function(){this.roollStartNum++,this.roollStartNum>9&&(this.roollStartNum=0);var t=this.getChildAt(this.roollIndex);t&&(t.texture=this.getSingleNumPic(this.roollStartNum+"")),this.roollStartNum==this.roollEndNum&&this.roollNext()},e.prototype.complete=function(){this.handler&&this.handler.run(),App.TimerManager.removeAll(this)},e.prototype.poolBit=function(t){ObjectPool.push(t)},e.prototype.getSingleNumPic=function(t){return"."==t&&(t="dot"),RES.getRes("num_json.pro_zl_"+t+"_png")},e}(BaseEuiComponent);__reflect(FightPowerRoll.prototype,"FightPowerRoll");var InfoViewController=function(){function t(){}return t.openView=function(t){if(1==t||9==t?GameCache.boss.addWorldBossINfo():GameCache.boss.removeWorldBossINfo(),5==t)App.ViewManager.open(ViewConst.COPYMATERIALSINFO);else if(App.ViewManager.isShow(ViewConst.COPYMATERIALSINFO)){App.ViewManager.close(ViewConst.COPYMATERIALSINFO);var e=new ViewProp;e.firIndex=0,App.ViewManager.open(ViewConst.COPY,e)}7==t?App.ViewManager.open(ViewConst.COPYEXPINFO):App.ViewManager.isShow(ViewConst.COPYEXPINFO)&&App.ViewManager.close(ViewConst.COPYEXPINFO),8==t?App.ViewManager.open(ViewConst.JINGJIINFO):App.ViewManager.isShow(ViewConst.JINGJIINFO)&&App.ViewManager.close(ViewConst.JINGJIINFO),11==t?App.ViewManager.open(ViewConst.FASHIONCOPYINFO):App.ViewManager.isShow(ViewConst.FASHIONCOPYINFO)&&App.ViewManager.close(ViewConst.FASHIONCOPYINFO)},t.autoOpen=function(){if(GlobalVar.autoOpenGroup.length)for(var t=GlobalVar.autoOpenGroup.concat(),e=0,i=t;e<i.length;e++){var n=i[e];App.ViewManager.open(n[0],n[1]),GlobalVar.autoOpenGroup.shift()}},t.customBtn=function(t){var e=GameCache.map.mapConfig;if(e.configureBtn)for(var i=0;i<e.configureBtn.length;i++){var n=e.configureBtn[i];if(t.getElementAt(i))t.getElementAt(i).data=n;else{var o=ObjectPool.get(BuffCustomBtn);o.data=n,o.name=n,t.addChild(o)}}},t}();__reflect(InfoViewController.prototype,"InfoViewController");var MainBtnIcon=function(t){function e(){var e=t.call(this)||this;return e.skinName="MainBtnIconSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.initUI=function(){},e.prototype.update=function(t){this.data=t,this.data&&this.data.icon&&(this.iconDisplay.source=this.data.icon,this.data.iconEff?this.showEff():this.hideEff())},e.prototype.showEff=function(){if(!this.mc){var t=App.DisplayUtils.addEffectToObj(this,"actIcon_0_1",-1,40,40);this.mc=t}this.mc.play(-1),this.mc.visible=!0},e.prototype.hideEff=function(){this.mc&&(this.mc.visible=!1,this.mc.stop())},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(MainBtnIcon.prototype,"MainBtnIcon");var MainCreateRoleBtn=function(t){function e(){var e=t.call(this)||this;return e._job=0,e.index=1,e.skinName="MainCreateRoleBtnSkin",e}return __extends(e,t),e.prototype.init=function(){this.addTouchEvent(this,this.onTouch)},Object.defineProperty(e.prototype,"job",{get:function(){return this._job},set:function(t){t?(this.img.source="zjm_json.zjm_createRole"+t+"_png",this.name=""):(this.img.source="zjm_json.zjm_createrole_bg_png",this.name=ViewConst[ViewConst.ADVENTURE]),this._job=t},enumerable:!0,configurable:!0}),e.prototype.onTouch=function(){if(0==this._job)App.ViewManager.open(ViewConst.ADVENTURE);else{var t=new ViewProp;t.exData1=this.index,App.ViewManager.open(ViewConst.ROLE,t)}},e}(BaseCustComponent);__reflect(MainCreateRoleBtn.prototype,"MainCreateRoleBtn");var MainUI=function(t){function e(){var e=t.call(this,LayerManager.UI_Main)||this;return e.tRefreshIcon={},e.stopTag=!1,e.skinName="MainUISkin",e.closeDispose=!1,e}return __extends(e,t),e.prototype.init=function(){this.tRefreshIcon[this.mailBtn.name]=this.mailBtn,this.tRefreshIcon[this.buffIcon.name]=this.buffIcon,this.initEvent(),this.roleBtnList=[],this.updateRoleList()},e.prototype.mainBtnIconAddConditon=function(t){return"FIRSTCHARGE"==t?this.firstChargeIconAct():App.ViewManager.checkWin(t)},e.prototype.firstChargeIconAct=function(){var t=GameCache.firstcharge.firstGetList.concat(GameCache.firstcharge.totalGetList),e=GameCache.firstcharge.firstChargeSt||0;if(e>0&&t.length>0){var i=t.reduce(function(t,e){return t+e});if(i>=12)return!1}return!0},e.prototype.upFirstChargeIcon=function(){var t=this.gBtnLeft.getChildByName("FIRSTCHARGE");t&&(this.firstChargeIconAct()||App.DisplayUtils.removeFromParent(t))},e.prototype.onBtnIconChange=function(){var t=GameConfig.mainIconCtr;for(var e in t)if(t[e].sort){var i=Math.floor(t[e].sort/100),n=this.gBtnLeft;switch(i){case 1:n=this.gBtnLeft;break;case 2:n=this.gBtnRight;break;case 3:n=this.gBtnUp}var o=this.tRefreshIcon[t[e].name],r=this.mainBtnIconAddConditon(t[e].name);if(o)o.includeInLayout=r,o.visible=r;else{var a=new MainBtnIcon;a.touchChildren=!1,a.name=t[e].name,a.update(t[e]),n.addChild(a),a.includeInLayout=r,a.visible=r,this.tRefreshIcon[a.name]=a}}},e.prototype.initEvent=function(){this.addTouchEvent(this.gBtnUp,this.onGroupTouch),this.addTouchEvent(this.gBtnLeft,this.onGroupTouch),this.addTouchEvent(this.gBtnRight,this.onGroupTouch),this.addTouchEvent(this.mailBtn,this.onGroupTouch),this.addTouchEvent(this.passBtn,this.onGroupTouch),this.addTouchEvent(this.chatGroup,this.onGroupTouch),this.addTouchEvent(this.chatLab,this.openChat),this.addTouchEvent(this.sysLab,this.openSys),this.addTouchEvent(this.buffIcon,this.onBuff),this.chatLab.addEventListener(egret.TextEvent.LINK,this.onLink,this),this.addEvent(egret.TextEvent.LINK,this.sysLab,this.onLink),this.focusToStage(),this.message(MsgConst.ENTER_SCENE,this.switchPassinfo),this.message(MsgConst.ENTER_SCENE,this.btnGroupVisible),this.message(MsgConst.NEW_HERO,this.updateRoleList),this.message(MsgConst.FIRST_CHARGE,this.upFirstChargeIcon),this.message(MsgConst.CHAT_INFO,this.initChat),this.message(MsgConst.SYS_INFO_MESSAGE,this.initSysInfo),this.message(MsgConst.PROPERTY+PropId.AP_LEVEL,this.onBtnIconChange),this.message(MsgConst.SERVER_TIME_CHANGE,this.onBtnIconChange),this.message(MsgConst.QUEST_REFRESH_MAIN,this.onBtnIconChange)},e.prototype.onGroupTouch=function(t){var e=t?t.target.name:"";(e||""!=e)&&App.ViewManager.open(ViewConst[e])},e.prototype.onBuff=function(){App.ViewManager.toggle(ViewConst.BUFF)},e.prototype.removeAllEvent=function(){},e.prototype.dispose=function(){t.prototype.removeAllEvent.call(this),t.prototype.dispose.call(this),this.chatLab.removeEventListener(egret.TextEvent.LINK,this.onLink,this)},e.prototype.updateRoleList=function(){for(var t=GameCache.hero.list,e=this.roleBtnList,i=this.buffGroup,n=0,o=1;o<t.length;o++){var r=t[o].pro.job,a=e[n];a&&a.job==r?n++:(a||(a=new MainCreateRoleBtn,i.addChildAt(a,n),e.push(a)),a.job=r,n++)}if(t.length<GlobalVar.ROLE_MAX){var a=e[n];a||(a=new MainCreateRoleBtn,i.addChildAt(a,n),e.push(a)),a.job=0,""==a.name||this.tRefreshIcon[a.name]||(this.tRefreshIcon[a.name]=a)}},e.prototype.guajiProgress=function(){if(GameCache.pass.killNum>=GameCache.pass.total){if(this.gjPro.visible=!1,!this.passEff){var t=App.DisplayUtils.addEffectToObj(this.passBtn,"guanqia_0_1",-1,68,62);this.passEff=t}this.passEff.play(-1),this.passEff.visible=!0,GameConfig.clientGlobal.barrierGuide>=GameCache.pass.level&&(this.passGuide||(this.passGuide=new NoviceGuideStep(!0),this.passGuide.start(GameConfig.noviceGuide[GameConfig.clientGlobal.barrierBOSSGuideID])))}else this.gjPro.visible=!0,this.gjPro.text=GameCache.pass.killNum+"/"+GameCache.pass.total,this.passEff&&(this.passEff.visible=!1,this.passEff.stop()),this.passGuide&&(this.passGuide.dispose(),this.passGuide=null)},e.prototype.switchPassinfo=function(){if(GameCache.map.mapId==GlobalVar.GUAJI_SCENE)this.passInfo||(this.passInfo=new PassInfo,this.passInfo.skinName="PassInfoSkin",this.infoGroup.addChild(this.passInfo)),this.passInfo.visible=!0,this.passInfo.lvlChange(),this.passInfo.top=0,this.passInfo.right=0,this.passBtn.visible=!0;else{if(this.passBtn.visible=!1,!this.passInfo)return;this.passInfo.visible=!1}},e.prototype.btnGroupVisible=function(){var t=GameCache.map.mapConfig;if(t&&t.LRbtnSHow)for(var e=0,i=t.LRbtnSHow;e<i.length;e++){var n=i[e];this[n[0]].visible=1==n[1]}},e.prototype.initChat=function(){App.FrameHandler.add(GameCache.chat.getPrevireChat,GameCache.chat,!0,this.chatLab)},e.prototype.initSysInfo=function(){App.FrameHandler.add(GameCache.chat.getSysMessage,GameCache.chat,!0,this.sysLab)},e.prototype.onLink=function(t){var e=t.text;TextFlowUtils.hrefType(e),App.ViewManager.isShow(ViewConst.CHAT)?App.ViewManager.close(ViewConst.CHAT):this.stopTag=!0},e.prototype.openChat=function(){if(this.stopTag)return void(this.stopTag=!1);var t=new ViewProp;t.exData2=1,App.ViewManager.open(ViewConst.CHAT,t)},e.prototype.openSys=function(){if(this.stopTag)return void(this.stopTag=!1);var t=new ViewProp;t.exData2=0,App.ViewManager.open(ViewConst.CHAT,t)},e}(BaseEuiWindow);__reflect(MainUI.prototype,"MainUI");var MainUICover=function(t){function e(){var e=t.call(this,LayerManager.UI_Main2)||this;return e.tRefreshIcon={},e.skinName="MainUICoverSkin",e.closeDispose=!1,e}return __extends(e,t),e.prototype.init=function(){this.tRefreshIcon={},this.tRefreshIcon[this.btn2.name]=this.btn2,this.tRefreshIcon[this.btn3.name]=this.btn3,this.tRefreshIcon[this.btn4.name]=this.btn4,this.tRefreshIcon[this.btn5.name]=this.btn5,this.redView=new RedPointView(this),this.addChild(this.redView)},e.prototype.open=function(t){void 0===t&&(t=null),this.addTouchEvent(this.main2,this.onClickGroBtn),this.addTouchEvent(this.btnVip,this.onClickVip),this.message(MsgConst.LOGIN_INIT,this.onLoginInit),this.message(MsgConst.ENTER_SCENE,this.switchGjIcon),this.message(MsgConst.PROPERTY+PropId.AP_EXP,this.onExp),this.message(MsgConst.PROPERTY+PropId.AP_MAX_EXP,this.onExp),this.message(MsgConst.PROPERTY+PropId.AP_HP,this.onHp),this.message(MsgConst.PROPERTY+PropId.AP_MAX_HP,this.onHp),this.message(MsgConst.PROPERTY+PropId.AP_LEVEL,this.onLevel),this.message(MsgConst.PROPERTY+PropId.AP_VIP_TEMPROARY,this.onVip),this.message(MsgConst.PROPERTY+PropId.AP_VIP_GRADE,this.onVip),this.message(MsgConst.PROPERTY+PropId.AP_COIN,this.onCoin),this.message(MsgConst.PROPERTY+PropId.AP_YUANBAO,this.onGold),this.message(MsgConst.PROPERTY+PropId.AP_BATTLE_POWER,this.onShowFight),this.focusToStage()},e.prototype.onLoginInit=function(){var t=GameCache.hero.mainPro;this.lbName.text=t.charName,this.onRoleInfo()},e.prototype.showRole=function(){GameCache.hero.mainPro.pro(PropId.AP_JOB)&&(this.imgRole.source="zjm_json.zjm_touxiang_"+GameCache.hero.mainPro.pro(PropId.AP_JOB)+"_png")},e.prototype.onRoleInfo=function(){this.onLevel(),this.onShowFight(),this.onGold(),this.onCoin(),this.onExp(),this.onHp(),this.onVip(),this.showRole()},e.prototype.onExp=function(t){if(void 0===t&&(t=!0),t)return void App.FrameHandler.add(this.onExp,this,!0,!1);var e=GameCache.hero.mainPro;if(e){this.progressBar2.maximum=e.pro(PropId.AP_MAX_EXP),this.progressBar2.value=e.pro(PropId.AP_EXP);var i=e.pro(PropId.AP_EXP)/e.pro(PropId.AP_MAX_EXP);i>1&&(i=1),App.DisplayUtils.addEffectToObj(this.progressBar2.parent,"exp_0_1",1,this.progressBar2.x+i*this.progressBar2.width,this.progressBar2.y+6)}},e.prototype.onVip=function(){this.btnVip.icon="zjm_json.zjm_vip_"+GameCache.vip.realValue()+"_png"},e.prototype.onHp=function(t){if(void 0===t&&(t=!0),t)return void App.FrameHandler.add(this.onHp,this,!0,!1);for(var e=GameCache.hero.list,i=0,n=0,o=0,r=e;o<r.length;o++){var a=r[o];i+=a.pro.pro(PropId.AP_HP),n+=a.pro.pro(PropId.AP_MAX_HP)}this.progressBar1.maximum=n,this.progressBar1.value=i},e.prototype.onLevel=function(t){if(void 0===t&&(t=!0),t)return void App.FrameHandler.add(this.onLevel,this,!0,!1);var e=GameCache.hero.mainPro;if(e){var i=StringUtils.substitute(Language.lang.mainLvl,e.pro(PropId.AP_LEVEL),"c0xFFF1E6","c0xFFF1E6");this.lbLevel.textFlow=TextFlowUtils.generateTextFlow(i)}},e.prototype.onGold=function(t){if(void 0===t&&(t=!0),t)return void App.FrameHandler.add(this.onGold,this,!0,!1);var e=GameCache.hero.mainPro;e&&(this.lbGold.text=e.pro(PropId.AP_YUANBAO)+"")},e.prototype.onCoin=function(t){if(void 0===t&&(t=!0),t)return void App.FrameHandler.add(this.onCoin,this,!0,!1);var e=GameCache.hero.mainPro;e&&(this.lbCoin.text=e.pro(PropId.AP_COIN)+"")},e.prototype.onShowFight=function(t){if(void 0===t&&(t=!0),t)return void App.FrameHandler.add(this.onShowFight,this,!0,!1);var e=GlobalFun.getTotalPower();if(e&&(this.fightNum.value=e+""),GameCache.global.oldPower){if(GameCache.global.oldPower==e)return;App.ViewManager.isShow(ViewConst.FIGHT_CHANGE)?this.onChangeFight():App.TimerManager.isExists(this.onChangeFight,this)||App.TimerManager.addDelay(500,1,1,this.onChangeFight,this)}else GameCache.global.oldPower=e},e.prototype.onChangeFight=function(){App.ViewManager.open(ViewConst.FIGHT_CHANGE)},e.prototype.onClickGroBtn=function(t){var e=t.target;e instanceof eui.Button&&("GUAJI"!=e.name?App.ViewManager.toggle(ViewConst[e.name]):this.switchGj())},e.prototype.onClickVip=function(){App.ViewManager.open(ViewConst.VIP)},e.prototype.switchGjIcon=function(){GameCache.map.mapId==GlobalVar.GUAJI_SCENE?this.btn1.icon="zjm_json.zjm_zc_png":this.btn1.icon="zjm_json.zjm_gj_png"},e.prototype.switchGj=function(){PassMgr.switchGj()},e.prototype.getBagBtn=function(){return this.btn5},e}(BaseEuiWindow);__reflect(MainUICover.prototype,"MainUICover");var NoviceCache=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.playGuide=function(t){this.guidId=t,this._guideView||(this._guideView=new NoviceGuideStep(!1)),this._guideView.start(GameConfig.noviceGuide[t])},Object.defineProperty(e.prototype,"guideView",{get:function(){return this._guideView},enumerable:!0,configurable:!0}),e}(BaseCache);__reflect(NoviceCache.prototype,"NoviceCache");var NoviceGuideArrow=function(t){function e(){var e=t.call(this)||this;return e.skinName="NoviceGuideArrowSkin",e}return __extends(e,t),e.prototype.setData=function(t,e){this.text.text=t,this.currentState=1==e?"r":"l",1==e?(this.currentState="r",this.x=-241):(this.currentState="l",this.x=40),this.y=-90},e}(BaseCustComponent);__reflect(NoviceGuideArrow.prototype,"NoviceGuideArrow");var NoviceGuideStep=function(t){function e(e){void 0===e&&(e=!0);var i=t.call(this)||this;return i._dispose=!1,i._dispose=e,i.pos=new egret.Point,i.arrow=new NoviceGuideArrow,i.addChild(i.arrow),i.eff=App.DisplayUtils.addEffectToObj(i,"guide_0_1",-1,0,0),i.touchEnabled=i.touchChildren=!1,i}return __extends(e,t),e.prototype.start=function(t){this.isComplete=!1,this.guidObj=t,this.curStep=0,this.curGuide=null,this.curTaget=null,App.TimerManager.isExists(this.onRefresh,this)||App.TimerManager.add(200,this.onRefresh,this),this.eff.play(-1),this.next()},e.prototype.hide=function(t){this.eff.stop(),App.DisplayUtils.removeFromParent(this),t&&App.TimerManager.removeAll(this)},e.prototype.complete=function(){this.guidObj=null,this.curStep=null,this.curGuide=null,this.clearTarget(),this._dispose?this.dispose():this.hide()},e.prototype.next=function(){this.guidObj&&(this.curStep++,this.guidObj[this.curStep]?(this.curGuide=this.guidObj[this.curStep],this.parseView()):this.complete())},e.prototype.back=function(){if(this.guidObj){if(this.curStep<=1)return void this.hide(!1);this.curStep--,this.guidObj[this.curStep]?(this.curGuide=this.guidObj[this.curStep],this.parseView()):this.complete()}},e.prototype.onRefresh=function(){this.curGuide&&this.parseView()},e.prototype.parseView=function(){var t=!1,e=this.curGuide;if(e){if("win"==e.command[0]&&(t=App.ViewManager.isShow(parseInt(ViewConst[e.command[1]]))),t)return void this.next();if(e.targetView){var i=App.ViewManager.isShow(parseInt(ViewConst[e.targetView[0]]));if(!i)return this.isComplete?void this.next():void this.back();for(var n=App.ViewManager.getView(parseInt(ViewConst[e.targetView[0]])),o=1;2>=o;o++)if(e.targetView[o]>-1){var r=this.tarBtnCheck(n,e.targetView[o]);if(!r)return r=n.tabBtn.getElementAt(e.targetView[o]),void(r&&this.arrowTo(r,!1,e.targetViewText[o-1]));n=r}this.parseTarget(n,e.targetEle)}}},e.prototype.parseTarget=function(t,e){for(var i=e.split("."),n=(i.length,!0),o=t,r=0;r<i.length;r++){if(0==i[r].indexOf("[")){var a=parseInt(i[r].replace(/[^0-9]/g,""));if(o.numChildren<a+1){o=null;break}o=o instanceof eui.DataGroup?o.getElementAt(a):o.getChildAt(a)}else if(-1!=i[r].indexOf("%")){var s=i[r].split("%");
o=o[s[0]][s[1]]}else o=o[i[r]];if(!o)break;o.visible||(n=!1)}o&&n?this.arrowTo(o,!0,null):(this.clearTarget(),App.DisplayUtils.removeFromParent(this))},e.prototype.tarBtnCheck=function(t,e){if(-1==e)return t;var i=t.viewDic[e];return i&&i.stage&&i.visible?i:null},e.prototype.arrowTo=function(t,e,i){this.clearTarget(),this.curTaget=t,e&&this.addTarget(),this.showTarget(i)},e.prototype.addTarget=function(){this.curTaget.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTargetTouch,this,!0)},e.prototype.clearTarget=function(){this.curTaget&&(this.curTaget.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTargetTouch,this,!0),this.curTaget=null)},e.prototype.onTargetTouch=function(){this.handlerCommand("click")},e.prototype.handlerCommand=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.curGuide&&this.curGuide.command[0]==t&&(this.curGuide.isComplete&&(this.isComplete=!0),this.next())},e.prototype.showTarget=function(t){var e=this.curTaget.parent;this.curGuide.layer?(e=LayerManager[this.curGuide.layer],this.curTaget.parent.localToGlobal(this.curTaget.x,this.curTaget.y,this.pos),e.globalToLocal(this.pos.x,this.pos.y,this.pos)):(this.pos.x=this.curTaget.x,this.pos.y=this.curTaget.y),e.addChild(this),this.x=this.pos.x,this.y=this.pos.y,this.curGuide.offset?(this.x=this.pos.x+this.curGuide.offset[0],this.y=this.pos.y+this.curGuide.offset[1]):(this.x=this.pos.x+(this.curTaget.width>>1),this.y=this.pos.y+(this.curTaget.height>>1)),this.arrow.setData(t?t:this.curGuide.text,this.curGuide.dir)},e}(BaseCustComponent);__reflect(NoviceGuideStep.prototype,"NoviceGuideStep");var NoviceWelcomeView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){t.prototype.open.call(this),this.addTouchEvent(this,this.onTouch)},e.prototype.onTouch=function(){this.closeView()},e.prototype.close=function(){t.prototype.close.call(this),GameCache.quest.autoQuest()},e}(BaseEuiWindow);__reflect(NoviceWelcomeView.prototype,"NoviceWelcomeView");var OffLineAward=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="OffLineAwardSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){t.prototype.open.call(this),this.addTouchEvent(this.vipBtn,this.vipFunc);for(var i=0;3>i;i++)this["t"+i].text=Language.lang.offLineText[i];var n=e.firData,o=GameCache.vip.realValue(),r=GameConfig.vip[o+1];this.currentState=r?"nor":"max",this.g0.text=GlobalFun.numCut(n.coin),this.e0.text=GlobalFun.numCut(n.exp),this.i1.text=this.i0.text=GlobalFun.numCut(n.eq),r&&(this.t4.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.offLineText[4],o+1)),this.g1.text=GlobalFun.numCut(n.coin*(1+r.goldadd/1e4)),this.e1.text=GlobalFun.numCut(n.exp*(1+r.expadd/1e4))),this.full.visible=n.full,n.full&&(this.full.text=n.melt?StringUtils.substitute(Language.lang.offLineBag[1],n.melt):Language.lang.offLineBag[0]);var a=GameCache.server.serverTime,s=Math.ceil((a-n.offLineTime)/1e3),h=App.DateUtils.getFormatBySecond(s,DateUtils.TIME_FORMAT_5);this.time.text=h},e.prototype.vipFunc=function(){App.ViewManager.open(ViewConst.VIP),this.closeView()},e}(BaseEuiWindow);__reflect(OffLineAward.prototype,"OffLineAward");var KFHDWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(){t.prototype.open.call(this)},e}(CommunalPageWin);__reflect(KFHDWin.prototype,"KFHDWin");var XSLBWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.lTime=0,e.day=0,e.skinName="XSLBWinSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.cost_0.numColor_0=this.cost_0.lab.textColor=16777215,this.cost_1.numColor_0=this.cost_1.lab.textColor=16777215},e.prototype.open=function(e){t.prototype.open.call(this),this.addTouchEvent(this.tabBtn,this.onTouche),this.addTouchEvent(this.buyBtn,this.buyFunc),this.message(MsgConst.XSYH_BUY_SUCCESS,this.onTouche),this.message(MsgConst.XSYH_BUY_SUCCESS,this.initCount),this.message(MsgConst.XSYH_INFO,this.onTouche),LayerManager.UI_Tips.setRectAlpha(.7),App.DisplayUtils.addClickEff(this.tabBtn),this.tabBtn.selectedIndex=0,this.initCount(),this.initData(),this.onTouche()},e.prototype.close=function(e){t.prototype.close.call(this),LayerManager.UI_Tips.resetAlpha(),this.confData=null,App.TimerManager.isExists(this.countDown,this)&&(App.TimerManager.remove(this.countDown,this),this.lTime=0)},e.prototype.dispose=function(){this.itemList.dispose(),t.prototype.dispose.call(this)},e.prototype.initCount=function(){var t=GameCache.server.serverTime;this.lTime=App.DateUtils.DayEndTimeSe(t),App.TimerManager.isExists(this.countDown,this)||App.TimerManager.addDelay(0,1e3,0,this.countDown,this)},e.prototype.countDown=function(){if(this.lTime<0)App.TimerManager.remove(this.countDown,this),this.lTime=0;else{this.lTime--;var t=App.DateUtils.getFormatBySecond(this.lTime,DateUtils.TIME_FORMAT_1);this.buyTime.text=StringUtils.substitute(Language.lang.restTime,t)}},e.prototype.initData=function(){var t=GameCache.activity.serverOpen,e=GameConfig.xslb,i=Object.keys(e).length;this.day=t>0&&i>t?t:Object.keys(e).length,this.confData=e[this.day]},e.prototype.onTouche=function(){var t=this.tabBtn.selectedIndex+1,e=this.confData[t];this.setAward(e),this.cost_0.setData(e.price.id,e.price.count),this.cost_1.setData(e.price.id,e.originalprice);var i=GameCache.activity.xslbData[this.day];i=i?i:{},this.buyBtn.visible=i[this.tabBtn.selectedIndex+1]?!1:!0,this.soldOut.visible=!this.buyBtn.visible},e.prototype.setAward=function(t){t&&t.showItem?(this.itemList||(this.itemList=ObjectPool.get(ItemList)),this.itemList.setData(t.showItem,this.iG)):this.itemList.dispose()},e.prototype.buyFunc=function(){this.cost_0.checkEnough()?Proxy.script.sendXSLBBuy(this.tabBtn.selectedIndex+1):this.closeView()},e}(BaseEuiWindow);__reflect(XSLBWin.prototype,"XSLBWin");var XSYHItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.buyBtn,this.onBuyFunc)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.id&&(this.l0.text=this.l1.text=Language.lang.xsyh_0,this.initdata())},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initdata=function(){this.icon0.data=this.data.item,this.lbNum1.text=this.data.originalprice,this.lbNum0.text=this.data.price[1],this.limit.text=StringUtils.substitute(Language.lang.xsyh_1,this.data.vip),this.imgSale.source=10==this.data.discount?"xsyh_json.xsyh_tag_png":"shop_json.shop_sale_"+this.data.discount+"_png",this.iName.text=this.icon0._itemData.name,this.initState()},e.prototype.initState=function(){if(this.data.state){var t=GameCache.vip.realValue();this.data.vip>t?(this.limit.visible=!0,this.bImg.visible=!0,this.buyBtn.visible=!1,this.soldOut.visible=!1):(this.limit.visible=!1,this.bImg.visible=!1,this.buyBtn.visible=!0,this.soldOut.visible=!1)}else this.limit.visible=!1,this.bImg.visible=!1,this.buyBtn.visible=!1,this.soldOut.visible=!0},e.prototype.onBuyFunc=function(){var t=0;if(this.data.state)return this.data.price[0]==GlobalVar.GOLD&&(t=GameCache.hero.mainPro.pro(PropId.AP_YUANBAO)),t<this.data.price[1]?void GlobalFun.gotoCharge():void Proxy.script.sendXSYHBuy(this.data.id)},e}(BaseCustComponent);__reflect(XSYHItem.prototype,"XSYHItem");var XSYHPage=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.lTime=0,i.skinName="XSYHPageSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=XSYHItem},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.XSYH_BUY_SUCCESS,this.initList),this.message(MsgConst.XSYH_BUY_SUCCESS,this.initCount),this.message(MsgConst.XSYH_INFO,this.initList),this.initCount()},e.prototype.close=function(e){t.prototype.close.call(this),App.TimerManager.isExists(this.countDown,this)&&(App.TimerManager.remove(this.countDown,this),this.lTime=0)},e.prototype.initCount=function(){var t=GameCache.server.serverTime;this.lTime=App.DateUtils.DayEndTimeSe(t),this.initList(),App.TimerManager.isExists(this.countDown,this)||App.TimerManager.addDelay(0,1e3,0,this.countDown,this)},e.prototype.initList=function(){var t=Object.keys(GameConfig.xsyh).length,e=GameCache.activity.serverOpen>t?t:GameCache.activity.serverOpen,i=GameCache.activity.xsyhData;e=e?e:1;var n=GameConfig.xsyh[e],o=[];for(var r in n){var a={state:i&&i[e]&&i[e][n[r].id]>=1?!1:!0,id:n[r].id,item:n[r].item,price:[n[r].price.id,n[r].price.count],originalprice:n[r].originalprice,vip:n[r].vipLimit,discount:n[r].discount};o.push(a)}this.setListData(this.itemList,o)},e.prototype.countDown=function(){if(this.lTime<0)App.TimerManager.remove(this.countDown,this),this.lTime=0;else{this.lTime--;var t=App.DateUtils.getFormatBySecond(this.lTime,DateUtils.TIME_FORMAT_1);t=t.replace(/:/g,"s"),this.num.value=t}},e}(BaseSpriteView);__reflect(XSYHPage.prototype,"XSYHPage");var XSYHPannel=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(){t.prototype.open.call(this)},e}(CommunalPagePannel);__reflect(XSYHPannel.prototype,"XSYHPannel");var XSYHWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="CommunalPageWin4Skin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this);for(var e=[XSYHPannel],i=[],n=1;n<=e.length;n++){var o={};o.icon="bag_json.bag_index_"+n+"_png",o.icon2="bag_json.bag_index_"+n+"_a_png",i.push(o)}this.setViewData(i,e)},e.prototype.open=function(){t.prototype.open.call(this)},e}(CommunalPageWin);__reflect(XSYHWin.prototype,"XSYHWin");var ChuangguanWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){},e}(CommunalPageWin);__reflect(ChuangguanWin.prototype,"ChuangguanWin");var ChuangguanPannel=function(t){function e(){var e=t.call(this)||this;return e.level=1,e.skinName="ChuangguanPannelSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.num.type="num_num_"},e.prototype.open=function(e){t.prototype.open.call(this),this.addTouchEvent(this.enterBtn,this.enterFunc),this.addTouchEvent(this.rankWin,this.openRank),this.message(MsgConst.PROPERTY+PropId.AP_CHKPOINT_AWARD_LV,this.initData),this.message(MsgConst.PROPERTY+PropId.AP_CHKPOINT_LV,this.initData),this.message(MsgConst.PASS_RANK_INFO,this.initRank),this.level=GameCache.pass.level?GameCache.pass.level:1,this.initData(),Proxy.copy.sendPassRank(1)},e.prototype.close=function(e){t.prototype.close.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.itemList.dispose(),this.itemEff&&this.itemEff.dispose(),this.itemEff=null},e.prototype.initData=function(){this.num.value=this.level;var t=PassMgr.getPassBossData(),e=PassMgr.getPassBossCfg();if(t){var i=GameConfig.monster[t];i&&this.mModel.showMonster(i.modelid),this.bossBg.source=RES_DIR_BG+"passBg"+e.backpic+".jpg"}this.initAw(),this.initProgress()},e.prototype.initAw=function(){var t=PassMgr.getPassAward(!0);this.itemList||(this.itemList=ObjectPool.get(ItemList)),this.itemList.setData(t,this.awGroup)},e.prototype.initProgress=function(){var t=0,e=GameConfig.passSpAw,i=GameCache.hero.mainPro.pro(PropId.AP_CHKPOINT_AWARD_LV),n=e[i]&&e[i].barrier?e[i].barrier:0;for(var o in e)if(n<e[o].barrier){t=e[o].barrier,this.item.data=e[o].showAwards[0];break}this.progress.maximum=t,this.progress.value=this.level-1<=0?0:this.level-1,this.initSpAw()},e.prototype.initSpAw=function(){var t=GameConfig.passSpAw,e=Object.getOwnPropertyNames(t).length,i=GameCache.hero.mainPro.pro(PropId.AP_CHKPOINT_AWARD_LV),n=t[i]&&t[i].barrier?t[i].barrier:0;this.passDone.visible=!1,this.spG.visible=!0;for(var o in t){var r=t[o];if(this.progress.value>=r.barrier&&n<r.barrier)return this.progress.visible=!1,this.itemEff||(this.itemEff=MovieClip.create(),this.item.addChild(this.itemEff),this.itemEff.x=40,this.itemEff.y=40),this.itemEff.loadFile(RES_DIR_EFF+"petselect_0_1",-1),this.revLb.visible=!0,void this.item.setHandler(this,this.recvFunc)}this.progress.visible=!0,this.revLb.visible=!1,this.itemEff&&this.itemEff.dispose(),this.itemEff=null,this.item.disposeHandler(),t[""+e].barrier<=n&&(this.spG.visible=!1,this.passDone.visible=!0)},e.prototype.initRank=function(t){this.fName.text=t&&t[0]?t[0].roleName:""},e.prototype.enterFunc=function(){var t=PassMgr.isComplete();return 0>=t&&GameCache.map.mapId==GlobalVar.GUAJI_SCENE?(Proxy.copy.sendPassEnter(),void App.ViewManager.close(ViewConst.CHUANGGUAN)):void GlobalFun.SysMsg("还需击杀"+t+"只怪")},e.prototype.recvFunc=function(){Proxy.copy.sendGetAward(GlobalVar.GUAJI_SCENE,1)},e.prototype.openRank=function(){GameCache.copy.openPassRank(0,[]),Proxy.copy.sendPassRank()},e}(BaseEuiWindow);__reflect(ChuangguanPannel.prototype,"ChuangguanPannel");var PassCache=function(t){function e(){var e=t.call(this)||this;return e.isOpen=!1,e.level=0,e.killNum=0,e.total=0,e.monsterNum=0,e.posIndex=0,e.recog=0,e.effs=[],e}return __extends(e,t),e.prototype.clear=function(){this.isOpen=!1,this.level=0,this.monConfig=null,this.killNum=0,this.total=0,this.lastMonsterTime=0},e.prototype.updateLv=function(t){this.level=t>0?t:1,this.monConfig=this.getMonsterConfig(this.level),this.killNum=0},e.prototype.getMapFile=function(){return this.monConfig.mapFile},e.prototype.getMonsterConfig=function(t){if(!t)return null;var e=t,i=this.getMonsterConfig2(e);if(i.circle){var n=i.circle,o=i.id,r=(e-n)%(o-n)+n;i=this.getMonsterConfig2(r)}return i},e.prototype.getMonsterConfig2=function(t){var e=GameConfig.passMonster;for(t;t>=0;t--)if(e[t])return e[t]},e.prototype.open=function(){this.isOpen||(this.isOpen=!0,App.MessageCenter.addListener(MsgConst.BATTLE_KILL,this.onMonsterKill,this),App.TimerManager.add(1e3,this.onTimer,this),this.monsterNum=0,this.posIndex=0,this.total=PassMgr.guajiTotal(),this.createMonster(),PassMgr.guajiProgress())},e.prototype.close=function(){this.isOpen&&(this.isOpen=!1,this.killNum=this.total=0,App.MessageCenter.removeAll(this),App.TimerManager.remove(this.onTimer,this))},e.prototype.onTimer=function(){this.monsterNum<=3&&this.createMonster()},e.prototype.onMonsterKill=function(){this.monsterNum--;var t=egret.getTimer();this.killNum++,PassMgr.guajiProgress(),(0==this.lastMonsterTime||t-this.lastMonsterTime>=2e3)&&(this.lastMonsterTime=t),GameCache.quest.questId>=0&&GameConfig.clientGlobal.passQuestID.indexOf(GameCache.quest.questId)>-1&&Proxy.quest.sendQuestProgress(GameCache.quest.questId,1)},e.prototype.createMonster=function(){var t=this.monConfig,e=t.monster;e=e[MathUtils.limitInteger(0,e.length)];for(var i=t.hp,n=t.count;n>0;){n--;var o=this.randomPos(),r=new PropertySet,a=e.name;r.recog=App.ThingManager.createRecog(),r.setRoleName(a),r.kind=ThingKind.Monster,r.fightAi=!0,r.skillList=GlobalVar.MONSTER_DEFAULTSKILL;var s=o[0]+(Math.random()>.5?1:-1)*MathUtils.limitInteger(0,o[2]),h=o[1];r.pro(PropId.AP_HP,i),r.pro(PropId.AP_MAX_HP,i),r.pro(PropId.AP_X,s),r.pro(PropId.AP_Y,h),r.pro(PropId.AP_MOVE_SPEED,600),r.pro(PropId.AP_ATTACK_SPEED,2e3),r.pro(PropId.AP_BODY_ID,e.modelid),r.pro(PropId.AP_ACTOR_ID,0),App.ThingManager.createThingToList(r),this.monsterNum++}},e.prototype.randomPos=function(){var t=this.monConfig,e=t.pos,i=e.length,n=Math.floor(Math.random()*i);return n==this.posIndex&&(n=this.posIndex-1<0?i-1:this.posIndex-1),this.posIndex=n,e[n]},e.prototype.playBossEffect=function(){for(var t=this.effs,e=0;5>e;e++){var i=t[e];i||(i=new eui.Image,i.source=RES_DIR_BG+"passEff.png",i.anchorOffsetX=345,i.anchorOffsetY=150,t[e]=i),i.alpha=0,i.scaleX=1.6,i.scaleY=1.6,LayerManager.UI_Message.addChild(i),i.x=App.StageUtils.getWidth()>>1,i.y=260,egret.Tween.removeTweens(this),egret.Tween.get(i).wait(60*e).to({alpha:1,scaleX:.8,scaleY:.8},400,egret.Ease.bounceIn).call(this.removeBossEff,this,[i,e])}},e.prototype.removeBossEff=function(t,e){e==this.effs.length-1?egret.Tween.get(t).wait(800).to({scaleX:.5,scaleY:.5,alpha:0},200,egret.Ease.cubicInOut).call(this.removeBossEff,this,[t,0]):App.DisplayUtils.removeFromParent(t)},e}(BaseCache);__reflect(PassCache.prototype,"PassCache");var PassMgr=function(){function t(){}return t.switchGj=function(t){void 0===t&&(t=!1);var e=GameCache.map.mapConfig;switch(e.type){case SceneType.WORLD_BOSS:case SceneType.VIP_BOSS:GameCache.boss.openExitTips(t);break;case SceneType.GUA_JI:Proxy.copy.sendQuit(GlobalVar.GUAJI_SCENE);break;case SceneType.NORMAL_FIELD:Proxy.copy.sendEnterFB(GlobalVar.GUAJI_SCENE);break;case SceneType.PERSONAL_BOSS:case SceneType.MATERIAL_COPY:case SceneType.FASHION:case SceneType.TOWER:case SceneType.EXP_COPY:case SceneType.ARENA:GameCache.copy.openExitTips(t);break;case SceneType.PURRGATORY_BOSS:GameCache.pgtBoss.openExitTips(t)}},t.guajiTotal=function(){var t=GameConfig.passBOSS,e=GameCache.pass.level;e=e>0?e:1;for(var i in t)if(t[i].start<=e&&t[i].end>=e)return t[i].needMon;return 9999},t.guajiProgress=function(){var t=App.ViewManager.getView(ViewConst.MAIN_UI);t.guajiProgress()},t.isComplete=function(){return GameCache.pass.total-GameCache.pass.killNum},t.getPassAward=function(t){void 0===t&&(t=!1);var e=GameCache.pass.level,i=GameConfig.passAw,n=Object.getOwnPropertyNames(GameConfig.passAw).length+"";for(var o in i)i[o].start<=e&&i[o].end>=e&&(n=o);var r=GameConfig.passAw[n],a=t?r.awardshow:r.award;return a},t.getPassBossCfg=function(){var t=GameCache.pass.level,e=GameConfig.passBOSS;e[Object.getOwnPropertyNames(e).length];for(var i in e)if(e[i].start<=t&&e[i].end>=t)return e[i];return null},t.getPassBossData=function(){var t,e=GameConfig.passBOSS;return(t=this.getPassBossCfg())?t.bossid:e[Object.getOwnPropertyNames(e).length]},t}();__reflect(PassMgr.prototype,"PassMgr");var PassInfo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.lvlChange=function(){var t=GameCache.pass.level,e=GameConfig.passAw,i=Object.getOwnPropertyNames(e).length,n=0,o=GameCache.vip.realValue(),r=GameConfig.vip[o],a=r?r.expadd/1e4:0;for(var s in e)e[s].end>=t&&e[s].start<=t&&(n=(1+e[s].expup*(e[s].end-e[s].start))*e[s].exp);if(0==n){var h=e[i];n=n=(1+h.expup*(h.end-h.start))*h.exp}n*=1+a,this.aTxt.text=Math.floor(n)+"/min"},e}(BaseCustComponent);__reflect(PassInfo.prototype,"PassInfo");var ActivateRect=function(t){function e(){var e=t.call(this)||this;return e.skinName="ActivateRectSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.btn,this.onClick)},e.prototype.onClick=function(){this.petData&&Proxy.pet.actPet(this.petData.id)},e.prototype.setData=function(t){t&&t.name&&t.activationNeed&&t.activationNeed[0]&&(this.icon.data=t.activationNeed[0].id,this.lbNe.textFlow=TextFlowUtils.generateTextFlow(ItemUtils.getItemNamewithColorById(t.activationNeed[0].id)),this.lbHave.text=t.activationNeed[0].count+"/"+GameCache.bag.itemCount(t.activationNeed[0].id),this.petData=t)},e}(BaseCustComponent);__reflect(ActivateRect.prototype,"ActivateRect");var ChangeName=function(t){function e(){var e=t.call(this)||this;return e.skinName="ChangeNameSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setData=function(t){t&&t.name&&(this.lbNe.text=t.name,this.num.value=1)},e}(BaseCustComponent);__reflect(ChangeName.prototype,"ChangeName");var PetEvoView=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.nSelect=0,i.initPetId=0,i.petStar=-1,i.skinName="PetInfoViewSkin",i}return __extends(e,t),e.prototype.init=function(){this.list.itemRenderer=PetInfoItem,this.cfg=GameConfig.pet,this.currentState="evo",this.expend.lab.textColor=4069120,this.gStar.visible=!1},e.prototype.open=function(t){void 0===t&&(t=null),this.addTouchEvent(this.btn,this.onClick),this.addItemClick(this.list,this.itemClick),this.message(MsgConst.PET_INFO,this.upCn),this.message(MsgConst.PET_INFO,this.upList),this.message(MsgConst.BAG_ITEM_NUM,this.upList),this.upList(),this.upCn()},e.prototype.upList=function(){var t=[];for(var e in this.cfg)this.cfg[e].id&&(this.cfg[e].select=this.nSelect,this.cfg[e].sort=GameCache.pet.judeSort(this.cfg[e]),t.push(this.cfg[e]));t.sort(this.sortPet),this.selectData=t[this.nSelect],this.setListData(this.list,t)},e.prototype.sortPet=function(t,e){return t.sort-e.sort},e.prototype.upCn=function(){if(this.selectData){var t=GameCache.pet.petArray[this.selectData.id];if(t){this.lbName.text=StringUtils.substitute(Language.lang.wbName,t.wLevel,this.selectData.name);var e=this.selectData.advancedFactor[t.wStep]/1e4,i=this.selectData.advancedFactor[t.wStep+1]/1e4,n=GlobalFun.ObjPlusRide(this.selectData.basicatt,e),o=GlobalFun.ObjPlusRide(this.selectData.basicatt,i);if(e){var r=GlobalFun.ObjPlusOrMinus(n,this.selectData.gradeatt,t.wLevel*e);if(this.zdl.value=ItemUtils.getZdlByProp(r),i){var a=GlobalFun.ObjPlusOrMinus(o,this.selectData.gradeatt,t.wLevel*i);this.propList.setData(r,a,0,16762368,16777215,16777215,[],"PropItem2Skin")}else this.propList.setData(r,[],0,16762368,16777215,16777215,[],"PropItem2Skin")}for(var s=0;4>s;s++)this["skill"+s].visible=this.selectData.skillnum[s],this["skill"+s].setData(this.selectData.skillnum[s],t.wStep);this.expend.setData(this.selectData.advanceditem,this.selectData.advancedcount[t.wStep]);var h=0;GameConfig.pet[0]&&GameConfig.pet[0].typeToStar&&(h=GameConfig.pet[0].typeToStar[this.selectData.petType-1]?GameConfig.pet[0].typeToStar[this.selectData.petType-1]:0);for(var p=[],s=0;h>s;s++){var l={icon:""};t.wStep>s?l.icon="public_json.public_star_on_png":l.icon="public_json.public_star_off_png",p.push(l)}this.setListData(this.listStar,p);var c=GameCache.pet.getModelId(t.wStep,this.selectData.id);-1!=this.petStar&&this.petStar!=t.wStep&&App.DisplayUtils.addEffectToObj(this,"petjinhua_0_1",1,255,260),this.petStar=t.wStep,t&&c&&this.mModel.showMonster(c)}}},e.prototype.itemClick=function(t){t.itemIndex!=this.nSelect&&(GameCache.pet.petArray[t.item.id]?(this.nSelect=t.itemIndex,this.petStar=-1,this.upList(),this.upCn()):GlobalFun.SysMsg(Language.lang.lcn15))},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn:this.expend.checkEnough()&&Proxy.pet.upStar(this.selectData.id)}},e}(BaseSpriteView);__reflect(PetEvoView.prototype,"PetEvoView");var PetInfoItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="PetInfoItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data.id){var e=this.data,i=RES_DIR_PET+this.data.icon+".png";this.imgBg.source="pet_json.pet_icon_bg"+this.data.petType+"_png";var n=GameCache.pet.petArray[this.data.id];this.itemIndex==this.data.select?this.mc?(this.mc.play(-1),this.mc.visible=!0):this.mc=App.DisplayUtils.addEffectToObj(this,"petselect_0_1",-1,40,40):this.mc&&(this.mc.visible=!1,this.mc.stop());var o=null;n?1==n.state&&(o="pet_json.pet_img_xiedai_png"):(GameCache.bag.getBagEnoughByCondtion(e.activationNeed)&&(o="pet_json.pet_img_kejihuo_png"),i=RES_DIR_PET+this.data.icon+"_ud.png"),this.have.source=o,this.icon.source=i}},e}(BaseCustComponent);__reflect(PetInfoItem.prototype,"PetInfoItem");var PetInfoView=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.nSelect=0,i.nSelectId=0,i.nShowExp=-1,i.oldPetLv=0,i.realvalue=0,i.lastTime=0,i.cacheGroup=[],i.skinName="PetInfoViewSkin",i}return __extends(e,t),e.prototype.init=function(){this.list.itemRenderer=PetInfoItem,this.cfg=GameConfig.pet,this.currentState="act",this.expend.lab.textColor=4069120},e.prototype.open=function(t){void 0===t&&(t=null),this.nShowExp=-1,this.oldPetLv=0,this.progressBar.slideDuration=0,this.addTouchEvent(this.btn,this.onClick),this.addTouchEvent(this.btnAll,this.onClick),this.addTouchEvent(this.btnAttr,this.onClick),this.addTouchEvent(this.btnState,this.onClick),this.addItemClick(this.list,this.itemClick),this.message(MsgConst.PET_INFO,this.upList),this.message(MsgConst.BAG_ITEM_NUM,this.upList),this.message(MsgConst.PET_INFO,this.upCn),this.message(MsgConst.PET_ACTIVATE,this.petActivate),this.upList(),this.upCn()},e.prototype.jugeTimeSpace=function(t){var e=egret.getTimer()-this.lastTime;this.lastTime=egret.getTimer(),100>e?(this.cacheGroup.push(t),App.TimerManager.isExists(this.delayFunc,this)||App.TimerManager.addDelay(200,100,0,this.delayFunc,this)):this.progressBar.value=t},e.prototype.delayFunc=function(){this.cacheGroup.length?this.progressBar.value=this.cacheGroup.shift():(App.TimerManager.remove(this.delayFunc,this),this.progressBar.value=this.realvalue)},e.prototype.upList=function(t){void 0===t&&(t=!1);var e=[];for(var i in this.cfg)this.cfg[i].id&&(this.cfg[i].sort=GameCache.pet.judeSort(this.cfg[i]),e.push(this.cfg[i]));e.sort(this.sortPet);for(var i in e){var n=e[i];n.id==this.nSelectId&&(this.nSelect=parseInt(i))}for(var i in e)e[i].select=this.nSelect;if(this.selectData=e[this.nSelect],this.setListData(this.list,e),this.selectData){var o=GameCache.pet.petArray[this.selectData.id];o?this.currentState="up":this.currentState="act"}},e.prototype.petActivate=function(){this.nSelect=0,this.upList(),this.upCn()},e.prototype.sortPet=function(t,e){return t.sort-e.sort},e.prototype.upCn=function(){if(this.selectData){var t=0;if("act"==this.currentState)this.lbName.text=this.selectData.name,this.propList.setData(this.selectData.basicatt,[],0,16762368,16777215,16777215,[],"PropItem2Skin"),this.selectData.activationNeed&&this.selectData.activationNeed[0]&&this.expend.setData(this.selectData.activationNeed[0].id,this.selectData.activationNeed[0].count);else{var e=GameCache.pet.petArray[this.selectData.id];if(e){this.lbName.text=StringUtils.substitute(Language.lang.wbName,e.wLevel,this.selectData.name);var i=this.selectData.advancedFactor[e.wStep]/1e4,n=GlobalFun.ObjPlusRide(this.selectData.basicatt,i),o=GlobalFun.ObjPlusOrMinus(n,this.selectData.gradeatt,e.wLevel*i),r=GlobalFun.ObjPlusOrMinus(n,this.selectData.gradeatt,(e.wLevel+1)*i);if(this.propList.setData(o,r,0,16762368,16777215,16777215,[],"PropItem2Skin"),this.zdl.value=ItemUtils.getZdlByProp(o),GameConfig.pet[0]){var a=GameConfig.pet[0].levelupItem,s=this.upNextItem(e);this.expend.setData(a,s)}t=e.wStep}this.btnState.icon=1==e.state?"pet_json.pet_btn_xx_png":"pet_json.pet_btn_cz_png";var h=GameConfig.petconfig[e.wLevel]?GameConfig.petconfig[e.wLevel].exp:100,p=this.oldPetLv!=e.wLevel?!0:!1;-1==this.nShowExp||this.nShowExp==e.nExp&&!p?this.showPar(!0):(egret.Tween.removeTweens(this.progressBar),this.showPar(!1)),this.progressBar.maximum=h,this.oldPetLv=e.wLevel,this.nShowExp=e.nExp,e.wStep&&(this.lbStar.text=e.wStep+"")}var l=GameCache.pet.getModelId(t,this.selectData.id);l&&this.mModel.showMonster(l),this.gStar.visible=t>0?!0:!1}},e.prototype.showPar=function(t){void 0===t&&(t=!1);var e=GameCache.pet.petArray[this.selectData.id],i=GameConfig.petconfig[e.wLevel]?GameConfig.petconfig[e.wLevel].exp:100;if(t)egret.Tween.removeTweens(this.progressBar),this.progressBar.value=e.nExp;else{var n=0==e.nExp?i:e.nExp;this.progressBar.value<n?(this.progressBar.value=this.progressBar.value+1,egret.Tween.get(this.progressBar).wait(100/n).call(this.showPar,this)):(egret.Tween.removeTweens(this.progressBar),this.progressBar.value=e.nExp)}},e.prototype.upNextItem=function(t){var e=1,i=GameConfig.pet[0].levelupItem,n=GameConfig.petconfig[t.wLevel]?GameConfig.petconfig[t.wLevel].exp:0,o=n-t.nExp,r=GameConfig.pet[0].giveExp||1,a=Math.ceil(o/r);return e=a<GameCache.bag.itemCount(i)?a:GameCache.bag.itemCount(i)||1},e.prototype.itemClick=function(t){t.itemIndex!=this.nSelect&&(this.nSelectId=t.item.id,this.nSelect=t.itemIndex,this.nShowExp=-1,this.oldPetLv=0,this.upList(),this.upCn())},e.prototype.onClick=function(t){var e=GameCache.pet.petArray[this.selectData.id];switch(t.currentTarget){case this.btn:if(e){var i=GameConfig.pet[0].levelupItem,n=this.upNextItem(e);this.expend.checkEnough()&&Proxy.pet.upLevel(this.selectData.id,n,i)}else this.expend.checkEnough()&&Proxy.pet.actPet(this.selectData.id);break;case this.btnAll:App.ViewManager.open(ViewConst.PETSHOWALL);break;case this.btnAttr:0==Object.keys(GameCache.pet.petArray).length?GlobalFun.SysMsg(Language.lang.lcn15):App.ViewManager.open(ViewConst.PETTIPS);break;case this.btnState:e&&Proxy.pet.changeState(this.selectData.id,0==e.state?1:0)}},e}(BaseSpriteView);__reflect(PetInfoView.prototype,"PetInfoView");var PetPannel=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this,e)},e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.onTabEvent=function(e){var i=e.target,n=!1;1==i.selectedIndex&&0==Object.keys(GameCache.pet.petArray).length&&(e.preventDefault(),GlobalFun.SysMsg(Language.lang.lcn15),n=!0),n||t.prototype.onTabEvent.call(this,e)},e}(CommunalPagePannel);__reflect(PetPannel.prototype,"PetPannel");var PetShowAllWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="PetShowAllWinSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.list.itemRenderer=PetShowInfoItem,this.setWinTitle("petAll")},e.prototype.open=function(e){t.prototype.open.call(this),this.upList()},e.prototype.upList=function(){var t=[];for(var e in GameConfig.pet)GameConfig.pet[e].id&&t.push(GameConfig.pet[e]);this.setListData(this.list,t)},e}(BaseEuiWindow);__reflect(PetShowAllWin.prototype,"PetShowAllWin");var PetShowInfoItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="PetShowInfoItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this,this.onClick)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data.id){this.imgBg.source="pet_json.pet_icon_bg"+this.data.petType+"_png";var e=this.data;if(this.lbNe.text=e.name,GameConfig.pet[0]&&GameConfig.pet[0].typeToStar){var i=GameConfig.pet[0].typeToStar[e.petType-1];i&&(this.lbstar.text="X"+i)}this.imgLock.visible=GameCache.pet.petArray[e.id]?!1:!0,GameCache.pet.petArray[e.id]?this.icon.source=RES_DIR_PET+this.data.icon+".png":this.icon.source=RES_DIR_PET+this.data.icon+"_ud.png"}},e.prototype.onClick=function(){App.ViewManager.close(ViewConst.PETSHOWALL);var t=new ViewProp;t.exData1=this.data,App.ViewManager.open(ViewConst.PETSIGLEINFOVIEW,t)},e}(BaseCustComponent);__reflect(PetShowInfoItem.prototype,"PetShowInfoItem");var PetSigleInfoView=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="PetSigleInfoViewSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){t.prototype.open.call(this),this.addTouchEvent(this.lbGo,this.onclick),this.selectData=e.exData1,this.upCn()},e.prototype.upCn=function(){if(this.selectData){var t=GameCache.pet.petArray[this.selectData.id];if(t)this.currentState="have";else if(this.currentState="act",this.selectData.activationNeed&&this.selectData.activationNeed[0]){this.icon.data=this.selectData.activationNeed[0],this.icon.initData();var e=this.selectData.activationNeed[0].id,i=this.selectData.activationNeed[0].count;this.lbNe&&(this.lbNe.textFlow=TextFlowUtils.generateTextFlow(ItemUtils.getItemNamewithColor(GameConfig.item[e]))),this.lbHave.text=GameCache.bag.itemCount(e)+"/"+i,this.lbHave.textColor=GameCache.bag.itemCount(e)>=i?ColorUtil.C_GREEN:ColorUtil.C_RED
}this.lbName.text=this.selectData.name;var n=GameConfig.pet[0].maxlevel||1,o=GameConfig.pet[0].typeToStar[this.selectData.petType-1],r=this.selectData.advancedFactor[o-1]/1e4;if(r){var a=GlobalFun.ObjPlusRide(this.selectData.basicatt,r),s=GlobalFun.ObjPlusOrMinus(a,this.selectData.gradeatt,n*r);this.propList.setData(s,[],0,16762368,16777215,65292,[],"PropItem4Skin")}for(var h=[],p=0;o>p;p++){var l={icon:""};l.icon="public_json.public_star_on_png",h.push(l)}this.setListData(this.listStar,h);for(var p=0;4>p;p++)if(this.selectData.skillnum[p]){var c=this.selectData.skillnum[p].skill;if(c){var u=GameConfig.petskill[c].icon;u&&(this["skill"+p].source=RES_DIR_PET_SKILL+u+".png")}else this["skill"+p].source=null}else this["skill"+p].source=null;var d=GameCache.pet.getModelId(o,this.selectData.id);d&&this.mModel.showMonster(d)}},e.prototype.onclick=function(){if(this.selectData.activationNeed&&this.selectData.activationNeed[0]){var t=this.selectData.activationNeed[0].id;if(t){var e=GameConfig.item[t]?GameConfig.item[t].jump:null;e?TextFlowUtils.hrefType(e):GlobalFun.SysMsg("请在物品表配置物品的跳转内容")}}},e}(BaseEuiWindow);__reflect(PetSigleInfoView.prototype,"PetSigleInfoView");var PetSkillItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="PetSkillItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.setData=function(t,e){if(t){var i=GameConfig.petskill[t.skill];i&&(e>=t.star?(this.lbNe.text=i.name,this.icon.source=RES_DIR_PET_SKILL+i.icon+".png",this.lbNe.textColor=ColorUtil.C_YELLOW):(this.lbNe.text=StringUtils.substitute(Language.lang.lcn16,t.star),this.lbNe.textColor=12369084,this.icon.source=RES_DIR_PET_SKILL+i.icon+"_s.png"))}},e}(BaseCustComponent);__reflect(PetSkillItem.prototype,"PetSkillItem");var PetTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="PetTipsSkin",e}return __extends(e,t),e.prototype.init=function(){},e.prototype.open=function(e){t.prototype.open.call(this);var i=[];for(var n in GameCache.pet.petArray){var o=GameCache.pet.petArray[n],r=GameConfig.pet[o.wid],a=r.advancedFactor[o.wStep]/1e4;if(r){var s=GlobalFun.ObjPlusRide(r.basicatt,a),h=GlobalFun.ObjPlusOrMinus(s,r.gradeatt,o.wLevel*a);i=GlobalFun.ObjPlusOrMinus(h,i)}}this.zdl.value=ItemUtils.getZdlByProp(i),this.propList.setData(i,[],0,16762368,16777215,65292,[],"PropItem4Skin")},e.prototype.close=function(t){},e}(BaseEuiWindow);__reflect(PetTips.prototype,"PetTips");var PetWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPageWin);__reflect(PetWin.prototype,"PetWin");var PetCache=function(t){function e(){var e=t.call(this)||this;return e.petArray={},e}return __extends(e,t),e.prototype.clear=function(){this.petArray={}},e.prototype.initData=function(t){this.petArray=t,this.updatePet()},e.prototype.upData=function(t){var e=t.readUnsignedShort();if(e&&this.petArray[e])this.petArray[e].update(t);else{var i=new PetItem;i.wid=e,i.update(t),this.petArray[e]=i}this.updatePet()},e.prototype.updatePet=function(){var t=GameCache.hero.mainPlayer;if(t&&t.pro){t.pro.petId=[],t.pro.petName=[],t.removePet();for(var e in this.petArray){var i=this.petArray[e];i.state&&(t.pro.petId.push(i.wid),t.pro.petName.push(i.name),t.updatePet(i.wid,i.name,i.wStep))}}},e.prototype.judeSort=function(t){var e=0,i=GameCache.pet.petArray[t.id];return e=i?t.id+1e3*t.petType:GameCache.bag.getBagEnoughByCondtion(t.activationNeed)?t.id+1e3*t.petType+1e4:t.id+1e3*t.petType+1e5},e.prototype.getModelId=function(t,e){var i=GameConfig.pet[e];if(i)for(var n=i.advancedMod.length,o=n-1;o>=0;o--)if(t>=i.advancedMod[o].star)return i.advancedMod[o].mod;return 0},e}(BaseCache);__reflect(PetCache.prototype,"PetCache");var PetItem=function(){function t(){}return t.prototype.init=function(t){t&&(this.wid=t.readUnsignedShort(),this.state=t.readByte(),this.wStep=t.readUnsignedShort(),this.wLevel=t.readUnsignedShort(),this.nExp=t.readUnsignedInt(),this.btSkillNum=t.readByte(),this.fGrowRate=t.readInt()/100,this.name=t.readCustomBytes())},t.prototype.update=function(t){this.state=t.readByte(),this.wStep=t.readUnsignedShort(),this.wLevel=t.readUnsignedShort(),this.nExp=t.readUnsignedInt(),this.btSkillNum=t.readByte(),this.fGrowRate=t.readInt()/100,this.name=t.readCustomBytes()},t}();__reflect(PetItem.prototype,"PetItem");var PetProxy=function(t){function e(){var e=t.call(this,PacketTypes.PET)||this;return e.regNetMsg(1,e.doInitPet),e.regNetMsg(2,e.doRefreshPet),e}return __extends(e,t),e.prototype.doInitPet=function(t){for(var e=t.readByte(),i={},n=0;e>n;n++){var o=new PetItem;o.init(t),i[o.wid]=o}GameCache.pet.initData(i),App.MessageCenter.dispatch(MsgConst.PET_INFO)},e.prototype.doRefreshPet=function(t){var e=Object.keys(GameCache.pet.petArray);GameCache.pet.upData(t),e<Object.keys(GameCache.pet.petArray)?App.MessageCenter.dispatch(MsgConst.PET_ACTIVATE):App.MessageCenter.dispatch(MsgConst.PET_INFO)},e.prototype.actPet=function(t){var e=this.getBytes(2);e.writeUnsignedShort(t),this.sendToServer(e)},e.prototype.changeState=function(t,e){var i=this.getBytes(3);i.writeUnsignedShort(t),i.writeByte(e),this.sendToServer(i)},e.prototype.upStar=function(t){var e=this.getBytes(4);e.writeUnsignedShort(t),this.sendToServer(e)},e.prototype.upLevel=function(t,e,i){var n=this.getBytes(5);n.writeUnsignedShort(t),n.writeUnsignedShort(e),n.writeInt(i),this.sendToServer(n)},e}(BaseProxy);__reflect(PetProxy.prototype,"PetProxy");var PropItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.initData()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){if(this.data&&this.data.type)if(this.prop2){var t=this.getPropstring2(this.data);this.prop.textFlow=t[0],this.prop2.textFlow=t[1],this.prop2.visible=this.arrow.visible=t[1]?!0:!1}else this.prop.textFlow=this.getPropString(this.data)},e.prototype.getPropString=function(t){var e=GameConfig.buffId[t.type],i=t.newValue;if(e){var n="";return n=i?"<(c"+t.color[0]+")"+e.attname+">  <(c"+t.color[1]+")"+t.str[0]+t.oldValue+">     <(c"+t.color[2]+")"+t.str[1]+i+">":"<(c"+t.color[0]+")"+e.attname+">  <(c"+t.color[1]+")"+t.str[0]+t.oldValue+">",TextFlowUtils.generateTextFlow(n)}},e.prototype.getPropstring2=function(t){var e=GameConfig.buffId[t.type],i=t.newValue;if(!e)return[null,null];var n="",o="";n="<(c"+t.color[0]+")"+e.attname+":>  <(c"+t.color[1]+")"+t.oldValue+">",o="<(c"+t.color[2]+")"+i+">";var r=TextFlowUtils.generateTextFlow(n),a=i&&i>t.oldValue?TextFlowUtils.generateTextFlow(o):null;return[r,a]},e}(BaseCustComponent);__reflect(PropItem.prototype,"PropItem");var PropItemMgr=function(){function t(){}return t}();__reflect(PropItemMgr.prototype,"PropItemMgr");var PropPartResonate=function(t){function e(){var e=t.call(this)||this;return e.skinName="PropPartResonateSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0,i=this.pG.$children;e<i.length;e++){var n=i[e];App.DisplayUtils.removeFromParent(n),ObjectPool.push(n)}},e.prototype.setData=function(t,e){this.pG.removeChildren(),this.title.textFlow=TextFlowUtils.generateTextFlow(t);for(var i=0,n=e;i<n.length;i++){var o=n[i],r=ObjectPool.get(eui.Label);r.maxWidth=318,r.size=16,r.textFlow=TextFlowUtils.generateTextFlow(o),this.pG.addChild(r)}},e}(BaseCustComponent);__reflect(PropPartResonate.prototype,"PropPartResonate");var PurgatoryBag=function(t){function e(){var e=t.call(this)||this;return e.skinName="PurgatoryBagSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=PurgatoryBagItem},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.equips=null},e.prototype.open=function(e){t.prototype.open.call(this,e),this.message(MsgConst.BAG_RECYCLE,this.initData),this.addTouchEvent(this.btnDe,this.onBtnDeClick),this.initData()},e.prototype.initData=function(){this.equips=GameCache.bag.getBagByType(BagType.BAG_TYPE_PURGATORY),this.setListData(this.list,this.equips)},e.prototype.onBtnDeClick=function(){Proxy.bag.sendEquipRecycleBagItem(BagType.BAG_TYPE_PURGATORY,this.equips)},e.prototype.close=function(){t.prototype.close.call(this),this.dispose()},e}(BaseEuiWindow);__reflect(PurgatoryBag.prototype,"PurgatoryBag");var PurgatoryBagItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.btnDe,this.onBtnDeClick)},e.prototype.onBtnDeClick=function(){Proxy.bag.sendEquipRecycleBagItem(BagType.BAG_TYPE_PURGATORY,[this.data])},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.initData()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){var t=this.data;if(t){this.item.data=t.stdItem,this.eqName.text=t.stdItem.name;var e=GameConfig.purgatoryResolve[t.stdItem.id],i=e.re_item[0],n=(i.type,i.id),o=i.count,r=GameConfig.item[n];this.icon.source=""+RES_DIR_IMAGES_ITEM+r.icon+".png",this.num.text=StringUtils.substitute(Language.lang.purgatoryDecomeNum,o)}},e}(BaseCustComponent);__reflect(PurgatoryBagItem.prototype,"PurgatoryBagItem");var PurgatoryCache=function(t){function e(){var e=t.call(this)||this;return e.purgatoryData={},e.rsnData={},e}return __extends(e,t),e.prototype.clear=function(){this.purgatoryData={},this.rsnData={}},e.prototype.updatePurgatory=function(t,e){if(e){this.purgatoryData[t]||(this.purgatoryData[t]=[]);for(var i in e)this.purgatoryData[t][i]=e[i];this.updateResonateLv(t)}},e.prototype.getPurgatoryCfg=function(t,e){return GameConfig.purgatory[t][e]},Object.defineProperty(e.prototype,"maxLv",{get:function(){if(!this.cfgMaxLv){this.cfgMaxLv=0;var t=GameConfig.purgatory[0];for(var e in t)Number(e)>this.cfgMaxLv&&(this.cfgMaxLv=Number(e))}return this.cfgMaxLv},enumerable:!0,configurable:!0}),e.prototype.getResonateLvNum=function(t,e){var i=this.rsnData[t],n=0;return i?(i[e]&&(n=i[e]),n):n},e.prototype.updateResonateLv=function(t){var e=this.purgatoryData[t];if(e){var i={};for(var n in e){var o=e[n];if(o)for(var r=1;o>=r;r++)i[r]||(i[r]=0),i[r]++}this.rsnData[t]=i}},e}(BaseCache);__reflect(PurgatoryCache.prototype,"PurgatoryCache");var PurgatoryPanel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.select=0,i.skinName="PurgatoryPanelSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=Handler.create(this,this.doInit,[],!1);this.roleSelect.handler=e,this.lv.gap=21,this.lv.alignV="mid"},e.prototype.doInit=function(){this.initEquips(),this.initProp(),this.initZDL()},e.prototype.initEquips=function(){var t=GameCache.purgatory.purgatoryData[this.roleSelect.roleId];t||(t=[]);for(var e,i,n=GameCache.hero.mainPro.pro(PropId.AP_JOB),o=0;6>o;o++){var r=t[o],a=this["eq"+o];a.select=o==this.select,r?(i=GameCache.purgatory.getPurgatoryCfg(o,r),a.filters=null,a.partSource=null):(i=GameCache.purgatory.getPurgatoryCfg(o,1),a.filters=FilterUtils.DefaultGrayFilters,a.partSource="purgatory_json.purgatory_part"+o+"_png"),e=i.icon[n-1],e||(e=i.icon[0]),a.setIconImg(""+RES_DIR_PURGATORY_ICON+e+".png"),a.select&&(this.imgName.source="purgatory_json."+e+"_png",this.lv.value=r,this.lv.includeInLayout=this.lv.visible=this.imgStep.includeInLayout=this.imgStep.visible=r>0,this.imgEquip.source=""+RES_DIR_PURGATORY_SHOW+e+".png",this.imgEquip.filters=r?null:FilterUtils.DefaultGrayFilters)}},e.prototype.initZDL=function(){var t=GameCache.purgatory.purgatoryData[this.roleSelect.roleId];t||(t=[]),this.eqProps=[];for(var e in t){var i=t[e],n=GameCache.purgatory.getPurgatoryCfg(Number(e),i);n&&(this.eqProps=GlobalFun.ObjPlusOrMinus(this.eqProps,n.attrs))}var o=GlobalFun.ObjPlusOrMinus(this.eqProps,[]),r=GameCache.purgatory.rsnData[this.roleSelect.roleId],a={};for(var i in r){var s=2*Math.floor(r[i]/2);if(s>0){var h=GameConfig.purgatoryResonate[i];for(var p in h){if(s<Number(p))break;(!a[p]||Number(i)>a[p])&&(a[p]=Number(i))}}}for(var e in a){var l=a[e],c=Number(e),n=GameConfig.purgatoryResonate[l][c];o=GlobalFun.ObjPlusOrMinus(o,n.attrs)}this.zdl.value=ItemUtils.getZdlByProp(o)},e.prototype.initProp=function(){var t=GameCache.purgatory.purgatoryData[this.roleSelect.roleId];t||(t=[]);var e=t[this.select];e||(e=0);var i=GameCache.purgatory.getPurgatoryCfg(this.select,e),n=[];i&&(n=i.attrs);var o=[];if(e<GameCache.purgatory.maxLv){var r=GameCache.purgatory.getPurgatoryCfg(this.select,e+1);o=r.attrs}this.propList.setData(n,o,this.roleSelect.job,16762368,16777215,65292,[],"PropItem2Skin")},e.prototype.open=function(t){void 0===t&&(t=null),this.message(MsgConst.EQUIP_PURGATORY,this.doInit),this.addTouchEvent(this.btnUp,this.onBtnUpClick),this.addTouchEvent(this.btnRsn,this.onBtnResonateClick),this.addTouchEvent(this.btnProp,this.onBtnPropClick),this.addTouchEvent(this.gl,this.onItemClick),this.addTouchEvent(this.gr,this.onItemClick),this.addTouchEvent(this.btnBag,this.onBtnBagClick),this.doInit()},e.prototype.onItemClick=function(t){t.target instanceof EquipItem&&(this.select=Number(t.target.name),this.initEquips(),this.initProp())},e.prototype.onBtnUpClick=function(){var t=GameCache.purgatory.maxLv,e=GameCache.purgatory.purgatoryData[this.roleSelect.roleId];e||(e=[]);var i=e[this.select];if(i||(i=0),!(i>=t)){for(var n=i+1,o=t;o>0&&!(i>=o);o--){var r=GameCache.purgatory.getPurgatoryCfg(this.select,o),a=GameCache.bag.itemCount(r.cost1.id),s=GameCache.bag.itemCount(r.cost2.id);a>=r.cost1.count&&s>=r.cost2.count&&o>n&&(n=o)}var h=GameCache.purgatory.getPurgatoryCfg(this.select,i),p=GameCache.purgatory.getPurgatoryCfg(this.select,n),l=new ViewProp,c={};c.roleIdx=this.roleSelect.nSlRole,c.cfgFrom=h,c.cfgTo=p,l.exData1=c,App.ViewManager.open(ViewConst.PURGATORY_UPGRADE,l)}},e.prototype.onBtnResonateClick=function(){var t=new ViewProp;t.winTitle="purgatory_json.purgatory_lab_resonate_png",t.firData=[];for(var e=GameCache.purgatory.maxLv,i=this.roleSelect.roleId,n=1;e>=n;n++){var o=GameCache.purgatory.getResonateLvNum(i,n),r=GameConfig.purgatoryResonate[n],a=ObjectPool.get(PropPartResonate),s=[],h=void 0;for(var p in r){var l=r[p];h||(h=StringUtils.substitute(Language.lang.purgatoryPropTitle,l.suitName,n));var c=o>=l.value?"c0x00ff12":"c0xffffff",u=StringUtils.substitute(Language.lang.purgatoryProp,l.name,this.getPropStr(l.attrs),c);s.push(u)}a.setData(h,s),t.firData.push(a)}App.ViewManager.open(ViewConst.PURGATORY_RESONATE_PROP,t)},e.prototype.getPropStr=function(t){var e="";if(!t)return e;for(var i=0;i<t.length;i++){var n=t[i],o=n.type,r=n.value,a=GameConfig.buffId[o];i>0&&(e+="   "),e+=""+a.attname+r}return e},e.prototype.onBtnPropClick=function(){var t=new ViewProp;t.firData={},t.firData.src="purgatory_json.purgatory_lab_prop_png",t.firData.prop=this.eqProps,App.ViewManager.open(ViewConst.TOTALPROP,t)},e.prototype.onBtnBagClick=function(){App.ViewManager.open(ViewConst.PURGATORY_BAG)},e.prototype.close=function(e){t.prototype.close.call(this,e),this.eqProps=null},e}(BaseSpriteView);__reflect(PurgatoryPanel.prototype,"PurgatoryPanel");var PurgatoryProxy=function(t){function e(){var e=t.call(this,PacketTypes.PURGATORY)||this;return e.regNetMsg(1,e.doUpdateData),e.regNetMsg(2,e.doInitData),e}return __extends(e,t),e.prototype.doInitData=function(t){for(var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=t.readByte(),n={},o=0;i>o;o++){var r=t.readByte(),a=t.readShort();n[r]=a}GameCache.purgatory.updatePurgatory(e,n),App.MessageCenter.dispatch(MsgConst.EQUIP_PURGATORY)},e.prototype.doUpdateData=function(t){var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=t.readByte(),n=t.readShort(),o={};o[i]=n,GameCache.purgatory.updatePurgatory(e,o),App.MessageCenter.dispatch(MsgConst.EQUIP_PURGATORY)},e.prototype.upgradeReq=function(t,e,i,n,o){var r=this.getBytes(1),a=GameCache.hero.getServerIdByIndex(t);r.writeInt(a),r.writeByte(e),r.writeShort(i),r.writeInt(n),r.writeInt(o),this.sendToServer(r)},e}(BaseProxy);__reflect(PurgatoryProxy.prototype,"PurgatoryProxy");var PurgatoryResonateProp=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="PurgatoryResonatePropSkin",e}return __extends(e,t),e.prototype.init=function(){},e.prototype.open=function(e){if(t.prototype.open.call(this),this.pG.removeChildren(),e&&(this.title.source=e.winTitle,e.firData instanceof Array))for(var i=0,n=e.firData;i<n.length;i++){var o=n[i];this.pG.addChild(o)}},e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0,i=this.pG.$children;e<i.length;e++){var n=i[e];App.DisplayUtils.removeFromParent(n),n.dispose(),ObjectPool.push(n)}},e.prototype.close=function(){t.prototype.close.call(this),this.dispose()},e}(BaseEuiWindow);__reflect(PurgatoryResonateProp.prototype,"PurgatoryResonateProp");var PurgatoryUpgrade=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.bagCount1=0,e.bagCount2=0,e.skinName="PurgatoryUpgradeSkin",e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.BAG_ITEM_NUM,this.initData),this.addTouchEvent(this.btnUp,this.onBtnUpgrageClick),this.roleIdx=Number(e.exData1.roleIdx),this.cfgFrom=e.exData1.cfgFrom,this.cfgTo=e.exData1.cfgTo,this.cfgFrom?(this.currentState="s1",this.title.source="purgatory_json.purgatory_lab_upgrade_png"):(this.currentState="s0",this.title.source="purgatory_json.purgatory_lab_active_png"),this.initData()},e.prototype.initData=function(){this.eqName.text=this.cfgTo.name;var t=GameCache.hero.mainPro.pro(PropId.AP_JOB),e=this.cfgTo.icon[t-1];e||(e=this.cfgTo.icon[0]),this.item3.setIconImg(""+RES_DIR_PURGATORY_ICON+e+".png"),this.bagCount1=GameCache.bag.itemCount(this.cfgTo.cost1.id);var i=GameConfig.item[this.cfgTo.cost1.id];this.item0.data=i;var n=this.bagCount1>=this.cfgTo.cost1.count?"c0xffffff":"c0xff0000";this.num0.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.purgatoryItemNum,this.bagCount1,this.cfgTo.cost1.count,n)),this.bagCount2=GameCache.bag.itemCount(this.cfgTo.cost2.id);var o=GameConfig.item[this.cfgTo.cost2.id];this.item2.data=o,n=this.bagCount2>=this.cfgTo.cost2.count?"c0xffffff":"c0xff0000",this.num2.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.purgatoryItemNum,this.bagCount2,this.cfgTo.cost2.count,n)),this.cfgFrom&&(e=this.cfgTo.icon[t-1],e||(e=this.cfgFrom.icon[0]),this.item1.setIconImg(""+RES_DIR_PURGATORY_ICON+e+".png"),this.num1.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.purgatoryItemNum,1,1,"c0xffffff")))},e.prototype.onBtnUpgrageClick=function(){this.bagCount1>=this.cfgTo.cost1.count&&this.bagCount2>=this.cfgTo.cost2.count&&(Proxy.purgatory.upgradeReq(this.roleIdx,this.cfgTo.type,this.cfgTo.level,this.cfgTo.cost1.id,this.cfgTo.cost2.id),App.ViewManager.close(ViewConst.PURGATORY_UPGRADE))},e}(BaseEuiWindow);__reflect(PurgatoryUpgrade.prototype,"PurgatoryUpgrade");var QuestCache=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.clear=function(){this.npcId=null,this.questId=null},e.prototype.update=function(t,e,i){if(this.questId=t,this.progress=i,this.state=e,t>=0){var n=GameConfig.quest[t];this.npcId=n.comp}else this.npcId=0;GameCache.sysopen.initCheckList(),App.MessageCenter.dispatch(MsgConst.QUEST_REFRESH_MAIN),App.FrameHandler.add(this.showMainView,this,!0),App.FrameHandler.add(SysOpenMgr.checkOpen,SysOpenMgr,!0)},e.prototype.showMainView=function(){var t=App.ViewManager.isShow(ViewConst.MAIN_QUEST);this.questId>=0?t||App.ViewManager.open(ViewConst.MAIN_QUEST):t&&App.ViewManager.close(ViewConst.MAIN_QUEST),App.MessageCenter.dispatch(MsgConst.QUEST_REFRESH_MAIN)},e.prototype.autoQuest=function(){if(this.questId>=0){var t=GameConfig.quest[this.questId];if(2==this.state)t.comp>0?App.VisitManager.goToNpc(t.comp):Proxy.quest.sendSumitQuest();else{var e=t.target;e.type==TaskTargetType.enTask_KillMonster?App.VisitManager.goToMonster(e.id,e.scene,e.x,e.y):e.type==TaskTargetType.enTask_Talk?App.VisitManager.goToNpc(e.id):t.mod&&(TextFlowUtils.hrefType(t.mod),t.GuideID&&GameCache.novice.playGuide(t.GuideID))}}},e}(BaseCache);__reflect(QuestCache.prototype,"QuestCache");var QuestProxy=function(t){function e(){var e=t.call(this,PacketTypes.QUEST)||this;return e.regNetMsg(1,e.updateQuest),e}return __extends(e,t),e.prototype.updateQuest=function(t){var e=t.readShort(),i=t.readByte(),n=t.readInt();GameCache.quest.update(e,i,n)},e.prototype.sendSumitQuest=function(){var t=this.getBytes(1);this.sendToServer(t)},e.prototype.sendQuestProgress=function(t,e){var i=this.getBytes(2);i.writeUnsignedInt(t),i.writeUnsignedInt(e),this.sendToServer(i)},e}(BaseProxy);__reflect(QuestProxy.prototype,"QuestProxy");var QuestAwType=function(){function t(){}return t.QA_ITEM=0,t.QA_EXP=2,t.QA_GUILD_CONTRIBUTION=3,t.QA_BIND_MONEY=5,t.QA_MONEY=6,t.QA_GIFT=7,t.QA_TITLE=8,t.QA_ACHIEVE_POnumber=11,t.QA_YB=15,t.QA_Add_Exp=20,t.QA_HONOR=21,t.QA_CIRCLE=22,t.QA_Guild_Coin=27,t.QA_numberimacy=28,t.QA_HeroExp=30,t.QA_MagicPower=34,t.QA_Service_Coin=35,t.QA_Soul=41,t.QA_King=42,t.QA_CardSoul=43,t.QA_CardDes=44,t.QA_Medal=45,t.QA_Official=47,t.QA_HERO_CIRCLE=49,t.QA_MELTING_SCORE=53,t.QA_USER_DEFINED=127,t}();__reflect(QuestAwType.prototype,"QuestAwType");var TaskTargetType;!function(t){t[t.enTask_Talk=0]="enTask_Talk",t[t.enTask_KillMonster=1]="enTask_KillMonster",t[t.enTask_ClientTask=2]="enTask_ClientTask",t[t.enTask_EnterScene=3]="enTask_EnterScene",t[t.enTask_RecycleEquip=4]="enTask_RecycleEquip",t[t.enTask_RuneUpgrade=5]="enTask_RuneUpgrade",t[t.enTask_WingUpgrade=6]="enTask_WingUpgrade",t[t.enTask_DiamondUpgrade=7]="enTask_DiamondUpgrade",t[t.enTask_PetUpgrade=8]="enTask_PetUpgrade",t[t.enTask_TotemUpgrade=9]="enTask_TotemUpgrade",t[t.enTask_SkillUpgrade=10]="enTask_SkillUpgrade",t[t.enTask_Suit=11]="enTask_Suit",t[t.enTask_Strong=12]="enTask_Strong",t[t.enTask_Refine=13]="enTask_Refine",t[t.enTask_Arena=14]="enTask_Arena",t[t.enTask_Fashion=15]="enTask_Fashion",t[t.enTask_NoCntMax=50]="enTask_NoCntMax",t[t.enTask_ChkToLvl=51]="enTask_ChkToLvl",t[t.enTask_StrongToLvl=52]="enTask_StrongToLvl",t[t.enTask_RuneToLvl=53]="enTask_RuneToLvl",t[t.enTask_WingToLvl=54]="enTask_WingToLvl",t[t.enTask_RefineToLvl=55]="enTask_RefineToLvl",t[t.enTask_DiamondToLvl=56]="enTask_DiamondToLvl",t[t.enTask_PetToLvl=57]="enTask_PetToLvl",t[t.enTask_TotemToLvl=58]="enTask_TotemToLvl",t[t.enTask_BadgeToLvl=59]="enTask_BadgeToLvl",t[t.enTask_SkillToLvl=60]="enTask_SkillToLvl",t[t.enTask_PetStageToLvl=61]="enTask_PetStageToLvl",t[t.enTask_TowerToLvl=62]="enTask_TowerToLvl",t[t.enTask_AddValMax=100]="enTask_AddValMax",t[t.enTask_KillBoss=100]="enTask_KillBoss",t[t.enTask_JoinInArean=101]="enTask_JoinInArean",t[t.enTask_FinishFuben=102]="enTask_FinishFuben",t[t.enTask_ActiveTotem=103]="enTask_ActiveTotem",t[t.enTask_WearFashion=104]="enTask_WearFashion",t[t.enTask_AddHero=105]="enTask_AddHero",t[t.enTask_DiamondLevelUp=106]="enTask_DiamondLevelUp",t[t.enTask_PetLevelUp=107]="enTask_PetLevelUp",t[t.enTask_Max=108]="enTask_Max"}(TaskTargetType||(TaskTargetType={}));var QuestTarget=function(){function t(){}return t}();__reflect(QuestTarget.prototype,"QuestTarget");var QuestTypes=function(){function t(){}return t.CLASS_DOING=1,t.CLASS_AVAILABLE=2,t.MAIN=0,t.BRANCH=1,t.CARBON=2,t.DAILY=3,t.GUILD=4,t.CHANLLENGE=5,t.ADVENTURE=6,t.ACTIVITY=7,t.CAMP=8,t.EQUIP=9,t.EXP=10,t.GOLD=11,t.REFRESHQUEST=12,t.CHECKPOINTS=13,t.TREASURE_PIC=14,t.FB_CAILIAO=100,t.FB_EXP=101,t.SHOWAWARDS=1,t}();__reflect(QuestTypes.prototype,"QuestTypes");var QuestAward=function(){function t(){this.sex=-1,this.initAttrs=[],this.importantLevel=0,this.hide=0,this.levelRate=0,this.ringRate=0}return t.prototype.clone=function(){var e=new t;return e.type=this.type,e.id=this.id,e.count=this.count,e.datastr=this.datastr,e.group=this.group,e.strong=this.strong,e.quality=this.quality,e.bind=this.bind,e.sex=this.sex,e.job=this.job,e.importantLevel=this.importantLevel,e.hide=this.hide,e},t.prototype.structureByObject=function(t){for(var e in t)t[e]&&(this[e]=t[e])},t.prototype.getAwardByType=function(t){switch(t){case QuestAwType.QA_EXP:case QuestAwType.QA_MONEY:case QuestAwType.QA_GIFT:case QuestAwType.QA_HONOR:return this.count}return 0},t.prototype.getSpCount=function(t){var e=0;switch(this.type){case QuestAwType.QA_Add_Exp:case QuestAwType.QA_EXP:t>0||(e=this.count);default:e=this.count}return e},t}();__reflect(QuestAward.prototype,"QuestAward");var StdQuest=function(){function t(){this.showTimerBox=!1}return t}();__reflect(StdQuest.prototype,"StdQuest");var UserQuest=function(){function t(t,e,i){if(void 0===t&&(t=-1),void 0===e&&(e=-1),void 0===i&&(i=1),this._star=1,t>-1){if(this.target=[],this.award=[],this.stdQuest=GameConfig.quest[t],!this.stdQuest)throw new Error("找不到任务ID为"+t+"的任务");var n=this.stdQuest;n.randomTarget||(this.target=[n.target],n.loopAwardId=0,this.award=n.awards[0]);var o=this.target.length;n.randomTarget&&(o=1),this.progress=[];for(var r=0;o>r;r++)this.progress[r]=0}}return Object.defineProperty(t.prototype,"isCompleted",{get:function(){if(!this.progress)return!1;for(var t,e=this.progress.length-1;e>-1;e--){if(t=this.target[e],!t)return!1;if(this.progress[e]<t.count)return!1}return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"star",{get:function(){return this._star},set:function(t){this._star=0==t?1:t},enumerable:!0,configurable:!0}),t}();__reflect(UserQuest.prototype,"UserQuest");var NPCTalkWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Main2)||this;return e.skinName="NPCTalkWinSkin",e.horizontalCenter=0,e.verticalCenter=0,e}return __extends(e,t),e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this),this.recog=e.exData1,this.npcId=e.exData2,this.bubbles=ObjectPool.get(ThingBubbles),this.addChild(this.bubbles),this.message(MsgConst.QUEST_REFRESH_MAIN,this.update),this.addTouchEvent(this.submitBtn,this.submit),this.update()},e.prototype.close=function(){t.prototype.close.call(this),this.bubbles.dispose(),this.bubbles=null},e.prototype.dispose=function(){this.itemList.dispose(),t.prototype.dispose.call(this)},e.prototype.update=function(){var t=GameCache.quest.questId;t>=0&&GameCache.quest.npcId!=this.npcId&&(t=-1);var e=GameConfig.npc[this.npcId],i=e.talk[MathUtils.limitInteger(0,e.talk.length)];if(this.submitBtn.visible=t>=0,t>=0){var n=GameConfig.quest[t];this.labTalk.text=n.npcTalk,this.setAward(n)}else this.labTalk.text=i,this.setAward(null);this.npcBody.source=RES_DIR_NPC_BODY+e.modelid+".png",this.npcBody.x=e.offx+126,this.npcBody.y=e.offy+294,this.bubbles.setData(i,0),this.bubbles.y=this.npcBody.y-10,this.bubbles.x=this.npcBody.x+24,this.npcName.source=RES_DIR_NPC_BODY+this.npcId+"n.png"},e.prototype.submit=function(){Proxy.quest.sendSumitQuest(),this.closeView()},e.prototype.setAward=function(t){t&&t.awards?(this.itemList||(this.itemList=ObjectPool.get(ItemList)),this.itemList.setData(t.awards,this.iG)):this.itemList.dispose()},e}(BaseEuiWindow);__reflect(NPCTalkWin.prototype,"NPCTalkWin");var QuestMainView=function(t){function e(){var e=t.call(this,LayerManager.UI_Main)||this;return e.skinName="QuestMainViewSkin",e.left=12,e.bottom=210,e.touchChildren=!1,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this),this.message(MsgConst.QUEST_REFRESH_MAIN,this.onUpdate),this.message(MsgConst.ENTER_SCENE,this.visitToggle),this.addTouchEvent(this,this.onTouch),this.onUpdate()},e.prototype.onTouch=function(){GameCache.quest.autoQuest()},e.prototype.onUpdate=function(){var t=GameCache.quest.questId;if(t>=0){var e=GameConfig.quest[t],i=e.name,n="";if(2==GameCache.quest.state)n="<(c0x36ff00)（完成）>",this.showEff();else{var o=GameCache.quest.progress,r=e.target.count;e.target.type==TaskTargetType.enTask_ChkToLvl&&(o--,r--),n="<(c0xff0000)（"+o+"/"+r+"）>",this.hideEff()}this.labTitle.textFlow=TextFlowUtils.generateTextFlow(i+n),this.labDes.textFlow=TextFlowUtils.generateTextFlow(e.content)}else this.closeView()},e.prototype.showEff=function(){if(!this.mc){var t=App.DisplayUtils.addEffectToObj(this,"newquest_0_1",-1,120,33);this.mc=t}this.mc.play(-1),this.mc.visible=!0},e.prototype.hideEff=function(){this.mc&&(this.mc.visible=!1,this.mc.stop())},e.prototype.visitToggle=function(){this.visible=1==GameCache.map.mapConfig.task?!0:!1},e}(BaseEuiWindow);__reflect(QuestMainView.prototype,"QuestMainView");var RankModeItemB=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.rank&&(this.bg.source=this.itemIndex%2==0?"public_json.public_rect_11_png":"public_json.public_rect_9_png",this.imgRank.visible=this.data.rank<4,this.rankNum.visible=!this.imgRank.visible,this.imgRank.visible?this.imgRank.source="public_json.public_rank_"+this.data.rank+"_png":this.rankNum.text=this.data.rank+"",this.rName.text=this.data.roleName,this.value_0.text=this.data.value,this.zdl.text=this.data.zdl)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(RankModeItemB.prototype,"RankModeItemB");var RankModelItemA=function(t){function e(){var e=t.call(this)||this;return e.skinName="RankModelItemASkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.layer&&(this.lbNe.text=this.data.name,this.lbLv.text=StringUtils.substitute(Language.lang.lcn5,this.data.layer)),this.setRankNum(this.imgRank,this.lbRank,this.itemIndex+1)},e.prototype.setRankNum=function(t,e,i){var n=["rank_json.rank_nb_1_png","rank_json.rank_nb_2_png","rank_json.rank_nb_3_png"];t.visible=4>i,n[i-1]&&(t.source=n[i-1]),e.visible=i>=4,e.text=i+""},e}(BaseCustComponent);__reflect(RankModelItemA.prototype,"RankModelItemA");var RankModelWinA=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="RankModelWinASkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.list.itemRenderer=RankModelItemA,this.setWinTitle("fogTower")},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.CPOY_TOWER_RANK,this.upList)},e.prototype.upList=function(){this.setListData(this.list,GameCache.copytower.rankList),this.setRankNum(this.imgRank,this.lbRank,GameCache.copytower.myRank);var t="";if(GameCache.copytower.copyTowerData){GameCache.copytower.copyTowerData.layer>0?GameCache.copytower.copyTowerData.layer:1;t=StringUtils.substitute(Language.lang.lcn5,GameCache.copytower.copyTowerData.layer)}this.lbLv.text=t},e.prototype.setRankNum=function(t,e,i){if(i>0){var n=["rank_json.rank_nb_1_png","rank_json.rank_nb_2_png","rank_json.rank_nb_3_png"];t.visible=4>i,n[i-1]&&(t.source=n[i-1]),e.visible=i>=4,e.text=i+""}else e.text=Language.lang.lcn6,t.visible=!1},e}(BaseEuiWindow);__reflect(RankModelWinA.prototype,"RankModelWinA");var RankModeWinB=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="RankModelWinBSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.list.itemRenderer=RankModeItemB},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.PASS_RANK_INFO,this.initRank),e&&e.exData1&&(this.setWinTitle(e.exData1.title),this.initData(e.exData1.myRank,e.exData1.myValue,e.exData1.listData))
},e.prototype.close=function(e){t.prototype.close.call(this)},e.prototype.initRank=function(t,e,i){this.initData(e,i,t)},e.prototype.initData=function(t,e,i){0>=t?(this.imgRank.visible=!1,this.lbRank.textFlow=TextFlowUtils.generateTextFlow("<(c"+ColorUtil.C_RED+")"+Language.lang.jingji_t4+">")):(this.imgRank.visible=4>t,this.lbRank.visible=!this.imgRank.visible,this.imgRank.visible&&(this.imgRank.source="public_json.public_rank_"+t+"_png"),this.lbRank.textFlow=TextFlowUtils.generateTextFlow("<(c"+ColorUtil.C_COFFEE+")"+t+">")),this.lbLv.text=e+"",this.setListData(this.list,i)},e}(BaseEuiWindow);__reflect(RankModeWinB.prototype,"RankModeWinB");var RankPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.rankListType=[],i.rankType=1,i.skinName="RankPannelSkin",i}return __extends(e,t),e.prototype.init=function(){this.listItem.itemRenderer=RankViewItem;var t=[];for(var e in GameConfig.rank){var i=GameConfig.rank[e];if(i.open){this.rankListType.push(i.type);var n={icon2:"rank_json.rank_type_0_png",icon:"rank_json.rank_type_0_ud_png"};n.icon="rank_json.rank_type_"+i.type+"_ud_png",n.icon2="rank_json.rank_type_"+i.type+"_png",t.push(n)}}this.tabBtn.dataProvider=new eui.ArrayCollection(t),this.rankNum.gap=15,this.rankValue.gap=15,this.title=new ThingTitle,this.title.scaleX=1.2,this.title.scaleY=1.2,this.gNe.addChild(this.title)},e.prototype.open=function(t){void 0===t&&(t=null),this.askRank(),this.addTouchEvent(this.tabBtn,this.tabTouche),this.message(MsgConst.RANK_INFO,this.upCn)},e.prototype.askRank=function(){Proxy.rank.askRank(this.rankListType[this.tabBtn.selectedIndex])},e.prototype.tabTouche=function(){this.rankType!=this.tabBtn.selectedIndex&&(this.askRank(),this.upCn())},e.prototype.upCn=function(){if(this.rankType=this.rankListType[this.tabBtn.selectedIndex],this.rankSigleData=GameCache.rank.rankData[this.rankType],this.rankSigleData&&(this.setListData(this.listItem,this.rankSigleData.rankList,!0),this.rankNum.value=this.rankSigleData.myRank,this.rankValue.value=this.rankSigleData.myValue,this.imgMore.visible=!this.rankSigleData.myRank,this.rankValue.visible=this.rankSigleData.myRank,this.imgDown.source="rank_json.rank_down_"+this.rankSigleData.type+"_png",this.refreshRoleModel(),this.rankSigleData.rankList&&this.rankSigleData.rankList[0])){var t=this.rankSigleData.rankList[0];this.title.setName(t.name)}},e.prototype.refreshRoleModel=function(){if(this.rankSigleData&&this.rankSigleData.firstRoleList)for(var t=0;3>t;t++)this["roleMdl"+t].visible=this.rankSigleData.firstRoleList[t],this.rankSigleData.firstRoleList[t]&&this["roleMdl"+t].setData(this.rankSigleData.firstRoleList[t])},e}(BaseSpriteView);__reflect(RankPannel.prototype,"RankPannel");var RankViewItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RankViewItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this,this.onClick)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;e.wid&&(this.lbNe.text=e.name,this.rankValue.value=e.rankValue,this.imgVip.source="zjm_json.zjm_vip_"+e.vipLv+"_png",this.setRankNum(this.imgRank,this.rankNum,e.rank,this.rankRe),this.imgDes.source="rank_json.rank_des_"+e.rankType+"_png"),this.bg.source=this.itemIndex%2==1?"public_json.public_rect_9_png":"public_json.public_rect_11_png"},e.prototype.setRankNum=function(t,e,i,n){var o=["public_json.public_rank_1_png","public_json.public_rank_2_png","public_json.public_rank_3_png"];t.visible=4>i,o[i-1]&&(t.source=o[i-1]),e.visible=i>=4,e.value=i,i>=4?n.source=null:n.source="rank_json.rank_rect_"+i+"_png"},e.prototype.onClick=function(t){var e=this.data;e&&Proxy.rank.askRoleInfo(e.wid)},e}(BaseCustComponent);__reflect(RankViewItem.prototype,"RankViewItem");var RankWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPageWin);__reflect(RankWin.prototype,"RankWin");var RankCache=function(t){function e(){var e=t.call(this)||this;return e.rankData={},e.otherRoleData={},e}return __extends(e,t),e.prototype.clear=function(){this.rankData={},this.otherRoleData={}},e.prototype.initData=function(t,e){this.rankData[t]=e},e}(BaseCache);__reflect(RankCache.prototype,"RankCache");var RankItemData=function(){function t(){}return t.prototype.init=function(t){t&&(this.rank=t.readInt(),this.wid=t.readUnsignedInt(),this.name=t.readCustomBytes(),this.job=t.readByte(),this.sex=t.readByte(),this.vipLv=t.readByte(),this.badgeLv=t.readByte(),this.rankValue=t.readUnsignedInt())},t}();__reflect(RankItemData.prototype,"RankItemData");var RankProxy=function(t){function e(){var e=t.call(this,PacketTypes.Default)||this;return e.regNetMsg(65,e.doInit),e.regNetMsg(67,e.doOtherPlayer),e}return __extends(e,t),e.prototype.doInit=function(t){var e={type:0,myRank:0,myValue:0,firstRoleList:[],rankList:[]};e.type=t.readByte(),e.myRank=t.readInt(),e.myValue=t.readUnsignedInt();for(var i=t.readByte(),n=0;i>n;n++){var o=new PropertySet;o.kind=ThingKind.Human;var r=(t.readInt(),t.readByte()),a=t.readUnsignedInt();o.pro(PropId.AP_JOB,r),o.pro(PropId.AP_BODY_ID,a),o.pro(PropId.AP_SEX,t.readByte()),o.pro(PropId.AP_WEAPON,t.readUnsignedInt()),o.pro(PropId.AP_MOUNT,t.readUnsignedInt()),o.pro(PropId.AP_SWING,t.readUnsignedInt()),o.pro(PropId.AP_HAIR,t.readUnsignedInt()),o.pro(PropId.AP_HAT,t.readUnsignedInt()),o.pro(PropId.AP_EYE,t.readUnsignedInt()),o.pro(PropId.AP_GLASSES,t.readUnsignedInt()),o.pro(PropId.AP_PANTS,t.readUnsignedInt()),o.pro(PropId.AP_ASSIST,t.readUnsignedInt()),o.pro(PropId.AP_BACK,t.readUnsignedInt()),e.firstRoleList.push(o)}for(var s=t.readByte(),n=0;s>n;n++){var h=new RankItemData;h.init(t),h.rankType=e.type,e.rankList.push(h)}GameCache.rank.initData(e.type,e),App.MessageCenter.dispatch(MsgConst.RANK_INFO,e.type)},e.prototype.doOtherPlayer=function(t){var e={};e.name=t.readCustomBytes(),e.lv=t.readInt(),e.title=t.readInt(),e.vip=t.readByte(),e.badgeLv=t.readByte(),e.unionNe=t.readCustomBytes(),e.unionJob=t.readByte(),e.roleList=[];for(var i=t.readByte(),n=0;i>n;n++){var o={};o.id=t.readInt(),o.power=t.readInt(),o.job=t.readByte(),o.bodyId=t.readUnsignedInt(),o.sex=t.readByte();var r=new PropertySet;r.kind=ThingKind.Human,r.pro(PropId.AP_JOB,o.job),r.pro(PropId.AP_BODY_ID,o.bodyId),r.pro(PropId.AP_SEX,o.sex),r.pro(PropId.AP_WEAPON,t.readUnsignedInt()),r.pro(PropId.AP_MOUNT,t.readUnsignedInt()),r.pro(PropId.AP_SWING,t.readUnsignedInt()),r.pro(PropId.AP_HAIR,t.readUnsignedInt()),r.pro(PropId.AP_HAT,t.readUnsignedInt()),r.pro(PropId.AP_EYE,t.readUnsignedInt()),r.pro(PropId.AP_GLASSES,t.readUnsignedInt()),r.pro(PropId.AP_PANTS,t.readUnsignedInt()),r.pro(PropId.AP_ASSIST,t.readUnsignedInt()),r.pro(PropId.AP_BACK,t.readUnsignedInt()),o.propSet=r,o.qe=[];for(var a=t.readByte(),s=0;a>s;s++){var h=new UserItem(t);h.sourceType=ItemSourceType.OTHER_ROLEEQUIP,o.qe.push(h)}o.strent=[];for(var p=t.readByte(),l=0;p>l;l++)o.strent.push(t.readUnsignedShort());e.roleList.push(o)}GameCache.rank.otherRoleData=e,App.ViewManager.open(ViewConst.OTHERROLE)},e.prototype.askRank=function(t){var e=this.getBytes(10);e.writeByte(t),this.sendToServer(e)},e.prototype.askRoleInfo=function(t){var e=this.getBytes(11);e.writeUnsignedInt(t),this.sendToServer(e)},e}(BaseProxy);__reflect(RankProxy.prototype,"RankProxy");var RefinePannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.seleIdx=0,i.skinName="RefinePannelSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.initPartName(),this.roleSelect.setHandler(this,this.onCLick),this.num.gap=14,this.num.alignV="mid",this.num.alignH="center"},e.red=function(){return GameCache.strength.checkRefineGrade()},e.prototype.roleRed=function(t){return GameCache.strength.checkRefineGrade(t)},e.changeMsg=function(){return[MsgConst.EQUIP_REFINE,MsgConst.NEW_HERO]},e.prototype.refreshRed=function(){t.prototype.refreshRed.call(this),this.redShow()},e.prototype.open=function(t){this.message(MsgConst.EQUIP_REFINE,this.initData),this.message(MsgConst.EQUIP_REFINE,this.initZDL),this.message(MsgConst.EQUIP_REFINE,this.showEff),this.cost_0.cleanMsg(),this.addTouchEvent(this.sGroup,this.onItemTouch),this.addTouchEvent(this.btn,this.refineFunc),this.addTouchEvent(this.mBtn,this.openMaster),this.onCLick()},e.prototype.onCLick=function(){var t=GameCache.hero.getDataByIndex(this.roleSelect.nSlRole,GameCache.equip.roleEquipList);this.initEquipItem(t),this.autoSele(),this.initZDL()},e.prototype.initPartName=function(){for(var t=0;10>t;t++){var e=this["item_"+t];e.partSource="strength_json.strength_text_part"+t+"_png"}},e.prototype.initEquipItem=function(t){t||(t=[]);for(var e=0;10>e;e++){var i=t[e],n=GameCache.hero.getDataByIndex(this.roleSelect.nSlRole,GameCache.equip.roleRefineList),o=n&&i&&n[i.stdItem.part]?n[i.stdItem.part]:0,r=this["item_"+e];r.color.visible=!1,i?(r.data=i,r.setHandler(this,this.openItemTips,[i])):r.reSet(),r.strengthLvl=[o],r.setIconImg("strength_json.strength_part"+e+"_png")}},e.prototype.autoSele=function(){var t=0,e=0,i=0;this["item_"+this.seleIdx].select=!1;for(var n=0;10>n;n++){var o=this["item_"+n];if(o.data){if(0==e){i=o.strenghLvl,t=n,e++;continue}if(o.strenghLvl<i){i=o.strenghLvl,t=n,e++;continue}}}this.seleIdx=t,this["item_"+t].select=!0,this.seleImg.source="strength_json.strength_part"+this.seleIdx+"_png",this.initData()},e.prototype.onItemTouch=function(t){var e=t?parseInt(t.target.name):this.seleIdx;this["item_"+this.seleIdx].select=!1,this["item_"+e].select=!0,this.seleIdx=e,this.seleImg.source="strength_json.strength_part"+this.seleIdx+"_png",this.initData()},e.prototype.initData=function(){var t=this.roleSelect.roleId,e=GameCache.equip.roleRefineList[t],i=this["item_"+this.seleIdx],n=0;i.data&&e&&(n=e[this.seleIdx],i.strengthLvl=[n]);var o=GameConfig.refine.ReEquip[n],r=GameConfig.refine.ReEquip[n+1],a=o["part"+this.seleIdx],s=r?r["part"+this.seleIdx]:null,h=GameConfig.strengthCost[n+1];this.cost_0.visible=this.cost_1.visible=h?!0:!1,h&&(this.cost_0.setData(h.reconsume[0].id,h.reconsume[0].count),this.cost_1.setData(h.reconsume[1].id,h.reconsume[1].count)),this.propList.setData(a,s,this.roleSelect.job,16762368,16777215,65292,[],"PropItem2Skin")},e.prototype.openItemTips=function(t){},e.prototype.refineFunc=function(){var t=this["item_"+this.seleIdx];if(t.data){if(this.cost_1.checkEnough()&&this.cost_0.checkEnough()){if(t.strenghLvl==GameCache.hero.mainPro.pro(PropId.AP_LEVEL))return void GlobalFun.SysMsg(Language.lang.refineLvlMax);Proxy.equip.sendRefine(this.roleSelect.nSlRole,this.seleIdx)}}else GlobalFun.SysMsg(Language.lang.refineHint)},e.prototype.openMaster=function(){var t=new ViewProp;t.exData1=this.roleSelect.nSlRole,t.exData2=2,App.ViewManager.open(ViewConst.STRENGTHMASTER,t)},e.prototype.initZDL=function(){var t=this.roleSelect.roleId+"",e=GameCache.equip.roleRefineList[t],i=0;if(e){for(var n=0;10>n;n++){var o=e[n];if(0!=o){var r=GameConfig.refine.ReEquip[o];i+=ItemUtils.getZdlByProp(r["part"+n])}}this.zdl.value="+"+i}else this.zdl.value=0;var a=e?GlobalFun.Min(e)[0]:0,s=GameConfig.refine.ReMaster;for(var n in s){if(s[n].level>a){this.mPro.text=a+"/"+s[n].level;break}this.num.value=n}},e.prototype.showEff=function(){this.mc=App.DisplayUtils.addEffectToObj(this,"jinglian_cg_0_1",1,270,380)},e.prototype.redShow=function(){App.ViewManager.showRedPoint(this.btn,GameCache.strength.checkRefineGrade(this.roleSelect.roleId,this.seleIdx));for(var t=0;10>t;t++){var e=this["item_"+t];App.ViewManager.showRedPoint(e,GameCache.strength.checkRefineGrade(this.roleSelect.roleId,t))}},e}(BaseSpriteView);__reflect(RefinePannel.prototype,"RefinePannel");var ReviveCache=function(t){function e(){var e=t.call(this)||this;return e.leftTime=0,e.reveiveList=[],e}return __extends(e,t),e.prototype.clear=function(){this.leftTime=0,this.reveiveList=[]},e}(BaseCache);__reflect(ReviveCache.prototype,"ReviveCache");var ReviveMgr=function(){function t(){}return t.roleRevive=function(t,e){var i=[];for(var n in e)i.push(e[n].job);var o=new ViewProp;o.exData1=i,o.exData2=t,App.ViewManager.open(ViewConst.REVIVE,o)},t}();__reflect(ReviveMgr.prototype,"ReviveMgr");var ReviveTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.time=0,e.skinName="ReviveTipsSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.setWinTitle("revive")},e.prototype.open=function(e){t.prototype.open.call(this),this.addTouchEvent(this.btn_0,this.reviveFunc),this.addTouchEvent(this.btn_1,this.closeView);var i=GameCache.revive.reveiveList;if(this.lbNextTime.text="",i)for(var n=0;3>n;n++){var o=null;if(i[n]){var r=i[n].job;o="public_json.public_icon_role_"+r+"_png"}this["imgRole"+n].source=o,this["imgRoleBg"+n].visible=null==o?!1:!0}i.length&&(this.lbValue.text=GlobalVar.Recount*i.length+""),e&&e.exData1&&App.TimerManager.add(1e3,this.upTime,this),this.time=GameCache.revive.leftTime,this.message(MsgConst.ENTER_SCENE,this.closeView)},e.prototype.upTime=function(){var t="",e=GlobalFun.getDiffMiniDateTime(this.time)/1e3;e>0?(t=App.DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_10),t=StringUtils.substitute(Language.lang.lcn13,t)):this.closeView(),this.lbNextTime.text=t},e.prototype.reviveFunc=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_YUANBAO);return t<GlobalVar.Recount?void GlobalFun.SysMsg("钻石不足"):(Proxy.script.sendRevive(1),void this.closeView())},e.prototype.showViewRed=function(t){},e.red=function(){return GameCache.bag.itemCount(3278)>1},e.changeMsg=function(){return[MsgConst.BAG_ITEM_NUM+3278]},e}(BaseEuiWindow);__reflect(ReviveTips.prototype,"ReviveTips");var RoleInfoItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="RoleInfoItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&(this.roleType.source=this.data.icon,this.imgRoleSl.visible=this.data.index==this.itemIndex)},e}(BaseCustComponent);__reflect(RoleInfoItem.prototype,"RoleInfoItem");var RoleOtherPannelInfo=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.roleData={},i.skinName="RoleOtherPannelInfoSkin",i}return __extends(e,t),e.prototype.init=function(){this.roleSelect.setHeroList(GameCache.rank.otherRoleData.roleList),this.roleSelect.setHandler(this,this.roleClick),this.title=new ThingTitle,this.title.scaleX=1.2,this.title.scaleY=1.2,this.gNe.addChild(this.title)},e.prototype.roleClick=function(t){this.upRolePart()},e.prototype.open=function(t){void 0===t&&(t=null),this.roleData&&(this.roleData=GameCache.rank.otherRoleData,this.upRolePart(),this.title.setName(this.roleData.name),this.title.setBadge(this.roleData.badgeLv))},e.prototype.upRolePart=function(){var t=this.roleData.roleList[this.roleSelect.nSlRole];if(t){this.zdl.value=t.power;var e=t.qe,i=t.strent;for(var n in this.gPart.$children){var o=this.gPart.$children[n];o.touchEnabled=!1;var r=e?e[o.name]:null;r?(o.data=r,i&&i[r.stdItem.part]&&(o.strengthLvl=[i[r.stdItem.part]])):(o.strengthLvl=[0],o.data&&(o.reSet(),o.setColorImg(),o.setIconImg("role_json.role_part_"+o.name+"_png")))}t.propSet&&this.role.setData(t.propSet)}},e}(BaseSpriteView);__reflect(RoleOtherPannelInfo.prototype,"RoleOtherPannelInfo");var RoleOtherPannelInfoWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="RoleOtherPannelInfoWinSkin",e}return __extends(e,t),e.prototype.init=function(){this.bg.setNameImg("otherRole")},e.prototype.open=function(e){t.prototype.open.call(this),this.cn.open()},e}(BaseEuiWindow);__reflect(RoleOtherPannelInfoWin.prototype,"RoleOtherPannelInfoWin");var RoleOtherSelect=function(t){function e(){var e=t.call(this)||this;return e.nSlRole=0,e.heroList=[],e.skinName="RoleSelectSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setHeroList=function(t){this.heroList=t,this.freshList()},e.prototype.setHandler=function(t,e,i){this.handler&&this.handler.dispose(),this.handler=Handler.create(t,e,i,!1)},e.prototype.init=function(){this.listRole.itemRenderer=RoleInfoItem,this.freshList(),this.addItemClick(this.listRole,this.itemClick)},e.prototype.freshList=function(){for(var t=[],e=this.heroList,i=0;i<GlobalVar.ROLE_MAX;i++){var n={icon:"",index:0},o=0;e[i]?(n.index=this.nSlRole,o=e[i].job-1,n.icon=this.getIcon(2,o)):n.icon=this.getIcon(0,o),t.push(n)}this.setListData(this.listRole,t)},e.prototype.getIcon=function(t,e){void 0===e&&(e=0);var i="";switch(t){case 0:i="public_json.public_role_lock_png";break;case 1:i="public_json.public_role_add_png";break;case 2:i="public_json.public_role_"+e+"_png"}return i},e.prototype.setListData=function(t,e){var i=t.dataProvider;i?i.source=e:t.dataProvider=new eui.ArrayCollection(e)},e.prototype.itemClick=function(t){if(t.itemIndex!=this.nSlRole){var e=this.heroList;e[t.itemIndex]&&(this.nSlRole=t.itemIndex,this.handler&&(this.handler.args=[this.nSlRole],this.handler.run()),this.freshList())}},e.prototype.dispose=function(){this.handler&&this.handler.dispose(),t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(RoleOtherSelect.prototype,"RoleOtherSelect");var RolePannel=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this,e)},e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPagePannel);__reflect(RolePannel.prototype,"RolePannel");var RolePannelEquip=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="RolePannelEquipSkin",i}return __extends(e,t),e.red=function(){return!1},e.prototype.roleRed=function(t){return GameCache.equip.roleRed[t]?GameCache.equip.roleRed[t]:!1},e.changeMsg=function(){return[]},e.prototype.init=function(){for(var t in this.gPart.$children){var e=this.gPart.$children[t];e.setColorImg(),e.setIconImg("role_json.role_part_"+e.name+"_png"),e.setHandler(this,function(t){if(t.itemData){var e=[];if(t.strenghLvl>0){var i=GameCache.strength.getStrengthProp(t.strenghLvl,t.itemData.part);e.push(i)}if(t.refineLvl>0){var n=GameCache.strength.getRefineProp(t.refineLvl,t.itemData.part);e.push(n)}GlobalFun.itemTips(t.userItem||t.itemData,e)}},[e])}this.roleSelect.setHandler(this,this.roleClick),this.title=new ThingTitle,this.title.scaleX=1.2,this.title.scaleY=1.2,this.gNe.addChild(this.title)},e.prototype.roleClick=function(t){this.upRolePart()},e.prototype.open=function(t){void 0===t&&(t=null),t&&t.exData1&&this.roleSelect.setRoleIndex(t.exData1),this.role.setData(GameCache.hero.list[this.roleSelect.nSlRole].pro),this.message(MsgConst.EQUIP_INFO,this.upRolePart),this.message(MsgConst.EQUIP_ATTR_CHANGE,this.updateModelEquip),this.message(MsgConst.BAG_ITEM_NUM,this.quickWearBtn),this.message(MsgConst.PROPERTY+PropId.AP_BATTLE_POWER,this.updatePower),this.addTouchEvent(this.i2,this.onOpenPro),this.addTouchEvent(this.imgTransfer,this.onTransfer),this.addTouchEvent(this.oneBtn,this.quickWear);var e=GameCache.hero.mainPro;e&&(this.title.setName(e.charName),this.title.setBadge(e.pro(PropId.AP_BADGE_LVL))),this.upRolePart()},e.prototype.updatePower=function(){this.zdl.value=this.roleSelect.selectPro.pro(PropId.AP_BATTLE_POWER)},e.prototype.upRolePart=function(){this.quickWearBtn(),this.updatePower();var t=GameCache.hero.getDataByIndex(this.roleSelect.nSlRole,GameCache.equip.roleEquipList),e=GameCache.hero.getDataByIndex(this.roleSelect.nSlRole,GameCache.equip.roleStrengthList),i=GameCache.hero.getDataByIndex(this.roleSelect.nSlRole,GameCache.equip.roleRefineList);for(var n in this.gPart.$children){var o=this.gPart.$children[n],r=t?t[o.name]:null;r?(e&&e[r.stdItem.part]&&(r.btStrong=e[r.stdItem.part],r.btRefine=i[r.stdItem.part],o.strengthLvl=[e[r.stdItem.part]],o.refineLvl=i[r.stdItem.part]),o.data=r):(o.strengthLvl=[0],o.refineLvl=0,o.data&&(o.reSet(),o.setColorImg(),o.setIconImg("role_json.role_part_"+o.name+"_png")))}var a=GameCache.hero.list;a[this.roleSelect.nSlRole]&&a[this.roleSelect.nSlRole].pro&&this.role.setData(a[this.roleSelect.nSlRole].pro)},e.prototype.onOpenPro=function(){var t=new ViewProp;t.exData1=this.roleSelect.selectPro,App.ViewManager.open(ViewConst.ROLEPROTIPS,t)},e.prototype.updateModelEquip=function(){this.role.refresh()},e.prototype.quickWear=function(){GameCache.equip.quickWear(this.roleSelect.job)},e.prototype.onTransfer=function(){App.ViewManager.open(ViewConst.TRANSFER)},e.prototype.quickWearBtn=function(){var t=GameCache.bag.roleSuggestBag[this.roleSelect.job]?Object.keys(GameCache.bag.roleSuggestBag[this.roleSelect.job]).length:0;this.oneBtn.visible=t>0},e}(BaseSpriteView);__reflect(RolePannelEquip.prototype,"RolePannelEquip");var RolePartSprite=function(t){function e(){var e=t.call(this)||this;return e.skinName="RolePartSkin",e}return __extends(e,t),e.prototype.init=function(){},e}(BaseCustComponent);__reflect(RolePartSprite.prototype,"RolePartSprite");var RoleSelect=function(t){function e(){var e=t.call(this)||this;return e.nSlRole=0,e.skinName="RoleSelectSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.setHandler=function(t,e,i){this.handler&&this.handler.dispose(),this.handler=Handler.create(t,e,i,!1),t&&(this.showView=t)},e.prototype.setRoleIndex=function(t){this.nSlRole=t,this.freshList()},e.prototype.init=function(){this.listRole.itemRenderer=RoleInfoItem,App.MessageCenter.addListener(MsgConst.NEW_HERO,this.freshList,this),this.freshList(),this.addItemClick(this.listRole,this.itemClick)},e.prototype.freshList=function(){for(var t=[],e=GameCache.hero.list,i=0;i<GlobalVar.ROLE_MAX;i++){var n={icon:"",index:0},o=0;e[i]&&(n.index=this.nSlRole,o=e[i].pro.job-1),n.icon=this.getIcon(GameCache.hero.getRoleStateByIndex(i),o),t.push(n)}this.setListData(this.listRole,t)},e.prototype.setListRed=function(){if(this.showView)for(var t=0;t<this.listRole.numChildren;t++)GameCache.hero.list[t]&&App.ViewManager.showRedPoint(this.listRole.getChildAt(t),this.getRoleRedFun(t))},e.prototype.getRoleRedFun=function(t){var e=!1;return this.showView&&this.showView.roleRed&&(e=this.showView.roleRed(GameCache.hero.getProByIndex(t).pro(PropId.AP_ACTOR_ID))),e},e.prototype.getIcon=function(t,e){void 0===e&&(e=0);var i="";switch(t){case 0:i="public_json.public_role_lock_png";break;case 1:i="public_json.public_role_add_png";break;case 2:i="public_json.public_role_"+e+"_png"}return i},e.prototype.setListData=function(t,e){var i=t.dataProvider;i?i.source=e:t.dataProvider=new eui.ArrayCollection(e)},e.prototype.itemClick=function(t){if(t.itemIndex!=this.nSlRole){var e=GameCache.hero.list;e[t.itemIndex]?(this.nSlRole=t.itemIndex,this.handler&&(this.handler.args=[this.nSlRole],this.handler.run()),this.freshList()):App.ViewManager.open(ViewConst.ADVENTURE)}},Object.defineProperty(e.prototype,"roleId",{get:function(){return GameCache.hero.getProByIndex(this.nSlRole).pro(PropId.AP_ACTOR_ID)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"job",{get:function(){return GameCache.hero.getProByIndex(this.nSlRole).pro(PropId.AP_JOB)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sex",{get:function(){return GameCache.hero.getProByIndex(this.nSlRole).pro(PropId.AP_SEX)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverId",{get:function(){return GameCache.hero.getServerIdByIndex(this.nSlRole)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectPro",{get:function(){return GameCache.hero.getProByIndex(this.nSlRole)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.handler&&this.handler.dispose(),t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(RoleSelect.prototype,"RoleSelect");var RoleWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPageWin);__reflect(RoleWin.prototype,"RoleWin");var RoleIcon=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data instanceof PropertySet&&this.initData()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){var t=this.data;t.pro(PropId.AP_HP)<=0?this.filters=FilterUtils.DefaultGrayFilters:this.filters=[]},e}(BaseCustComponent);__reflect(RoleIcon.prototype,"RoleIcon");var RoleProTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="RoleProTipsSkin",e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this,e),this.getProShow();var i=e.exData1,n=GameConfig.prop;for(var o in this.proShow){for(var r=this.proShow[o],a=[],s=0,h=r.length;h>s;s++){var p=parseInt(r[s].id),l=i.pro(p);n[p]&&(p=n[p].toBuffId);var c={type:p,value:l};a.push(c)}this["pro"+o].setData(a,[],i.job)}},e.prototype.getProShow=function(){if(!this.proShow){var t=this.proShow={},e=GameConfig.prop;for(var i in e){var n=e[i];if(n.showPos){var o=Math.floor(n.showPos/10);t[o]||(t[o]=[]),t[o].push(n)}}for(var r in t)t[r].sort(this.sort)}},e.prototype.sort=function(t,e){return t.showPos>e.showPos?1:t.showPos<e.showPos?-1:0},e}(BaseEuiWindow);__reflect(RoleProTipsView.prototype,"RoleProTipsView");var RuneCache=function(t){function e(){var e=t.call(this)||this;return e.runeData={},e}return __extends(e,t),e.prototype.clear=function(){this.runeData={}},e.prototype.initRuneData=function(t,e,i,n){var o={},r=10*e+i;r=0>r?0:r;var a=GameCache.hero.getRoleIdByIndex(t);o.id=r,o.star=i,o.lvl=e,o.exp=n,this.runeData[a]=o},e.prototype.getUpGradeNum=function(t){var e=GameCache.hero.getRoleIdByIndex(t),i=GameCache.rune.runeData[e];i||(i={exp:0,id:0,lvl:0,star:0});var n=GameConfig.rune[t+1][i.id],o=i.exp,r=n.upExp,a=n.addExp,s=n.item[0].count;return Math.ceil((r-o)/a)*s},e.prototype.checkGrade=function(t){var e=GameCache.hero.list;if(!t){for(var i=GameCache.hero.list,n=0;n<i.length;n++)if(this.checkGrade(i[n].id))return!0;return!1}for(var o=0,n=0;n<e.length;n++)if(e[n].id==t){o=n;break}var r=this.runeData[t],a=r?r.id:0,s=GameConfig.rune[o+1][a+1];if(!s)return!1;var h=GameCache.bag.itemCount(s.item[0].id);return h>=s.item[0].count},e}(BaseCache);__reflect(RuneCache.prototype,"RuneCache");var RunePage=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.oldLvl=0,i.curid=0,i.tempId=0,i.skinName="RunePageSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.roleSelect.setHandler(this,this.onCLick,[]),this.num.gap=22},e.red=function(){return GameCache.rune.checkGrade()?!0:!1},e.prototype.roleRed=function(t){return GameCache.rune.checkGrade(t)?!0:!1},e.changeMsg=function(){return[MsgConst.RUNE_INFO,MsgConst.NEW_HERO]},e.prototype.refreshRed=function(){t.prototype.refreshRed.call(this),this.redShow()},e.prototype.open=function(t){this.message(MsgConst.RUNE_INFO,this.initData),this.message(MsgConst.RUNE_INFO,this.lvlUpAnimate),this.addTouchEvent(this.pBtn,this.lvlUp),this.onCLick()},e.prototype.close=function(e){t.prototype.close.call(this)},e.prototype.onCLick=function(){this.cleanAnimate(),App.TimerManager.addDelay(50,50,1,this.initData,this)},e.prototype.initData=function(){var t=GameCache.rune.runeData[this.roleSelect.roleId];t||(t={exp:0,id:0,lvl:0,star:0});var e=t.id;this.curid=t.id;var i=GameConfig.rune[this.roleSelect.nSlRole+1][e],n=GameConfig.rune[this.roleSelect.nSlRole+1][e+1];this.pro.maximum=i.upExp,App.TimerManager.isExists(this.proAnimate,this)||(this.pro.value=t.exp),this.starPro.setData(10,i.starLevel),n?(this.cost.visible=!0,this.lvlMax.visible=!1,this.item.visible=!0,this.pBtn.visible=!0,this.cost.setData(n.item[0].id,n.item[0].count),this.item.data=n.item[0].id):(this.cost.visible=!1,this.item.visible=!1,this.pBtn.visible=!1,this.lvlMax.visible=!0);var o=StringUtils.substitute(Language.lang.rune_0,i.classLevel,i.starLevel);this.num.value=o,this.num.x=Math.floor((510-22*o.length)/2),this.initSkill(i.classLevel);var r=n?n.attrs:[];this.propList.setData(i.attrs,r,this.roleSelect.job,16762368,16777215,65292,[],"PropItem2Skin"),this.initZdl()},e.prototype.initSkill=function(t){if(0==this.oldLvl||this.oldLvl!=t){this.oldLvl=t;for(var e=0;4>e;e++){var i={roleIdx:this.roleSelect.nSlRole,job:this.roleSelect.job,jLvl:t,skillId:e+1};this["skill_"+e].data=i}}},e.prototype.initZdl=function(){for(var t=0,e=0;4>e;e++)t+=this["skill_"+e].zdl;this.zdl.value=t+this.propList.zdl},e.prototype.lvlUp=function(){if(this.cost.checkEnough()){var t=GameCache.rune.getUpGradeNum(this.roleSelect.nSlRole);this.cost.have<t&&(t=this.cost.have),this.tempId=this.curid,Proxy.rune.sendRuneLvlUp(this.roleSelect.nSlRole,t,this.cost.item)}},e.prototype.lvlUpAnimate=function(){App.TimerManager.isExists(this.proAnimate,this)&&App.TimerManager.remove(this.proAnimate,this);var t=GameCache.rune.runeData[this.roleSelect.roleId],e=t.id,i=e==this.tempId?t.exp:this.pro.maximum,n=(i-this.pro.value)/10;App.TimerManager.addDelay(100,100,0,this.proAnimate,this,null,null,i,n)},e.prototype.cleanAnimate=function(){App.TimerManager.isExists(this.proAnimate,this)&&App.TimerManager.remove(this.proAnimate,this),this.pro.value=GameCache.rune.runeData[this.roleSelect.roleId].exp},e.prototype.proAnimate=function(t,e){this.pro.value<t?this.pro.value+=e:this.cleanAnimate()},e.prototype.redShow=function(){App.ViewManager.showRedPoint(this.pBtn,GameCache.rune.checkGrade(this.roleSelect.roleId))},e}(BaseSpriteView);__reflect(RunePage.prototype,"RunePage");var RunePannel=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this,e)},e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPagePannel);__reflect(RunePannel.prototype,"RunePannel");var RuneProxy=function(t){function e(){var e=t.call(this,PacketTypes.RUNE)||this;return e.regNetMsg(2,e.doInitRuneData),e.regNetMsg(1,e.doInitSingleRune),e}return __extends(e,t),e.prototype.doInitRuneData=function(t){for(var e=t.readInt(),i=0;e>i;i++){var n=t.readByte(),o=t.readUnsignedShort(),r=t.readByte(),a=t.readInt();GameCache.rune.initRuneData(n-1,o,r,a)}App.MessageCenter.dispatch(MsgConst.RUNE_INFO)},e.prototype.doInitSingleRune=function(t){var e=t.readByte(),i=t.readUnsignedShort(),n=t.readByte(),o=t.readInt();GameCache.rune.initRuneData(e-1,i,n,o),App.MessageCenter.dispatch(MsgConst.RUNE_INFO)},e.prototype.sendRuneLvlUp=function(t,e,i){var n=this.getBytes(1),o=GameCache.hero.getServerIdByIndex(t);n.writeInt(o),n.writeUnsignedShort(t+1),n.writeUnsignedShort(e),n.writeInt(i),this.sendToServer(n)},e}(BaseProxy);__reflect(RuneProxy.prototype,"RuneProxy");var RuneSkillItem=function(t){function e(){var e=t.call(this)||this;return e._zdl=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.sIcon,this.openTips)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.skillId&&this.judgeState()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.judgeState=function(){var t=GameConfig.runeSkill[this.data.roleIdx+1][this.data.skillId];t&&(this.sIcon.source="rune_json.rune_skill_ico_"+this.data.job+"_"+t.img+"_png",t.conds>this.data.jLvl?(this.sIcon.filters=FilterUtils.DefaultGrayFilters,this.sName.filters=FilterUtils.DefaultGrayFilters,this.condi.text=StringUtils.substitute(Language.lang.openTxt,t.conds)):(this.sIcon.filters=null,this.sName.filters=null,this._zdl=ItemUtils.getZdlByProp(t.attrs),this.condi.text=""))},e.prototype.openTips=function(){var t=new ViewProp;
t.exData1=[this.data.skillId,this.data.roleIdx],t.exData2=this.data.jLvl,t.firData=this.data.job,App.ViewManager.open(ViewConst.RUNESKILL,t)},Object.defineProperty(e.prototype,"zdl",{get:function(){return this._zdl},enumerable:!0,configurable:!0}),e}(BaseCustComponent);__reflect(RuneSkillItem.prototype,"RuneSkillItem");var RuneSkillTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="WingSkillTipsSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){t.prototype.open.call(this),this.t1.text=Language.lang.wingSkillEff,this.t0.text=Language.lang.wingActiCondition,this.initData(e.exData1,e.exData2,e.firData)},e.prototype.initData=function(t,e,i){var n=GameConfig.runeSkill[t[1]][t[0]];n&&(e<n.conds?(this.skillIcon.filters=FilterUtils.DefaultGrayFilters,this.skillName.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.unActive,n.name[i-1]))):(this.skillIcon.filters=null,this.skillName.text=n.name[i-1]),this.skillIcon.source="rune_json.rune_skill_ico_"+i+"_"+n.img+"_png",this.condiTxt.text=StringUtils.substitute(Language.lang.rune_1,n.conds),this.desc.text=n.dec)},e}(BaseEuiWindow);__reflect(RuneSkillTips.prototype,"RuneSkillTips");var ScriptProxy=function(t){function e(){var e=t.call(this,PacketTypes.SCRIPT)||this;return e.regNetMsg(13,e.doRankData),e.regNetMsg(1,e.doRevive),e.regNetMsg(26,e.doRankInfo),e.regNetMsg(3,e.doInitXSYh),e.regNetMsg(2,e.doXSYHBuyDone),e.regNetMsg(4,e.doInitXSLB),e.regNetMsg(5,e.doXSLBBuyDone),e}return __extends(e,t),e.prototype.doRankData=function(t){},e.prototype.doRevive=function(t){for(var e=t.readByte(),i=t.readUnsignedInt(),n=t.readByte(),o=[],r=0;n>r;r++){var a={job:0,sex:0};a.job=t.readByte(),a.sex=t.readByte(),o.push(a)}if(GameCache.revive.leftTime=i,GameCache.revive.reveiveList=o,e){var s=new ViewProp;s.exData1=o,s.exData2=i,App.ViewManager.open(ViewConst.REVIVE,s)}},e.prototype.doRankInfo=function(t){for(var e=t.readUnsignedShort(),i=t.readUnsignedShort(),n=[],o=0;i>o;o++){var r=t.readUnsignedShort(),a=t.readUnsignedInt(),s=t.readCustomBytes(),h=t.readUnsignedInt(),p={bossid:e,rank:r+1,roleId:a,roleName:s,value:h};n.push(p)}var l=t.readShort()+1,c=t.readUnsignedInt();App.MessageCenter.dispatch(MsgConst.BOSS_RANK_INFO,[n,l,c])},e.prototype.doRankSelf=function(t){var e=t.readUnsignedShort(),i=t.readUnsignedInt(),n=t.readShort(),o=t.readUnsignedInt(),r={bossid:e,rank:n+1,roleId:i,value:o,roleName:GameCache.hero.mainPro.charName};App.MessageCenter.dispatch(MsgConst.BOSS_MYRANK,r)},e.prototype.doInitXSYh=function(t){for(var e=t.readInt(),i=t.readUnsignedShort(),n={},o=0;i>o;o++){var r=t.readUnsignedShort(),a=t.readByte();n[r]=a}GameCache.activity.xsyhData[e]=n,GameCache.activity.serverOpen=e,App.MessageCenter.dispatch(MsgConst.XSYH_INFO)},e.prototype.doXSYHBuyDone=function(t){var e=t.readUnsignedShort();GameCache.activity.XSYHBough(e),App.MessageCenter.dispatch(MsgConst.XSYH_BUY_SUCCESS,e)},e.prototype.doInitXSLB=function(t){for(var e=t.readInt(),i=t.readUnsignedShort(),n={},o=0;i>o;o++){var r=t.readUnsignedShort(),a=t.readByte();n[r]=a}GameCache.activity.xslbData[e]=n,GameCache.activity.serverOpen=e,App.MessageCenter.dispatch(MsgConst.XSYH_INFO)},e.prototype.doXSLBBuyDone=function(t){var e=t.readUnsignedShort();GameCache.activity.XSLBBough(e),App.MessageCenter.dispatch(MsgConst.XSYH_BUY_SUCCESS,e)},e.prototype.sendRevive=function(t){var e=this.getBytes(1);e.writeByte(t),this.sendToServer(e)},e.prototype.sendXSYHBuy=function(t){var e=this.getBytes(2);e.writeUnsignedShort(t),this.sendToServer(e)},e.prototype.sendXSLBBuy=function(t){var e=this.getBytes(3);e.writeUnsignedShort(t),this.sendToServer(e)},e}(BaseProxy);__reflect(ScriptProxy.prototype,"ScriptProxy");var ServerCache=function(t){function e(){var e=t.call(this)||this;return e._serverTimeBase=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"serverTimeBase",{set:function(t){this._serverTimeBase=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverTime",{get:function(){return this._serverTimeBase+egret.getTimer()},enumerable:!0,configurable:!0}),e.prototype.clear=function(){t.prototype.clear.call(this),this.serverOpenTime=null,this._serverTimeBase=0},e}(BaseCache);__reflect(ServerCache.prototype,"ServerCache");var SettingsCache=function(t){function e(){var e=t.call(this)||this;return e.oData={},e.data={},e}return __extends(e,t),e.prototype.clear=function(){this.data={}},e.prototype.init=function(){this.oData=(t={},t[SettingType.BOSS_REMIND]=0,t[SettingType.VIP_BOSS_REMIND]=0,t[SettingType.AUTO_RECYCLE]=0,t);var t},e.prototype.update=function(t,e,i){this.data[t]=e,i&&this.saveToServer()},e.prototype.saveToServer=function(){Proxy.other.sendSystemConfigSave(this.data)},e.prototype.getValue=function(t){return this.data[t]||this.oData[t]||0},e}(BaseClass);__reflect(SettingsCache.prototype,"SettingsCache");var SettingType=function(){function t(){}return t.AUTO_RECYCLE=0,t.BASE_GAME_SETTING=1,t.BOSS_REMIND=2,t.VIP_BOSS_REMIND=3,t}();__reflect(SettingType.prototype,"SettingType");var ShopBaseItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShopBaseItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.eBtn,this.onClick)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data.id){var e=this.data;this.gLimit.visible=e.restrictions?!0:!1;var i=e.des?e.des:"",n=0;GameCache.shop.shopData[e.type]&&GameCache.shop.shopData[e.type][e.id]&&(n=GameCache.shop.shopData[e.type][e.id]),this.lbLimit.text=i+(e.restrictions-n),e.png?this.imgSale.source=e.png:this.imgSale.source=null,e.originalprice&&(this.lbNum0.text=e.originalprice+""),e.price&&(this.imgItem0.source=GlobalFun.getItemSourceById(e.price.id),this.imgItem1.source=GlobalFun.getItemSourceById(e.price.id),this.lbNum1.text=e.price.count+""),e.item&&(this.icon.data=e.item,this.icon.initData(),this.lbNe.text=GameConfig.item[e.item.id]?GameConfig.item[e.item.id].name:"")}},e.prototype.onClick=function(){var t=this.data;if(t){var e=0;GameCache.shop.shopData[t.type]&&GameCache.shop.shopData[t.type][t.id]&&(e=GameCache.shop.shopData[t.type][t.id]);var i=!1;t.restrictions>0&&e>=t.restrictions?(i=!0,GlobalFun.SysMsg(Language.lang.lcn17)):t.price&&(GameCache.bag.itemCount(t.price.id)>=t.price.count?Proxy.shop.sendShopBuy(t.type,t.id,1):GlobalFun.gotoCharge())}},e}(BaseCustComponent);__reflect(ShopBaseItem.prototype,"ShopBaseItem");var ShopBasePannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="ShopBasePannelSkin",i}return __extends(e,t),e.red=function(){return!1},e.changeMsg=function(){return[]},e.prototype.init=function(){this.listLb.itemRenderer=ShopBaseItem,this.cfgShop=GameConfig.shop[ShopType.gold]},e.prototype.open=function(t){void 0===t&&(t=null),this.cfgShop[1]&&this.cfgShop[1].type&&this.message(MsgConst.SHOP_INFO+this.cfgShop[1].type,this.upCn),this.upCn()},e.prototype.upCn=function(){var t=[];for(var e in this.cfgShop)t.push(this.cfgShop[e]);this.setListData(this.listLb,t)},e}(CommunalPagePannel);__reflect(ShopBasePannel.prototype,"ShopBasePannel");var ShopTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="ShopTipsSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){t.prototype.open.call(this)},e}(BaseEuiWindow);__reflect(ShopTips.prototype,"ShopTips");var ShopWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="CommunalPageWin4Skin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPageWin);__reflect(ShopWin.prototype,"ShopWin");var ShopType;!function(t){t[t.prop=0]="prop",t[t.gold=1]="gold",t[t.score=2]="score"}(ShopType||(ShopType={}));var ShopCache=function(t){function e(){var e=t.call(this)||this;return e.shopData={},e}return __extends(e,t),e.prototype.clear=function(){this.shopData={}},e.prototype.initData=function(t,e){this.shopData[t]=e},e.prototype.upStList=function(t,e,i){},e}(BaseCache);__reflect(ShopCache.prototype,"ShopCache");var ShopProxy=function(t){function e(){var e=t.call(this,PacketTypes.SHOP)||this;return e.regNetMsg(1,e.doInit),e.regNetMsg(2,e.doBuyTime),e.regNetMsg(3,e.doShopScore),e}return __extends(e,t),e.prototype.doInit=function(t){for(var e=t.readByte(),i=t.readUnsignedShort(),n={},o=0;i>o;o++)n[t.readByte()]=t.readUnsignedShort();GameCache.shop.initData(e,n),App.MessageCenter.dispatch(MsgConst.SHOP_INFO+e)},e.prototype.doBuyTime=function(t){var e=t.readByte(),i=t.readByte(),n=t.readShort();GameCache.shop.shopData[e]&&(GameCache.shop.shopData[e][i]=n),App.MessageCenter.dispatch(MsgConst.SHOP_INFO+e)},e.prototype.doShopScore=function(t){},e.prototype.sendShopBuy=function(t,e,i){var n=this.getBytes(1);n.writeByte(t),n.writeByte(e),n.writeUnsignedShort(i),this.sendToServer(n)},e}(BaseProxy);__reflect(ShopProxy.prototype,"ShopProxy");var SignCache=function(t){function e(){var e=t.call(this)||this;return e.signCounts=0,e.canSign=0,e.awardFlag=0,e.dailyAwardList=[],e.totalAwardList=[],e.init(),e}return __extends(e,t),e.prototype.clear=function(){this.signCounts=0,this.canSign=0,this.awardFlag=0},e.prototype.init=function(){var t=GameConfig.sign;GameConfig.globalConfig.signNeed;for(var e in t){var i=t[e];(i.need?this.totalAwardList:this.dailyAwardList).push(i)}},e.prototype.updateCounts=function(t){this.signCounts=NumericUtils.LoWord(t);var e=NumericUtils.HiWord(t);this.canSign=e-this.signCounts},e.prototype.updateAwardState=function(t){this.awardFlag=t},e.prototype.getAwardState=function(t){var e=this.awardFlag;return 1==(e>>t&1)},e}(BaseCache);__reflect(SignCache.prototype,"SignCache");var SignDailyItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.item.setBgImg(null)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.indexTx.text=e.id+"",this.item.data=e.reward[0];var i=GameCache.sign.signCounts>=e.id;this.removeTouch(),i?(this.finish1.visible=this.finish2.visible=!0,this.canSign.visible=!1):(this.finish1.visible=this.finish2.visible=!1,this.canSign.visible=GameCache.sign.signCounts+GameCache.sign.canSign>=e.id,this.canSign.visible&&this.addTouch())},e.prototype.addTouch=function(){this.item.enabled=!1,this.addTouchEvent(this,this.onTouch)},e.prototype.removeTouch=function(){this.item.enabled=!0,this.removeAllEvent()},e.prototype.onTouch=function(){Proxy.sign.sendPrize(this.data.id)},e}(BaseCustComponent);__reflect(SignDailyItem.prototype,"SignDailyItem");var SignProxy=function(t){function e(){return t.call(this,PacketTypes.GETGIFTOL)||this}return __extends(e,t),e.prototype.sendPrize=function(t){var e=this.getBytes(3);e.writeUnsignedShort(t),this.sendToServer(e)},e}(BaseProxy);__reflect(SignProxy.prototype,"SignProxy");var SignWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="SignWinSkin",e}return __extends(e,t),e.prototype.init=function(){for(var t=0;4>t;t++)this["item"+t].setBgImg(null),this["item"+t].showArrow=!1,this["item"+t].showColor=!1,this["item"+t].setHandler(this,this.onItemTouch,[this["item"+t]]);this.dailyList.itemRenderer=SignDailyItem},e.prototype.open=function(){t.prototype.open.call(this),this.message(MsgConst.PROPERTY+PropId.AP_SIGNIN,this.doUpdate),this.message(MsgConst.PROPERTY+PropId.AP_CHECKINS,this.doUpdate),this.update()},e.prototype.onItemTouch=function(t){var e=parseInt(t.name);if(e>=0){var i=GameCache.sign.totalAwardList[e];if(i){var n=GameCache.sign.getAwardState(e);!n&&GameCache.sign.signCounts>=i.need?Proxy.sign.sendPrize(i.id):GlobalFun.itemTips(i.reward[0].id)}}},e.prototype.doUpdate=function(){this.flushFun(this.update,!0)},e.prototype.update=function(){this.setListData(this.dailyList,GameCache.sign.dailyAwardList),this.updateTotal()},e.prototype.updateTotal=function(){this.totalDay.text=GameCache.sign.signCounts+"";for(var t=GameCache.sign.totalAwardList,e=0,i=t.length;i>e;e++){var n=GameCache.sign.getAwardState(e);if(!n)break}e+4>=i&&(e=i-4);for(var o=0;4>o;o++){var r=o+e;this["item"+o].name=r,this["item"+o].data=t[r].reward[0],this["day"+o].text=StringUtils.substitute(Language.lang.signDay,t[r].need);var n=GameCache.sign.getAwardState(r);n?this["finish"+o].visible=!0:(this["finish"+o].visible=!1,this["flag"+o].visible=GameCache.sign.signCounts>=t[r].need)}},e}(BaseEuiWindow);__reflect(SignWin.prototype,"SignWin");var RoleSkillPannel=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this,e)},e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPagePannel);__reflect(RoleSkillPannel.prototype,"RoleSkillPannel");var SkillCache=function(t){function e(){var e=t.call(this)||this;return e.learnSkill={},e.sortSkill={},e.hookSkill={},e.allDefaultUserSkill={},e}return __extends(e,t),e.prototype.clear=function(){this.learnSkill={},this.sortSkill={},this.hookSkill={}},e.prototype.addSKill=function(t,e){this.roleSkillCfg(),this.learnSkill[t]=e},e.prototype.initSortSKill=function(t,e){var i=this.learnSkill[t];if(i){this.sortSkill[t]=e;var n=this.hookSkill[t]=[],o=!1;for(var r in e){var a=e[r];a&&i[a]&&(n.push(i[a]),o=!0)}!o&&this.setDefaulHookSkill(t)}},e.prototype.setDefaulHookSkill=function(t){var e=this.sortSkill[t];for(var i in e)if(e[i])return;var n=this.hookSkill[t];!n&&(n=this.hookSkill[t]=[]);var o=this.learnSkill[t];if(o&&0==n.length)for(var r in o)n.push(o[r])},e.prototype.getSkillByActorId=function(t){return this.learnSkill[t]},e.prototype.getFightSkilList=function(t){return this.hookSkill[t]},e.prototype.updataSkill=function(t,e,i){var n=this.learnSkill[t];n||(n=this.learnSkill[t]={});for(var o in n){var r=n[o];if(r.nSkillId==e)return void(r.nLevel=i)}var a=new UserSkill;a.nSkillId=e,a.nLevel=i,a.dwResumeTick=0,a.exp=0,n[a.nSkillId]=a,this.setDefaulHookSkill(t)},e.prototype.roleSkillCfg=function(){if(!this.roleSkilList){var t=this.roleSkilList={};for(var e in GameConfig.skill){var i=GameConfig.skill[e],n=i.vocation;if(n){var o=t[n];!o&&(o=t[n]=[]),o.push(i)}}}},e.prototype.getDefaultUserSkill=function(t){var e=this.allDefaultUserSkill[t];return e||(e=UserSkill.create(t,1),this.allDefaultUserSkill[t]=e),e},e.prototype.skillUpRed=function(t){if(!t)return!1;var e=this.getSkillByActorId(t);for(var i in e){var n=e[i],o=GameConfig.skill[n.nSkillId];if(n.nLevel<GlobalFun.getRoleLv()&&o.need){var r=CommonUtils.copyDataHandler(o.need);for(var a in r){var s=r[a],h=s.count+0;s.count&&(s.count=(n.nLevel+1)*h+0)}if(GlobalFun.getBagEnounghUseCondition(r))return!0}}return!1},e.prototype.skillDeployRed=function(t){if(!t)return!1;var e=this.sortSkill[t];for(var i in e){var n=GameConfig.skillBar[i];if(n&&GlobalFun.getRoleLv()>=n.level&&0==e[i])return!0}return!1},e}(BaseCache);__reflect(SkillCache.prototype,"SkillCache");var SkillDeployView=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.nSlRole=0,i.nSlSkill=0,i.changeSkillIndex=-1,i.skillSort=[],i.sortList=[],i.skinName="SkillDeployViewSkin",i}return __extends(e,t),e.red=function(){if(!GameCache.skill)return!1;for(var t in GameCache.hero.list){var e=GameCache.hero.list[t];if(GameCache.skill.skillDeployRed(e.id))return!0}return!1},e.prototype.roleRed=function(t){return GameCache.skill.skillDeployRed(t)?!0:!1},e.changeMsg=function(){return[MsgConst.SKILL_SORT]},e.prototype.init=function(){this.list.itemRenderer=SkillInfo,this.listHave.itemRenderer=SkillInfoSort,this.roleSelect.setHandler(this,this.roleClick)},e.prototype.open=function(t){void 0===t&&(t=null),this.changeSkillIndex=-1,Proxy.skill.getSkillSort(this.roleSelect.serverId),this.initSkillList(),this.message(MsgConst.SKILL_INFO,this.upRoleSkill),this.addEvent(egret.TouchEvent.TOUCH_BEGIN,this,this.onBeginList),this.addEvent(egret.TouchEvent.TOUCH_END,this,this.onEndList),this.addEvent(egret.TouchEvent.TOUCH_MOVE,this,this.onMove),this.addEvent(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this,this.onOutside),this.upRoleSkill()},e.prototype.close=function(){t.prototype.close.call(this),this.endGuide()},e.prototype.initSkillList=function(){var t=GameCache.skill.sortSkill[this.roleSelect.roleId];this.skillSort=[];for(var e in t)GameCache.skill.learnSkill&&GameCache.skill.learnSkill[this.roleSelect.roleId]&&this.skillSort.push(GameCache.skill.learnSkill[this.roleSelect.roleId][t[e]])},e.prototype.itemClick=function(t){t.itemIndex!=this.nSlSkill&&(this.nSlSkill=t.itemIndex,this.upRoleSkill())},e.prototype.onMove=function(t){var e=this.globalToLocal(t.stageX,t.stageY);this.moveIcon.x=e.x-this.moveIcon.width/2,this.moveIcon.y=e.y-this.moveIcon.height/2;var i=e.x-this.moveIcon.width/2,n=e.y-this.moveIcon.height/2;this.moveIcon.x=i,this.moveIcon.y=n},e.prototype.onBeginList=function(t){if(this.changeSkillIndex=-1,t.target instanceof SkillInfo||t.target instanceof SkillInfoSort){var e=t.target.icon.localToGlobal();this.globalToLocal(e.x,e.y,e),this.moveIcon.x=e.x,this.moveIcon.y=e.y,this.moveIcon.source=t.target.icon.source,t.target.data&&t.target.data.skill&&(this.moveIcon.visible=!0,this.userMoveSkill=t.target.data.skill),t.target instanceof SkillInfoSort&&t.target.data.skill&&(this.changeSkillIndex=t.target.itemIndex)}},e.prototype.onEndList=function(t){if(this.moveIcon.visible=!1,t.target instanceof SkillInfoSort){var e=GameConfig.skillBar[t.target.itemIndex+1];if(e&&GlobalFun.getRoleLv()<e.level)return this.userMoveSkill=null,void GlobalFun.SysMsg("暂未开放");this.changeSkillIndex>-1?(this.skillSort[this.changeSkillIndex]=this.skillSort[t.target.itemIndex],this.skillSort[t.target.itemIndex]=this.userMoveSkill,this.changeSkillIndex=-1):this.userMoveSkill&&this.skillSort.indexOf(this.userMoveSkill)<0&&(this.skillSort[t.target.itemIndex]=this.userMoveSkill),this.upRoleSortSkill(),Proxy.skill.chanegeSkillSort(this.roleSelect.serverId,this.sortList)}else t.target instanceof SkillInfo&&this.userMoveSkill?(this.nSlSkill=t.target.itemIndex,this.upRoleSkill()):this.changeSkillIndex>-1&&(this.skillSort[this.changeSkillIndex]=null,this.changeSkillIndex=-1,this.upRoleSortSkill(),Proxy.skill.chanegeSkillSort(this.roleSelect.serverId,this.sortList));this.userMoveSkill=null},e.prototype.onOutside=function(t){this.moveIcon.visible=!1},e.prototype.roleClick=function(t){this.nSlRole=t,this.changeSkillIndex=-1,this.initSkillList(),this.upRoleSkill()},e.prototype.upRoleSkill=function(){var t=GameCache.skill.getSkillByActorId(GameCache.hero.transIdFromeServer(this.nSlRole)),e=[],i=GameCache.skill.roleSkilList[this.roleSelect.job];for(var n in i){var o=i[n],r={sl:1,skill:null,cfg:null};if(r.sl=this.nSlSkill,r.skill=t[o.id],r.cfg=o,!o||1==o.skillsort){if(parseInt(n)==this.nSlSkill&&r.skill){this.slSkill=r.skill;var a=o;if(a){this.skillName.text=a.name;var s=[];for(var h in o.valuedec)s.push(o.valuedec[h]*this.slSkill.nLevel);this.skillDsc.text=StringUtils.substitute(o.desc,s),this.imgNum.value=this.slSkill.nLevel}}e.push(r)}}e.sort(this.sort),this.setListData(this.list,e),this.upRoleSortSkill()},e.prototype.sort=function(t,e){return t.cfg.id-e.cfg.id},e.prototype.upRoleSortSkill=function(){var t=[],e=!1;this.sortList=[];for(var i=0;4>i;i++){var n={skill:null};n.skill=this.skillSort[i],t.push(n);var o=0;this.skillSort[i]&&this.skillSort[i].nSkillId&&(o=this.skillSort[i].nSkillId),this.sortList.push(o),o&&(e=!0)}this.setListData(this.listHave,t),e?this.endGuide(e):GameConfig.clientGlobal.skillGuideID&&GameCache.novice.guidId==GameConfig.clientGlobal.skillGuideID&&this.playGuide()},e.prototype.playGuide=function(){if(!this.guideImage){var t=this.guideImage=new eui.Image;t.alpha=.8;var e=this.list.dataProvider&&this.list.dataProvider.source;if(e){var i=e[0],n=i.skill,o=GameConfig.skill[n.nSkillId];t.source=RES_DIR_SKILL+o.icon+".png",this.addChild(t);var r=t.x=38,a=t.y=88;egret.Tween.get(t,{loop:!0}).to({x:38,y:444},1e3).call(function(){t.x=r,t.y=a},this)}}},e.prototype.endGuide=function(t){void 0===t&&(t=!1);var e=this.guideImage;if(e&&(egret.Tween.removeTweens(e),e.source=null,App.DisplayUtils.removeFromParent(e),this.guideImage=null,t&&GameCache.novice.guidId==GameConfig.clientGlobal.skillGuideID)){var i=GameCache.novice.guideView;i&&i.handlerCommand("skill")}},e}(BaseSpriteView);__reflect(SkillDeployView.prototype,"SkillDeployView");var SkillExItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SkillExItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data&&this.data.skill){var e=this.data.skill,i=GameConfig.skill[e.nSkillId];this.select.visible=this.data.sl==this.itemIndex,i&&(this.imgNe.source="res/images/skillLb/"+i.id+".png",this.icon.source=RES_DIR_SKILL+i.icon+".png")}},e}(BaseCustComponent);__reflect(SkillExItem.prototype,"SkillExItem");var SkillExView=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.nSlRole=0,i.nSlSkill=0,i.skinName="SkillExViewSkin",i}return __extends(e,t),e.red=function(){return GameCache.skill?!1:!1},e.prototype.roleRed=function(t){return!1},e.changeMsg=function(){},e.prototype.refreshRed=function(){t.prototype.refreshRed.call(this),!GameCache.skill},e.prototype.init=function(){this.list.itemRenderer=SkillExItem,this.roleSelect.setHandler(this,this.roleClick)},e.prototype.open=function(t){void 0===t&&(t=null),this.message(MsgConst.SKILL_INFO,this.upRoleSkill),this.addTouchEvent(this.btn,this.onClick),this.upRoleSkill(),this.addItemClick(this.list,this.itemClick)},e.prototype.itemClick=function(t){t.itemIndex!=this.nSlSkill&&(this.nSlSkill=t.itemIndex,this.upRoleSkill())},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn:Proxy.skill.setSkillAllUp(this.roleSelect.serverId)}},e.prototype.roleClick=function(t){this.nSlRole=t,this.upRoleSkill()},e.prototype.upRoleSkill=function(){var t=GameCache.skill.getSkillByActorId(GameCache.hero.transIdFromeServer(this.nSlRole)),e=[],i=GameCache.skill.roleSkilList[this.roleSelect.job];for(var n in i){var o=i[n];if(!o||3==o.skillsort){var r={sl:1,skill:null,cfg:null,st:0};if(r.sl=this.nSlSkill,r.skill=t[o.id],r.cfg=o,parseInt(n)==this.nSlSkill&&r.skill){this.slSkill=r.skill;var a=o;if(a){this.skillName.text=a.name+"Lv"+this.slSkill.nLevel;var s=[];for(var h in o.valuedec)s.push(o.valuedec[h]*this.slSkill.nLevel);this.skillDsc.text=StringUtils.substitute(o.desc,s);var p=GameConfig.transfer[o.transferlevel];if(!p)return;this.zdl.value=ItemUtils.getZdlByProp(p.attrs)}}e.push(r)}}e.sort(this.sort),this.setListData(this.list,e)},e.prototype.sort=function(t,e){return t.cfg.id-e.cfg.id},e}(BaseSpriteView);__reflect(SkillExView.prototype,"SkillExView");var SkillInfo=function(t){function e(){var e=t.call(this)||this;return e.skinName="SkillInfoSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchChildren=!1,this.currentState="info"},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data&&this.data.skill){var e=this.data.skill,i=GameConfig.skill[e.nSkillId];this.select.visible=this.data.sl==this.itemIndex,i&&(this.lbName.text=i.name,this.lv.text=e.nLevel+"",this.icon.source=RES_DIR_SKILL+i.icon+".png"),this.gLv.visible=!0}else this.gLv.visible=!1,this.data.cfg&&(this.icon.source=RES_DIR_SKILL+this.data.cfg.icon+"_s.png",this.lbName.text=StringUtils.substitute(Language.lang.lcn2,this.data.cfg.uselevel))},e}(BaseCustComponent);__reflect(SkillInfo.prototype,"SkillInfo");var SkillInfoSort=function(t){function e(){var e=t.call(this)||this;return e.skinName="SkillInfoSkin",e}return __extends(e,t),e.prototype.init=function(){this.currentState="sort"},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchChildren=!1},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data&&this.data.skill){var e=this.data.skill,i=GameConfig.skill[e.nSkillId];this.select.visible=this.data.sl==this.itemIndex,i&&(this.lbName.text=i.name,this.lv.text=e.nLevel+"",this.icon.source=RES_DIR_SKILL+i.icon+".png"),this.gLv.visible=!0}else{var n="public_json.public_lock_1_png";this.gLv.visible=!1;var o=GameConfig.skillBar[this.itemIndex+1];o?GlobalFun.getRoleLv()>=o.level?(this.lbName.text=o.name,n="public_json.public_add_1_png"):this.lbName.text=StringUtils.substitute(Language.lang.lcn2,o.level):this.lbName.text="",this.icon.source=n}},e}(BaseCustComponent);__reflect(SkillInfoSort.prototype,"SkillInfoSort");var SkillItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.id&&(this.sName.text=this.data.name,this.des.textFlow=TextFlowUtils.generateTextFlow(this.data.desc))},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.editFunc=function(){},e}(BaseCustComponent);__reflect(SkillItem.prototype,"SkillItem");var SkillProxy=function(t){function e(){var e=t.call(this,PacketTypes.SKILL)||this;return e.regNetMsg(1,e.doQueryMySkill),e.regNetMsg(2,e.doHitTarget),e.regNetMsg(3,e.doUpdateSkill),e.regNetMsg(4,e.doSkillSort),e.regNetMsg(5,e.doSkillCd),e}return __extends(e,t),e.prototype.doQueryMySkill=function(t){for(var e={},i=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),n=t.readByte(),o=0;n>o;o++){var r=new UserSkill;r.readAttr(t),e[r.nSkillId]=r}GameCache.skill.addSKill(i,e),App.MessageCenter.dispatch(MsgConst.SKILL_INFO)},e.prototype.doUpdateSkill=function(t){var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=t.readUnsignedShort(),n=t.readByte();GameCache.skill.updataSkill(e,i,n),App.MessageCenter.dispatch(MsgConst.SKILL_INFO)},e.prototype.doSkillSort=function(t){for(var e={},i=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),n=t.readByte(),o=0;n>o;o++){var r=t.readByte(),a=t.readUnsignedShort();e[r]=a}GameCache.skill.initSortSKill(i,e),App.MessageCenter.dispatch(MsgConst.SKILL_SORT)},e.prototype.doSkillCd=function(t){GameCache.hero.transIdFromeServer(t.readUnsignedInt()),t.readUnsignedShort(),t.readUnsignedInt()},e.prototype.doHitTarget=function(t){var e=t.readDouble(),i=App.ThingManager.getThing(e),n=t.readInt(),o=(t.readInt(),1==t.readUnsignedByte());return App.HurtTxtManager.play(e,n,o,t.readByte(),i),!0},e.prototype.sendGetMySkill=function(){this.sendMsgId(1)},e.prototype.sendUseSkill=function(t,e,i,n,o,r){var a=this.getBytes(2);a.writeUnsignedInt(t),a.writeShort(e),a.writeDouble(i),a.writeShort(n),a.writeShort(o),a.writeByte(r),this.sendToServer(a)},e.prototype.sendUpSkillLv=function(t,e){var i=this.getBytes(3);i.writeUnsignedInt(t),i.writeShort(e),this.sendToServer(i)},e.prototype.getSkillSort=function(t){var e=this.getBytes(4);e.writeUnsignedInt(t),this.sendToServer(e)},e.prototype.chanegeSkillSort=function(t,e){var i=this.getBytes(5);i.writeUnsignedInt(t),i.writeByte(e.length);for(var n=0;n<e.length;n++)i.writeByte(n),i.writeUnsignedShort(e[n]);this.sendToServer(i)},e.prototype.setSkillAllUp=function(t){var e=this.getBytes(6);e.writeUnsignedInt(t),this.sendToServer(e)},e.prototype.sendUpExSkillLv=function(t,e){var i=this.getBytes(7);i.writeUnsignedInt(t),i.writeShort(e),this.sendToServer(i)},e}(BaseProxy);__reflect(SkillProxy.prototype,"SkillProxy");var SkillTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="SkillTipsSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){if(t.prototype.open.call(this),e&&e.exData1){var i=GameConfig.skill[e.exData1];if(i){this.itemName.text=i.name,this.lv.text=Language.lang.lcn20,this.icon.source=RES_DIR_SKILL+i.icon+".png";var n=[];for(var o in i.valuedec)n.push(1*i.valuedec[o]);this.desc.text=StringUtils.substitute(i.desc,n)}}},e}(BaseEuiWindow);__reflect(SkillTips.prototype,"SkillTips");var SkillUpView=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.nSlRole=0,i.nSlSkill=0,i.skinName="SkillUpViewSkin",i}return __extends(e,t),e.red=function(){if(!GameCache.skill)return!1;for(var t in GameCache.hero.list){var e=GameCache.hero.list[t];if(GameCache.skill.skillUpRed(e.id))return!0}return!1},e.prototype.roleRed=function(t){return GameCache.skill.skillUpRed(t)?!0:!1},e.changeMsg=function(){return[MsgConst.SKILL_INFO,MsgConst.PROPERTY+PropId.AP_COIN,MsgConst.PROPERTY+PropId.AP_LEVEL]},e.prototype.refreshRed=function(){t.prototype.refreshRed.call(this),GameCache.skill&&App.ViewManager.showRedPoint(this.btnL,GameCache.skill.skillUpRed(this.roleSelect.roleId))},e.prototype.init=function(){this.list.itemRenderer=SkillInfo,this.roleSelect.setHandler(this,this.roleClick)},e.prototype.open=function(t){void 0===t&&(t=null),this.message(MsgConst.SKILL_INFO,this.upRoleSkill),this.addTouchEvent(this.btnL,this.onClick),this.addTouchEvent(this.btnR,this.onClick),this.upRoleSkill(),this.addItemClick(this.list,this.itemClick)},e.prototype.itemClick=function(t){t.itemIndex!=this.nSlSkill&&(this.nSlSkill=t.itemIndex,this.upRoleSkill())},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnL:Proxy.skill.setSkillAllUp(this.roleSelect.serverId);break;case this.btnR:Proxy.skill.sendUpSkillLv(this.roleSelect.serverId,this.slSkill.nSkillId)}},e.prototype.roleClick=function(t){this.nSlRole=t,this.upRoleSkill()},e.prototype.upRoleSkill=function(){var t=GameCache.skill.getSkillByActorId(GameCache.hero.transIdFromeServer(this.nSlRole)),e=[],i=GameCache.skill.roleSkilList[this.roleSelect.job];for(var n in i){var o=i[n];if(!o||1==o.skillsort){var r={sl:1,skill:null,cfg:null,st:0};if(r.sl=this.nSlSkill,r.skill=t[o.id],r.cfg=o,parseInt(n)==this.nSlSkill&&r.skill){this.slSkill=r.skill;var a=o;if(a){this.skillName.text=a.name;var s=[];for(var h in o.valuedec)s.push(o.valuedec[h]*this.slSkill.nLevel);this.skillDsc.text=StringUtils.substitute(o.desc,s),a.need&&a.need[0]&&this.expend.setData(a.need[0].id,(this.slSkill.nLevel+1)*a.need[0].count),this.imgNum.value=this.slSkill.nLevel}}e.push(r)}}e.sort(this.sort),this.setListData(this.list,e)},e.prototype.sort=function(t,e){return t.cfg.id-e.cfg.id},e}(BaseSpriteView);__reflect(SkillUpView.prototype,"SkillUpView");var SkillWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="SkillWinSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.init.call(this)},e.prototype.open=function(t){this.itemList.itemRenderer=SkillItem;var e=GameConfig.skill,i=[];for(var n in e){var o={id:e[n].id,sId1:e[n].skilleff1,sId2:e[n].skilleff2,name:e[n].name,desc:e[n].desc};i.push(o)}this.setListData(this.itemList,i)},e}(BaseEuiWindow);__reflect(SkillWin.prototype,"SkillWin");var StdSkill=function(){function t(){}return t}();__reflect(StdSkill.prototype,"StdSkill");var StdSkillRange=function(){function t(){this.xStart=0,this.xEnd=0,this.yStart=0,this.yEnd=0,this.rangeType=0,this.rangeCenter=0}return t}();__reflect(StdSkillRange.prototype,"StdSkillRange");var StdSkillEff=function(){function t(){}return t}();__reflect(StdSkillEff.prototype,"StdSkillEff");var UserSkill=function(){function t(){this.active=!0}return t.prototype.readAttr=function(t){this.nSkillId=t.readUnsignedShort(),this.nLevel=t.readUnsignedByte(),this.dwResumeTick=App.TimerManager.getSyncTime()+t.readUnsignedInt(),this.exp=t.readUnsignedInt(),t.readByte()},Object.defineProperty(t.prototype,"canUse",{get:function(){return this.active&&this.dwResumeTick<=App.TimerManager.getSyncTime()},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){t._pool.push(this)},t.create=function(e,i){var n=this._pool.shift();return!n&&(n=new t),n.nSkillId=e,n.nLevel=i,n.dwResumeTick=0,n},t._pool=[],t}();__reflect(UserSkill.prototype,"UserSkill");
var BattleManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.test=function(){for(var t=GameCache.hero.list,e=[],i=0,n=t;i<n.length;i++){var o=n[i],r=o.pro.clone(),a=GameCache.skill.getFightSkilList(r.pro(PropId.AP_ACTOR_ID));r.skillList=[];for(var s=0,h=a;s<h.length;s++){var p=h[s];r.skillList.push([p.nSkillId,p.nLevel])}r.charName="目标",r.kind=ThingKind.Human,r.pro(PropId.AP_X,o.cellXY.x+12),r.pro(PropId.AP_Y,o.cellXY.y),r.pro(PropId.AP_HP,100*r.pro(PropId.AP_HP)),r.pro(PropId.AP_MAX_HP,100*r.pro(PropId.AP_MAX_HP)),e.push(r)}this.start(e,null,null)},e.prototype.start=function(t,e,i){this.countDic={1:0,2:0};for(var n=0,o=GameCache.hero.list;n<o.length;n++){var r=o[n];r.pro.aiCamp=AICampType.BATTLE1,this.countDic[1]++}for(var a=GameCache.hero.mainPlayer.cellXY,s=0,h=t;s<h.length;s++){var p=h[s];p.pro(PropId.AP_X,a.x+8),p.pro(PropId.AP_Y,a.y),p.kind=ThingKind.Human,p.recog=App.ThingManager.createRecog(),p.aiCamp=AICampType.BATTLE2,p.hpType=null,p.fightAi=!0,App.ThingManager.createThing(p),this.countDic[2]++}e&&i&&(this.handler=Handler.create(i,e,null,!1)),GameCache.map.isAIMap=!0,App.FightManager.starAllAI(!0),App.MessageCenter.addListener(MsgConst.BATTLE_KILL,this.onKill,this)},e.prototype.exit=function(){GameCache.map.isAIMap=!1,App.MessageCenter.removeAll(this),App.FightManager.starAllAI(!1),this.handler&&(this.handler.dispose(),this.handler=null)},e.prototype.resetState=function(){for(var t=0,e=GameCache.hero.list;t<e.length;t++){var i=e[t];i.pro.aiCamp=AICampType.SELF,i.isDie&&i.reAlive(),i.pro.pro(PropId.AP_HP,i.pro.pro(PropId.AP_MAX_HP),i)}},e.prototype.onKill=function(t){t.pro.aiCamp==AICampType.BATTLE1?this.countDic[1]--:t.pro.aiCamp==AICampType.BATTLE2&&this.countDic[2]--,this.handler&&(this.handler.args=[this.countDic[1],this.countDic[2]],this.handler.run());for(var e in this.countDic)if(0==this.countDic[e])return void this.exit()},e}(BaseClass);__reflect(BattleManager.prototype,"BattleManager");var FightManager=function(t){function e(){var e=t.call(this)||this;return e.autoFight=!0,e.fightDic={},e.onHook=!1,e}return __extends(e,t),e.prototype.mapChange=function(){App.TimerManager.removeAll(this)},e.prototype.addFight=function(t){this.fightDic[t.user.pro.recog]=t,t.open=this.autoFight},e.prototype.removeFight=function(t){delete this.fightDic[t]},e.prototype.useSkill=function(t,e,i){if(GameCache.map.isAIMap)this.playUseSkill(t,i.cellXY.x,i.cellXY.y,e,i.pro.recog);else{var n=MathUtils.getDirByGridPoint(t.cellXY.x,t.cellXY.y,i.cellXY.x,i.cellXY.y);Proxy.skill.sendUseSkill(t.pro.isMainPlayer?0:t.pro.pro(PropId.AP_ACTOR_ID),e.nSkillId,i.pro.recog,i.cellXY.x,i.cellXY.y,n)}},e.prototype.playUseSkill=function(t,e,i,n,o){t.setBanHavior(0),t.playSkill(n,e,i,o)},e.prototype.playBeHitSkill=function(t,e,i){App.skillPlay.playHitEff(t,e,i.nSkillId),t&&e&&this.fightDic[e.pro.recog]&&this.fightDic[e.pro.recog].beHit(t)},e.prototype.postHitTarget=function(t,e,i,n,o){if(GameCache.map.isAIMap&&(!GameCache.pass.isOpen||t.pro.kind!=ThingKind.Monster)){var r=App.ThingManager.getThing(i);if(r&&!r.disappear&&!r.isDie){var a=(t.pro,r.pro,GameConfig.skill[e.nSkillId]),s=a.actRange&&a.actRange[0];if(s){var h=s.acts&&s.acts[0]&&s.acts[0].results&&s.acts[0].results;if(!h)return;if(0==s.rangeType||1==s.rangeType){if(r.isDie||r.disappear)return;this.doResult(h,t,r,e)}else{var p=void 0,l=void 0,c=void 0,u=void 0,d=void 0,g=void 0;if(0==s.rangeCenter||2==s.rangeCenter?(d=n,g=o):(d=t.cellXY.x,g=t.cellXY.y),p=d+s.xStart,l=d+s.xEnd,2==s.rangeType)c=u=g;else if(6==s.rangeType){var f=n>d?1:-1;n==d&&(f=t.getBodyDir()),c=g,u=g+s.yEnd,1==f?(p=d,l=d+s.xEnd):(p=d-s.xEnd,l=d)}else c=g+s.yStart,u=g+s.yEnd;GlobalVar.testSkill&&App.gameWorld.drawSkillRange(p,c,l,u);var m=AICampEnemy[t.pro.aiCamp];if(m){var y=App.ThingManager.getThingDic();for(var _ in y){var v=y[_];if(!v.isDie&&!v.disappear&&-1!=m.indexOf(v.pro.aiCamp)){var C=v.cellXY.x,I=v.cellXY.y;p>C||C>l||c>I||I>u||this.doResult(h,t,v,e)}}}}}}}},e.prototype.doResult=function(t,e,i,n){for(var o=0,r=t.length;r>o&&(!i.isDie&&!i.disappear);o++){var a=t[o],s=e.pro.pro(PropId.AP_ATTACK),h=e.pro.pro(PropId.AP_CRIT),p=e.pro.pro(PropId.AP_CRIT_HURT),l=i.pro.pro(PropId.AP_DEFENCE),c=GameConfig.globalConfig.DEF,u=i.pro.pro(PropId.AP_DAMAGE_DEC),d=i.pro.pro(PropId.AP_UNCRIT),g=GameConfig.globalConfig.CRIT_MAX,f=GameConfig.globalConfig.CRIT_MIN,m=Math.random()>.5?1:-1;m=Math.random()*GameConfig.globalConfig.DMG_FLOAT*m/1e4,m=1-m;var y=e.pro.pro(PropId.AP_DAMAGE_INC),_=e.pro.pro(PropId.AP_DAMAGE_EXT);s=(s*a.id/1e4+a.value)*(1+y)*(1-l/(l+c))*(1-u)*m+_>>0;var v=Math.min(Math.max(h-d,f),g)/1e4,C=Math.random(),I=v>=C;I&&(s=s*GameConfig.globalConfig.CRIT_RATE*(1+p)),this.calHurt(s,i,a.resultType,a.delay,I),this.playBeHitSkill(e,i,n)}},e.prototype.calHurt=function(t,e,i,n,o){var r=HurtType.NORMAL,a=e.pro;0>=t&&(t=1);var s=t;GameCache.pass.isOpen&&(t=1);var h=a.pro(PropId.AP_HP)-t;0>=h?(GameCache.pass.isOpen||(s=a.pro(PropId.AP_HP)),e.die(),App.MessageCenter.dispatch(MsgConst.BATTLE_KILL,e)):a.pro(PropId.AP_HP,h,e),GameCache.hero.isMySelf(e.pro.recog)&&(r=HurtType.SELF),n?App.TimerManager.addDelay(n,1,1,App.HurtTxtManager.play,App.HurtTxtManager,null,null,a.recog,s,o,r,e):App.HurtTxtManager.play(a.recog,s,o,r,e)},e.prototype.starAllAI=function(t){for(var e in this.fightDic)this.fightDic[e].open=t,this.autoFight=t},e.prototype.setFightTarget=function(t){if(t&&(t.isDie||t.disappear))return void this.heroStart(!1);for(var e=GameCache.hero.list,i=0,n=e;i<n.length;i++){var o=n[i],r=o.pro.recog,a=this.fightDic[r];a.target=t}this.heroStart(!0)},e.prototype.heroStart=function(t,e){void 0===e&&(e=0),this.onHook=t;for(var i=GameCache.hero.list,n=0,o=i;n<o.length;n++){var r=o[n],a=r.pro.recog,s=this.fightDic[a];s.open=t,s.monsterId=e,t||(s.target=null)}t||GameCache.map.isHookMap()&&GameCache.map.dataInit&&(App.TimerManager.isExists(this.startHook,this)||App.TimerManager.addDelay(5e3,1,1,this.startHook,this))},e.prototype.startHook=function(){GameCache.map.dataInit&&this.heroStart(!0)},e.prototype.setUseSKill=function(t,e){var i=GameCache.hero.mainPro.recog,n=this.fightDic[i];e&&(n.foreverSkill=t),n.useSkill=t},e}(BaseClass);__reflect(FightManager.prototype,"FightManager");var HurtTxtManager=function(t){function e(){var e=t.call(this)||this;return e.hurtDic={},e.volist=[],App.TimerManager.addFrame(10,e.onTimer,e),e}return __extends(e,t),e.prototype.onTimer=function(){var t=0,e=this.volist.length;if(e>10&&(this.volist.splice(0,e-10),e=10),0!=e){for(var i={};e>t;t++){var n=this.volist[t];if(n.actor&&n.actor.pro){var o=1e3*n.actor.cellXY.y+Math.floor(n.actor.cellXY.x/5),r=void 0;n.type!=HurtType.SELF?(r=i[o],r||(r=i[o]=[]),r.push(n),n.y=n.actor.y-120,n.x=n.actor.x+40*(1&r.length),n.delay=r.length-1):(n.y=n.actor.y-120,n.x=n.actor.x,this.playSingle(n,1))}}this.volist.length=0;for(var a in i)for(var r=i[a],s=0,h=r.length;h>s;s++)this.playSingle(r[s],h-1);i=null}},e.prototype.playSingle=function(t,e){var i=ObjectPool.get(HurtTxt);App.ThingManager.titleLayer.addChild(i),i.y=t.y,i.x=t.x,i.setData(t.recog,t.value,t.type,t.bon,t.delay,e);var n=this.hurtDic[t.recog];n||(n=this.hurtDic[t.recog]=[]),n.push(i),t.dispose(),ObjectPool.push(t)},e.prototype.play=function(t,e,i,n,o){if(o&&o.isInView){var r=ObjectPool.get(HurtVo);r.recog=t,r.value=e,r.bon=i,r.type=n,r.actor=o,this.volist.push(r)}},e.prototype.remove=function(t,e){if(void 0===e&&(e=!0),egret.Tween.removeTweens(t),App.DisplayUtils.removeFromParent(t),ObjectPool.push(t),e){var i=this.hurtDic[t.recog];if(i){for(var n=0,o=i.length;o>n;n++)if(i[n]==t){i.splice(n,1),n--,o--;break}0==o&&delete this.hurtDic[t.recog]}}},e.prototype.removeAll=function(){for(var t in this.hurtDic){var e=this.hurtDic[t];if(e)for(var i=0,n=e.length;n>i;i++)this.remove(e[i],!1)}this.hurtDic={}},e}(BaseClass);__reflect(HurtTxtManager.prototype,"HurtTxtManager");var HurtTxt=function(t){function e(){var e=t.call(this)||this;return e._value=0,e._type="0",e.touchEnabled=e.touchChildren=!1,e._gap=-16,e._numCon=new egret.DisplayObjectContainer,e.addChild(e._numCon),e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.setData=function(t,e,i,n,o,r){this.recog=t,this._type=this.getType(i,n),this._value=0!=e?e:SpecialHurtBm.MISS,this.upNumber(),this.scaleX=this.scaleY=1,this.alpha=1,this.x=this.x-(this.width>>1);var a=egret.Tween.get(this);if(o&&(this.visible=!1,a=a.wait(50*o).call(this.onAdd,this)),i==HurtType.NORMAL){this.scaleX=this.scaleY=1;var s=1.2;a.to({scaleX:s,scaleY:s,y:this.y-60},50,egret.Ease.cubicOut),a.to({scaleX:.6,scaleY:.6,alpha:0,y:this.y-280},1e3,egret.Ease.cubicInOut).call(this.dispose,this)}else i==HurtType.SELF&&a.to({y:this.y-120,alpha:0},1500).call(this.dispose,this)},e.prototype.upNumber=function(){for(var t,e=this._value+"",i=0,n=this._numCon.numChildren,o=e.length,r=0;o>r;r++)n>r?t=this._numCon.getChildAt(r):(t=ObjectPool.get(egret.Bitmap),this._numCon.addChild(t)),0==r?(t.scaleX=t.scaleY=1,t.y=0):(t.scaleX=t.scaleY=MathUtils.limit(.9,.95),t.y=1==(1&r)?5:3),t.texture=this.getSingleNumPic(e.charAt(r),this._type),t.x=i,i=t.x+t.width+this._gap;for(;n>o;){var a=this._numCon.removeChildAt(r);this.poolBit(a),o++}t&&(this.width=t.x+t.width,this.height=t.height)},e.prototype.onAdd=function(){this.visible=!0},e.prototype.getType=function(t,e){return t==HurtType.SELF?"sel":t==HurtType.NORMAL?e?"bon":"nor":void 0},e.prototype.getSingleNumPic=function(t,e){return"."==t&&(t="dot"),RES.getRes(e+"_"+t+"_png")},e.prototype.poolBit=function(t){t.scaleX=t.scaleY=1,t.x=t.y=0,ObjectPool.push(t)},e.prototype.dispose=function(){App.HurtTxtManager.remove(this)},e}(egret.DisplayObjectContainer);__reflect(HurtTxt.prototype,"HurtTxt");var HurtVo=function(){function t(){}return t.prototype.dispose=function(){this.recog=null,this.value=null,this.bon=!1,this.type=null,this.actor=null,this.x=null,this.y=null,this.delay=null},t}();__reflect(HurtVo.prototype,"HurtVo");var HurtType=function(){function t(){}return t.SELF=-1,t.NORMAL=0,t.CRIT=1,t}();__reflect(HurtType.prototype,"HurtType");var SpecialHurtBm=function(){function t(){}return t.MISS="m",t}();__reflect(SpecialHurtBm.prototype,"SpecialHurtBm");var SkillPlayManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.play=function(t,e,i,n,o){var r=GameConfig.skill[e.nSkillId];this.playId(t,r.skilleff1,t.cellXY.x,t.cellXY.y,i,n,o,e)},e.prototype.playId=function(t,e,i,n,o,r,a,s){var h=GameConfig.skillEff[e];h&&(h.delay?App.TimerManager.addDelay(h.delay,1,1,this.useEff,this,null,null,t,h,s,i,n,o,r,a,GameCache.map.mapId):this.useEff(t,h,s,i,n,o,r,a,GameCache.map.mapId),h.hiteff&&1!=h.type&&this.postBeHit(t,s,a,o,r))},e.prototype.useEff=function(t,e,i,n,o,r,a,s,h){if(GameCache.map.mapId==h&&t.pro){e.shake&&GameCache.hero.isMySelf(t.pro.recog)&&App.gameWorld.shake();var p=0;n>r?p=-1:r>n&&(p=1);var l=this,c=l.createMc(e,null,t,n,o,!1,0,p);if(c){if(1==e.type||2==e.type){e.flyDis&&(r=n+p*e.flyDis);var u=(r+.5)*GameCache.map.cellWidth+(e.offsetX?e.offsetX:0),d=(a+.5)*GameCache.map.cellHeight+(e.offsetY?e.offsetY:0),g=MathUtils.getDistance(c.x,c.y,u,d),f=MathUtils.getAngle(MathUtils.getRadian2(c.x,c.y,u,d));c.rotation=f+90;var m=egret.Tween.get(c);m.to({x:u,y:d},g/e.flySpeed*1e3).call(function(){c.dispose(),GameCache.map.mapId==h&&1==e.type&&e.hiteff&&l.postBeHit(t,i,s,r,a)})}e.nextId&&l.playId(t,e.nextId,n,o,r,a,s,i)}else 1==e.type&&e.hiteff&&l.postBeHit(t,i,s,r,a),e.nextId&&l.playId(t,e.nextId,n,o,r,a,s,i)}},e.prototype.postBeHit=function(t,e,i,n,o){App.FightManager.postHitTarget(t,e,i,n,o)},e.prototype.playHitEff=function(t,e,i){var n=GameConfig.skill[i];if(n&&n.skilleff2){var o=GameConfig.skillEff[n.skilleff2];o&&(o.delay?App.TimerManager.addDelay(o.delay,0,1,this.createMc,this,null,null,o,t,e,e.cellXY.x,e.cellXY.y,!0,i):this.createMc(GameConfig.skillEff[n.skilleff2],t,e,e.cellXY.x,e.cellXY.y,!0,i))}},e.prototype.createMc=function(t,e,i,n,o,r,a,s){if(void 0===r&&(r=!1),void 0===a&&(a=0),void 0===s&&(s=0),!i.pro)return null;if(r&&i){var h=GameConfig.skill[a];h&&h.action2&&(i.isDie||i.disappear||(i.action==ActionStandard.SA_IDLE&&i.updateBodyDir(i.cellXY.x,e.cellXY.x),i.playAction(h.action2,1)))}if(!t||!t.eff)return null;if(SkillMovieClip.num>=12&&!GameCache.hero.isMySelf(i.pro.recog))return null;t.music&&App.SoundManager.playEffect(t.music);var p=SkillMovieClip.create();p.rotation=0,p.loadFile(RES_DIR_SKILLEFF+t.eff,t.playCount?t.playCount:0);var l=t.layer;3==l?(App.ThingManager.bottomLayer.addChild(p),p.x=(n+.5)*GameCache.map.cellWidth,p.y=(o+.5)*GameCache.map.cellHeight):4==l?(App.ThingManager.titleLayer.addChild(p),p.x=(n+.5)*GameCache.map.cellWidth,p.y=(o+.5)*GameCache.map.cellHeight):1==l?(i&&i.addChildAt(p,0),p.x=0,p.y=0):(i&&i.addChild(p),p.x=0,p.y=0),t.hasDir&&(s?p.scaleX=s:p.scaleX=i.getBodyDir());var c=t.offsetX?t.offsetX:0,u=t.offsetY?t.offsetY:0;return-1==u&&(u=-(i.height>>1)),p.x+=c*p.scaleX,p.y+=u,p},e}(BaseClass);__reflect(SkillPlayManager.prototype,"SkillPlayManager");var StrengthCache=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.estimateLvl=function(t,e,i){var n=GameCache.hero.getDataByIndex(i,GameCache.equip.roleStrengthList);if(n){var o=n[n.length-1],r=n.indexOf(o),a=GameConfig.strengthProp.Equip[o+1];a||(r=9);var s=0,h=0;return h=r>t?r-t:10-t+r,9*s+h}},e.prototype.carculate=function(t){for(var e in t){var i=GameCache.bag.itemCount(e)>t[e];if(!i)return!1}return!0},e.prototype.clear=function(){},e.prototype.getStrengthProp=function(t,e){var i=GameConfig.strengthProp.Equip[t],n=i["part"+e];return n},e.prototype.getRefineProp=function(t,e){var i=GameConfig.refine.ReEquip[t],n=i["part"+e];return n},e.prototype.checkStrengthGrade=function(t){if(!t){for(var e=GameCache.hero.list,i=0;i<e.length;i++)if(this.checkStrengthGrade(e[i].id))return!0;return!1}var n=GameCache.equip.roleStrengthList[t],o=n?n[n.length-1]:0;if(o+=1,o>GameCache.hero.mainPro.pro(PropId.AP_LEVEL))return!1;var r=GameConfig.strengthCost[o];if(r){var a=GameCache.bag.itemCount(r.consume[0].id);return a>=r.consume[0].count}},e.prototype.checkRefineGrade=function(t,e){if(!t){for(var i=GameCache.hero.list,n=0;n<i.length;n++)for(var o=0;10>o;o++)if(this.checkRefineGrade(i[n].id,o))return!0;return!1}var r=GameCache.equip.roleRefineList[t],a=r?r[e]:0;a+=1;var s=GameCache.equip.roleEquipList[t];if(!s||!s[e])return!1;if(a>GameCache.hero.mainPro.pro(PropId.AP_LEVEL))return!1;var h=GameConfig.strengthCost[a],p=GameCache.bag.itemCount(h.reconsume[0].id),l=GameCache.hero.mainPro.pro(PropId.AP_COIN);return p>=h.reconsume[0].count&&l>=h.reconsume[1].count},e}(BaseCache);__reflect(StrengthCache.prototype,"StrengthCache");var StrengthMasterTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="StrengthMasterTipsSkin",e}return __extends(e,t),e.prototype.init=function(){},e.prototype.open=function(t){this.initData(t.exData1,t.exData2)},e.prototype.initData=function(t,e){var i,n;switch(e){case 1:i=GameCache.hero.getDataByIndex(t,GameCache.equip.roleStrengthList),n=GameConfig.strengthProp.Master,this.icon.source="strength_json.strength_master_png";break;case 2:i=GameCache.hero.getDataByIndex(t,GameCache.equip.roleRefineList),n=GameConfig.refine.ReMaster,this.icon.source="strength_json.strength_refineMaster_png"}var o=0;i&&(o=i[i.length-1]);var r=Math.floor(o/10),a=r+1;this.currentState=n[a]?"s1":"s2",this.prop_0.setData(n[r].attrs,[],0,8548214,8548214,8548214,["+",""]),this.zdl_0.text="+"+ItemUtils.getZdlByProp(n[r].attrs),n[a]?(this.prop_1.setData(n[a].attrs,[],0,16777215,16777215,16777215,["+",""]),this.zdl_1.text="+"+ItemUtils.getZdlByProp(n[a].attrs)):a=r;for(var s in n){if(n[s].level>o){this.mPro.text=o+"/"+n[s].level;break}this.mLvl.text=StringUtils.substitute(Language.lang.jie,s),this.num.value=s}},e}(BaseEuiWindow);__reflect(StrengthMasterTips.prototype,"StrengthMasterTips");var StrengthPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.curIdx=0,i.upDataEnable=!0,i.zValue=1,i.curLvl=0,i.skinName="StrengthPannelSkin",i}return __extends(e,t),e.prototype.init=function(){if(t.prototype.init.call(this),this.roleSelect.setHandler(this,this.onCLick),this.initPartName(),!this.mc2){var e=App.DisplayUtils.addEffectToObj(this,"chuizi_eff_0_1",-1,266,284);this.mc2=e}this.mc2.play(-1),this.mc2.visible=!0,this.num.gap=14},e.red=function(){return GameCache.strength.checkStrengthGrade()},e.prototype.roleRed=function(t){return GameCache.strength.checkStrengthGrade(t)},e.changeMsg=function(){return[MsgConst.EQUIP_STRENGTH,MsgConst.NEW_HERO]},e.prototype.refreshRed=function(){t.prototype.refreshRed.call(this),this.showRed()},e.prototype.open=function(t){this.onCLick(),this.addTouchEvent(this.sBtn,this.strengthFunc),this.addTouchEvent(this.mBtn,this.openMaster),this.message(MsgConst.EQUIP_STRENGTH,this.setPlay)},e.prototype.onCLick=function(){var t=this.roleSelect.nSlRole,e=GameCache.hero.getDataByIndex(t,GameCache.equip.roleEquipList);this.zdl.value="+0",App.TimerManager.removeAll(this),this.initEquipItem(e),this.initData(),this.initZDL()},e.prototype.clsoe=function(t){App.TimerManager.removeAll(this)},e.prototype.initPartName=function(){for(var t=0;10>t;t++){var e=this["item_"+t];e.partSource="strength_json.strength_text_part"+t+"_png",e.touchEnabled=!1}},e.prototype.initEquipItem=function(t){t||(t=[]),this.upDataEnable=!0;for(var e=0;10>e;e++){var i=t[e],n=this.roleSelect.roleId+"",o=GameCache.equip.roleStrengthList[n],r=o&&o[e]?o[e]:0,a=this["item_"+e];a.color.visible=!1,i?(a.data=i,a.setHandler(this,this.openItemTips,[i])):(this.upDataEnable=!0,a.reSet()),a.strengthLvl=[r],a.setIconImg("strength_json.strength_part"+e+"_png"),a.select=!1}},e.prototype.initData=function(){var t=this.roleSelect.roleId+"",e=GameCache.equip.roleStrengthList[t],i=0,n=0;e&&(n=e[e.length-1],i=e.indexOf(n));var o=GameConfig.strengthProp.Equip[n+1];GameConfig.strengthProp.Equip[n];o||(i=9),this.curIdx=i,this.curLvl=n,this.initProp(n,i),this["item_"+i].select=!0;var r=GameConfig.strengthCost[n+1];this.cost_0.visible=r?!0:!1,r&&this.cost_0.setData(r.consume[0].id,r.consume[0].count)},e.prototype.initProp=function(t,e){var i=GameConfig.strengthProp.Equip[t+1],n=GameConfig.strengthProp.Equip[t],o=n["part"+e],r=i?i["part"+e]:null;this.propList.setData(o,r,this.roleSelect.job,16762368,16777215,65292,[],"PropItem2Skin")},e.prototype.initZDL=function(){var t=this.roleSelect.roleId+"",e=GameCache.equip.roleStrengthList[t],i=0;if(e){for(var n=0;10>n;n++){var o=e[n];if(0!=o){var r=GameConfig.strengthProp.Equip[o];i+=ItemUtils.getZdlByProp(r["part"+n])}}this.zdl.value="+"+i}else this.zdl.value=0;var a=e&&e[e.length-1]?e[e.length-1]:0,s=GameConfig.strengthProp.Master;for(var n in s){if(s[n].level>a){this.mPro.text=a+"/"+s[n].level;break}this.num.value=n}},e.prototype.setPlay=function(){if(!App.TimerManager.isExists(this.effPlay,this)){var t=GameCache.strength.estimateLvl(this.curIdx,this.curLvl,this.roleSelect.nSlRole),e=t;if(this.tarIdx=this.curIdx,0==e)return;App.TimerManager.addDelay(0,200,e,this.effPlay,this,this.onCLick,this)}this.showEff()},e.prototype.effPlay=function(){this.oldIdx=this.tarIdx,this.tarIdx=9==this.tarIdx?0:this.tarIdx+1;var t=this["item_"+this.tarIdx],e=this["item_"+this.oldIdx];e.select=!1,t.select=!0,e.strengthLvl=[e.strenghLvl+1],App.SoundManager.playEffect(SoundType.STRENGTH),this.initProp(e.strenghLvl||1,this.tarIdx)},e.prototype.showEff=function(){App.DisplayUtils.addEffectToObj(this,"qianghua_cg_0_1",1,270,380)},e.prototype.strengthFunc=function(){this.upDataEnable?this.cost_0.checkEnough()&&(this.curLvl==GameCache.hero.mainPro.pro(PropId.AP_LEVEL)&&GlobalFun.SysMsg(Language.lang.strengthLvlMax),Proxy.equip.sendEquipStrength(this.roleSelect.nSlRole)):GlobalFun.SysMsg(Language.lang.strengthPart)},e.prototype.openItemTips=function(t){var e,i=t,n=new ViewProp,o=this.roleSelect.roleId+"",r=GameCache.equip.roleStrengthList[o],a=r&&r[i.stdItem.part]?r[i.stdItem.part]:1,s=GameConfig.strengthProp.Equip[a];s&&(e=s["part"+i.stdItem.part]),n.itemData=i.stdItem,n.exData1=i,n.exData2=e,App.ViewManager.open(ViewConst.ITEMTIPS,n)},e.prototype.openMaster=function(){var t=new ViewProp;t.exData1=this.roleSelect.nSlRole,t.exData2=1,App.ViewManager.open(ViewConst.STRENGTHMASTER,t)},e.prototype.showRed=function(){App.ViewManager.showRedPoint(this.sBtn,GameCache.strength.checkStrengthGrade(this.roleSelect.roleId))},e}(BaseSpriteView);__reflect(StrengthPannel.prototype,"StrengthPannel");var StrengthWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPageWin);__reflect(StrengthWin.prototype,"StrengthWin");var SuitItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SuitItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.imgItem.source=GlobalFun.getItemSourceById(GameCache.suit.nResolveId),this.addTouchEvent(this.eBtn,this.onClick)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data.item){var e=GameConfig.item[this.data.item];if(e){this.lbLv.text="Lv"+this.data.level,this.lbLv.textColor=ItemUtils.getItemColor(e.showQuality),this.lbNe.textFlow=TextFlowUtils.generateTextFlow(ItemUtils.getItemNamewithColor(e));var i=1e4;GameConfig.equipExchange[this.data.item]&&GameConfig.equipExchange[this.data.item].needNum&&GameConfig.equipExchange[this.data.item].needNum[0]&&(this.lbNum.text=GameConfig.equipExchange[this.data.item]?"X"+GameConfig.equipExchange[this.data.item].needNum[0].count:"",i=GameConfig.equipExchange[this.data.item].needNum[0].count);var n=GameCache.bag.itemCount(e.id)>0,o=!1;n||(o=GameCache.bag.itemCount(GameCache.suit.nResolveId)>=i);var r=GameCache.equip.bEquip(e);o&&r&&(o=!1),App.ViewManager.showRedPoint(this.eBtn,o),this.num.value=ItemUtils.getItemZDL(e),this.setPower(e),this.itemBase.data=e}}},e.prototype.onClick=function(){Proxy.suit.sendSuitChange(this.data.roleId,this.data.item,1)},e.prototype.setPower=function(t){this.gZll.visible=0!=this.data.gap,this.imgAdd.source=this.data.gap>0?"public_json.public_add_2_png":"public_json.public_minus_1_png",this.imgZl.source=this.data.gap>0?"public_json.public_zhanli_2_png":"public_json.public_zhanli_1_png",this.num.type=this.data.gap>0?"num_yellow_1_":"num_green_1_",this.num.value=Math.abs(this.data.gap);var e="";this.data.gap>0?e="public_json.public_g_allow_png":this.data.gap<0&&(e="public_json.public_r_allow_png"),this.itemBase.setMarkImg(e)},e}(BaseCustComponent);__reflect(SuitItem.prototype,"SuitItem");var SuitPropertyItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SuitPropertyItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.eBtn,this.onClick)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.name&&(this.prop.setData(this.data.att,[]),this.lbNe.text=this.data.name,this.prop.setSortType("hor"),this.lbLv.textFlow=TextFlowUtils.generateTextFlow(this.data.dec),this.num.value=ItemUtils.getZdlByProp(this.data.att),this.eBtn.visible=this.data.sortId<1e3,this.eBtn.source=this.data.eqLv>=this.data.showlevel?"res/btn/activate_1.png":"res/btn/activate_2.png")},e.prototype.onClick=function(){this.data.eqLv>=this.data.showlevel?Proxy.suit.sendSuitGetLv(this.data.roleId,this.data.level):GlobalFun.SysMsg(Language.lang.suit1)},e}(BaseCustComponent);__reflect(SuitPropertyItem.prototype,"SuitPropertyItem");var SuitPropertyWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.listData=[],e.skinName="SuitPropertyWinSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.cfg=GameConfig.equipAddition,this.list.itemRenderer=SuitPropertyItem,this.setWinTitleHold("suit_json.suit_title_tzfx_png")},e.prototype.open=function(e){t.prototype.open.call(this),this.serverRoleId=e.exData1,this.roleId=e.exData2,this.message(MsgConst.SUIT_CHANGE,this.upList),this.message(MsgConst.SUIT_INFO,this.upCn),this.message(MsgConst.SUIT_INFO,this.upList),this.upList(),Proxy.equip.sendQueryMyEquip(),this.upCn()},e.prototype.upCn=function(){this.num.text=GameCache.suit.roleSuit[this.roleId]?GameCache.suit.roleSuit[this.roleId].fight+"":"0"},e.prototype.upList=function(){this.listData=[];for(var t in this.cfg){var e=CommonUtils.copyDataHandler(this.cfg[t]);e.roleId=this.serverRoleId;var i=this.cfg[t].level;e.sortId=i;var n=GameCache.equip.roleEquipList[this.roleId];if(e.eqLv=0,e.fight=GameCache.suit.roleSuit[this.roleId].fight||0,n)for(var o in n){var r=n[o];r&&r.stdItem&&r.stdItem.level&&6==r.stdItem.showQuality&&(e.eqLv=e.eqLv+r.stdItem.level)}if(GameCache.suit.roleSuit[this.roleId]&&GameCache.suit.roleSuit[this.roleId].lvList){var a=GameCache.suit.roleSuit[this.roleId].lvList.indexOf(e.level);a>-1&&(e.sortId=e.sortId+1e3)}this.listData.push(e)}this.listData.sort(this.sort),this.setListData(this.list,this.listData)},e.prototype.sort=function(t,e){return t.sortId-e.sortId},e}(BaseEuiWindow);__reflect(SuitPropertyWin.prototype,"SuitPropertyWin");var SuitResolveItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SuitResolveItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.eBtn,this.onClick)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.id&&(this.lbNe.textFlow=TextFlowUtils.generateTextFlow(ItemUtils.getItemNamewithColor(this.data)),this.imgItem.source=GlobalFun.getItemSourceById(GameCache.suit.nResolveId),GameConfig.equipExchange[this.data.id]&&GameConfig.equipExchange[this.data.id].needNum[0]&&(this.lbNum.text=GameConfig.equipExchange[this.data.id]?"X"+GameConfig.equipExchange[this.data.id].needNum[0].count:""),this.itemBase.data=this.data.id)},e.prototype.onClick=function(){Proxy.suit.sendSuitResolve(this.data.roleId,this.data.id,1)},e}(BaseCustComponent);__reflect(SuitResolveItem.prototype,"SuitResolveItem");var SuitResolveWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.resolveList=[],e.skinName="SuitResolveWinSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.list.itemRenderer=SuitResolveItem,this.setWinTitleHold("suit_json.suit_title_tzfj_png")},e.prototype.open=function(e){t.prototype.open.call(this),this.roleId=e.exData1,this.upList(),this.addTouchEvent(this.btn,this.onclick),this.message(MsgConst.SUIT_RESOLVE,this.upList),this.message(MsgConst.BAG_ITEM_NUM,this.upList),this.message(MsgConst.SUIT_INFO,this.upList)},e.prototype.upList=function(){this.resolveList=GameCache.suit.sortResolveList(),this.setListData(this.list,this.resolveList)},e.prototype.onclick=function(){Proxy.suit.sendSuitAllResolve(this.roleId,this.resolveList)},e}(BaseEuiWindow);__reflect(SuitResolveWin.prototype,"SuitResolveWin");var SuitView=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.nSlRole=0,i.listSuitInfo=[],i.skinName="SuitViewSkin",i}return __extends(e,t),e.prototype.init=function(){this.list.itemRenderer=SuitItem,this.roleSelect.setHandler(this,this.roleClick),this.imgItem.source=GlobalFun.getItemSourceById(GameCache.suit.nResolveId)},e.red=function(){if(!GameCache.suit)return!1;if(GameCache.suit.sortResolveList().length>0)return!0;for(var t in GameCache.hero.list){var e=GameCache.hero.list[t];if(GameCache.suit.suitPropertyList(e.id))return!0;if(GameCache.suit.suitChangeListRed(e.pro.job,e.id))return!0}return!1},e.prototype.roleRed=function(t){return GameCache.suit.suitPropertyList(t)?!0:GameCache.suit.suitChangeListRed(GameCache.hero.getJobByRoleId(t),t)?!0:!1},e.changeMsg=function(){return[MsgConst.SUIT_CHANGE,MsgConst.SUIT_RESOLVE,MsgConst.SUIT_INFO]},e.prototype.refreshRed=function(){t.prototype.refreshRed.call(this),GameCache.suit&&(App.ViewManager.showRedPoint(this.gResolve,GameCache.suit.sortResolveRed()),App.ViewManager.showRedPoint(this.gProperty,GameCache.suit.suitPropertyList(this.roleSelect.roleId)))},e.prototype.open=function(t){void 0===t&&(t=null),this.addTouchEvent(this.imgProperty,this.onClick),this.addTouchEvent(this.imgResolve,this.onClick),this.message(MsgConst.BAG_ITEM_NUM+GameCache.suit.nResolveId,this.updateHaveItem),this.message(MsgConst.SUIT_CHANGE,this.upList),this.message(MsgConst.EQUIP_INFO,this.upList),this.upList(),this.updateHaveItem()},e.prototype.upList=function(){this.listSuitInfo=GameCache.suit.suitChangeList(this.roleSelect.job,this.roleSelect.serverId,this.roleSelect.roleId),this.setListData(this.list,this.listSuitInfo)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.imgProperty:var e=new ViewProp;e.exData1=this.roleSelect.serverId,e.exData2=this.roleSelect.roleId,App.ViewManager.open(ViewConst.SUITPROPERTY,e);break;case this.imgResolve:var i=new ViewProp;i.exData1=GameCache.hero.getServerIdByIndex(0),App.ViewManager.open(ViewConst.SUITRESOLVE,i)}},e.prototype.updateHaveItem=function(){this.lbNum.text=GameCache.bag.itemCount(GameCache.suit.nResolveId)+"",this.upList()},e.prototype.roleClick=function(t){this.nSlRole=t,this.upList()},e}(BaseSpriteView);__reflect(SuitView.prototype,"SuitView");var SuitCache=function(t){function e(){var e=t.call(this)||this;return e.roleSuit={},e.nResolveId=16,e}return __extends(e,t),e.prototype.clear=function(){this.roleSuit={}},e.prototype.initStList=function(t,e,i){var n={lv:1,lvList:[],fight:0},o=i.length>0?Math.max.apply(null,i):1;n.lv=o,n.lvList=i,n.fight=e,this.roleSuit[t]=n},e.prototype.upStList=function(t,e,i){var n=this.roleSuit[t];if(n){n.lvList.push(i),n.fight=e;var o=n.lvList.length>0?Math.max.apply(null,n.lvList):1;n.lv=o}else{var r={lv:1,lvList:[],fight:0};r.lv=i,r.lvList.push(i),r.fight=e,this.roleSuit[t]=r}},e.prototype.suitChangeList=function(t,e,i){var n=[],o=GameCache.hero.mainPro?GameCache.hero.mainPro.pro(PropId.AP_LEVEL):1;o=10>o?1:10*Math.floor(o/10);var r=GameConfig.equipExchangeLevel[t][o];if(!r)return[];for(var a in r){var s=CommonUtils.copyDataHandler(r[a]);s.gap=0,s.roleId=e;var h=GameConfig.item[s.item];if(h){var p=ItemUtils.getItemZDL(h),l=GameCache.equip.roleEquipList[i];l&&l[h.part]?s.gap=p-ItemUtils.getItemZDL(l[h.part].stdItem):s.gap=p,n.push(s)}}return n.sort(this.sort),n},e.prototype.sort=function(t,e){return t.gab-e.gab},e.prototype.sortResolveList=function(){var t=[],e=GameCache.bag.getBagByType(BagType.BAG_TYPE_EQUIP);for(var i in e){var n=e[i];if(6==n.stdItem.showQuality)for(var o in GameCache.equip.roleEquipList){var r=GameCache.equip.roleEquipList[o],a=r[n.stdItem.part];a&&ItemUtils.getItemZDL(n.stdItem)<=ItemUtils.getItemZDL(a.stdItem)&&t.push(n.stdItem)}}return t},e.prototype.sortResolveRed=function(){var t=GameCache.bag.getBagByType(BagType.BAG_TYPE_EQUIP);for(var e in t){var i=t[e];if(6==i.stdItem.showQuality)for(var n in GameCache.equip.roleEquipList){var o=GameCache.equip.roleEquipList[n],r=o[i.stdItem.part];if(r&&ItemUtils.getItemZDL(i.stdItem)<=ItemUtils.getItemZDL(r.stdItem))return!0}}return!1},e.prototype.suitPropertyList=function(t){var e=GameCache.equip.roleEquipList[t],i=0;if(e)for(var n in e){var o=e[n];o&&o.stdItem&&o.stdItem.level&&6==o.stdItem.showQuality&&(i+=o.stdItem.level)}for(var r in GameConfig.equipAddition){var a=GameConfig.equipAddition[r],s=GameCache.suit.roleSuit[t].lvList.indexOf(a.level);if(i>=a.showlevel&&-1==s)return!0}return!1},e.prototype.suitChangeListRed=function(t,e){var i=GameCache.hero.mainPro?GameCache.hero.mainPro.pro(PropId.AP_LEVEL):1;i=10>i?1:10*Math.floor(i/10);var n=GameConfig.equipExchangeLevel[t][i];if(!n)return!1;for(var o in n){var r=n[o].item,a=GameConfig.equipExchange[r]?GameConfig.equipExchange[r].needNum[0].count:0;if(GameCache.bag.itemCount(this.nResolveId)>=a)return!0}return!1},e}(BaseCache);__reflect(SuitCache.prototype,"SuitCache");var SuitProxy=function(t){function e(){var e=t.call(this,PacketTypes.EQUIP)||this;return e.regNetMsg(26,e.doSuitResolve),e.regNetMsg(27,e.doSuitChange),e.regNetMsg(28,e.doSuitInfo),e.regNetMsg(29,e.doSuitInfoOnce),e
}return __extends(e,t),e.prototype.doSuitResolve=function(t){var e=t.readBoolean();if(e)App.MessageCenter.dispatch(MsgConst.SUIT_RESOLVE);else{var i=t.readInt();i&&GameConfig.errotips[i]&&GlobalFun.SysMsg(GameConfig.errotips[i].dec)}},e.prototype.doSuitChange=function(t){var e=t.readBoolean();if(e)App.MessageCenter.dispatch(MsgConst.SUIT_CHANGE);else{var i=t.readInt();i&&GameConfig.errotips[i]&&GlobalFun.SysMsg(GameConfig.errotips[i].dec)}},e.prototype.doSuitInfo=function(t){for(var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=t.readInt(),n=t.readInt(),o=[],r=0;n>r;r++)o.push(t.readInt());GameCache.suit.initStList(e,i,o),App.MessageCenter.dispatch(MsgConst.SUIT_INFO)},e.prototype.doSuitInfoOnce=function(t){var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=t.readInt(),n=t.readInt();GameCache.suit.upStList(e,i,n),App.MessageCenter.dispatch(MsgConst.SUIT_INFO)},e.prototype.sendSuitResolve=function(t,e,i){var n=this.getBytes(28);n.writeUnsignedInt(t),n.writeInt(e),n.writeInt(i),this.sendToServer(n)},e.prototype.sendSuitChange=function(t,e,i){var n=this.getBytes(29);n.writeUnsignedInt(t),n.writeInt(e),n.writeInt(i),this.sendToServer(n)},e.prototype.sendSuitGetLv=function(t,e){var i=this.getBytes(30);i.writeUnsignedInt(t),i.writeInt(e),this.sendToServer(i)},e.prototype.sendSuitAllResolve=function(t,e){var i=this.getBytes(31);i.writeUnsignedInt(t),i.writeUnsignedInt(e.length);for(var n=0;n<e.length;n++)i.writeInt(e[n].id);this.sendToServer(i)},e}(BaseProxy);__reflect(SuitProxy.prototype,"SuitProxy");var SysOpenCache=function(t){function e(){var e=t.call(this)||this;return e.checkList={},e.checkInited=!1,e}return __extends(e,t),e.prototype.initCheckList=function(){if(!this.checkInited){var t=GameConfig.modControl;GameCache.hero.mainPro.pro(PropId.AP_LEVEL),GameCache.server.serverOpenDay,GameCache.quest.questId;for(var e in t)for(var i in t[e])for(var n in t[e][i]){var o=t[e][i][n];if(o.location&&!App.ViewManager.checkOpenCondition(o,!1)){var r=e+i+n;this.checkList[r]={icon:o.image[0],name:o.image[1],location:o.location,openLv:o.openLv,openDay:o.openDay,openQuest:o.openQuest}}}this.checkInited=!0}},e.prototype.clear=function(){this.checkList={}},e}(BaseCache);__reflect(SysOpenCache.prototype,"SysOpenCache");var SysOpenHint=function(t){function e(){var e=t.call(this,LayerManager.UI_Main2)||this;return e.skinName="SysOpenHintSkin",e.top=e.bottom=e.left=e.right=0,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){t.prototype.open.call(this);var i=e.firData;if(!i.length)return void this.playFinish();App.DisplayUtils.addEffectToObj(this.g0,"opensys_0_1",-1,160,100),this.icon.source=RES_DIR_SYSOPEN_ICON+i[0].icon,this.sName.source=RES_DIR_SYSOPEN_NAME+i[0].name;var n=i[0].location,o=n.split("#"),r=App.ViewManager.getView(ViewConst[o[0]]);this.g0.horizontalCenter=1,this.g0.verticalCenter=1,this.icon.x=r.width-105>>1,this.icon.y=r.height-111>>1,this.icon.visible=this.g0.visible=!0;var a=2==o.length?r[o[1]]:r[o[1]].getChildByName(o[2]);if(a){var s=a.parent.localToGlobal(a.x,a.y);s=this.globalToLocal(s.x,s.y),this.playAnimate(s.x,s.y)}else this.playFinish()},e.prototype.close=function(e){t.prototype.close.call(this)},e.prototype.playAnimate=function(t,e){this.tw=egret.Tween.get(this.icon),this.tw.wait(1500).call(this.hide,this).to({x:t,y:e},1500,egret.Ease.cubicInOut).wait(700).call(this.playFinish,this)},e.prototype.hide=function(){this.g0.visible=!1},e.prototype.playFinish=function(){this.tw&&(egret.Tween.removeTweens(this.tw),this.tw=null),this.icon.visible=!1,this.closeView()},e}(BaseEuiWindow);__reflect(SysOpenHint.prototype,"SysOpenHint");var SysOpenMgr=function(){function t(){}return t.checkOpen=function(){var t,e=GameCache.sysopen.checkList,i=(GameCache.server.serverOpenDay,[]),n=0;GameCache.quest.questId,GameCache.quest.state;for(var o in e){var r=e[o];App.ViewManager.checkOpenCondition(r,!1)&&(t=r,n=r.openLv,delete GameCache.sysopen.checkList[o])}if(t){var a=new ViewProp;i.push(t),a.firData=i,App.ViewManager.open(ViewConst.SYSOPENHINT,a)}},t}();__reflect(SysOpenMgr.prototype,"SysOpenMgr");var BarrageTips=function(){function t(){this.gap=60,this.w=580,this.msgList=[],this.groPool=[],this.playingGro=[],this.groBg=new eui.Image,this.groBg.touchEnabled=!1,this.groBg.source=RES_DIR_IMAGES+"groBg.png",this.w=App.StageUtils.getWidth()}return t.prototype.createGroBg=function(t,e,i){void 0===i&&(i=16768513);var n=this.groPool.shift();return null==n&&(n=new BarrageTipsGro,n.touchEnabled=n.touchChildren=!1,n.y=295),n.currentState=t,n.text=e,n.textColor=i,n.name="0",n},t.prototype.push=function(t,e){return e?(this.msgList.unshift(t),this.stopAll(),void this.playNext()):(this.msgList.push(t),void this.playNext())},t.prototype.stopAll=function(){for(var t=0,e=this.playingGro;t<e.length;t++){var i=e[t];App.DisplayUtils.removeFromParent(i),this.groPool.push(i),egret.Tween.removeTweens(i)}this.playingGro=[],this.stopPlay()},t.prototype.startPlay=function(){this.playing||(this.playing=!0,this.showBg())},t.prototype.stopPlay=function(){this.playing&&(this.playing=!1,this.hideBg())},t.prototype.complete1=function(t){t.name="1",this.playNext()},t.prototype.complete2=function(t){var e=this.playingGro.indexOf(t);e>=0&&this.playingGro.splice(e,1),App.DisplayUtils.removeFromParent(t),this.groPool.push(t),this.playingGro.length<=0&&this.stopPlay()},t.prototype.playNext=function(){if(this.getCanPlayNow()){var t=this.msgList.shift();if(t){var e,i,n;if(-1!=t.indexOf("$$")){var o=t.split("$$");if("99"==o[0])return;e=o[0],i=o[1]}else e="0",i=t,n=15129260;this.w=App.StageUtils.getWidth(),this.startPlay();var r=this.createGroBg(e,i,n);r.x=App.stage.stageWidth,this.playingGro.push(r),LayerManager.UI_Message.addChild(r);var a=this.w-r.width-this.gap,s=9*(r.x-a),h=9*(this.w-this.gap);egret.Tween.get(r).to({x:a},s).call(this.complete1,this,[r]).to({x:-r.width},h).call(this.complete2,this,[r])}}},t.prototype.getCanPlayNow=function(){var t=this.playingGro.length;if(0==t)return!0;var e=this.playingGro[t-1];return"1"==e.name},t.prototype.showBg=function(){var t=this.groBg;t.height=36,t.width=App.stage.stageWidth,t.y=287,LayerManager.UI_Message.addChild(t),egret.Tween.removeTweens(t),t.alpha=0,egret.Tween.get(t).to({alpha:1},500)},t.prototype.hideBg=function(){var t=this.groBg;t.parent&&(egret.Tween.removeTweens(t),egret.Tween.get(t).to({alpha:0},500).call(App.DisplayUtils.removeFromParent,null,[t]))},t}();__reflect(BarrageTips.prototype,"BarrageTips");var ProChangeTips=function(t){function e(){var e=t.call(this)||this;return e.curShow=[],e._h=34,e}return __extends(e,t),e.prototype.addPro=function(t){this.onShow(t)},e.prototype.onShow=function(t){for(var e=0;e<this.curShow.length;e++){var i=this.curShow[e];i.disappear()}this.curShow.length=0,App.TimerManager.remove(this.checkClear,this),this.show(t)},e.prototype.show=function(t){0==this.curShow.length&&App.TimerManager.add(50,this.checkClear,this);var e=0,i=t.length;this.reset(i);var n;for(this._bottom=300;i>e;e++)n=ObjectPool.get(ProChangeItem),n.setData(t[e].type,t[e].value),LayerManager.UI_Message.addChild(n),this.curShow.push(n),n.y=this._bottom,n.time=App.TimerManager.getSyncTime()+2e3,egret.Tween.get(n).to({y:this._bottom-(i-e)*this._h},300)},e.prototype.reset=function(t){for(var e,i=0,n=this.curShow.length,o=t+n;n>i;i++)e=this.curShow[i],egret.Tween.removeTweens(e),egret.Tween.get(e).to({y:this._bottom-(o-i)*this._h},300)},e.prototype.checkClear=function(){if(!this.curShow.length)return void App.TimerManager.remove(this.checkClear,this);for(var t=App.TimerManager.getSyncTime(),e=0;e<this.curShow.length;e++){var i=this.curShow[e];i.time<=t&&(egret.Tween.removeTweens(i),this.curShow.splice(e,1),e--,i.disappear())}},e}(BaseClass);__reflect(ProChangeTips.prototype,"ProChangeTips");var ProChangeItem=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=e.touchChildren=!1,e.attName=new eui.Image,e.attName.x=50,e.attName.y=4,e.addChild(e.attName),e.attValue=new NumberMC,e.attValue.y=6,e.addChild(e.attValue),e}return __extends(e,t),e.prototype.setData=function(t,e){var i=RES.getRes("num_json.pro_type_"+t+"_png");this.attName.source=i;var n;e>0?(this.attValue.updateType("num_json.pro_green_"),n="+"+e):(this.attValue.updateType("num_json.pro_red_"),n=e),i&&(this.attValue.x=this.attName.x+i.textureWidth+2,this.attValue.value=n,this.x=120-this.attValue.x)},e.prototype.disappear=function(){egret.Tween.get(this).to({x:-this.width},300,egret.Ease.sineIn).call(this.dispose,this)},e.prototype.dispose=function(){App.DisplayUtils.removeFromParent(this),egret.Tween.removeTweens(this),ObjectPool.push(this)},e}(egret.DisplayObjectContainer);__reflect(ProChangeItem.prototype,"ProChangeItem");var SystemTextTips=function(t){function e(){var e=t.call(this)||this;return e.skinName="SystemTextTipsSkin",e.horizontalCenter=0,e.touchEnabled=e.touchChildren=!1,e._init=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._init=!0,this.text=this._text},Object.defineProperty(e.prototype,"text",{set:function(t){this._text=t,this._init&&(this.txt.textFlow=TextFlowUtils.generateTextFlow(t),egret.Tween.removeTweens(this),this.alpha=1,this.y=App.StageUtils.getHeight()-280,egret.Tween.get(this).to({y:this.y-40},1500).to({alpha:0},500).call(this.remove,this))},enumerable:!0,configurable:!0}),e.prototype.remove=function(){App.DisplayUtils.removeFromParent(this)},e}(eui.Component);__reflect(SystemTextTips.prototype,"SystemTextTips");var SysTips=function(t){function e(){var e=t.call(this,LayerManager.UI_TipsNoClick)||this;return e.skinName="SysTipsSkin",e.horizontalCenter=1,e.verticalCenter=1,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.setWinTitle("hint2")},e.prototype.open=function(e){t.prototype.open.call(this),this.initData(e),this.addTouchEvent(this.btn0,this.closeView),this.addTouchEvent(this.btn1,this.onCLick),this.currentState=1==e.exData1.state?"single":"normal"},e.prototype.close=function(e){t.prototype.close.call(this),this.handler&&(this.handler.dispose(),this.handler=null)},e.prototype.initData=function(t){this.desc.textFlow=TextFlowUtils.generateTextFlow(t.exData1.desc),this.handler&&this.handler.dispose(),this.handler=Handler.create(t.exData1.thisc,t.exData1.func,[],!1)},e.prototype.onCLick=function(){this.handler&&this.handler.run(),this.closeView()},e}(BaseEuiWindow);__reflect(SysTips.prototype,"SysTips");var TipsPopupMgr=function(t){function e(){var e=t.call(this)||this;return e.isDelay=!1,e.tipsShowList=[],e.msgList=[],e}return __extends(e,t),e.prototype.pushStr=function(t){this.msgList.push(t),this.isDelay||(this.isDelay=!0,App.TimerManager.addDelay(100,1,1,this.doTips,this))},e.prototype.doTips=function(){for(var t=0;t<this.tipsShowList.length;t++){var e=this.tipsShowList[t];App.DisplayUtils.removeFromParent(e),egret.Tween.removeTweens(e),e.alpha=1,ObjectPool.push(e)}this.tipsShowList.length=0,this.isDelay=!1;var i=0,n=this.msgList.length;for(n>6&&(i=n-6);n>i;i++){var o=this.msgList[i],r=ObjectPool.get(CenterTipsItem);r.text=o,r.x=App.StageUtils.getWidth()>>1,r.y=(App.StageUtils.getHeight()>>1)-100,r.time=App.TimerManager.getSyncTime()+2e3,LayerManager.UI_Message.addChild(r),this.tipsShowList.push(r),1==this.tipsShowList.length&&App.TimerManager.add(50,this.checkClear,this)}this.resetPosition(),this.msgList.length=0},e.prototype.resetPosition=function(){for(var t,e=App.StageUtils.getHeight()>>1,i=this.tipsShowList.length,n=e-28*(10>i?10:i),o=0;i>o;o++)t=this.tipsShowList[o],egret.Tween.removeTweens(t),egret.Tween.get(t).to({y:n+28*o},800)},e.prototype.checkClear=function(){if(!this.tipsShowList.length)return void App.TimerManager.remove(this.checkClear,this);for(var t=App.TimerManager.getSyncTime(),e=0;e<this.tipsShowList.length;e++){var i=this.tipsShowList[e];i.time<=t&&(i.alpha>0?i.alpha=i.alpha-.1:(App.DisplayUtils.removeFromParent(i),egret.Tween.removeTweens(i),i.alpha=1,this.tipsShowList.splice(e,1),e--,ObjectPool.push(i)))}},e}(egret.HashObject);__reflect(TipsPopupMgr.prototype,"TipsPopupMgr");var BarrageTipsGro=function(t){function e(){var e=t.call(this)||this;return e.skinName="BarrageTipsSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},Object.defineProperty(e.prototype,"text",{set:function(t){this.content.textFlow=TextFlowUtils.generateTextFlow(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textColor",{set:function(t){this.content.textColor=t},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.content.removeEventListener(egret.TextEvent.LINK,this.onLink,this)},e.prototype.onLink=function(t){TextFlowUtils.hrefType(t.text)},e}(eui.Component);__reflect(BarrageTipsGro.prototype,"BarrageTipsGro");var CenterTipsItem=function(t){function e(){var e=t.call(this)||this;return e.decsTxt=App.DisplayUtils.newTextField("",84,4,16373546,"left",18),e.decsTxt.stroke=1,e.decsTxt.strokeColor=0,e.decsTxt.lineSpacing=5,e.addChild(e.decsTxt),e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"text",{set:function(t){this.decsTxt.textFlow=TextFlowUtils.generateTextFlow(t);var e=this.decsTxt.width;126>e&&(e=126),this.decsTxt.x=-this.decsTxt.width>>1,this.width=this.decsTxt.textWidth},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(CenterTipsItem.prototype,"CenterTipsItem");var PropTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="PropTipsSkin",e}return __extends(e,t),e.prototype.init=function(){},e.prototype.open=function(e){t.prototype.open.call(this),e&&(this.title.source=e.firData.src,this.propList.setData(e.firData.prop,[]))},e}(BaseEuiWindow);__reflect(PropTips.prototype,"PropTips");var ResonanceItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.upBtn,this.upGradeFunc)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&this.initData()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){var t=this.data,e=GameCache.totems.resonanceData[t]?GameCache.totems.resonanceData[t]:0,i=GameConfig.resonance[t][e];this.skillName.text=StringUtils.substitute(Language.lang.resonanSkillName,i.skillName,e),this.desc.textFlow=TextFlowUtils.generateTextFlow(i.desc);for(var n=GameCache.totems.totemsData[i.number[0]],o=n?n.jie:0,r=!0,a=0;a<i.number.length;a++){var s=i.number[a];this["item_"+a].data=s;var h=GameCache.totems.totemsData[s],p=h?h.jie:0;h&&1!=h.id||(r=!1),o=o>p?p:o}this.upBtn.icon=e>0?"res/btn/promote_2.png":"res/btn/activate_1.png",this.upBtn.visible=r&&(o>=i.classLvl||0==i.classLvl),this.unacti.visible=!r},e.prototype.upGradeFunc=function(){var t=this.data;"string"==typeof t&&(t=parseInt(t)),Proxy.totems.sendResonanceUpGrade(t)},e}(BaseCustComponent);__reflect(ResonanceItem.prototype,"ResonanceItem");var ResonanceTips=function(t){function e(){var e=t.call(this)||this;return e.skinName="ResonanceTipsSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.bg.setNameImg("resonance"),this.itemList.itemRenderer=ResonanceItem},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.TOTEMS_RESONANCE,this.initData),this.message(MsgConst.TOTEMS_INFO,this.initData),this.initData()},e.prototype.initData=function(){var t=GameConfig.resonance,e=[];for(var i in t)e.push(i);this.setListData(this.itemList,e)},e}(BaseEuiWindow);__reflect(ResonanceTips.prototype,"ResonanceTips");var TotemsCache=function(t){function e(){var e=t.call(this)||this;return e.totemsData={},e.resonanceData={},e}return __extends(e,t),e.prototype.clear=function(){this.totemsData={},this.resonanceData={}},e.prototype.initTotemsData=function(t,e,i){var n=7*e+i+1,o={id:n,jie:e,star:i};this.totemsData[t]=o},e.prototype.initResonanData=function(t,e){this.resonanceData[t]=e},e.prototype.checkGrade=function(t){if(!t){for(var e=Object.keys(GameConfig.totems).length,i=1;e>=i;i++)if(this.checkGrade(i))return!0;return!1}if(t.length){for(var i=t[0];i<=t[1];i++)if(this.checkGrade(i))return!0;return!1}var n=this.totemsData[t],o=n?n.id:1,r=GameConfig.totems[t][o];if(!r)return!1;if(!r.consume)return!1;var a=GameCache.bag.itemCount(r.consume[0].id);return a>=r.consume[0].count},e.prototype.checkReonance=function(t){if(!t){for(var e in GameConfig.resonance)if(this.checkReonance(e))return!0;return!1}for(var i=(GameConfig.resonance[t],GameCache.totems.resonanceData[t]?GameCache.totems.resonanceData[t]:0),n=GameConfig.resonance[t][i],o=GameCache.totems.totemsData[n.number[0]],r=o?o.jie:0,a=!0,s=0,h=n.number;s<h.length;s++){var e=h[s],p=GameCache.totems.totemsData[e],l=p?p.jie:0;p&&1!=p.id||(a=!1),r=r>l?l:r}return a&&(r>=n.classLvl||0==n.classLvl)},e}(BaseCache);__reflect(TotemsCache.prototype,"TotemsCache");var TotemsImgItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TotemsImgItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data){this.saveData=this.data;var e=GameConfig.totems[this.saveData[0]][this.saveData[1]];this.img.source=this.saveData[1]>1?RES_DIR_TOTEMS_ICON+"b"+this.saveData[0]+".png":RES_DIR_TOTEMS_ICON+"b"+this.saveData[0]+"u.png",this.nImg.source=this.saveData[1]>1?RES_DIR_TOTEMS_NAME+"n"+this.saveData[0]+".png":RES_DIR_TOTEMS_NAME+"n"+this.saveData[0]+"u.png",this.lNum.visible=!0,this.lNum.value=StringUtils.substitute(Language.lang.jie_j,e.classLvl)}},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(TotemsImgItem.prototype,"TotemsImgItem");var TotemsItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.initData()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){var t=GameConfig.totems[this.data],e=GameCache.totems.totemsData[this.data],i=e?e.id:1;t&&(this.icon.source=i>1?RES_DIR_TOTEMS_ICON+"s"+this.data+".png":RES_DIR_TOTEMS_ICON+"s"+this.data+"u.png",this.lvl.text=StringUtils.substitute(Language.lang.jie,StringUtils.toCNUpper(t[i].classLvl)),this.bg.source=i>1?"totems_json.totems_item_bg_"+t[i].icon+"_png":"totems_json.totems_item_bg_0_png",this.tName.source=i>1?RES_DIR_TOTEMS_NAME+"s"+this.data+".png":RES_DIR_TOTEMS_NAME+"s"+this.data+"u.png")},e}(BaseCustComponent);__reflect(TotemsItem.prototype,"TotemsItem");var TotemsPage=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.arrayType=[],i.skinName="TotemsPageSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.arrayType=[1,Object.keys(GameConfig.totems).length]},e.red=function(){return GameCache.totems.checkGrade()?!0:GameCache.totems.checkReonance()?!0:!1},e.changeMsg=function(){return[MsgConst.TOTEMS_INFO]},e.prototype.refreshRed=function(){this.redShow()},e.prototype.open=function(t){this.addTouchEvent(this.btn_1,this.openPropTips),this.addTouchEvent(this.btn_0,this.openResonance),this.addTouchEvent(this.pBtn,this.upGradeFunc),this.message(MsgConst.TOTEMS_INFO,this.initData),this.message(MsgConst.TOTEMS_INFO,this.upGradeChange);var e=[];for(var i in GameConfig.totems){var n=GameCache.totems.totemsData[i]?GameCache.totems.totemsData[i].id:1;e.push([i,n])}this.slider.initData(TotemsImgItem,e,this.onCall,this),this.initData()},e.prototype.onCall=function(){this.initData()},e.prototype.initData=function(){var t=this.slider.currentIndex+1,e=GameCache.totems.totemsData[t]?GameCache.totems.totemsData[t].id:1,i=GameConfig.totems[t][e],n=GameConfig.totems[t][e+1]?GameConfig.totems[t][e+1]:null;if(1==e?(this.img_0.source="totems_json.totems_active_txt_png",this.pBtn.icon=RES_DIR_BTN+"activate_3.png"):(this.img_0.source="totems_json.totems_upGrade_txt_png",this.pBtn.icon=RES_DIR_BTN+"promote_1.png"),i){var o=[];n?(this.lvlMax.visible=!1,this.pBtn.visible=!0,this.cost.visible=!0,this.item.visible=!0,this.item.data=i.consume[0],this.cost.setData(i.consume[0].id,i.consume[0].count),o=n.levelAtt.concat()):(this.lvlMax.visible=!0,this.pBtn.visible=!1,this.cost.visible=!1,this.item.visible=!1),this.propList.setData(i.levelAtt,o,0,16762368,16777215,65292,[],"PropItem2Skin");for(var r=i.starlevel,a=0;6>a;a++)this["item_"+a].source=r>=a+1?"totems_json.totems_item_sele_png":"totems_json.totems_item_u_sele_png";var s=0;for(var a in GameConfig.totems){var h=GameCache.totems.totemsData[a]?GameCache.totems.totemsData[a].id:1,p=GameConfig.totems[a][h];s+=ItemUtils.getZdlByProp(p.levelAtt)}this.zdl.value=s}},e.prototype.upGradeChange=function(){var t=this.slider.currentIndex+1,e=GameCache.totems.totemsData[t]?GameCache.totems.totemsData[t].id:1;this.slider.replaceItemData(this.slider.currentIndex,[t,e]),this.showEff()},e.prototype.openPropTips=function(){var t=[];for(var e in GameConfig.totems){var i=GameCache.totems.totemsData[e]?GameCache.totems.totemsData[e].id:1,n=GameConfig.totems[e][i];t=GlobalFun.ObjPlusOrMinus(t,n.levelAtt)}var o=new ViewProp;o.firData={},o.firData.src="totems_json.totems_texture_0_png",o.firData.prop=t,App.ViewManager.open(ViewConst.TOTALPROP,o)},e.prototype.openResonance=function(){App.ViewManager.open(ViewConst.RESONANCE)},e.prototype.upGradeFunc=function(){if(this.cost.checkEnough()){var t=this.slider.currentIndex+1;Proxy.totems.sendUpGrade(t)}},e.prototype.redShow=function(){App.ViewManager.showRedPoint(this.pBtn,GameCache.totems.checkGrade(this.slider.currentIndex+1)),App.ViewManager.showRedPoint(this.slider.lBtn,GameCache.totems.checkGrade([this.arrayType[0],this.slider.currentIndex])),App.ViewManager.showRedPoint(this.slider.rBtn,GameCache.totems.checkGrade([this.slider.currentIndex+2,this.arrayType[1]])),App.ViewManager.showRedPoint(this.btn_0,GameCache.totems.checkReonance())},e.prototype.showEff=function(){var t=this.slider.currentIndex+1,e=GameCache.totems.totemsData[t]?GameCache.totems.totemsData[t].id:1,i=GameConfig.totems[t][e],n=i.starlevel;if(i){var o=n-1;if(!(0>o)){var r=this["item_"+o];App.DisplayUtils.addEffectToObj(this.iG,"point2_0_1",1,r.x+22,r.y+22)}}},e}(BaseSpriteView);__reflect(TotemsPage.prototype,"TotemsPage");var TotemsProxy=function(t){function e(){var e=t.call(this,PacketTypes.TOTEMS)||this;return e.regNetMsg(1,e.doSingleTotemsInfo),e.regNetMsg(2,e.doTotemsInfo),e.regNetMsg(3,e.doSingleResonanInfo),e.regNetMsg(4,e.doResonanInfo),e}return __extends(e,t),e.prototype.doSingleTotemsInfo=function(t){var e=t.readByte(),i=t.readUnsignedShort(),n=t.readByte();GameCache.totems.initTotemsData(e,i,n),App.MessageCenter.dispatch(MsgConst.TOTEMS_INFO)},e.prototype.doTotemsInfo=function(t){for(var e=t.readInt(),i=0;e>i;i++){var n=t.readByte(),o=t.readUnsignedShort(),r=t.readByte();GameCache.totems.initTotemsData(n,o,r)}App.MessageCenter.dispatch(MsgConst.TOTEMS_INFO)},e.prototype.doSingleResonanInfo=function(t){var e=t.readUnsignedShort(),i=t.readUnsignedShort();GameCache.totems.initResonanData(e,i),App.MessageCenter.dispatch(MsgConst.TOTEMS_RESONANCE)},e.prototype.doResonanInfo=function(t){for(var e=t.readInt(),i=0;e>i;i++){var n=t.readUnsignedShort(),o=t.readUnsignedShort();GameCache.totems.initResonanData(n,o)}App.MessageCenter.dispatch(MsgConst.TOTEMS_RESONANCE)},e.prototype.sendTotemsInfo=function(){var t=this.getBytes(1);this.sendToServer(t)},e.prototype.sendUpGrade=function(t){var e=this.getBytes(2);e.writeInt(t),this.sendToServer(e)},e.prototype.sendResonanceUpGrade=function(t){var e=this.getBytes(3);e.writeInt(t),this.sendToServer(e)},e}(BaseProxy);__reflect(TotemsProxy.prototype,"TotemsProxy");var SlidePart=function(t){function e(){var e=t.call(this)||this;return e._safeDelta=50,e.beginPos=0,e.curIdx=0,e.moving=!1,e.listData=[],e.timera=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEvent(eui.UIEvent.CHANGE_START,this.sc,this.recodeFunc),this.addEvent(eui.UIEvent.CHANGE_END,this.sc,this.endFunc),this.addEvent(egret.Event.CHANGE,this.sc,this.pringMove),this.addTouchEvent(this.lBtn,this.onBtnTouche),this.addTouchEvent(this.rBtn,this.onBtnTouche)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),egret.Tween.removeTweens(this.sc.viewport),this.tw=null},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.pringMove=function(){this.timera||(this.timera=egret.getTimer()),console.log("TIME SPAVE : "+(this.timera-egret.getTimer())),this.timera=egret.getTimer()},e.prototype.initData=function(t,e,i,n){this.itemList.itemRenderer=t,this.listData=e,this.setListData(this.itemList,this.listData),this.curIdx=0,i&&(this.handler&&this.handler.dispose(),this.handler=Handler.create(n,i,[],!1)),this.beginPos=this.sc.viewport.scrollH,App.TimerManager.addDelay(50,50,1,this.btnVisible,this)},e.prototype.recodeFunc=function(){this.beginPos=this.sc.viewport.scrollH},e.prototype.endFunc=function(){var t=this.sc.viewport.scrollH-this.beginPos;return Math.abs(t)<this._safeDelta&&!this.moving?(this.moving=!0,this.tw=egret.Tween.get(this.sc.viewport),this.sc.touchEnabled=!1,this.sc.touchChildren=!1,this.lBtn.touchEnabled=this.rBtn.touchEnabled=!1,void this.tw.to({scrollH:this.beginPos},100).call(this.resetListener,this)):void this.triggerFunc()},e.prototype.triggerFunc=function(){var t=this.sc.viewport.scrollH-this.beginPos;if(!(Math.abs(t)<this._safeDelta)){var e=t/Math.abs(t);0>e&&0==this.curIdx||e>0&&this.curIdx==this.itemList.numElements-1||this.moving||(this.moving=!0,this.animateFunc(e))}},e.prototype.onBtnTouche=function(t){var e=parseInt(t.target.name);this.recodeFunc(),this.animateFunc(e)},e.prototype.animateFunc=function(t){this.tw=egret.Tween.get(this.sc.viewport),this.sc.touchEnabled=!1,this.sc.touchChildren=!1,this.lBtn.touchEnabled=this.rBtn.touchEnabled=!1;var e=0;this.curIdx+=t,e=this.curIdx*this.sc.width,this.tw.to({scrollH:e},200).call(this.resetListener,this)},e.prototype.resetListener=function(){this.lBtn.touchEnabled=this.rBtn.touchEnabled=!0,this.sc.touchEnabled=!0,this.sc.touchChildren=!0,this.moving=!1,this.tw=null,this.btnVisible(),this.runHandler()},e.prototype.runHandler=function(){this.handler&&this.handler.run()},e.prototype.btnVisible=function(){0==this.curIdx?(this.lBtn.visible=!1,this.rBtn.visible=!0):this.curIdx==this.itemList.numElements-1?(this.lBtn.visible=!0,this.rBtn.visible=!1):this.itemList.numElements-1==0?this.rBtn.visible=this.lBtn.visible=!1:this.rBtn.visible=this.lBtn.visible=!0},Object.defineProperty(e.prototype,"currentIndex",{get:function(){return this.curIdx},enumerable:!0,configurable:!0}),e.prototype.replaceItemData=function(t,e){this.listData[t]=e;var i=this.itemList.dataProvider;i.replaceAll(this.listData)},e}(BaseCustComponent);__reflect(SlidePart.prototype,"SlidePart");var TransferPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skillList=[],i.skinName="TransferPannelSkin",i}return __extends(e,t),e.prototype.init=function(){this.roleSelect.setHandler(this,this.roleClick),this.cfg=GameConfig.transfer},e.red=function(){var t=GameCache.transfer.enoughUpRed();if(t)return!0;for(var e in GameCache.hero.list){var i=GameCache.hero.list[e];if(GameCache.transfer.enoughExpRed(i.id))return!0}return!1},e.prototype.roleRed=function(t){return GameCache.transfer.enoughUpRed()||GameCache.transfer.enoughExpRed(t)},e.changeMsg=function(){return[MsgConst.TRANSFER_INFO]},e.prototype.refreshRed=function(){t.prototype.refreshRed.call(this)},e.prototype.open=function(t){void 0===t&&(t=null),this.addTouchEvent(this.btn,this.onClick),this.addTouchEvent(this.lbGo,this.onClick),this.addTouchEvent(this.show,this.onClick),this.addTouchEvent(this.iconEx,this.onClick),this.addTouchEvent(this.icon0,this.onClick),this.addTouchEvent(this.icon1,this.onClick),this.addTouchEvent(this.show,this.onClick),this.addTouchEvent(this.show,this.onClick),this.message(MsgConst.TRANSFER_INFO,this.upCn),this.upCn()},e.prototype.upCn=function(){this.imgRole.source="res/images/bg/transferRole0"+this.roleSelect.job+".png";var t=GameCache.transfer.syData[this.roleSelect.roleId];if(t){var e=this.cfg[GameCache.transfer.truanChange(this.roleSelect.job,t.turnNum,t.turnLv)],i=this.cfg[e?e.next:null];if(e&&(this.btn.visible=i?!0:!1,this.lbGo.visible=i?!0:!1,this.step.visible=i?!0:!1,this.gAttr.visible=i?!0:!1,this.gSkill.visible=i?!0:!1,this.progressBar.visible=i?!0:!1,this.skillList=[],i)){if(this.step.source=i.level?"transfer_json.transfer_step_"+i.level+"_png":null,this.job.source=i.stepImg?i.stepImg:null,i.ZXCID){var n=i.ZXCID?i.ZXCID[0]:0,o=GameConfig.skill[n];o&&(this.iconEx.source=RES_DIR_SKILL+o.icon+".png"),this.skillList.push(n)}if(i.skillID)for(var r in i.skillID){var a=GameConfig.skill[i.skillID[r]];a&&this["icon"+r]&&(this["icon"+r].source=RES_DIR_SKILL+a.icon+".png"),this.skillList.push(i.skillID[r])}else i&&this.propList.setData(e.attrs,i.attrs,0,16762368,16777215,16777215,[],"PropItem2Skin");this.gAttr.visible=i.skillID?!1:!0,this.gSkill.visible=i.skillID?!0:!1,i&&i.transferExe&&(this.progressBar.value=t.exp,this.progressBar.maximum=i.transferExe)}}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btn:Proxy.transfer.sendSuitResolve(this.roleSelect.serverId);break;case this.lbGo:App.ViewManager.openParm(ViewConst.TRANSFERUSE,this.roleSelect.nSlRole);break;case this.show:App.ViewManager.openParm(ViewConst.TRANSFERSHOW,this.roleSelect.job);break;case this.iconEx:App.ViewManager.openParm(ViewConst.SKILLTIPS,this.skillList[0]);break;case this.icon0:App.ViewManager.openParm(ViewConst.SKILLTIPS,this.skillList[1]);break;case this.icon1:App.ViewManager.openParm(ViewConst.SKILLTIPS,this.skillList[2])}},e.prototype.roleClick=function(t){this.upCn()},e}(BaseSpriteView);__reflect(TransferPannel.prototype,"TransferPannel");var TransferShowItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TransferShowItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.des&&(this.lbDesc.textFlow=TextFlowUtils.generateTextFlow(this.data.des),this.imgAccount.source="transfer_json.transfer_name_"+(this.data.job-1)+this.itemIndex+"_png")},e}(BaseCustComponent);__reflect(TransferShowItem.prototype,"TransferShowItem");var TransferShowWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.job=0,e.skinName="TransferShowWinSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.list.itemRenderer=TransferShowItem,this.setWinTitle("jobShow")},e.prototype.open=function(e){t.prototype.open.call(this),this.job=e.exData1?e.exData1:0;var i=GameConfig.transfertotal[this.job];if(i&&i.describe){var n=[];for(var o in i.describe){var r={des:"",job:0};r.job=this.job,r.des=i.describe[o],n.push(r)}this.setListData(this.list,n)}},e}(BaseEuiWindow);__reflect(TransferShowWin.prototype,"TransferShowWin");var TransferUseItem=function(t){function e(){var e=t.call(this)||this;return e.bGotoCharge=!0,e.skinName="TransferUseItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.eBtn,this.onClick)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.bGotoCharge=!0,this.data.item){var e=this.data.item;if(e){this.item.data=e.id,this.lbNe.text=StringUtils.substitute(Language.lang.lcn21,e.exp),e.consume&&e.consume[0]&&(this.itemIcon.source=GlobalFun.getItemSourceById(e.consume[0].id),this.lbLv.text=e.consume[0].count,this.bGotoCharge=GlobalFun.getBagEnounghUseCondition(e.consume,null));var i=GameCache.transfer.syData[GameCache.hero.getRoleIdByIndex(this.data.slRoleId)];
if(i){var n=i.itemUseIime[e.idex]||0;e.count>0?(this.lbUse.visible=!0,e.count-n>0?this.lbUse.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.lcn22,e.count-n)):this.lbUse.textFlow=TextFlowUtils.generateTextFlow(Language.lang.lcn23)):this.lbUse.visible=!1}var o=GameCache.bag.itemCount(e.id);this.eBtn.icon=o>0?"res/btn/use.png":"res/btn/buyUse.png",o>0?(this.bGotoCharge=!0,this.lbLeft.text=StringUtils.substitute(Language.lang.lcn24,o),this.lbLeft.visible=!0,this.gPrice.visible=!1):(this.lbLeft.visible=!1,this.gPrice.visible=!0),App.ViewManager.showRedPoint(this.eBtn,o>0)}}},e.prototype.onClick=function(){this.data.item&&(this.bGotoCharge?Proxy.transfer.sendSuitChange(this.data.slRoleId,this.data.item.idex):(GlobalFun.gotoCharge(),App.ViewManager.close(ViewConst.TRANSFERUSE)))},e}(BaseCustComponent);__reflect(TransferUseItem.prototype,"TransferUseItem");var TransferUseWin=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.slRoleId=0,e.skinName="TransferUseWinSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.list.itemRenderer=TransferUseItem,this.setWinTitle("expChange")},e.prototype.open=function(e){t.prototype.open.call(this),this.slRoleId=e.exData1?e.exData1:0,this.upList(),this.message(MsgConst.TRANSFER_INFO,this.upList)},e.prototype.upList=function(){var t=[];if(GameConfig.transferconfig)for(var e in GameConfig.transferconfig){var i={item:[],slRoleId:0};i.slRoleId=this.slRoleId,i.item=GameConfig.transferconfig[e],t.push(i)}this.setListData(this.list,t)},e}(BaseEuiWindow);__reflect(TransferUseWin.prototype,"TransferUseWin");var TransferWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPageWin);__reflect(TransferWin.prototype,"TransferWin");var TransferCache=function(t){function e(){var e=t.call(this)||this;return e.syData={},e}return __extends(e,t),e.prototype.clear=function(){this.syData={}},e.prototype.initData=function(t){this.syData[t.roldId]=t},e.prototype.truanChange=function(t,e,i){var n=0;if("number"==typeof t&&"number"==typeof e&&"number"==typeof i){GameCache.hero.transServerFromeId(t);n=i+1e3*e+1e3*t*1e3}return n},e.prototype.upTrunLv=function(t,e,i,n){var o=this.syData[t];o&&(o.turnNum=e,o.turnLv=i,o.exp=n)},e.prototype.upItemInfo=function(t,e,i,n){var o=this.syData[t];o&&(o.exp=e,o.itemUseIime[i]=n)},e.prototype.enoughExpRed=function(t){var e=this.syData[t];if(!e)return!1;var i=GameConfig.transfer[GameCache.transfer.truanChange(GameCache.hero.getJobByRoleId(t),e.turnNum,e.turnLv)];if(!i)return!1;var n=GameConfig.transfer[i.next];return n&&e.exp>=n.transferExe?!0:!1},e.prototype.enoughUpRed=function(){for(var t in GameConfig.transferconfig){var e=GameConfig.transferconfig[t],i=GameCache.bag.itemCount(e.id);if(i)return!0}return!1},e}(BaseCache);__reflect(TransferCache.prototype,"TransferCache");var TransferItem=function(){function t(){this.itemUseIime={}}return t.prototype.init=function(t){t&&(this.roldId=GameCache.hero.transIdFromeServer(t.readInt()),this.job=t.readByte(),this.sex=t.readByte(),this.turnNum=t.readUnsignedShort(),this.turnLv=t.readUnsignedShort(),this.exp=t.readUnsignedInt(),this.itemUseIime[0]=t.readByte(),this.itemUseIime[1]=t.readByte(),this.itemUseIime[2]=t.readByte())},t}();__reflect(TransferItem.prototype,"TransferItem");var TransferProxy=function(t){function e(){var e=t.call(this,PacketTypes.TRANSFER)||this;return e.regNetMsg(1,e.doInit),e.regNetMsg(2,e.doRetrunRes),e.regNetMsg(3,e.doRetrunExp),e}return __extends(e,t),e.prototype.doInit=function(t){var e=new TransferItem;e.init(t),GameCache.transfer.initData(e),App.MessageCenter.dispatch(MsgConst.TRANSFER_INFO)},e.prototype.doRetrunRes=function(t){var e=GameCache.hero.transIdFromeServer(t.readInt()),i=t.readUnsignedShort(),n=t.readUnsignedShort(),o=t.readUnsignedInt();GameCache.transfer.upTrunLv(e,i,n,o),App.MessageCenter.dispatch(MsgConst.TRANSFER_INFO)},e.prototype.doRetrunExp=function(t){var e=GameCache.hero.transIdFromeServer(t.readInt()),i=t.readUnsignedInt(),n=t.readByte(),o=t.readByte();GameCache.transfer.upItemInfo(e,i,n,o),App.MessageCenter.dispatch(MsgConst.TRANSFER_INFO)},e.prototype.sendSuitResolve=function(t){var e=this.getBytes(1);e.writeInt(t),this.sendToServer(e)},e.prototype.sendSuitChange=function(t,e){var i=this.getBytes(2);i.writeInt(t),i.writeByte(e),this.sendToServer(i)},e}(BaseProxy);__reflect(TransferProxy.prototype,"TransferProxy");var VipCardItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="VipCardItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.listLb.itemRenderer=VipWelfareItem,this.addTouchEvent(this.eBtn,this.onClick),this.addTouchEvent(this.lbMore,this.onClickMore)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data.id){var e=this.data,i=[];for(var n in e.desc){var o={bNew:!1,dec:""};o.dec=e.desc[n],i.push(o)}this.imgPrice.visible=e.condsIcon?!0:!1,e.condsIcon&&(this.imgPrice.source=e.condsIcon),this.gPrice.visible=e.OriDiamondConds?!0:!1,e.OriDiamondConds&&(this.imgItem0.source=GlobalFun.getItemSourceById(e.OriDiamondConds.id),this.lbNum0.text=e.OriDiamondConds.count+""),e.diamondConds&&(this.imgItem1.source=GlobalFun.getItemSourceById(e.diamondConds.id),this.lbNum1.text=e.diamondConds.count+""),this.imgVip.source=e.icon,this.eBtn.icon=GameCache.vip.vipCardSt[e.id]?"public_json.luck_img2_png":"res/btn/ljkt.png",this.eBtn.touchEnabled=!GameCache.vip.vipCardSt[e.id],!GameCache.vip.vipCardSt[e.id]&&e.effect?(this.passEff||(this.passEff=App.DisplayUtils.addEffectToObj(this.eff,"vipCard_0_1",-1)),this.passEff.play(-1),this.passEff.visible=!0):this.passEff&&(this.passEff.visible=!1,this.passEff.stop()),this.setListData(this.listLb,i)}},e.prototype.onClick=function(){Proxy.vip.actCard(this.data.id)},e.prototype.onClickMore=function(){if(this.data.id){var t=new ViewProp;t.exData1=this.data.id,App.ViewManager.open(ViewConst.VIPTIPS,t)}},e}(BaseCustComponent);__reflect(VipCardItem.prototype,"VipCardItem");var VipCardPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="VipCardPannelSkin",i}return __extends(e,t),e.prototype.init=function(){this.listLb.itemRenderer=VipCardItem},e.prototype.open=function(t){void 0===t&&(t=null),this.addTouchEvent(this.btnLuck,this.onClick),this.message(MsgConst.PROPERTY+PropId.AP_VIP_TEMPROARY,this.upVip),this.message(MsgConst.PROPERTY+PropId.AP_VIP_GRADE,this.upVip),this.message(MsgConst.PROPERTY+PropId.AP_VIP_TEMPROARY,this.upCn),this.message(MsgConst.PROPERTY+PropId.AP_VIP_GRADE,this.upCn),this.message(MsgConst.PROPERTY+PropId.AP_VIP_POINT,this.upVip),this.message(MsgConst.VIP_CARD_TIME,this.upTime),this.message(MsgConst.VIP_CARD,this.upCn),this.upCn(),this.upVip(),App.TimerManager.add(1e3,this.upTime,this)},e.prototype.upCn=function(){var t=[];for(var e in GameConfig.vipCard)t.push(GameConfig.vipCard[e]);this.setListData(this.listLb,t),this.upTime()},e.prototype.upTime=function(){var t="";GameCache.vip.privilegeCardTime>0?(t=App.DateUtils.getFormatBySecond(GlobalFun.getDiffMiniDateTime(GameCache.vip.privilegeCardTime)/1e3,DateUtils.TIME_FORMAT_5,2),t=StringUtils.substitute(Language.lang.lcn10,t)):-1==GameCache.vip.privilegeCardTime&&(t=Language.lang.lcn11),this.lbWelfareDay.text=t},e.prototype.upVip=function(){this.vipNum.source="vip_json.vip_"+GameCache.vip.realValue()+"_png";var t=GameCache.hero.mainPro;if(t){var e=GameConfig.vip[GameCache.vip.realValue()];e&&e.upgradePoint&&(this.progressBar.maximum=e.upgradePoint),this.progressBar.value=t.pro(PropId.AP_VIP_POINT)}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnLuck:App.ViewManager.close(ViewConst.VIP),App.ViewManager.open(ViewConst.CHARGE)}},e}(CommunalPagePannel);__reflect(VipCardPannel.prototype,"VipCardPannel");var VipChargeItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="VipChargeItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this,this.onClick)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data.money){var e=this.data;this.lbNum0.text=e.desc,this.lb1.text=e.giftDesc?e.giftDesc:"",this.lb2.visible=e.giftDesc?!0:!1,this.lb3.text=StringUtils.substitute(Language.lang.lcn12,e.money),e.doubleDimond&&(this.imgItem1.source=GlobalFun.getItemSourceById(e.doubleDimond.id),this.lbNum1.text=e.doubleDimond.count),e.diamondIcon?this.imgIcon.icon=e.diamondIcon:this.imgIcon.icon=null;var i=!1;e.doubleDimond&&(i=GameCache.firstcharge.secondChargeSt&&1==GameCache.firstcharge.secondChargeSt[e.money]?!1:!0),this.gPrice.visible=i}},e.prototype.onClick=function(){var t=this.data;if(t.money){var e="@AddMoney 3 ";e+=t.money,Proxy.chat.sendChatMessage(1,e,!1)}},e}(BaseCustComponent);__reflect(VipChargeItem.prototype,"VipChargeItem");var VipChargePannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="VipChargePannelSkin",i}return __extends(e,t),e.prototype.init=function(){this.listLb.itemRenderer=VipChargeItem},e.prototype.open=function(t){void 0===t&&(t=null),this.addTouchEvent(this.btnLuck,this.onClick),this.message(MsgConst.PROPERTY+PropId.AP_VIP_TEMPROARY,this.upVip),this.message(MsgConst.PROPERTY+PropId.AP_VIP_GRADE,this.upVip),this.message(MsgConst.PROPERTY+PropId.AP_VIP_TEMPROARY,this.upCn),this.message(MsgConst.PROPERTY+PropId.AP_VIP_GRADE,this.upCn),this.message(MsgConst.PROPERTY+PropId.AP_VIP_POINT,this.upVip),this.message(MsgConst.FIRST_CHARGE,this.upCn),this.upCn(),this.upVip()},e.prototype.upCn=function(){this.setListData(this.listLb,GameCache.vip.getchargeCfg())},e.prototype.upVip=function(){this.vipNum.source="vip_json.vip_"+GameCache.vip.realValue()+"_png";var t=GameCache.hero.mainPro;if(t){var e=GameConfig.vip[GameCache.vip.realValue()];e&&e.upgradePoint&&(this.progressBar.maximum=e.upgradePoint),this.progressBar.value=t.pro(PropId.AP_VIP_POINT)}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnLuck:App.ViewManager.close(ViewConst.CHARGE),App.ViewManager.open(ViewConst.VIP)}},e}(CommunalPagePannel);__reflect(VipChargePannel.prototype,"VipChargePannel");var VipChargeWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="CommunalPageWin3Skin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPageWin);__reflect(VipChargeWin.prototype,"VipChargeWin");var VipTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="VipTipsSkin",e.closeDispose=!1,e}return __extends(e,t),e.prototype.open=function(t){if(void 0===t&&(t=null),this.list.itemRenderer=VipWelfareItem,t){var e=GameConfig.vip[t.exData1],i=[];if(e){for(var n in e.des){var o={bNew:!1,dec:""};o.dec=e.des[n],i.push(o)}this.setListData(this.list,i)}}},e}(BaseEuiWindow);__reflect(VipTips.prototype,"VipTips");var VipWelfareItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.dec&&(this.data.dec&&(this.lbDes.textFlow=TextFlowUtils.generateTextFlow(this.data.dec)),this.imgNew&&(this.imgNew.visible=this.data.bNew))},e}(BaseCustComponent);__reflect(VipWelfareItem.prototype,"VipWelfareItem");var VipWelfarePannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.indexPage=1,i.skinName="VipWelfarePannelSkin",i}return __extends(e,t),e.prototype.init=function(){this.list.itemRenderer=ItemBase},e.prototype.open=function(t){void 0===t&&(t=null),this.indexPage=1,this.addTouchEvent(this.btnLuck,this.onClick),this.message(MsgConst.PROPERTY+PropId.AP_VIP_TEMPROARY,this.upVip),this.message(MsgConst.PROPERTY+PropId.AP_VIP_GRADE,this.upVip),this.message(MsgConst.PROPERTY+PropId.AP_VIP_POINT,this.upVip),this.message(MsgConst.VIP_WELFARE,this.upCn),this.addTouchEvent(this.imgDaily,this.onClick),this.addTouchEvent(this.btnRw,this.onClick),this.slider.initData(VipWelfareSlideItem,this.getVipList(),this.onCall,this),this.upVip(),this.upCn()},e.prototype.getVipList=function(){var t=[];for(var e in GameConfig.vip)"0"!=e&&t.push(GameConfig.vip[e]);return t},e.prototype.upCn=function(){var t=GameConfig.vip[this.indexPage];this.lbTq.text=StringUtils.substitute(Language.lang.lcn7,this.indexPage),this.lbTqlb.text=StringUtils.substitute(Language.lang.lcn8,this.indexPage),this.lbAcross.text=Language.lang.lcn9,t&&(t.ExclusivePackage.length&&this.setListData(this.list,t.ExclusivePackage),t.DailyNum&&(this.imgItem.source=GlobalFun.getItemSourceById(t.DailyNum.id),this.lbNum.text=t.DailyNum.count+""));var e=!1,i="res/btn/getReward.png";GameCache.vip.vipWelfare&&GameCache.vip.vipWelfare.exclusiveList&&GameCache.vip.vipWelfare.exclusiveList[this.indexPage-1]&&2==GameCache.vip.vipWelfare.exclusiveList[this.indexPage-1]&&(i="res/btn/get_4.png"),this.btnRw.icon=i,GameCache.vip.vipWelfare&&2==GameCache.vip.vipWelfare.dailyGet&&(e=!0),this.imbGet.visible=e},e.prototype.onCall=function(){this.indexPage=this.slider.currentIndex+1,this.upCn()},e.prototype.upVip=function(){this.vipNum.source="vip_json.vip_"+GameCache.vip.realValue()+"_png";var t=GameCache.hero.mainPro;if(t){var e=GameConfig.vip[GameCache.vip.realValue()];e&&e.upgradePoint&&(this.progressBar.maximum=e.upgradePoint),this.progressBar.value=t.pro(PropId.AP_VIP_POINT)}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.btnLuck:App.ViewManager.close(ViewConst.VIP),App.ViewManager.open(ViewConst.CHARGE);break;case this.imgDaily:Proxy.vip.actDaily(this.indexPage);break;case this.btnRw:Proxy.vip.actExclusive(this.indexPage)}},e}(CommunalPagePannel);__reflect(VipWelfarePannel.prototype,"VipWelfarePannel");var VipWelfareSlideItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="VipWelfareSlideItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.listDes.itemRenderer=VipWelfareItem},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.setListData(this.listDes,this.getDesList(this.data))},e.prototype.getDesList=function(t){var e=[];if(t.sort)for(var i in t.sort){var n=t.sort[i],o={bNew:!1,dec:""},r=t.des[n];r&&(o.dec=r,o.bNew=parseInt(i)<t.number,e.push(o))}else for(var i in t.des){var o={bNew:!1,dec:""};o.dec=t.des[i],o.bNew=parseInt(i)<t.number,e.push(o)}return e},e}(BaseCustComponent);__reflect(VipWelfareSlideItem.prototype,"VipWelfareSlideItem");var VipWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="CommunalPageWin3Skin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPageWin);__reflect(VipWin.prototype,"VipWin");var VipCache=function(t){function e(){var e=t.call(this)||this;return e.privilegeCardTime=0,e.vipWelfare={dailyGet:0,exclusiveList:[]},e.chargeCfg=[],e.vipCardSt={},e}return __extends(e,t),e.prototype.clear=function(){this.privilegeCardTime=0,this.vipWelfare={dailyGet:0,exclusiveList:[]},this.chargeCfg=[],this.vipCardSt={}},e.prototype.upWelfare=function(t){this.vipWelfare=t},e.prototype.realValue=function(){var t=1,e=GameCache.hero.mainPro;return e&&(t=Math.max(e.pro(PropId.AP_VIP_TEMPROARY),e.pro(PropId.AP_VIP_GRADE))),t},e.prototype.getchargeCfg=function(){if(0==this.chargeCfg.length){for(var t in GameConfig.chognzhi){var e=GameConfig.chognzhi[t];e.sort&&this.chargeCfg.push(e)}this.chargeCfg.sort(this.sort)}return this.chargeCfg},e.prototype.sort=function(t,e){return t.sort-e.sort},e.prototype.openRechargeWin=function(){var t=new ViewProp;t.exData1={},t.exData1.func=this.openRechargeFunc,t.exData1.thisc=this,t.exData1.desc=Language.lang.reChargeHint,App.ViewManager.open(ViewConst.SYSTIPS,t)},e.prototype.openRechargeFunc=function(){if(GameCache.firstcharge.firstChargeSt){var t=this.realValue();6>t?App.ViewManager.open(ViewConst.VIP):App.ViewManager.open(ViewConst.CHARGE)}else App.ViewManager.open(ViewConst.FIRSTCHARGE)},e}(BaseCache);__reflect(VipCache.prototype,"VipCache");var VipProxy=function(t){function e(){var e=t.call(this,PacketTypes.VIP)||this;return e.regNetMsg(1,e.privilegeCardTime),e.regNetMsg(2,e.vipWelfareData),e.regNetMsg(3,e.vipWelfareExclusive),e.regNetMsg(4,e.vipWelfareDaily),e.regNetMsg(5,e.vipCardSt),e}return __extends(e,t),e.prototype.privilegeCardTime=function(t){var e=t.readInt();GameCache.vip.privilegeCardTime=e,App.MessageCenter.dispatch(MsgConst.VIP_CARD_TIME)},e.prototype.vipWelfareData=function(t){var e={dailyGet:0,exclusiveList:[]};e.dailyGet=t.readByte();for(var i=t.readByte(),n=0;i>n;n++)e.exclusiveList.push(t.readByte());GameCache.vip.upWelfare(e),App.MessageCenter.dispatch(MsgConst.VIP_WELFARE)},e.prototype.vipWelfareExclusive=function(t){var e=t.readByte(),i=GameCache.vip.vipWelfare;i&&i.exclusiveList&&(i.exclusiveList[e-1]=t.readByte()),App.MessageCenter.dispatch(MsgConst.VIP_WELFARE)},e.prototype.vipWelfareDaily=function(t){GameCache.vip.vipWelfare.dailyGet=t.readByte(),App.MessageCenter.dispatch(MsgConst.VIP_WELFARE)},e.prototype.vipCardSt=function(t){for(var e=t.readByte(),i=0;e>i;i++)GameCache.vip.vipCardSt[t.readByte()]=t.readByte();App.MessageCenter.dispatch(MsgConst.VIP_CARD)},e.prototype.actCard=function(t){var e=this.getBytes(1);e.writeByte(t),this.sendToServer(e)},e.prototype.actExclusive=function(t){var e=this.getBytes(2);e.writeByte(t),this.sendToServer(e)},e.prototype.actDaily=function(t){var e=this.getBytes(3);e.writeByte(t),this.sendToServer(e)},e}(BaseProxy);__reflect(VipProxy.prototype,"VipProxy");var VipBossItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.enterBtn,this.enterFunc),this.addTouchEvent(this.check,this.onCheck),this.check.selected=!1,this.time=new SecondCountDown,this.time.addCallBack(this.initTime,this),this.time.addLabel(this.rTime,Language.lang.reviveTime,DateUtils.TIME_FORMAT_1)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.id&&(this.time.time=0,this.stateJuge(),this.initData(),this.autoHint())},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(){var t=GameConfig.monster[this.data.id];t&&(this.mName.text=t.name,this.mLvl.text=t.level,0==this.data.hp?this.icon.source=RES_DIR_MONSTERICON+t.icon+"d.png":this.icon.source=RES_DIR_MONSTERICON+t.icon+".png",this.item_0.data=this.data.conf.reward_show[0],this.item_1.data=this.data.conf.reward_show[1],this.item_2.data=this.data.conf.reward_show[2],this.setProgess(),this.fName.text=this.data.kname,""==this.data.kname?(this.fName.visible=!1,this.fImg.visible=!1):(this.fName.visible=!0,this.fImg.visible=!0))},e.prototype.setProgess=function(){this.hp.maximum=100,this.hp.value=this.data.hp;var t=this.data.hp+"%";this.labelDisplay.text=t},e.prototype.stateJuge=function(){var t=(this.data.conf,Math.floor((this.data.reviveTime-GameCache.server.serverTime)/1e3));this.rTime.visible=!1;var e=GameCache.vip.realValue(),i=GameCache.hero.mainPro.pro(PropId.AP_LEVEL);this.lG.visible=!1,this.enterBtn.visible=!0,this.check.visible=!0,e<this.data.conf.conds||i<this.data.conf.levelConds?(this.rTime.visible=!1,this.enterBtn.visible=!1,this.lG.visible=!0,this.check.visible=!1,this.lLvl.text=StringUtils.substitute(Language.lang.vipBoss_1,this.data.conf.levelConds,this.data.conf.conds)):t>0&&0!=this.data.killTime&&0==this.data.hp&&(this.rTime.visible=!0,this.enterBtn.visible=!1,this.time.time=t)},e.prototype.initTime=function(t){return 0>=t?(App.TimerManager.remove(this.initTime,this),void GameCache.boss.refleshWorldBossData()):void 0},e.prototype.enterFunc=function(){GameCache.boss.currentBossId=this.data.id,Proxy.boss.sendBossFubenOpt(1,this.data.id),App.ViewManager.close(ViewConst.BOSS)},e.prototype.autoHint=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_LEVEL),e=GameCache.boss.getRemindSet(this.data.index);t<this.data.conf.conds?e&&(this.check.selected=!1):this.check.selected=GameCache.boss.getRemindSet(this.data.index)},e.prototype.onCheck=function(){GameCache.boss.setRemindSet(this.data.index,this.check.selected,SettingType.VIP_BOSS_REMIND)},e}(BaseCustComponent);__reflect(VipBossItem.prototype,"VipBossItem");var VipBossPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="VipBossPannelSkin",i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=VipBossItem,this.tabBar.dataProvider=new eui.ArrayCollection([{icon:"worldBoss_json.worldBoss_map_0_png"},{icon:"worldBoss_json.worldBoss_map_1_png"},{icon:"worldBoss_json.worldBoss_map_2_png"}])},e.prototype.open=function(t){this.tabBar.selectedIndex=t&&t.secIndex||0,this.message(MsgConst.BOSS_INFO,this.onTabTouche),Proxy.boss.sendBossInfo(),this.addTouchEvent(this.sweepBtn,this.openVipTips),this.addTouchEvent(this.tabBar,this.onTabTouche),App.TimerManager.addDelay(50,50,1,this.onTabTouche,this)},e.prototype.onTabTouche=function(){var t=this.tabBar.selectedIndex+1,e=[],i=GameCache.boss.bossData[BossType.VIPBOSS];for(var n in i){var o=i[n];o.conf.page==t&&e.push(o)}this.setListData(this.itemList,e)},e.prototype.sortFuncByLvl=function(t,e){return t.conf.conds<e.conf.conds?-1:1},e.prototype.exitFunc=function(){Proxy.boss.sendBossFubenOpt(2,GameCache.boss.currentBossId)},e.prototype.openVipTips=function(){var t=new ViewProp;t.firIndex=0,App.ViewManager.open(ViewConst.VIP,t)},e}(BaseSpriteView);__reflect(VipBossPannel.prototype,"VipBossPannel");var WingCache=function(t){function e(){var e=t.call(this)||this;return e.wingUpcost=0,e.wingData={},e}return __extends(e,t),e.prototype.clear=function(){this.wingData={}},e.prototype.initWingData=function(t,e,i,n){var o={lvl:e,exp:i,count:n};this.wingData[t]=o,App.MessageCenter.dispatch(MsgConst.WING_INFO),this.wingUpcost||(this.wingUpcost=GameConfig.wing[1].consumeItems[0].id)},e.prototype.checkGrade=function(t){if(!t){for(var e=GameCache.hero.list,i=0;i<e.length;i++)if(this.checkGrade(e[i].pro.pro(PropId.AP_ACTOR_ID)))return!0;return!1}var n=GameCache.wing.wingData[t],o=n&&n.lvl?n.lvl:0,r=GameConfig.wing[o+1];if(!r)return!1;var a=GameCache.wing.wingData[GameCache.hero.mainPro.pro(PropId.AP_ACTOR_ID)],s=a?a.count:0,h=GameCache.vip.realValue(),p=GameConfig.vip[h].wing;if(p-s){var l=GameCache.hero.mainPro.pro(PropId.AP_COIN);if(l>=r.consumeGold[0].count)return!0}else{var c=GameCache.bag.itemCount(r.consumeItems[0].id);if(c>=r.consumeItems[0].count)return!0}return!1},e}(BaseCache);__reflect(WingCache.prototype,"WingCache");var WingPage=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.countNum=0,i.realvalue=0,i.lastTime=0,i.cacheGroup=[],i.btnTime=0,i.skinName="WingPageSkin",i.body=new DBAvatar,i.body.setRoot(i.roleMdl,null),i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.roleSelect.setHandler(this,this.onCLick,[]),this.cost_0.lab.textFlow=this.cost_1.lab.textFlow=TextFlowUtils.generateTextFlow("<(c0x4c2f27)"+Language.lang.consume+">"),this.cost_0.gainWay.visible=this.cost_1.gainWay.visible=!1,this.cBox.labelDisplay.color=4992807,this.propList.setGap(11)},e.red=function(){return GameCache.wing.checkGrade()?!0:!1},e.prototype.roleRed=function(t){return GameCache.wing.checkGrade(t)?!0:!1},e.changeMsg=function(){return[MsgConst.WING_INFO,MsgConst.PROPERTY+PropId.AP_COIN]},e.prototype.refreshRed=function(){t.prototype.refreshRed.call(this)},e.prototype.open=function(t){this.message(MsgConst.WING_INFO,this.initData),this.addTouchEvent(this.btn_0,this.wingUpgrade),this.addTouchEvent(this.btn_1,this.wingUpgrade),this.addTouchEvent(this.btn_2,this.wingUpgrade),this.onCLick()},e.prototype.destroy=function(){this.body&&(this.body.dispose(),this.body=null),t.prototype.destroy.call(this)},e.prototype.onCLick=function(){this.pro.slideDuration=0,this.initData()},e.prototype.initData=function(){var t=GameCache.wing.wingData[this.roleSelect.roleId];t||(t={lvl:0,exp:0,count:10});var e=GameConfig.wing[t.lvl],i=GameConfig.wing[t.lvl+1];if(e){this.realvalue=t.exp,this.pro.maximum!=e.wingExp?(this.pro.maximum=e.wingExp,App.FrameHandler.add(this.jugeTimeSpace,this,!0,t.exp)):this.jugeTimeSpace(t.exp),this.cost_0.visible=this.cost_1.visible=i?!0:!1,i&&(this.cost_1.setData(i.consumeItems[0].id,i.consumeItems[0].count),this.cost_0.setData(i.consumeGold[0].id,i.consumeGold[0].count));var n=this.roleSelect.sex+"";e.wingAppearance?(this.roleMdl.visible=!0,this.body.load(e.wingAppearance[this.roleSelect.job-1]+n,!0,!1),this.body.play("stand")):this.roleMdl.visible=!1;var o=i?i.levelAtt:[];this.propList.setData(e.levelAtt,o,this.roleSelect.job,16762368,16777215,65292,[],"PropItem2Skin");var r=GameCache.vip.realValue(),a=GameConfig.vip[r].wing,s=GameCache.wing.wingData[GameCache.hero.getRoleIdByIndex(0)],h=s?s.count:0;this.countNum=a-h,this.count.text="("+(a-h)+")",this.starPro.setData(10,e.starlevel),this.lvlT.text=e.classLvl+"阶"+e.starlevel+"星",this.initSkill(e.classLvl),this.initZdl()}},e.prototype.jugeTimeSpace=function(t){var e=egret.getTimer()-this.lastTime;this.lastTime=egret.getTimer(),100>e?(this.cacheGroup.push(t),App.TimerManager.isExists(this.delayFunc,this)||App.TimerManager.addDelay(200,100,0,this.delayFunc,this)):this.pro.value=t},e.prototype.delayFunc=function(){this.cacheGroup.length?this.pro.value=this.cacheGroup.shift():(App.TimerManager.remove(this.delayFunc,this),this.pro.value=this.realvalue)},e.prototype.initSkill=function(t){var e=GameConfig.wingSkill,i=0;for(var n in e)this["skill_"+i].initData(e[n],t),i++},e.prototype.initZdl=function(){for(var t=0,e=0;4>e;e++)t+=this["skill_"+e].zdl;this.zdl.value=t+this.propList.zdl},e.prototype.wingUpgrade=function(t){var e=parseInt(t.target.name),i=egret.getTimer()-this.btnTime;if(!(250>i))if(this.cacheGroup=[],this.btnTime=egret.getTimer(),2!=e){if(this["cost_"+e].checkEnough()){if(!this.countNum&&0==e)return void GlobalFun.SysMsg(Language.lang.wing_0);Proxy.wing.sendWingUpgrade(this.roleSelect.nSlRole,e)}}else if(this.countNum)this.cost_0.isExpend||this.cost_1.isExpend?Proxy.wing.sendWingUpgrade(this.roleSelect.nSlRole,e):this.cost_1.checkEnough();else{if(!this.cost_1.checkEnough())return;Proxy.wing.sendWingUpgrade(this.roleSelect.nSlRole,e)}},e}(BaseSpriteView);__reflect(WingPage.prototype,"WingPage");var WingPanel=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.open=function(e){void 0===e&&(e=null),t.prototype.open.call(this,e)},e.prototype.init=function(){t.prototype.init.call(this)},e}(CommunalPagePannel);__reflect(WingPanel.prototype,"WingPanel");var WingProxy=function(t){function e(){var e=t.call(this,PacketTypes.WING)||this;return e.regNetMsg(1,e.doWingInfo),e}return __extends(e,t),e.prototype.doWingInfo=function(t){var e=GameCache.hero.transIdFromeServer(t.readUnsignedInt()),i=t.readUnsignedShort(),n=t.readUnsignedInt(),o=t.readByte();GameCache.wing.initWingData(e,i,n,o)},e.prototype.sendWingInfo=function(t){var e=GameCache.hero.getServerIdByIndex(t),i=this.getBytes(1);i.writeByte(e),this.sendToServer(i)},e.prototype.sendWingUpgrade=function(t,e){var i=this.getBytes(2),n=GameCache.hero.getServerIdByIndex(t);i.writeInt(n),i.writeByte(e),this.sendToServer(i)},e}(BaseProxy);__reflect(WingProxy.prototype,"WingProxy");var WingSkillTips=function(t){function e(){var e=t.call(this)||this;return e.skinName="WingSkillTipsSkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.t0.text=Language.lang.wingActiCondition,this.t1.text=Language.lang.wingSkillEff},e.prototype.open=function(e){t.prototype.open.call(this),this.initData(e.exData1,e.exData2)},e.prototype.close=function(t){},e.prototype.initData=function(t,e){var i=GameConfig.wingSkill[t];this.condiTxt.text=StringUtils.substitute(Language.lang.conditionText,t),this.skillIcon.source="wing_json.wing_skill_"+i.img+"_png",this.desc.text=i.dec;var n=i.id>e?StringUtils.substitute(Language.lang.unActive,i.name):i.name;this.skillName.textFlow=TextFlowUtils.generateTextFlow(n)},e}(BaseEuiWindow);__reflect(WingSkillTips.prototype,"WingSkillTips");var StarItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(StarItem.prototype,"StarItem");var StarProgress=function(t){function e(){var e=t.call(this)||this;return e._maximum=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.itemList.itemRenderer=StarItem},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.setData=function(t,e){var i=[];i.length=t,this._maximum=t,this.datatGroup?t!=this._maximum&&(this.datatGroup.source=i,this.itemList.dataProviderRefreshed()):(this.datatGroup=new eui.ArrayCollection(i),this.itemList.dataProvider=this.datatGroup),App.TimerManager.addDelay(50,50,1,this.value,this,null,null,e)},e.prototype.value=function(t){for(var e=0;e<this.itemList.numChildren;e++){var i=this.itemList.getChildAt(e);i.currentState=t-1>=e?"on":"off"}},e}(BaseCustComponent);__reflect(StarProgress.prototype,"StarProgress");var WingSkillItem=function(t){function e(){var e=t.call(this)||this;return e._zdl=0,e.lvl=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this,this.openTips)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initData=function(t,e){this.skillIcon.source="wing_json.wing_skill_"+t.img+"_png",this.lvl=e,this.skillId=t.id;var i=e>=t.id;this.condi.text=i?t.name:StringUtils.substitute(Language.lang.openTxt,t.id),i||this.filters||(this.filters=FilterUtils.DefaultGrayFilters),i&&(this.filters=null,this._zdl=ItemUtils.getZdlByProp(t.att))},Object.defineProperty(e.prototype,"zdl",{get:function(){return this._zdl},enumerable:!0,configurable:!0}),e.prototype.openTips=function(){var t=new ViewProp;t.exData1=this.skillId,t.exData2=this.lvl,App.ViewManager.open(ViewConst.WINGSKILL,t)},e}(BaseCustComponent);__reflect(WingSkillItem.prototype,"WingSkillItem");var BossCache=function(t){function e(){var e=t.call(this)||this;return e.bossHintGroup=[],e.worldEnterCount={},e.bossData={},e.reviveGroup={},e}return __extends(e,t),e.prototype.clear=function(){this.bossData={},this.worldEnterCount={},App.TimerManager.remove(this.refleshFunc,this),this.currentBossId=0,this.reviveGroup={}},e.prototype.refleshWorldBossData=function(){App.TimerManager.isExists(this.refleshFunc,this)||App.TimerManager.addDelay(0,200,1,this.refleshFunc,this)},e.prototype.refleshFunc=function(){Proxy.boss.sendBossInfo()},e.prototype.isWorldBossMap=function(){var t=GameCache.map.mapId,e=GameConfig.worldBoss;switch(GameCache.map.mapConfig.type){case 1:e=GameConfig.worldBoss;break;case 9:e=GameConfig.vipBoss}for(var i in e)if(e[i].scenceid==t)return this.currentBossId=e[i].entityid,!0;return!1},e.prototype.openExitTips=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=Language.lang.exitWorldBoss),t)return void this.exit();var i=new ViewProp,n={},o=GameCache.map.fbId,r=GameConfig.fuben[o];e=e?e:r.exitDec,n.desc=e,n.thisc=this,n.func=this.exit,i.exData1=n,App.ViewManager.open(ViewConst.SYSTIPS,i)},e.prototype.exit=function(){Proxy.boss.sendBossFubenOpt(2,GameCache.boss.currentBossId)},e.prototype.addWorldBossINfo=function(){this.isWorldBossMap(),App.ViewManager.open(ViewConst.WBINFO)
},e.prototype.removeWorldBossINfo=function(){App.ViewManager.isShow(ViewConst.WBINFO)&&App.ViewManager.close(ViewConst.WBINFO)},e.prototype.getRemindSet=function(t,e){void 0===e&&(e=SettingType.BOSS_REMIND);var i=GameCache.settings.getValue(e);return 1!=(i>>t&1)},e.prototype.setRemindSet=function(t,e,i){void 0===i&&(i=SettingType.BOSS_REMIND);var n=e?0:1,o=GameCache.settings.getValue(i);o&=4294967295-(1<<t),1==n&&(o+=1<<t),GameCache.settings.update(i,o,!0)},e.prototype.openAwardTips=function(t,e,i){if(void 0===t&&(t=[]),void 0===e&&(e=2),App.ViewManager.isShow(ViewConst.AWARDTIPS)){var n=App.ViewManager.getView(ViewConst.AWARDTIPS);n.setList(e,t)}else{var o={};o.state=i?i:"boss",o.func=this.recvAward,o.itemArr1=1==e?t:[],o.itemArr=2==e?t:[];var n=new ViewProp;n.firData=o,App.ViewManager.open(ViewConst.AWARDTIPS,n)}},e.prototype.recvAward=function(){Proxy.boss.sendRecieveAw(GameCache.boss.currentBossId),Proxy.boss.sendBossFubenOpt(2,GameCache.boss.currentBossId)},e.prototype.isReviving=function(t,e,i,n){var o=e-GameCache.server.serverTime;o>=0&&0==n?this.reviveGroup[t.id]=[e,i,t.conds]:this.reviveGroup[t.id]&&delete this.reviveGroup[t.id],App.TimerManager.isExists(this.countDown,this)||App.TimerManager.addDelay(0,3e3,0,this.countDown,this)},e.prototype.countDown=function(){if(Object.keys(this.reviveGroup).length)for(var t in this.reviveGroup){var e=GameCache.server.serverTime,i=GameCache.boss.getRemindSet(this.reviveGroup[t][1]),n=GameCache.hero.mainPro.pro(PropId.AP_LEVEL);this.reviveGroup[t][0]-e<3e3&&this.reviveGroup[t][0]-e>=0?i&&this.reviveGroup[t][2]<=n&&(this.bossHintGroup.push(parseInt(t)),App.ViewManager.isShow(ViewConst.WBREVIVE)||GameCache.map.mapConfig.type!=SceneType.NORMAL_FIELD||App.ViewManager.open(ViewConst.WBREVIVE)):this.reviveGroup[t][0]-e<0&&delete this.reviveGroup[t]}else App.TimerManager.remove(this.countDown,this)},e.prototype.getWorldBossBuyMax=function(){var t=GameCache.vip.realValue(),e=GameConfig.vip[t],i=GameConfig.vip[t+1]?GameConfig.vip[t+1]:e,n=this.worldEnterCount?this.worldEnterCount:null,o=e.WorldBoss;return[o,n.limit,i.WorldBoss]},e.prototype.getEnableEnterWB=function(){var t=GameCache.boss.worldEnterCount,e=t&&t.count?t.count:0,i=GameConfig.globalConfig.worldBossNum,n=i+t.buyCount-e;return n>0},e}(BaseCache);__reflect(BossCache.prototype,"BossCache");var BossProxy=function(t){function e(){var e=t.call(this,PacketTypes.BOSS)||this;return e.regNetMsg(1,e.doBossInfo),e.regNetMsg(25,e.doWorldBossCount),e.regNetMsg(4,e.doAwardInfo),e.regNetMsg(27,e.updatePgtBossChallengeInfo),e.regNetMsg(28,e.updatePgtBossInfo),e}return __extends(e,t),e.prototype.doBossInfo=function(t){for(var e=t.readUnsignedShort(),i={},n={},o=0;e>o;o++){var r={};r.id=t.readShort(),r.hp=t.readByte(),r.killTime=GlobalFun.formatMiniDateTime(t.readUnsignedInt()),r.reviveTime=GlobalFun.formatMiniDateTime(t.readUnsignedInt()),r.type=t.readUnsignedShort(),r.kname=t.readCustomBytes(),n[r.type]=n[r.type]>0?n[r.type]:0,r.index=n[r.type]++,i[r.type]||(i[r.type]={});var a=i[r.type];a[r.id]?r.conf=a[r.id].conf:r.conf=this.getBossConfig(r.id,r.type),r.conf&&(a[r.id]=r,GameCache.boss.isReviving(r.conf,r.reviveTime,r.index,r.hp))}GameCache.boss.bossData=i,App.MessageCenter.dispatch(MsgConst.BOSS_INFO)},e.prototype.getBossConfig=function(t,e){var i;switch(e){case BossType.WORLDBOSS:i=GameConfig.worldBoss[t];break;case BossType.VIPBOSS:i=GameConfig.vipBoss[t]}return i},e.prototype.doWorldBossCount=function(t){var e={};e.count=t.readUnsignedShort(),e.buyCount=t.readUnsignedShort();var i=t.readUnsignedInt();e.timeChkPoint=i?GlobalFun.formatMiniDateTime(i):0,e.limit=t.readUnsignedShort(),GameCache.boss.worldEnterCount=e,App.MessageCenter.dispatch(MsgConst.WORLDBOSS_COUNT)},e.prototype.doAwardInfo=function(t){for(var e=t.readUnsignedShort(),i=[],n=0;e>n;n++){var o=(t.readByte(),t.readUnsignedShort()),r=t.readUnsignedInt();i.push([o,r])}GameCache.award.openAwardTips(i,AwardSourceType.BOSS)},e.prototype.sendBossInfo=function(){var t=this.getBytes(1);this.sendToServer(t)},e.prototype.sendBossFubenOpt=function(t,e){var i=this.getBytes(2);i.writeByte(t),i.writeShort(e),this.sendToServer(i)},e.prototype.sendRecieveAw=function(t){var e=this.getBytes(4);e.writeShort(t),this.sendToServer(e)},e.prototype.updatePgtBossInfo=function(t){GameCache.pgtBoss.pgtBuy=t.readUnsignedByte(),GameCache.pgtBoss.pgtChallenge=t.readUnsignedByte();var e=t.readUnsignedInt();e&&(e=GlobalFun.formatMiniDateTime(e)),GameCache.pgtBoss.pgtRefresh=e;for(var i=t.readUnsignedShort(),n=[],o=0;i>o;o++){var r=t.readUnsignedInt();r&&(r=GlobalFun.formatMiniDateTime(r));var a=t.readUnsignedByte(),s=t.readUnsignedByte(),h=t.readUnsignedShort();n.push({bossid:h,hp:a,complete:s,cd:r})}GameCache.pgtBoss.updatePgtBossData(n),App.MessageCenter.dispatch(MsgConst.PURGATORY_BOSS_UPDATE)},e.prototype.updatePgtBossChallengeInfo=function(t){GameCache.pgtBoss.pgtBuy=t.readByte(),GameCache.pgtBoss.pgtChallenge=t.readByte();var e=t.readUnsignedInt();e&&(e=GlobalFun.formatMiniDateTime(e)),GameCache.pgtBoss.pgtRefresh=e,App.MessageCenter.dispatch(MsgConst.PURGATORY_BOSS_UPDATE)},e.prototype.pgtBossBuy=function(){var t=this.getBytes(22);this.sendToServer(t)},e}(BaseProxy);__reflect(BossProxy.prototype,"BossProxy");var WorldBossCountBuy=function(t){function e(){var e=t.call(this,LayerManager.UI_Tips)||this;return e.skinName="WorldBossCountBuySkin",e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){t.prototype.open.call(this),this.message(MsgConst.WORLDBOSS_COUNT,this.initData),this.addTouchEvent(this.numSele,this.onTouche),this.addTouchEvent(this.btn_0,this.buyFunc),this.initData()},e.prototype.initData=function(){var t=GameCache.boss.worldEnterCount?GameCache.boss.worldEnterCount:null,e=t?10-t.buyCount:10;this.max.text="今日尚可购买"+e+"次",this.numSele.initData(10-t,1),this.cost.setData(GlobalVar.GOLD,5)},e.prototype.onTouche=function(){this.cost.setData(GlobalVar.GOLD,5*this.numSele.num)},e.prototype.buyFunc=function(){Proxy.boss.sendBossFubenOpt(3,29),this.closeView()},e}(BaseEuiWindow);__reflect(WorldBossCountBuy.prototype,"WorldBossCountBuy");var WorldBossPannel=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,e)||this;return i.skinName="WorldBossPannelSkin",i.bossListData={},i}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=WorldBossItem,this.tabBar.dataProvider=new eui.ArrayCollection([{icon:"worldBoss_json.worldBoss_map_0_png"},{icon:"worldBoss_json.worldBoss_map_1_png"},{icon:"worldBoss_json.worldBoss_map_2_png"}])},e.red=function(){return GameCache.boss.getEnableEnterWB()},e.changeMsg=function(){return[MsgConst.WORLDBOSS_COUNT]},e.prototype.refreshRed=function(){},e.prototype.open=function(t){this.tabBar.selectedIndex=t&&t.secIndex||0,this.message(MsgConst.BOSS_INFO,this.onTabTouche),this.message(MsgConst.WORLDBOSS_COUNT,this.initTime),Proxy.boss.sendBossInfo(),this.addTouchEvent(this.buyBtn,this.openBuy),this.addTouchEvent(this.tabBar,this.onTabTouche),this.initTime()},e.prototype.close=function(e){t.prototype.close.call(this)},e.prototype.onTabTouche=function(){var t=this.tabBar.selectedIndex+1,e=[],i=GameCache.boss.bossData[BossType.WORLDBOSS];for(var n in i){var o=i[n];o.conf.page==t&&e.push(o)}this.setListData(this.itemList,e)},e.prototype.sortFuncByLvl=function(t,e){return t.conf.conds<e.conf.conds?-1:1},e.prototype.exitFunc=function(){Proxy.boss.sendBossFubenOpt(2,GameCache.boss.currentBossId)},e.prototype.initTime=function(){var t=GameCache.boss.worldEnterCount,e=t&&t.count?t.count:0,i=GameConfig.globalConfig.worldBossNum,n=i+t.buyCount-e;this.count.textFlow=TextFlowUtils.generateTextFlow(StringUtils.substitute(Language.lang.remain,n+"/"+i)),t.timeChkPoint?(this.cTime.visible=!0,this.time=3600-Math.floor((GameCache.server.serverTime-t.timeChkPoint)/1e3),this.time>=0&&(App.TimerManager.isExists(this.timeCount,this)||App.TimerManager.addDelay(0,1e3,0,this.timeCount,this))):(this.cTime.visible=!1,App.TimerManager.isExists(this.timeCount,this)&&App.TimerManager.remove(this.timeCount,this))},e.prototype.timeCount=function(){return this.time<0?(App.TimerManager.remove(this.timeCount,this),void(this.time=0)):(this.cTime.text=StringUtils.substitute(Language.lang.resetTime,App.DateUtils.getFormatBySecond(this.time,DateUtils.TIME_FORMAT_1)),void this.time--)},e.prototype.openBuy=function(){GlobalFun.openEnterBuy("wboss")},e}(BaseSpriteView);__reflect(WorldBossPannel.prototype,"WorldBossPannel");var WorldBossReviveTips=function(t){function e(){var e=t.call(this,LayerManager.UI_Message)||this;return e.skinName="WorldBossReviveTipsSkin",e.right=10,e.bottom=200,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.open=function(e){t.prototype.open.call(this),this.addTouchEvent(this.cBtn,this.closeFunc),this.addTouchEvent(this.enterBtn,this.enterFunc),this.initLabel()},e.prototype.initLabel=function(){var t=GameCache.boss.bossHintGroup.shift(),e=GameConfig.monster[t];return t&&e?(this.bName.text=StringUtils.substitute(Language.lang.wbName,e.level,e.name),this.bossId=t,void(this.icon.source=RES_DIR_MONSTERICON+e.icon+".png")):void this.closeView()},e.prototype.closeFunc=function(){this.initLabel()},e.prototype.enterFunc=function(){var t;for(var e in GameCache.boss.bossData)if(GameCache.boss.bossData[e][this.bossId]){t=GameCache.boss.bossData[e][this.bossId];break}var i=new ViewProp;switch(t.type){case BossType.WORLDBOSS:i.firIndex=0;break;case BossType.VIPBOSS:i.firIndex=2}i.secIndex=t.conf.page-1,App.ViewManager.open(ViewConst.BOSS,i),this.closeView()},e}(BaseEuiWindow);__reflect(WorldBossReviveTips.prototype,"WorldBossReviveTips");var BossWin=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(CommunalPageWin);__reflect(BossWin.prototype,"BossWin");var BossRankItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){return t.prototype.dataChanged.call(this),this.data&&this.data.bossid?(this.rName.text=this.data.roleName,this.value.text=GlobalFun.numCut(this.data.value),this.rNum.visible=this.data.rank>3||this.data.rank<0,this.rImg.visible=!this.rNum.visible,this.rNum.text=this.data.rank<=0?Language.lang.jingji_t8:this.data.rank+"",void(this.rImg.visible?this.rImg.source="public_json.public_rank_"+this.data.rank+"_png":this.rImg.source=null)):void this.cleanFunc()},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.cleanFunc=function(){this.rNum.text=this.rName.text=this.value.text="",this.rImg.source=null},e}(BaseCustComponent);__reflect(BossRankItem.prototype,"BossRankItem");var GSItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.gs||(this.gs=ObjectPool.get(eui.Image),this.gs.top=-2,this.gs.left=-2,this.gs.source="public_json.public_gs_tag_png",this.addChild(this.gs))},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.gs&&(this.gs.source=null)},e}(ItemBase);__reflect(GSItem.prototype,"GSItem");var LiveScroll=function(t){function e(){var e=t.call(this)||this;return e.oncea=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);var e=this.g.layout;this.gap=e.gap,this.addEvent(egret.TouchEvent.TOUCH_BEGIN,this,this.onBegin),this.addEvent(egret.TouchEvent.TOUCH_MOVE,this,this.onMove)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this)},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.initSC=function(t,e,i,n){this.type=i;var o=ObjectPool.get(i);n&&(o.skinName=n,this.itemSkin=n),this.g.addChild(o);var r=Math.ceil(this.sc.height/o.height),a=[],s=[];for(var h in t)s.push(t[h]);for(var h=0;r>h;h++){var p=t[""+(e+h)]||s[e+h];if(!p)break;if(0==h)o.data=p;else{var l=ObjectPool.get(i);n&&(l.skinName=n),l.data=p,this.g.addChild(l)}a.push(p)}},e.prototype.onBegin=function(t){this.scY=this.sc.viewport.scrollV,this.firstItem=this.g.getElementAt(0)},e.prototype.onMove=function(){if(this.firstItem&&this.oncea&&this.sc.viewport.scrollV-this.scY<=-3){var t=ObjectPool.get(this.type);t.skinName=this.itemSkin,this.g.addChildAt(t,0),this.oncea=!1}},e}(BaseCustComponent);__reflect(LiveScroll.prototype,"LiveScroll");var WorldBossItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addTouchEvent(this.enterBtn,this.enterFunc),this.addTouchEvent(this.check,this.onCheck),this.check.selected=!1,this.time=new SecondCountDown,this.time.addCallBack(this.initTime,this),this.time.addLabel(this.rTime,Language.lang.reviveTime,DateUtils.TIME_FORMAT_1)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data.id&&(this.time.time=0,this.stateJuge(),this.initData(),this.autoHint())},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.time.dispose()},e.prototype.initData=function(){var t=GameConfig.monster[this.data.id];t&&(this.mName.text=t.name,this.mLvl.text=t.level,0==this.data.hp?this.icon.source=RES_DIR_MONSTERICON+t.icon+"d.png":this.icon.source=RES_DIR_MONSTERICON+t.icon+".png",this.item_0.data=this.data.conf.reward_show[0],this.item_1.data=this.data.conf.reward_show[1],this.item_2.data=this.data.conf.reward_show[2],this.setProgess(),this.fName.text=this.data.kname,""==this.data.kname?(this.fName.visible=!1,this.fImg.visible=!1):(this.fName.visible=!0,this.fImg.visible=!0))},e.prototype.setProgess=function(){this.hp.maximum=100,this.hp.value=this.data.hp;var t=this.data.hp+"%";this.labelDisplay.text=t},e.prototype.stateJuge=function(){var t=(this.data.conf,Math.floor((this.data.reviveTime-GameCache.server.serverTime)/1e3));this.rTime.visible=!1;var e=GameCache.hero.mainPro.pro(PropId.AP_LEVEL);this.lG.visible=!1,this.enterBtn.visible=!0,this.check.visible=!0,e<this.data.conf.conds?(this.rTime.visible=!1,this.enterBtn.visible=!1,this.lG.visible=!0,this.check.visible=!1,this.lLvl.text=StringUtils.substitute(Language.lang.lvlCondition,this.data.conf.conds)):t>0&&0!=this.data.killTime&&0==this.data.hp&&(this.rTime.visible=!0,this.enterBtn.visible=!1,this.time.time=t)},e.prototype.autoHint=function(){var t=GameCache.hero.mainPro.pro(PropId.AP_LEVEL),e=GameCache.boss.getRemindSet(this.data.index);t<this.data.conf.conds?e&&(this.check.selected=!1):this.check.selected=GameCache.boss.getRemindSet(this.data.index)},e.prototype.initTime=function(t){return 0>=t?(App.TimerManager.remove(this.initTime,this),void GameCache.boss.refleshWorldBossData()):void 0},e.prototype.enterFunc=function(){var t=GameCache.boss.worldEnterCount,e=t&&t.count?t.count:0,i=10+t.buyCount-e;i>0?(GameCache.boss.currentBossId=this.data.id,Proxy.boss.sendBossFubenOpt(1,this.data.id),App.ViewManager.close(ViewConst.BOSS)):GlobalFun.openEnterBuy("wboss")},e.prototype.onCheck=function(){GameCache.boss.setRemindSet(this.data.index,this.check.selected)},e}(BaseCustComponent);__reflect(WorldBossItem.prototype,"WorldBossItem");var WorldInfo=function(t){function e(){var e=t.call(this,LayerManager.UI_Main)||this;return e.skinName="WorldInfoSkin",e.verticalCenter=10,e.horizontalCenter=0,e.left=5,e.right=5,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.itemList.itemRenderer=BossRankItem},e.prototype.open=function(){InfoViewController.customBtn(this.btnGroup),this.mySelf.data=null,this.message(MsgConst.BOSS_RANK_INFO,this.initRank),this.addTouchEvent(this.btn_1,this.buyBuff),this.mySelf.rName.text=GameCache.hero.mainPro.charName,this.mySelf.value.text="0"},e.prototype.close=function(){t.prototype.close.call(this),this.setListData(this.itemList,[]),this.mySelf.data=null,GameCache.copy.buffBuy=[0,0]},e.prototype.initRevive=function(){},e.prototype.openRevive=function(){App.ViewManager.open(ViewConst.REVIVE)},e.prototype.openStrength=function(){App.ViewManager.open(ViewConst.SHOPTIPS)},e.prototype.buyBuff=function(){App.ViewManager.open(ViewConst.BUYBUFF)},e.prototype.initRank=function(t){if(this.setListData(this.itemList,t[0]),t[0]){var e={bossid:t[0],rank:t[1],roleId:GameCache.hero.mainPro.pro(PropId.AP_ACTOR_ID),value:t[2],roleName:GameCache.hero.mainPro.charName};this.initMyself(e)}else this.initMyself(null)},e.prototype.initMyself=function(t){this.mySelf.data=t},e}(BaseEuiWindow);__reflect(WorldInfo.prototype,"WorldInfo");var BossType;!function(t){t[t.STAGE_FB=1]="STAGE_FB",t[t.PERSIONAL_FB=2]="PERSIONAL_FB",t[t.MATERIAL=3]="MATERIAL",t[t.MIWU_TOWER=4]="MIWU_TOWER",t[t.EXP=5]="EXP",t[t.ARENA=6]="ARENA",t[t.WORLDBOSS=7]="WORLDBOSS",t[t.VIPBOSS=8]="VIPBOSS",t[t.PURGATORY_BOSS=9]="PURGATORY_BOSS"}(BossType||(BossType={}));var ZdlPrint=function(t){function e(){var e=t.call(this)||this;return e.zdlValue=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.zdl.gap=17},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),"number"==typeof this.data?this.zdl.value=this.data:"string"==typeof this.data&&(this.zdl.value=parseInt(this.data))},Object.defineProperty(e.prototype,"value",{get:function(){return this.zdl.value},set:function(t){"number"==typeof t?this.zdl.value=t:"string"==typeof t&&(this.zdl.value=parseInt(t))},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){t.prototype.dispose.call(this)},e}(BaseCustComponent);__reflect(ZdlPrint.prototype,"ZdlPrint");var GameCache;!function(t){function e(){t.hero=new HeroCache,t.map=new MapCache,t.global=new GlobalCache,t.server=new ServerCache,t.settings=new SettingsCache,t.novice=new NoviceCache,t.skill=new SkillCache,t.pet=new PetCache,t.shop=new ShopCache,t.email=new EmailCache,t.suit=new SuitCache,t.equip=new EquipCache,t.bag=new BagCache,t.gashapon=new GashaponCache,t.buff=new BuffCache,t.daily=new DailyCache,t.transfer=new TransferCache,t.sign=new SignCache,t.adventure=new AdventrueCache,t.quest=new QuestCache,t.pass=new PassCache,t.strength=new StrengthCache,t.fashion=new FashionCache,t.boss=new BossCache,t.wing=new WingCache,t.copy=new CopyCache,t.vip=new VipCache,t.rank=new RankCache,t.revive=new ReviveCache,t.firstcharge=new FirstChargeCache,t.copytower=new CopyTowerCache,t.badge=new BadgeCache,t.totems=new TotemsCache,t.jingji=new JingjiCache,t.jewel=new JewelCache,t.rune=new RuneCache,t.sysopen=new SysOpenCache,t.chat=new ChatCache,t.activity=new ActivityCache,t.purgatory=new PurgatoryCache,t.award=new AwardCache,t.pgtBoss=new PgtBossCache,t.family=new FamilyCache}t.init=e}(GameCache||(GameCache={}));var GameConfig=function(){function t(){}return Object.defineProperty(t,"scene",{get:function(){return ConfigCache.getConfig("scene")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"fuben",{get:function(){return ConfigCache.getConfig("fuben")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"monster",{get:function(){return ConfigCache.getConfig("monster")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"clientGlobal",{get:function(){return ClientGlobalConfig.ins()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"globalConfig",{get:function(){return ConfigCache.getConfig("GlobalConfig")[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"brocast",{get:function(){return ConfigCache.getConfig("broadcast")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"carousel",{get:function(){return ConfigCache.getConfig("carousel")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"noviceGuide",{get:function(){return ConfigCache.getConfig("noviceGuide")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"npc",{get:function(){return ConfigCache.getConfig("npc")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"skill",{get:function(){return ConfigCache.getConfig("skill")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"skillBar",{get:function(){return ConfigCache.getConfig("skillBar")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"rank",{get:function(){return ConfigCache.getConfig("rank")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"miwuTower",{get:function(){return ConfigCache.getConfig("miwuTower")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"miwuTowerJackpot",{get:function(){return ConfigCache.getConfig("miwuTowerJackpot")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"modControl",{get:function(){return ConfigCache.getConfig("modControl")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"skillEff",{get:function(){return ConfigCache.getConfig("skillEffect")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"daily",{get:function(){return ConfigCache.getConfig("daily")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DailyReward",{get:function(){return ConfigCache.getConfig("DailyReward")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gashaponDisplay",{get:function(){return ConfigCache.getConfig("gashaponDisplay")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"adventure",{get:function(){return ConfigCache.getConfig("maoxian")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"sign",{get:function(){return ConfigCache.getConfig("dailySign")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pet",{get:function(){return ConfigCache.getConfig("pet")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"petconfig",{get:function(){return ConfigCache.getConfig("petconfig")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"petskill",{get:function(){return ConfigCache.getConfig("petskill")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"equipAddition",{get:function(){return ConfigCache.getConfig("equipAddition")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"equipExchangeLevel",{get:function(){return ConfigCache.getConfig("equipExchangeLevel")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"equipExchange",{get:function(){return ConfigCache.getConfig("equipExchange")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"mainIconCtr",{get:function(){return ConfigCache.getConfig("mainUIIconControl")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"item",{get:function(){return ConfigCache.getConfig("item")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"quest",{get:function(){return ConfigCache.getConfig("quest")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"errotips",{get:function(){return ConfigCache.getConfig("errotips")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"passMonster",{get:function(){return ConfigCache.getConfig("passMonster")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"passSpAw",{get:function(){return ConfigCache.getConfig("barrierSpecialAward")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"passAw",{get:function(){return ConfigCache.getConfig("barrierPassAward")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"passBOSS",{get:function(){return ConfigCache.getConfig("barrierBOSS")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"prop",{get:function(){return ConfigCache.getConfig("attribute")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"buffId",{get:function(){return ConfigCache.getConfig("attributeBuffId")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strengthProp",{get:function(){return ConfigCache.getConfig("StrsMaster")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strengthCost",{get:function(){return ConfigCache.getConfig("StrengthEquip")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"transfer",{get:function(){return ConfigCache.getConfig("transfer")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"transfertotal",{get:function(){return ConfigCache.getConfig("transfertotal")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"transferconfig",{get:function(){return ConfigCache.getConfig("transferconfig")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"instruction",{get:function(){return ConfigCache.getConfig("syshelp")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"worldBoss",{get:function(){return ConfigCache.getConfig("WorldBoss")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"worldBossAw",{get:function(){return ConfigCache.getConfig("")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"fashion",{get:function(){return ConfigCache.getConfig("fashionequip")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"fashionSuit",{get:function(){return ConfigCache.getConfig("fashionesuit")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"dress",{get:function(){return ConfigCache.getConfig("dress")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"refine",{get:function(){return ConfigCache.getConfig("ReMaster")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"wing",{get:function(){return ConfigCache.getConfig("wing")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"wingSkill",{get:function(){return ConfigCache.getConfig("wingSkill")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"bagStuff",{get:function(){return ConfigCache.getConfig("bagConfig")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"grBoss",{get:function(){return ConfigCache.getConfig("personalBoss")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"copyMaterials",{get:function(){return ConfigCache.getConfig("cailiaoCopy")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"copyExp",{get:function(){return ConfigCache.getConfig("expCopy")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"totems",{get:function(){return ConfigCache.getConfig("Totems")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"resonance",{get:function(){return ConfigCache.getConfig("TotemsRes")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"badge",{get:function(){return ConfigCache.getConfig("badge")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"recharge",{get:function(){return ConfigCache.getConfig("recharge")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"chognzhi",{get:function(){return ConfigCache.getConfig("chognzhi")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"vip",{get:function(){return ConfigCache.getConfig("vip")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"vipCard",{get:function(){return ConfigCache.getConfig("vipCard")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shop",{get:function(){return ConfigCache.getConfig("shop")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"jingji",{get:function(){return ConfigCache.getConfig("arena")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"customBtn",{get:function(){return ConfigCache.getConfig("customBtn")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"jewel",{get:function(){return ConfigCache.getConfig("gem")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"rune",{get:function(){return ConfigCache.getConfig("Rune")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"runeSkill",{get:function(){return ConfigCache.getConfig("runeSkill")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"vipBoss",{get:function(){return ConfigCache.getConfig("vipBoss")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"fail",{get:function(){return ConfigCache.getConfig("failtips")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"xsyh",{get:function(){return ConfigCache.getConfig("timeDiscount")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"purgatory",{get:function(){return ConfigCache.getConfig("equipPurgatory")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"purgatoryResonate",{get:function(){return ConfigCache.getConfig("equipPurgatoryAdd")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"purgatoryResolve",{get:function(){var t=ConfigCache.getConfig("equipPurgatoryResolve");return t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"xslb",{get:function(){return ConfigCache.getConfig("timeGift")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"purgatoryBoss",{get:function(){var t=ConfigCache.getConfig("PurgatoryBoss");return t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"activityCata",{get:function(){var t=ConfigCache.getConfig("activityCata");return t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"fashionCopy",{get:function(){return ConfigCache.getConfig("fashionCopy")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"familyCfg",{get:function(){var t=ConfigCache.getConfig("family");return t[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"familyLv",{get:function(){var t=ConfigCache.getConfig("familyLv");return t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"familySys",{get:function(){var t=ConfigCache.getConfig("FamilySys");return t},enumerable:!0,configurable:!0}),t}();__reflect(GameConfig.prototype,"GameConfig");var ModuleManager=function(){function t(){}return t.init=function(){this.register(ViewConst.CREATE_ROLE,CreateRoleView),this.register(ViewConst.CREATE_HERO,CreateHeroView),this.register(ViewConst.WELCOME,NoviceWelcomeView),this.register(ViewConst.GAME_WORLD,GameWorld),this.register(ViewConst.MAIN_UI,MainUI),this.register(ViewConst.MAIN_UI_COCER,MainUICover),this.register(ViewConst.BUFF,BuffWin),this.register(ViewConst.MAIN_QUEST,QuestMainView),this.register(ViewConst.FIGHT_CHANGE,FightPowerChangeView),this.register(ViewConst.SIGN,SignWin),this.register(ViewConst.ROLE,RoleWin),this.register(ViewConst.PET,PetWin),this.register(ViewConst.SHOP,ShopWin),this.register(ViewConst.PETSHOWALL,PetShowAllWin),this.register(ViewConst.PETSIGLEINFOVIEW,PetSigleInfoView),this.register(ViewConst.PETTIPS,PetTips),this.register(ViewConst.ROLEPROTIPS,RoleProTipsView),this.register(ViewConst.BAG,BagWin),this.register(ViewConst.ITEMTIPS,ItemTips),this.register(ViewConst.SKILLTIPS,SkillTips),this.register(ViewConst.VIPTIPS,VipTips),this.register(ViewConst.DEBUG,DeBugWin),this.register(ViewConst.DEBUGDRAGON,DragonTestWin),this.register(ViewConst.NPCTALK,NPCTalkWin),this.register(ViewConst.EDITWIN,ConfigEditWin),this.register(ViewConst.SKILL,SkillWin),this.register(ViewConst.NEWITEM,NewItem),this.register(ViewConst.GASHAPON,GashaponWin),this.register(ViewConst.GASHAPONRW,GashaponRwWin),this.register(ViewConst.GASHAPONBAG,GashaponBagWin),this.register(ViewConst.OTHERROLE,RoleOtherPannelInfoWin),this.register(ViewConst.EMAIL,EmailWin),this.register(ViewConst.EMAIL_DETAIL,EmailDetailWin),this.register(ViewConst.SUITPROPERTY,SuitPropertyWin),this.register(ViewConst.SUITRESOLVE,SuitResolveWin),this.register(ViewConst.COPYTOWERRW,CopyTowerRwWin),this.register(ViewConst.RANKMODELWINA,RankModelWinA),this.register(ViewConst.LUCKYDAIL,LuckyDail),this.register(ViewConst.DAILYSHOWTIP,DailyShowTipWin),this.register(ViewConst.DAILY,DailyWin),this.register(ViewConst.ADVENTURE,AdventureWin),this.register(ViewConst.MELT,BagRecycleWin),this.register(ViewConst.COPY,CopyWin),this.register(ViewConst.VIP,VipWin),this.register(ViewConst.RANK,RankWin),this.register(ViewConst.CHARGE,VipChargeWin),this.register(ViewConst.CHUANGGUAN,ChuangguanPannel),this.register(ViewConst.FIRSTCHARGE,FirstChargeWin),this.register(ViewConst.REWARDEX,RewardExWin),this.register(ViewConst.AWARDTIPS,AwardTips),this.register(ViewConst.MAPLOADING,MapLoadingView),this.register(ViewConst.STRENGTH,StrengthWin),this.register(ViewConst.INSTRUCTION,InstructionTips),this.register(ViewConst.TRANSFER,TransferWin),this.register(ViewConst.TRANSFERSHOW,TransferShowWin),this.register(ViewConst.TRANSFERUSE,TransferUseWin),this.register(ViewConst.STRENGTHMASTER,StrengthMasterTips),this.register(ViewConst.BOSS,BossWin),this.register(ViewConst.SHOPTIPS,ShopTips),this.register(ViewConst.SYSTIPS,SysTips),this.register(ViewConst.REVIVE,ReviveTips),this.register(ViewConst.WBREVIVE,WorldBossReviveTips),this.register(ViewConst.BAGEXPAND,BagExpand),this.register(ViewConst.COORDINATE,CoordinateTips),this.register(ViewConst.FASHIONBUY,FashionBuyTips),this.register(ViewConst.WBBUY,EnterBuyTips),this.register(ViewConst.WINGSKILL,WingSkillTips),this.register(ViewConst.WBINFO,WorldInfo),this.register(ViewConst.COPY,CopyWin),this.register(ViewConst.COPYMATERIALSINFO,CopyMaterialsInfo),this.register(ViewConst.FAIL,FailTips),this.register(ViewConst.TOTALPROP,PropTips),this.register(ViewConst.RESONANCE,ResonanceTips),this.register(ViewConst.OFFLINEAW,OffLineAward),this.register(ViewConst.COPYEXPINFO,CopyExpInfo),this.register(ViewConst.JINGJI,JingjiWin),this.register(ViewConst.BUYBUFF,CopyExpBuffBuy),this.register(ViewConst.JINGJIRANK,JingjiRankTips),this.register(ViewConst.JINGJIINFO,JingjiInfo),this.register(ViewConst.ITEMLISTTIPS,ItemListTips),this.register(ViewConst.JEWELREPLACE,JewelReplaceTips),this.register(ViewConst.RUNESKILL,RuneSkillTips),this.register(ViewConst.SYSOPENHINT,SysOpenHint),this.register(ViewConst.CHAT,ChatWin),this.register(ViewConst.EMOJI,EmojiPart),this.register(ViewConst.KFHD,KFHDWin),this.register(ViewConst.PURGATORY_UPGRADE,PurgatoryUpgrade),this.register(ViewConst.PURGATORY_RESONATE_PROP,PurgatoryResonateProp),this.register(ViewConst.RANKB,RankModeWinB),this.register(ViewConst.XSLB,XSLBWin),this.register(ViewConst.PURGATORY_BAG,PurgatoryBag),this.register(ViewConst.ACTIVITY_CATALOGUE,ActivityCatalogue),this.register(ViewConst.FASHIONCOPYINFO,FashionCopyInfo),this.register(ViewConst.FAMILY,FamilyWin),this.register(ViewConst.FAMILY_LIST,FamilyListPanel),this.register(ViewConst.FAMILY_CREATE,FamilyCreatePanel),this.register(ViewConst.FAMILY_SETTING,FamilyApplyConfigPanel),this.register(ViewConst.FAMILY_DISMISS,FamilyDismissTipsPanel),this.register(ViewConst.FAMILY_APPLY,FamilyApplyPanel),this.register(ViewConst.FAMILY_NOTICE,FamilyNoticePanel),Proxy.init(),GameCache.init()
},t.register=function(t,e){App.ViewManager.register(t,e)},t}();__reflect(ModuleManager.prototype,"ModuleManager");var MsgConst=function(){function t(){}return t.RESIZE_STAGE="RESIZE_STAGE",t.GET_ROLELIST="GET_ROLELIST",t.RECONNECTED="RECONNECTED",t.CREATE_ROLE_ERROR="CREATE_ROLE_ERROR",t.PROPERTY="PROPERTY",t.LOGIN_INIT="LOGIN_INIT",t.FOCUS_CHANGE="FOCUS_CHANGE",t.CREATE_THING="CREATE_THING",t.ENTER_SCENE="ENTER_SCENE",t.UPDATE_SCENE_MAPITEM="UPDATE_SCENE_MAPITEM",t.BATTLE_KILL="BATTLE_KILL",t.HERO_DIE="HERO_DIE",t.NEW_HERO="NEW_HERO",t.BUFF_UPDATE="BUFF_UPDATE",t.ADVENTURE_UPDATE_LV="ADVENTURE_UPDATE_LV",t.ADVENTURE_UPDATE_SINGLE="ADVENTURE_UPDATE_SINGLE",t.QUEST_INIT_DOING="QUEST_INIT_DOING",t.QUEST_DELETE_DOING="QUEST_DELETE_DOING",t.QUEST_INIT_AVAILABLE="QUEST_INIT_AVAILABLE",t.QUEST_DELETE_AVAILABLE="QUEST_DELETE_AVAILABLE",t.QUEST_PROGRESS="QUEST_PROGRESS",t.QUEST_REFRESH_MAIN="QUEST_REFRESH_MAIN",t.EMAIL_REFRESH="EMAIL_REFRESH",t.EMAIL_UPDATE="EMAIL_UPDATE",t.EQUIP_INFO="EQUIP_INFO",t.EQUIP_ATTR_CHANGE="EQUIP_ATTR_CHANGE",t.EQUIP_STRENGTH="EQUIP_STRENGTH",t.EQUIP_REFINE="EQUIP_REFINE",t.EQUIP_PURGATORY="EQUIP_PURGATORY",t.SKILL_INFO="SKILL_INFO",t.SKILL_SORT="SKILL_SORT",t.SUIT_INFO="SUIT_INFO",t.SUIT_RESOLVE="SUIT_RESOLVE",t.SUIT_CHANGE="SUIT_CHANGE",t.TRANSFER_INFO="TRANSFER_INFO",t.SHOP_INFO="SHOP_INFO",t.RANK_INFO="RANK_INFO",t.PET_INFO="PET_INFO",t.PET_ACTIVATE="PET_ACTIVATE",t.DAILY="DAILY",t.ADVENTURE="ADVENTURE",t.VIP_CARD_TIME="VIP_CARD_TIME",t.VIP_CARD="VIP_CARD",t.VIP_WELFARE="VIP_WELFARE",t.FIRST_CHARGE="FIRST_CHARGE",t.CPOY_TOWER="CPOY_TOWER",t.CPOY_TOWER_LUCK="CPOY_TOWER_LUCK",t.CPOY_TOWER_RANK="CPOY_TOWER_RANK",t.COPY_EVALUATION="COPY_EVALUATION",t.COPY_COUNT="COPY_COUNT",t.COPY_TIME="COPY_TIME",t.COPY_BUFF_COUNT="COPY_BUFF_COUNT",t.COPY_EXP_TIME="COPY_EXP_TIME",t.COPY_EXP_WAVE="COPY_EXP_WAVE",t.COPY_EXP_INCOME="COPY_EXP_INCOME",t.BAG_INFO="BAG_INFO",t.BAG_ITEM_NUM="BAG_ITEM_NUM",t.BAG_EXPAND="BAG_EXPAND",t.BAG_RECYCLE="BAG_RECYCLE",t.BOSS_INFO="BOSS_INFO",t.WORLDBOSS_COUNT="WORLDBOSS_COUNT",t.BOSS_RANK_INFO="BOSS_RANK_INFO",t.BOSS_MYRANK="BOSS_MYRANK",t.FASHION_INFO="FASHION_INFO",t.FASHION_TRY="FASHION_TRY",t.FASHION_BUY="FASHION_BUY",t.FASHION_TAKE_OFF="FASHION_TAKE_OFF",t.FASHION_GET="FASHION_GET",t.FASHION_DELETE="FASHION_DELETE",t.SERVER_TIME_CHANGE="SERVER_TIME_CHANGE",t.WING_INFO="WING_INFO",t.GASHAPON="GASHAPON",t.GASHAPON_BAG="GASHAPON_BAG",t.GASHAPON_ONE_GET="GASHAPON_ONE_GET",t.GASHAPON_TEN_GET="GASHAPON_TEN_GET",t.TOTEMS_INFO="TOTEMS_INFO",t.TOTEMS_RESONANCE="TOTEMS_RESONANCE",t.JINGJI_PERSONAL_DATA="JINGJI_PERSONAL_DATA",t.JINGJI_LIST="JINGJI_LIST",t.JINGJI_DETAIL="JINGJI_DETAIL",t.JINGJI_RANK="JINGJI_RANK",t.JEWEL_BAG="JEWEL_BAG",t.JEWEL_LIST="JEWEL_LIST",t.RUNE_INFO="RUNE_INFO",t.CHAT_INFO="CHAT_INFO",t.SYS_INFO_MESSAGE="SYS_INFO_MESSAGE",t.CHAT_SHOWOFF="CHAT_SHOWOFF",t.XSYH_INFO="XSYH_INFO",t.XSYH_BUY_SUCCESS="XSYH_BUY_SUCCESS",t.PASS_RANK_INFO="PASS_RANK_INFO",t.PURGATORY_BOSS_UPDATE="PURGATORY_BOSS_UPDATE",t.FAMILY_INFO_UPDATE="FAMILY_INFO_UPDATE",t.FAMILY_LIST_UPDATE="FAMILY_LIST_UPDATE",t.FAMILY_MEM_UPDATE="FAMILY_MEM_UPDATE",t.FAMILY_APPLY_UPDATE="FAMILY_APPLY_UPDATE",t.FASHION_COPY="FASHION_COPY",t}();__reflect(MsgConst.prototype,"MsgConst");var PacketTypes;!function(t){t[t.Default=0]="Default",t[t.MOVE=1]="MOVE",t[t.PROPERTY=2]="PROPERTY",t[t.OBSERVER=3]="OBSERVER",t[t.BUFF=4]="BUFF",t[t.SKILL=5]="SKILL",t[t.EQUIP=7]="EQUIP",t[t.BAG=8]="BAG",t[t.CHAT=9]="CHAT",t[t.FAMILY=10]="FAMILY",t[t.SUB=11]="SUB",t[t.SHOP=12]="SHOP",t[t.DEAL=13]="DEAL",t[t.EFFECT=14]="EFFECT",t[t.DROP=15]="DROP",t[t.TEAM=16]="TEAM",t[t.PRACTICE=17]="PRACTICE",t[t.ONHOOK=18]="ONHOOK",t[t.COPY=20]="COPY",t[t.MAIL=22]="MAIL",t[t.STORAGE=23]="STORAGE",t[t.PK=24]="PK",t[t.DAILY=25]="DAILY",t[t.OTHER=26]="OTHER",t[t.SELLBUY=27]="SELLBUY",t[t.ACHIEVE=28]="ACHIEVE",t[t.ADVENTURE=29]="ADVENTURE",t[t.SWORN=31]="SWORN",t[t.CAMP=32]="CAMP",t[t.PET=34]="PET",t[t.TRAFFIC=35]="TRAFFIC",t[t.GASHAPON=36]="GASHAPON",t[t.QUEST=37]="QUEST",t[t.SLG=38]="SLG",t[t.MARKET=39]="MARKET",t[t.FRIEND=41]="FRIEND",t[t.MOUNT=42]="MOUNT",t[t.JEWEL=43]="JEWEL",t[t.HERO=44]="HERO",t[t.Device=45]="Device",t[t.Service=46]="Service",t[t.RICH=47]="RICH",t[t.TALISMAN=48]="TALISMAN",t[t.BOSS=49]="BOSS",t[t.CLOUDSTREASURE=50]="CLOUDSTREASURE",t[t.TALENT=51]="TALENT",t[t.PURGATORY=53]="PURGATORY",t[t.YEAR_ACTIVITY=52]="YEAR_ACTIVITY",t[t.Artifact=53]="Artifact",t[t.GEM_CLEAR=54]="GEM_CLEAR",t[t.ARUNE=55]="ARUNE",t[t.CARD=56]="CARD",t[t.VIP=57]="VIP",t[t.King=58]="King",t[t.SpiriBeasts=59]="SpiriBeasts",t[t.ARM=60]="ARM",t[t.CLOTHESPRESS=61]="CLOTHESPRESS",t[t.NEIGONG=62]="NEIGONG",t[t.WING=63]="WING",t[t.FURNACE=64]="FURNACE",t[t.NEW_EAMIL=65]="NEW_EAMIL",t[t.ROLE_TITLE=66]="ROLE_TITLE",t[t.VIP_NEW=67]="VIP_NEW",t[t.Gift_NEW=68]="Gift_NEW",t[t.SPECIALRING=69]="SPECIALRING",t[t.ShaCitySkill=70]="ShaCitySkill",t[t.GodEquip=71]="GodEquip",t[t.OFFICIAL=72]="OFFICIAL",t[t.LIANTI=73]="LIANTI",t[t.BOSSBOOK=74]="BOSSBOOK",t[t.HONOR=75]="HONOR",t[t.MONTHCARD=76]="MONTHCARD",t[t.STRENGTHEN=77]="STRENGTHEN",t[t.REFINE=78]="REFINE",t[t.FASHION=79]="FASHION",t[t.BADGE=80]="BADGE",t[t.TOTEMS=81]="TOTEMS",t[t.RUNE=82]="RUNE",t[t.TRANSFER=83]="TRANSFER",t[t.ONHOOK_DATA=129]="ONHOOK_DATA",t[t.DEPUTY=130]="DEPUTY",t[t.INTERACTIVE=131]="INTERACTIVE",t[t.ARENA=132]="ARENA",t[t.NPCDEAL=133]="NPCDEAL",t[t.SHORTCUT=134]="SHORTCUT",t[t.STORAGE_EXTEND=135]="STORAGE_EXTEND",t[t.EQUIP_FIX=136]="EQUIP_FIX",t[t.GETGIFTOL=138]="GETGIFTOL",t[t.PULSE=137]="PULSE",t[t.SCRIPT=139]="SCRIPT",t[t.MOUNT_SCRIPT=141]="MOUNT_SCRIPT",t[t.CLIMBINGTOWER_COPY=142]="CLIMBINGTOWER_COPY",t[t.NEARMOVING_COPY=143]="NEARMOVING_COPY",t[t.ACTIVE_SCRIPT=145]="ACTIVE_SCRIPT",t[t.ARCHIVEROLES=146]="ARCHIVEROLES",t[t.CIRCLE=147]="CIRCLE",t[t.NEWBOSS=148]="NEWBOSS",t[t.MONEYTREE=149]="MONEYTREE",t[t.GUILDWAREHOUSE=151]="GUILDWAREHOUSE",t[t.OFFER_QUEST=152]="OFFER_QUEST",t[t.LOGIN=255]="LOGIN"}(PacketTypes||(PacketTypes={}));var Proxy;!function(t){function e(){t.login=new LoginProxy,t.main=new MainProxy,t.move=new MoveProxy,t.other=new OtherProxy,t.skill=new SkillProxy,t.buff=new BuffProxy,t.email=new EmailProxy,t.suit=new SuitProxy,t.gashapon=new GashaponProxy,t.equip=new EquipProxy,t.bag=new BagProxy,t.daily=new DailyProxy,t.transfer=new TransferProxy,t.sign=new SignProxy,t.adventure=new AdventureProxy,t.chat=new ChatProxy,t.quest=new QuestProxy,t.drop=new DropProxy,t.copy=new CopyProxy,t.vip=new VipProxy,t.rank=new RankProxy,t.firstcharge=new FirstChargeProxy,t.copytower=new CopyTowerProxy,t.boss=new BossProxy,t.pet=new PetProxy,t.shop=new ShopProxy,t.script=new ScriptProxy,t.fashion=new FashionProxy,t.wing=new WingProxy,t.badge=new BadgeProxy,t.totems=new TotemsProxy,t.jewel=new JewelProxy,t.rune=new RuneProxy,t.purgatory=new PurgatoryProxy,t.family=new FamilyProxy}t.init=e}(Proxy||(Proxy={}));var ViewConst;!function(t){t[t.CREATE_ROLE=1]="CREATE_ROLE",t[t.CREATE_HERO=2]="CREATE_HERO",t[t.ROLE=3]="ROLE",t[t.BAG=4]="BAG",t[t.PET=5]="PET",t[t.COPY=6]="COPY",t[t.SHOP=7]="SHOP",t[t.VIP=8]="VIP",t[t.DAILY=9]="DAILY",t[t.TRANSFER=10]="TRANSFER",t[t.TRANSFERSHOW=11]="TRANSFERSHOW",t[t.TRANSFERUSE=12]="TRANSFERUSE",t[t.ADVENTURE=13]="ADVENTURE",t[t.FIRSTCHARGE=14]="FIRSTCHARGE",t[t.REWARDEX=15]="REWARDEX",t[t.CHARGE=16]="CHARGE",t[t.OTHERROLE=17]="OTHERROLE",t[t.SKILL=18]="SKILL",t[t.GASHAPON=19]="GASHAPON",t[t.GASHAPONRW=20]="GASHAPONRW",t[t.GASHAPONBAG=21]="GASHAPONBAG",t[t.EDITWIN=22]="EDITWIN",t[t.CHUANGGUAN=23]="CHUANGGUAN",t[t.STRENGTH=24]="STRENGTH",t[t.BOSS=25]="BOSS",t[t.JINGJI=26]="JINGJI",t[t.SIGN=27]="SIGN",t[t.EMAIL=28]="EMAIL",t[t.KFHD=29]="KFHD",t[t.FAMILY=30]="FAMILY",t[t.CLOSEALLWIN=1e4]="CLOSEALLWIN",t[t.GAME_WORLD=2e4]="GAME_WORLD",t[t.MAIN_UI=20001]="MAIN_UI",t[t.MAIN_QUEST=20002]="MAIN_QUEST",t[t.MAIN_UI_COCER=20003]="MAIN_UI_COCER",t[t.FIGHT_CHANGE=20004]="FIGHT_CHANGE",t[t.WELCOME=20005]="WELCOME",t[t.DEBUG=20006]="DEBUG",t[t.DEBUGDRAGON=20007]="DEBUGDRAGON",t[t.BUFF=20008]="BUFF",t[t.NPCTALK=20009]="NPCTALK",t[t.ROLEPROTIPS=20010]="ROLEPROTIPS",t[t.ITEMTIPS=20011]="ITEMTIPS",t[t.SKILLTIPS=20012]="SKILLTIPS",t[t.VIPTIPS=20013]="VIPTIPS",t[t.NEWITEM=20014]="NEWITEM",t[t.MELT=20015]="MELT",t[t.SUITPROPERTY=20016]="SUITPROPERTY",t[t.SUITRESOLVE=20017]="SUITRESOLVE",t[t.PETSHOWALL=20018]="PETSHOWALL",t[t.PETSIGLEINFOVIEW=20019]="PETSIGLEINFOVIEW",t[t.PETTIPS=20020]="PETTIPS",t[t.COPYTOWERRW=20021]="COPYTOWERRW",t[t.RANKMODELWINA=20022]="RANKMODELWINA",t[t.LUCKYDAIL=20023]="LUCKYDAIL",t[t.DAILYSHOWTIP=20024]="DAILYSHOWTIP",t[t.AWARDTIPS=20025]="AWARDTIPS",t[t.MAPLOADING=20026]="MAPLOADING",t[t.INSTRUCTION=20027]="INSTRUCTION",t[t.STRENGTHMASTER=20028]="STRENGTHMASTER",t[t.SHOPTIPS=20029]="SHOPTIPS",t[t.SYSTIPS=20030]="SYSTIPS",t[t.EMAIL_DETAIL=20031]="EMAIL_DETAIL",t[t.REVIVE=20032]="REVIVE",t[t.WBREVIVE=20033]="WBREVIVE",t[t.WBBUY=20034]="WBBUY",t[t.BAGEXPAND=20035]="BAGEXPAND",t[t.COORDINATE=20036]="COORDINATE",t[t.FASHIONBUY=20037]="FASHIONBUY",t[t.WINGSKILL=20038]="WINGSKILL",t[t.FAIL=20039]="FAIL",t[t.TOTALPROP=20040]="TOTALPROP",t[t.RESONANCE=20041]="RESONANCE",t[t.OFFLINEAW=20042]="OFFLINEAW",t[t.BUYBUFF=20043]="BUYBUFF",t[t.JINGJIRANK=20044]="JINGJIRANK",t[t.ITEMLISTTIPS=20045]="ITEMLISTTIPS",t[t.JEWELREPLACE=20046]="JEWELREPLACE",t[t.WBINFO=20047]="WBINFO",t[t.RANK=20048]="RANK",t[t.COPYMATERIALSINFO=20049]="COPYMATERIALSINFO",t[t.JINGJIINFO=20050]="JINGJIINFO",t[t.COPYEXPINFO=20051]="COPYEXPINFO",t[t.RUNESKILL=20052]="RUNESKILL",t[t.SYSOPENHINT=20053]="SYSOPENHINT",t[t.CHAT=20054]="CHAT",t[t.EMOJI=20055]="EMOJI",t[t.PURGATORY_RESONATE_PROP=20056]="PURGATORY_RESONATE_PROP",t[t.RANKB=20057]="RANKB",t[t.XSLB=20058]="XSLB",t[t.PURGATORY_BAG=20059]="PURGATORY_BAG",t[t.ACTIVITY_CATALOGUE=20060]="ACTIVITY_CATALOGUE",t[t.FASHIONCOPYINFO=20061]="FASHIONCOPYINFO",t[t.PURGATORY_UPGRADE=20062]="PURGATORY_UPGRADE",t[t.FAMILY_SETTING=20063]="FAMILY_SETTING",t[t.FAMILY_CREATE=20064]="FAMILY_CREATE",t[t.FAMILY_LIST=20065]="FAMILY_LIST",t[t.FAMILY_DISMISS=20066]="FAMILY_DISMISS",t[t.FAMILY_APPLY=20067]="FAMILY_APPLY",t[t.FAMILY_NOTICE=20068]="FAMILY_NOTICE"}(ViewConst||(ViewConst={}));var ViewManager=function(t){function e(){var e=t.call(this)||this;return e._viewCl={},e._viewCl={},e._views={},e._opens=[],e._opened={},e}return __extends(e,t),e.prototype.register=function(t,e){this._viewCl[t]=e},e.prototype.clear=function(){this.closeAll(),this._views={}},e.prototype.destroy=function(t){var e=this._views[t];e&&(e.destroy(),delete this._views[t],e=null)},e.prototype.destroyView=function(){var t=this._views,e=this._opens;for(var i in t){var n=t[i];-1==e.indexOf(parseInt(i))&&n.addDelayDestroy&&n.addDelayDestroy()}},e.prototype.openTab=function(t,e,i){var n;(e||i)&&(n=new ViewProp,n.firIndex=e,n.secIndex=i),this.open(t,n)},e.prototype.open=function(t,e){if(void 0===e&&(e=null),this.checkWin(t,!0)){if(t&&e){var i="";"string"!=typeof t&&(i=ViewConst[t]);var n=e.firIndex||0,o=e.secIndex||0;if(GameConfig.modControl[i]){var r=GameConfig.modControl[i][n][o];if(r&&!this.checkOpenCondition(r,!0))return}}"string"==typeof t&&(t=parseInt(t)||ViewConst[t]),t==ViewConst.FAMILY&&(GameCache.family.isInFamily||(t=ViewConst.FAMILY_LIST));var a=this.getView(t);if(null!=a)return a.isShow()?(a.resetOpen(e),a):(a.myParent==LayerManager.UI_Win&&t<ViewConst.CLOSEALLWIN&&this.closeAll(),a.addToParent.call(a,e),a.openView.call(a,e),(a.myParent==LayerManager.UI_Win||a.myParent==LayerManager.UI_Tips||a.myParent==LayerManager.UI_TipsNoClick)&&(a.horizontalCenter=0,a.verticalCenter=0),-1==this._opens.indexOf(t)&&this._opens.push(t),DeviceUtils.IsMobile&&t<ViewConst.GAME_WORLD&&(this.close(ViewConst.GAME_WORLD),LayerManager.UI_Main.visible=!1),a)}},e.prototype.recoredWin=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),"string"!=typeof t&&(t=ViewConst[t]),this.backOpen||(this.backOpen=new ViewProp),this.backOpen.key=t,this.backOpen.firIndex=e,this.backOpen.secIndex=i},e.prototype.close=function(t,e){if(void 0===e&&(e=null),"string"==typeof t&&(t=parseInt(t)||ViewConst[t]),t!=this.backOpen&&this.backOpen&&(this.backOpen=null),this.isShow(t)){var i=this.getView(t);if(null!=i){var n=this._opens.indexOf(t);n>=0&&this._opens.splice(n,1),i.removeFromParent(),i.close.call(i,e);for(var o=!0,r=0,a=this._opens;r<a.length;r++){var s=a[r];if(s<ViewConst.GAME_WORLD){o=!1;break}}return DeviceUtils.IsMobile&&o&&(this.open(ViewConst.GAME_WORLD),LayerManager.UI_Main.visible=!0),"string"==typeof ViewConst[t]&&this.recordOpenWin(ViewConst[t]),!0}}},e.prototype.recordOpenWin=function(t){this._opened[t]||(this._opened[t]=!0)},e.prototype.toggle=function(t,e){void 0===e&&(e=null),"string"==typeof t&&(t=parseInt(t)||ViewConst[t]),this.isShow(t)?this.close.call(this,t,e):this.open.call(this,t,e)},e.prototype.getView=function(t){"string"==typeof t&&(-1!=t.indexOf("#")&&(t=t.split("#")[0]),t=parseInt(t)||ViewConst[t]);var e=this._views[t];if(e)return e;var i=this._viewCl[t];return i&&(e=new i,e.viewKey=t,this._views[t]=e),e},e.prototype.getViewCl=function(t){return this._viewCl[t]},e.prototype.openParm=function(t,e,i){var n;n=new ViewProp,n.exData1=e,n.exData2=i,this.open(t,n)},e.prototype.closeAll=function(t){void 0===t&&(t=!0);for(var e=this._opens.length;e;){e--;var i=this.getView(this._opens[e]);t&&i.myParent==LayerManager.UI_Win?this.close(this._opens[e]):t||i.myParent==LayerManager.UI_Main||i.myParent==LayerManager.UI_Main2||this.close(this._opens[e])}},e.prototype.currOpenNum=function(){return this._opens.length},e.prototype.isShow=function(t){return-1!=this._opens.indexOf(t)},e.prototype.bOpened=function(t,e){void 0===e&&(e=0);var i=0==e?ViewConst[t]:ViewConst[t]+"#"+e;return this._opened[i]?!1:!0},e.prototype.getRedByWinName=function(t,e,i){void 0===i&&(i=!0);var n=GameConfig.modControl[t];if(!n){"string"==typeof t&&(t=parseInt(t)||ViewConst[t]);var o=App.ViewManager.getViewCl(t);return this.getRedByViewFun(o,e,[],t)}if(!this.checkWin(t))return!1;for(var r in n){var a=n[r];for(var s in a){var h=a[s];if(this.getRedByViewName(h,e)&&i)return!0}}return!1},e.prototype.getRedByViewFun=function(t,e,i,n){function o(){r=t.red(),App.RedPoint.redViewResult[n]=r,App.RedPoint.redViewCycleResult[n]=r}void 0===i&&(i=[]);var r=!1;if(t&&t.red)if(void 0==App.RedPoint.redViewCycleResult[n])if(t.changeMsg){var a=[];a=i&&i.length?t.changeMsg().concat(i):t.changeMsg();var s=!1;for(var h in a){var p=a[h];if(e[p]){s=!0;break}}void 0==App.RedPoint.redViewResult[n]&&(s=!0),s?o():(r=App.RedPoint.redViewResult[n]||!1,App.RedPoint.redViewCycleResult[n]=r)}else o();else r=App.RedPoint.redViewResult[n],App.RedPoint.redViewCycleResult[n]=r;return r},e.prototype.getRedByViewName=function(t,e){if(!t)return!1;if(!this.checkOpenCondition(t,!1))return!1;var i=[];if(t.redItemIdList)for(var n in t.redItemIdList)i.push(MsgConst.BAG_ITEM_NUM+t.redItemIdList[n]);return t.module?this.getRedByViewFun(window[t.module],e,i,t.module):t.pannel?this.getRedByViewFun(window[t.pannel],e,i,t.pannel):!1},e.prototype.showRedPoint=function(t,e,i,n,o){if(void 0===i&&(i=-5),void 0===n&&(n=-5),t instanceof egret.DisplayObjectContainer){o=o||"redPoint";var r=t.getChildByName(o);return e?r?r.visible=!0:(r=new eui.Image("public_json.public_hongdian_png"),r.touchEnabled=!1,r.right=i,r.top=n,r.name=o,t.addChild(r)):r&&(r.visible=!1),r}},e.prototype.checkWin=function(t,e){var i=!0;"string"!=typeof t&&(t=ViewConst[t]);var n,o=GameConfig.modControl[t];return o&&o[0]&&(n=o[0][0]?o[0][0]:o[0]),i=this.checkOpenCondition(n,e)},e.prototype.checkOpenCondition=function(t,e){if(void 0===e&&(e=!1),GlobalVar.OPEN_ALL_WIN)return!0;var i=!0,n=[];if(t){var o=GameCache.hero.mainPro;if(!o)return!1;if(t.openLv){var r=o.pro(PropId.AP_LEVEL);if(r<t.openLv){if(i=!1,!e)return!1;n.push(StringUtils.substitute(Language.lang.sysOpenError1,t.openLv))}}if(t.openQuest){var a=GameCache.quest.questId;if(null==a)return!1;if(-1!=a&&a<t.openQuest){if(i=!1,!e)return!1;var s=GameConfig.quest[t.openQuest-1]?GameConfig.quest[t.openQuest-1].name:"";n.push(StringUtils.substitute(Language.lang.lcn18,s))}}if(t.openDay){if(!GameCache.server.serverOpenDay)return!1;if(t.openDay>GameCache.server.serverOpenDay){if(i=!1,!e)return!1;n.push(StringUtils.substitute(Language.lang.lcn19,t.openQuest))}}if(t.vipLv&&t.vipLv>GameCache.vip.realValue()){if(i=!1,!e)return!1;n.push(StringUtils.substitute(Language.lang.sysOpenError2,t.vipLv))}}return!i&&e&&GlobalFun.SysMsg(StringUtils.substitute(Language.lang.sysOpen,n.join(","))),i},Object.defineProperty(e.prototype,"openedUI",{get:function(){var t=[];for(var e in this._opens){var i=this._opens[e];i!=ViewConst.GAME_WORLD&&i!=ViewConst.MAIN_UI&&i!=ViewConst.MAIN_QUEST&&i!=ViewConst.MAIN_UI_COCER&&t.push(this._opens[e])}return t},enumerable:!0,configurable:!0}),e}(BaseClass);__reflect(ViewManager.prototype,"ViewManager");var ViewProp=function(){function t(){this.key="",this.module="",this.firIndex=0,this.secIndex=0,this.openLv=1,this.openDay=1,this.winTitle=""}return t}();__reflect(ViewProp.prototype,"ViewProp");var MainProxy=function(t){function e(){var e=t.call(this,PacketTypes.Default)||this;return e.regNetMsg(2,e.doEntityAppear),e.regNetMsg(3,e.createMainActor),e.regNetMsg(4,e.createOtherActor),e.regNetMsg(5,e.doEntityDisappear),e.regNetMsg(6,e.doOtherPropertyChange),e.regNetMsg(7,e.doMainPropertyChange),e.regNetMsg(9,e.doEntityWalk),e.regNetMsg(10,e.sendHearBeat),e.regNetMsg(11,e.doNPCTalk),e.regNetMsg(13,e.doMapChange),e.regNetMsg(19,e.doAddActorEffect),e.regNetMsg(32,e.doAddSceneEffect),e.regNetMsg(35,e.doEntityDie),e.regNetMsg(76,e.doUpdatePet),e.regNetMsg(77,e.doOffLineAward),e.regNetMsg(78,e.doYewaiAward),e.regNetMsg(79,e.doEquitDone),e.regNetMsg(80,e.doServerDisconnected),e}return __extends(e,t),e.prototype.sendOnLogin=function(){Proxy.boss.sendBossInfo(),Proxy.other.sendJingjiDataRequest(),this.sendViewRange()},e.prototype.doEntityAppear=function(t){var e=t.readUnsignedByte(),i=t.readDouble();if(!GameCache.hero.isMySelf(i)){var n=App.ThingManager.getThing(i);if(!n){var o=new PropertySet,r=t.readCustomBytes();o.recog=i,o.setRoleName(r),o.kind=e;var a=t.readShort(),s=t.readShort();o.pro(PropId.AP_X,a),o.pro(PropId.AP_Y,s),o.pro(PropId.AP_BODY_ID,t.readUnsignedInt()),o.pro(PropId.AP_DIR,t.readByte()),ThingKind.isMonster(e)||ThingKind.isMonsterHuman(e)||ThingKind.isBuildMonster(e)?(o.pro(PropId.AP_LEVEL,t.readByte()),o.pro(PropId.AP_HP,t.readUnsignedInt()),o.pro(PropId.AP_MAX_HP,t.readUnsignedInt()),o.pro(PropId.AP_MOVE_SPEED,t.readShort()),o.pro(PropId.AP_ATTACK_SPEED,t.readUnsignedShort()),o.pro(PropId.AP_STATE,t.readUnsignedInt()),o.pro(PropId.AP_BODY_COLOR,t.readUnsignedInt()),t.readUnsignedInt(),o.pro(PropId.AP_ACTOR_ID,t.readShort()),o.gsName=t.readCustomBytes(),o.fightAi=GameCache.map.isAIMap):ThingKind.isPet(e)?(o.pro(PropId.AP_LEVEL,t.readByte()),o.pro(PropId.AP_HP,t.readUnsignedInt()),o.pro(PropId.AP_MAX_HP,t.readUnsignedInt()),o.pro(PropId.AP_MOVE_SPEED,t.readShort()),o.pro(PropId.AP_ATTACK_SPEED,t.readUnsignedShort()),o.pro(PropId.AP_STATE,t.readUnsignedInt()),o.pro(PropId.AP_BODY_COLOR,t.readUnsignedInt()),t.readUnsignedInt(),t.readUnsignedInt(),t.readByte(),t.readUnsignedInt()):ThingKind.isNPC(e)?(o.pro(PropId.AP_FACE_ID,t.readUnsignedByte()),o.pro(PropId.AP_STATE,t.readByte())):e==ThingKind.HeroPet&&(o.pro(PropId.AP_ACTOR_ID,t.readUnsignedInt()),o.pro(PropId.AP_LEVEL,t.readByte()),o.pro(PropId.AP_HP,t.readUnsignedInt()),o.pro(PropId.AP_MAX_HP,t.readUnsignedInt()),o.pro(PropId.AP_MOVE_SPEED,t.readUnsignedShort()),o.pro(PropId.AP_ATTACK_SPEED,t.readUnsignedShort()),o.pro(PropId.AP_STATE,t.readUnsignedInt()),o.pro(PropId.AP_BODY_COLOR,t.readUnsignedInt()),o.masterId=t.readUnsignedInt(),o.pro(PropId.AP_SEX,t.readByte()),o.pro(PropId.AP_JOB,t.readByte()),o.pro(PropId.AP_WEAPON,t.readUnsignedInt()),o.pro(PropId.AP_SWING,t.readUnsignedInt()),o.pro(PropId.AP_HAIR,t.readUnsignedInt()),o.pro(PropId.AP_HAT,t.readUnsignedInt()),o.pro(PropId.AP_EYE,t.readUnsignedInt()),o.pro(PropId.AP_GLASSES,t.readUnsignedInt()),o.pro(PropId.AP_PANTS,t.readUnsignedInt()),o.pro(PropId.AP_ASSIST,t.readUnsignedInt()),o.pro(PropId.AP_BACK,t.readUnsignedInt())),App.ThingManager.createThingToList(o)}}},e.prototype.createMainActor=function(t){var e=t.readByte(),i=t.readDouble();t.position+=2;var n=new PropertySet;n.recog=i,n.kind=ThingKind.Hero,n.fightAi=!0,n.aiCamp=AICampType.SELF,n.hpType=1,e==ThingKind.Human&&App.ThingManager.clear();var o=e==ThingKind.Human?PropId.numProperties:PropId.AP_PK_MOD;try{for(var r=0;o>r;r++)n.readProperty(r,t);n.setRoleName(t.readCustomBytes())}catch(a){alert("客户端与服务端的属性的定义不匹配")}e==ThingKind.Human&&(n.isMainPlayer=!0,GameCache.hero.mainPro=n);var s=App.ThingManager.createThing(n);GameCache.hero.addHero(s),App.MessageCenter.dispatch(MsgConst.LOGIN_INIT),App.ChatMgr.init()},e.prototype.doEntityWalk=function(t){var e=t.readDouble(),i=App.ThingManager.getThing(e),n=t.readShort(),o=t.readShort();i?i.addPathPoint(n,o):App.ThingManager.updatePoseInWaite(e,n,o)},e.prototype.sendHearBeat=function(){var t=this.getBytes(2);t.writeUnsignedInt(App.TimerManager.getSyncTime()),this.sendToServer(t)},e.prototype.doNPCTalk=function(t){var e=t.readByte();if(e){t.readDouble(),t.readCustomBytes()}},e.prototype.doMapChange=function(t){var e=t.readShort(),i=t.readShort(),n=t.readShort(),o=t.readByte(),r=(1==t.readUnsignedByte(),GameCache.map);r.exit(),r.update(e,o),GameCache.hero.focusPlayer&&(r.isSameMap()||(GameCache.hero.clearJump(),GameCache.hero.setPosition(i,n))),App.gameWorld.refreshDraw(),r.showLoading?App.ViewManager.open(ViewConst.MAPLOADING):App.MessageCenter.dispatch(MsgConst.ENTER_SCENE),r.firstEnterScene&&(App.TimerManager.addDelay(1,1,1,this.sendOnLogin,this),r.firstEnterScene=!1)},e.prototype.createOtherActor=function(t){var e=t.readDouble(),i=App.ThingManager.getThing(e);if(i)i.disappear=!1;else{var n=t.readCustomBytes(),o=(t.readByte(),t.readShort()),r=t.readShort(),a=new PropertySet;a.setRoleName(n),a.recog=e,a.kind=ThingKind.Human,a.pro(PropId.AP_X,o),a.pro(PropId.AP_Y,r),a.pro(PropId.AP_BODY_ID,t.readInt()),a.pro(PropId.AP_HP,t.readUnsignedInt()),a.pro(PropId.AP_MAX_HP,t.readUnsignedInt()),a.pro(PropId.AP_MOVE_SPEED,t.readUnsignedShort()),a.pro(PropId.AP_SEX,t.readByte()),a.pro(PropId.AP_JOB,t.readByte()),a.pro(PropId.AP_LEVEL,t.readByte()),a.pro(PropId.AP_WEAPON,t.readInt()),a.pro(PropId.AP_MOUNT,t.readInt()),a.pro(PropId.AP_SWING,t.readInt()),a.pro(PropId.AP_HAIR,t.readUnsignedInt()),a.pro(PropId.AP_HAT,t.readUnsignedInt()),a.pro(PropId.AP_EYE,t.readUnsignedInt()),a.pro(PropId.AP_GLASSES,t.readUnsignedInt()),a.pro(PropId.AP_PANTS,t.readUnsignedInt()),a.pro(PropId.AP_ASSIST,t.readUnsignedInt()),a.pro(PropId.AP_BACK,t.readUnsignedInt()),a.pro(PropId.AP_SOCIALMASK,t.readInt()),a.pro(PropId.AP_FACE_ID,t.readShort()),a.pro(PropId.AP_ATTACK_SPEED,t.readUnsignedShort()),a.pro(PropId.AP_DIR,t.readByte()),a.pro(PropId.AP_STATE,t.readUnsignedInt()),a.pro(PropId.AP_TEAM_ID,t.readUnsignedInt()),a.pro(PropId.AP_ZY,t.readByte()),a.pro(PropId.AP_CURNEWTITLE,t.readUnsignedInt()),a.pro(PropId.AP_RIDE_LEVEL,t.readUnsignedInt()),a.pro(PropId.AP_RIDEONID,t.readUnsignedInt()),t.readUnsignedInt(),a.pro(PropId.AP_BODY_COLOR,t.readUnsignedInt()),a.pro(PropId.AP_MOUNT_TYPE,t.readInt()),a.pro(PropId.AP_VIP_GRADE,t.readUnsignedInt()),a.pro(PropId.AP_CJG_BOX_OPEN_TICK,t.readInt());for(var s=t.readUnsignedByte(),h=0;s>h;h++)a.petId.push(t.readUnsignedShort()),a.petStar.push(t.readUnsignedShort()),a.petName.push(t.readCustomBytes());t.readUnsignedInt(),t.readByte(),a.pro(PropId.AP_BADGE_LVL,t.readUnsignedShort()),App.ThingManager.createThingToList(a)}},e.prototype.doAddActorEffect=function(t){var e=App.ThingManager.getThing(t.readDouble()),i=App.ThingManager.getThing(t.readDouble());if(i){var n=t.readByte();e&&i&&n&&App.FightManager.playBeHitSkill(e,i,GameCache.skill.getDefaultUserSkill(n))}},e.prototype.doAddSceneEffect=function(t){var e=App.ThingManager.getThing(t.readDouble());if(e){var i=t.readByte(),n=t.readUnsignedShort(),o=t.readUnsignedShort(),r=(t.readUnsignedShort(),t.readDouble());App.FightManager.playUseSkill(e,n,o,GameCache.skill.getDefaultUserSkill(i),r)}},e.prototype.doEntityDisappear=function(t){var e=t.readDouble();App.ThingManager.removeThing(e)},e.prototype.doMainPropertyChange=function(t){this.doPropertyChange(t,!0)},e.prototype.doOtherPropertyChange=function(t){this.doPropertyChange(t,!1)},e.prototype.doPropertyChange=function(t,e){void 0===e&&(e=!1);var i;if(e)i=GameCache.hero.list[0];else{var n=t.readDouble();i=App.ThingManager.getThing(n,!1),GameCache.hero.isMySelf(n)&&(e=!0)}if(i){for(var o=GameConfig.prop,r=void 0,a=t.readByte();a>0;){a--;var s=t.readUnsignedByte(),h=void 0,p=void 0;e&&(p=o[s]&&o[s].isFly,(s==PropId.AP_LEVEL||s==PropId.AP_COIN||s==PropId.AP_YUANBAO)&&(p=!0),p&&(h=i.pro.pro(s)));var l=t.readUnsignedInt();if(i.updateProperty(s,l),p&&l-h!=0){var c=l-h;s==PropId.AP_LEVEL?(App.FrameHandler.add(App.DisplayUtils.addEffectToObj,App.DisplayUtils,!0,i,"levelupeff_0_1",1,0,-100),App.FrameHandler.add(SysOpenMgr.checkOpen,SysOpenMgr,!0)):s==PropId.AP_COIN?c>0&&GlobalFun.SysMsg(StringUtils.substitute(Language.lang.huode,Language.lang.coin+" x"+c),SysMessageType.CHAT_PANEL_RIGHT):s==PropId.AP_YUANBAO?c>0&&GlobalFun.SysMsg(StringUtils.substitute(Language.lang.huode,Language.lang.yb+" x"+c),SysMessageType.CHAT_PANEL_RIGHT):(r||(r=[]),r.push({type:s,value:c}))}}r&&r.length&&ProChangeTips.ins().addPro(r)}},e.prototype.doEntityDie=function(t){var e=App.ThingManager.getThing(t.readDouble());App.ThingManager.getThing(t.readDouble());if(e){e.die();t.readInt()}},e.prototype.doUpdatePet=function(t){var e=t.readDouble(),i=App.ThingManager.getThing(e);if(i&&i.pro){var n=t.readByte();i.pro.petId=[],i.pro.petName=[],i.removePet();for(var o=0;n>o;o++)i.pro.petId.push(t.readUnsignedShort()),i.pro.petStar.push(t.readUnsignedShort()),i.pro.petName.push(t.readCustomBytes()),i.updatePet(i.pro.petId[o],i.pro.petName[o],i.pro.petStar[o])}},e.prototype.doOffLineAward=function(t){var e=t.readUnsignedInt(),i=t.readUnsignedInt(),n=t.readUnsignedInt(),o=t.readUnsignedInt(),r=0==t.readByte()?!1:!0,a=GlobalFun.formatMiniDateTime(t.readUnsignedInt()),s=new ViewProp;s.firData={},s.firData.coin=e,s.firData.exp=i,s.firData.eq=n,s.firData.melt=o,s.firData.full=r,s.firData.offLineTime=a,App.ViewManager.open(ViewConst.OFFLINEAW,s)},e.prototype.doYewaiAward=function(t){for(var e=t.readUnsignedByte(),i=0,n=[];e>i;i++){var o=t.readUnsignedShort(),r=t.readUnsignedInt();t.readUnsignedInt();0==o&&n.push({id:r})}App.ThingManager.addDropList(n)},e.prototype.doEquitDone=function(){GameCache.bag.reFreshRecyle()},e.prototype.doServerDisconnected=function(t){var e=t.readUnsignedByte();GameCache.global.disconnectedType=e,App.Socket.close(),GlobalFun.alert(Language.lang.socket1,null,null,1)},e.prototype.sendEnterGameScene=function(t,e){var i=this.getBytes(1);i.writeUnsignedInt(t),i.writeUnsignedInt(e),i.writeInt(0),this.sendToServer(i),console.log("角色登录",t)},e.prototype.sendMsgToGetSrvTime=function(){this.sendMsgId(10)},e.prototype.welcomeBoxCallBack=function(){var t="startPlay";this.sendTalkToNPC(0,t)},e.prototype.sendTalkToNPC=function(t,e){void 0===e&&(e="");var i=this.getBytes(5);i.writeDouble(t),i.writeString(e),this.sendToServer(i)},e.prototype.sendViewRange=function(){var t=this.getBytes(22),e=DeviceUtils.IsPC?25:10,i=DeviceUtils.IsPC?20:15;t.writeUnsignedShort(e),t.writeUnsignedShort(i),this.sendToServer(t)},e}(BaseProxy);__reflect(MainProxy.prototype,"MainProxy");var MoveProxy=function(t){function e(){return t.call(this,PacketTypes.MOVE)||this}return __extends(e,t),e.prototype.sendMoveto=function(t,e,i){var n=this.getBytes(1);n.writeUnsignedInt(i),n.writeUnsignedShort(t),n.writeUnsignedShort(e),n.writeUnsignedInt(0),n.writeUnsignedShort(GameCache.map.mapId),this.sendToServer(n)},e}(BaseProxy);__reflect(MoveProxy.prototype,"MoveProxy");var OtherProxy=function(t){function e(){var e=t.call(this,PacketTypes.OTHER)||this;return e.regNetMsg(8,e.doGetServicerTime),e.regNetMsg(28,e.doServerOpenTime),e.regNetMsg(31,e.doGetSystemData),e.regNetMsg(80,e.doAwardInfo),e.regNetMsg(82,e.doJingjiData),e.regNetMsg(83,e.doTargetList),e.regNetMsg(84,e.doTargetDetal),e.regNetMsg(85,e.doJingjiRankData),e}return __extends(e,t),e.prototype.doGetServicerTime=function(t){var e=GameCache.server;e.serverTimeBase=GlobalFun.formatMiniDateTime(t.readUnsignedInt())-egret.getTimer();var i=new Date;i.setTime(e.serverTime),console.log("当前时间：",i.toString())},e.prototype.doServerOpenTime=function(t){var e=GameCache.server;e.serverOpenDay=t.readUnsignedInt(),e.serverOpenTime=GlobalFun.formatMiniDateTime(t.readUnsignedInt()),e.serverCombineDay=t.readUnsignedInt(),e.serverCombineTime=GlobalFun.formatMiniDateTime(t.readUnsignedInt()),console.log("开服天数：",e.serverOpenDay),console.log("合服天数：",e.serverCombineDay),App.MessageCenter.dispatch(MsgConst.SERVER_TIME_CHANGE)},e.prototype.doGetSystemData=function(t){GameCache.settings.init();for(var e=t.readInt(),i=0;e>i;i++){var n=t.readByte(),o=t.readUnsignedInt();GameCache.settings.update(n,o,!1)}},e.prototype.doJingjiData=function(t){var e=t.readUnsignedInt(),i=t.readUnsignedInt(),n=t.readByte(),o=t.readByte(),r=GlobalFun.formatMiniDateTime(t.readUnsignedInt()),a=GlobalFun.formatMiniDateTime(t.readUnsignedInt()),s=t.readUnsignedShort();GameCache.jingji.initJingjiData(e,i,n,o,r,a,s)},e.prototype.doTargetList=function(t){for(var e=t.readByte(),i=[],n=0;e>n;n++){var o=t.readUnsignedInt(),r=t.readUnsignedInt(),a=t.readUnsignedInt(),s=t.readCustomBytes(),h={icon:o,lvl:r,power:a,roleName:s};i.push(h)}GameCache.jingji.jingjiList=i.concat(),App.MessageCenter.dispatch(MsgConst.JINGJI_LIST)},e.prototype.doTargetDetal=function(t){for(var e=t.readByte(),i=[],n=0;e>n;n++){var o=new PropertySet;t.readUnsignedInt(),o.pro(PropId.AP_ACTOR_ID,t.readInt()),o.pro(PropId.AP_JOB,t.readUnsignedInt()),o.pro(PropId.AP_LEVEL,t.readUnsignedInt()),o.pro(PropId.AP_SEX,t.readUnsignedInt());var r=t.readUnsignedInt();o.pro(PropId.AP_MAX_HP,r),o.pro(PropId.AP_HP,r),o.pro(PropId.AP_ATTACK,t.readUnsignedInt()),o.pro(PropId.AP_DEFENCE,t.readUnsignedInt()),o.pro(PropId.AP_HITVALUE,t.readUnsignedInt()),o.pro(PropId.AP_DOGVALUE,t.readUnsignedInt()),o.pro(PropId.AP_MOVE_SPEED,t.readUnsignedInt()),o.pro(PropId.AP_ATTACK_SPEED,t.readUnsignedInt()),o.pro(PropId.AP_CRIT,t.readUnsignedInt()),o.pro(PropId.AP_CRIT_HURT,t.readUnsignedInt()),o.skillList=[];for(var a=0;5>a;a++){var s=t.readUnsignedShort(),h=t.readUnsignedInt();0!=s&&o.skillList.push([s,h])}var p=t.readCustomBytes();o.setRoleName(p),i.push(o)}GameCache.jingji.targetDetail=i,App.MessageCenter.dispatch(MsgConst.JINGJI_DETAIL)},e.prototype.doJingjiRankData=function(t){for(var e=t.readByte(),i=[],n=0;e>n;n++){var o=t.readUnsignedInt(),r=t.readUnsignedInt(),a=t.readUnsignedInt(),s=t.readUnsignedInt(),h=t.readCustomBytes(),p={rank:o,job:r,lvl:a,winPoint:s,roleName:h};i.push(p)}App.MessageCenter.dispatch(MsgConst.JINGJI_RANK,i)},e.prototype.sendSystemConfigSave=function(t){var e=this.getBytes(30),i=Object.keys(t).length;e.writeInt(i);for(var n in t)e.writeByte(parseInt(n)),e.writeInt(t[n]);this.sendToServer(e)},e.prototype.doAwardInfo=function(t){for(var e=t.readUnsignedShort(),i=[],n=0;e>n;n++){var o=(t.readByte(),t.readUnsignedShort()),r=t.readUnsignedInt();i.push([o,r])}GameCache.map.mapConfig.type==SceneType.WORLD_BOSS||GameCache.map.mapConfig.type==SceneType.VIP_BOSS?GameCache.award.openAwardTips(i,AwardSourceType.BOSS_PLUS):GameCache.map.mapConfig.type==SceneType.FASHION?GameCache.copy.recordItemArr=GameCache.copy.recordItemArr.concat(i):GameCache.map.mapConfig.awardPanel&&GameCache.award.openAwardTips(i,AwardSourceType.OTHER)},e.prototype.sendJingjiDataRequest=function(){var t=this.getBytes(48);this.sendToServer(t)},e.prototype.sendListRefresh=function(t){void 0===t&&(t=0);var e=this.getBytes(49);e.writeByte(t),this.sendToServer(e)},e.prototype.sendBuyChance=function(){var t=this.getBytes(50);this.sendToServer(t)},e.prototype.sendChallenge=function(t){var e=this.getBytes(51);e.writeByte(t),this.sendToServer(e)},e.prototype.sendResult=function(t){var e=this.getBytes(52);e.writeByte(t),this.sendToServer(e)
},e.prototype.sendPointRank=function(t){var e=this.getBytes(53);e.writeByte(t),this.sendToServer(e)},e}(BaseProxy);__reflect(OtherProxy.prototype,"OtherProxy");var CreateRoleScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main),this.addLayer(LayerManager.UI_Win),this.addLayer(LayerManager.UI_Tips),App.ViewManager.open(ViewConst.CREATE_ROLE),window.showGame&&window.showGame()},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(CreateRoleScene.prototype,"CreateRoleScene");var MainScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayerAt(LayerManager.Game_Main,0),this.addLayer(LayerManager.UI_Main),this.addLayer(LayerManager.UI_Win),this.addLayer(LayerManager.UI_Main2),this.addLayer(LayerManager.UI_TipsNoClick),this.addLayer(LayerManager.UI_Tips),this.addLayer(LayerManager.UI_Message),this.addLayer(LayerManager.UI_Guide),App.ViewManager.open(ViewConst.GAME_WORLD),App.ViewManager.open(ViewConst.MAIN_UI),App.ViewManager.open(ViewConst.MAIN_UI_COCER),App.ViewManager.open(ViewConst.MAPLOADING)},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(MainScene.prototype,"MainScene");